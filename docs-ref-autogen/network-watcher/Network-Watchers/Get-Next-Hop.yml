### YamlMime:RESTOperation
uid: management.azure.com.network-watcher.networkwatchers.getnexthop
name: Get Next Hop
service: Network Watcher
groupName: Network Watchers
apiVersion: 2021-08-01
summary: Gets the next hop from the specified VM.
consumes:
- application/json
produces:
- application/json
paths:
- content: POST https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/networkWatchers/{networkWatcherName}/nextHop?api-version=2021-08-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The subscription credentials which uniquely identify the Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group.
  types:
  - uid: string
- name: networkWatcherName
  in: path
  isRequired: true
  description: The name of the network watcher.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: Client API version.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Request successful. The operation returns the next hop from the VM.
  types:
  - uid: NextHopResult
- name: 202 Accepted
  description: Accepted and the operation will complete asynchronously.
  types:
  - uid: NextHopResult
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: targetResourceId
    in: body
    isRequired: true
    description: The resource identifier of the target resource against which the action is to be performed.
    types:
    - uid: string
  - name: sourceIPAddress
    in: body
    isRequired: true
    description: The source IP address.
    types:
    - uid: string
  - name: destinationIPAddress
    in: body
    isRequired: true
    description: The destination IP address.
    types:
    - uid: string
  - name: targetNicResourceId
    in: body
    description: The NIC ID. (If VM has multiple NICs and IP forwarding is enabled on any of the nics, then this parameter must be specified. Otherwise optional).
    types:
    - uid: string
requestHeader: []
definitions:
- name: NextHopResult
  description: The information about next hop from the specified VM.
  kind: object
  properties:
  - name: nextHopType
    description: Next hop type.
    types:
    - uid: NextHopType
  - name: nextHopIpAddress
    description: Next hop IP Address.
    types:
    - uid: string
  - name: routeTableId
    description: The resource identifier for the route table associated with the route being returned. If the route being returned does not correspond to any user created routes then this field will be the string 'System Route'.
    types:
    - uid: string
- name: ErrorResponse
  description: The error object.
  kind: object
  properties:
  - name: error
    description: "Error  \nThe error details object."
    types:
    - uid: ErrorDetails
- name: NextHopParameters
  description: Parameters that define the source and destination endpoint.
  kind: object
  properties:
  - name: targetResourceId
    description: The resource identifier of the target resource against which the action is to be performed.
    types:
    - uid: string
  - name: sourceIPAddress
    description: The source IP address.
    types:
    - uid: string
  - name: destinationIPAddress
    description: The destination IP address.
    types:
    - uid: string
  - name: targetNicResourceId
    description: The NIC ID. (If VM has multiple NICs and IP forwarding is enabled on any of the nics, then this parameter must be specified. Otherwise optional).
    types:
    - uid: string
- name: NextHopType
  description: Next hop type.
  kind: enum
  properties:
  - name: Internet
    types:
    - uid: string
  - name: VirtualAppliance
    types:
    - uid: string
  - name: VirtualNetworkGateway
    types:
    - uid: string
  - name: VnetLocal
    types:
    - uid: string
  - name: HyperNetGateway
    types:
    - uid: string
  - name: None
    types:
    - uid: string
- name: ErrorDetails
  description: Common error details representation.
  kind: object
  properties:
  - name: code
    description: Error code.
    types:
    - uid: string
  - name: target
    description: Error target.
    types:
    - uid: string
  - name: message
    description: Error message.
    types:
    - uid: string
examples:
- name: Get next hop
  request:
    uri: POST https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkWatchers/nw1/nextHop?api-version=2021-08-01
    body: >-
      {
        "targetResourceId": "/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Compute/virtualMachines/vm1",
        "sourceIPAddress": "10.0.0.5",
        "destinationIPAddress": "10.0.0.10",
        "targetNicResourceId": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkInterfaces/nic1"
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkWatchers/nw1/nextHop?api-version=2021-08-01

      {
        "targetResourceId": "/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Compute/virtualMachines/vm1",
        "sourceIPAddress": "10.0.0.5",
        "destinationIPAddress": "10.0.0.10",
        "targetNicResourceId": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkInterfaces/nic1"
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.network.models.NextHopParameters;

      /** Samples for NetworkWatchers GetNextHop. */
      public final class Main {
          /*
           * x-ms-original-file: specification/network/resource-manager/Microsoft.Network/stable/2021-08-01/examples/NetworkWatcherNextHopGet.json
           */
          /**
           * Sample code: Get next hop.
           *
           * @param azure The entry point for accessing resource management APIs in Azure.
           */
          public static void getNextHop(com.azure.resourcemanager.AzureResourceManager azure) {
              azure
                  .networks()
                  .manager()
                  .serviceClient()
                  .getNetworkWatchers()
                  .getNextHop(
                      "rg1",
                      "nw1",
                      new NextHopParameters()
                          .withTargetResourceId(
                              "/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Compute/virtualMachines/vm1")
                          .withSourceIpAddress("10.0.0.5")
                          .withDestinationIpAddress("10.0.0.10")
                          .withTargetNicResourceId(
                              "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkInterfaces/nic1"),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager_2.16.0/sdk/resourcemanager/azure-resourcemanager/README.md) on how to add the SDK to your project and authenticate.
      # [Go](#tab/Go)
      ``` go
      package armnetwork_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"
      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/network/armnetwork"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/network/resource-manager/Microsoft.Network/stable/2021-08-01/examples/NetworkWatcherNextHopGet.json
      func ExampleWatchersClient_BeginGetNextHop() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armnetwork.NewWatchersClient("subid", cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	poller, err := client.BeginGetNextHop(ctx,
      		"rg1",
      		"nw1",
      		armnetwork.NextHopParameters{
      			DestinationIPAddress: to.Ptr("10.0.0.10"),
      			SourceIPAddress:      to.Ptr("10.0.0.5"),
      			TargetNicResourceID:  to.Ptr("/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkInterfaces/nic1"),
      			TargetResourceID:     to.Ptr("/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Compute/virtualMachines/vm1"),
      		},
      		nil)
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	res, err := poller.PollUntilDone(ctx, nil)
      	if err != nil {
      		log.Fatalf("failed to pull the result: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fnetwork%2Farmnetwork%2Fv1.0.0/sdk/resourcemanager/network/armnetwork/README.md) on how to add the SDK to your project and authenticate.
      # [JavsScirpt](#tab/JavsScirpt)
      ``` js
      const { NetworkManagementClient } = require("@azure/arm-network");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Gets the next hop from the specified VM.
       *
       * @summary Gets the next hop from the specified VM.
       * x-ms-original-file: specification/network/resource-manager/Microsoft.Network/stable/2021-08-01/examples/NetworkWatcherNextHopGet.json
       */
      async function getNextHop() {
        const subscriptionId = "subid";
        const resourceGroupName = "rg1";
        const networkWatcherName = "nw1";
        const parameters = {
          destinationIPAddress: "10.0.0.10",
          sourceIPAddress: "10.0.0.5",
          targetNicResourceId:
            "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkInterfaces/nic1",
          targetResourceId:
            "/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Compute/virtualMachines/vm1",
        };
        const credential = new DefaultAzureCredential();
        const client = new NetworkManagementClient(credential, subscriptionId);
        const result = await client.networkWatchers.beginGetNextHopAndWait(
          resourceGroupName,
          networkWatcherName,
          parameters
        );
        console.log(result);
      }

      getNextHop().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-network_28.0.0/sdk/network/arm-network/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "nextHopType": "VnetLocal",
        "nextHopIpAddress": "10.0.0.1",
        "routeTableId": "/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Network/routeTables/rt1"
      }
  - statusCode: "202"
    headers:
    - name: Location
      value: https:/management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkWatchers/nw1/nextHop?api-version=2021-08-01
    body: >-
      {
        "nextHopType": "VnetLocal",
        "nextHopIpAddress": "10.0.0.1",
        "routeTableId": "/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Network/routeTables/rt1"
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow.
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: Learn more about Network Watcher service - Gets the next hop from the specified VM.
errorCodes: []
