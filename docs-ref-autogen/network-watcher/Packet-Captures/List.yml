### YamlMime:RESTOperation
uid: management.azure.com.network-watcher.packetcaptures.list
name: List
service: Network Watcher
groupName: Packet Captures
apiVersion: 2022-01-01
summary: Lists all packet capture sessions within the specified resource group.
consumes:
- application/json
produces:
- application/json
paths:
- content: GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/networkWatchers/{networkWatcherName}/packetCaptures?api-version=2022-01-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The subscription credentials which uniquely identify the Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group.
  types:
  - uid: string
- name: networkWatcherName
  in: path
  isRequired: true
  description: The name of the Network Watcher resource.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: Client API version.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Successful packet capture enumeration request.
  types:
  - uid: PacketCaptureListResult
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: ErrorResponse
requestHeader: []
definitions:
- name: PacketCaptureListResult
  description: List of packet capture sessions.
  kind: object
  properties:
  - name: value
    description: Information about packet capture sessions.
    types:
    - uid: PacketCaptureResult
      isArray: true
- name: ErrorResponse
  description: The error object.
  kind: object
  properties:
  - name: error
    description: "Error  \nThe error details object."
    types:
    - uid: ErrorDetails
- name: PacketCaptureResult
  description: Information about packet capture session.
  kind: object
  properties:
  - name: name
    isReadyOnly: true
    description: Name of the packet capture session.
    types:
    - uid: string
  - name: id
    isReadyOnly: true
    description: ID of the packet capture operation.
    types:
    - uid: string
  - name: etag
    isReadyOnly: true
    description: A unique read-only string that changes whenever the resource is updated.
    types:
    - uid: string
  - name: properties.provisioningState
    isReadyOnly: true
    description: The provisioning state of the packet capture session.
    types:
    - uid: ProvisioningState
  - name: properties.target
    description: The ID of the targeted resource, only AzureVM and AzureVMSS as target type are currently supported.
    types:
    - uid: string
  - name: properties.scope
    description: A list of AzureVMSS instances which can be included or excluded to run packet capture. If both included and excluded are empty, then the packet capture will run on all instances of AzureVMSS.
    types:
    - uid: PacketCaptureMachineScope
  - name: properties.targetType
    description: Target type of the resource provided.
    types:
    - uid: PacketCaptureTargetType
  - name: properties.bytesToCapturePerPacket
    description: Number of bytes captured per packet, the remaining bytes are truncated.
    types:
    - uid: integer
    defaultValue: 0
  - name: properties.totalBytesPerSession
    description: Maximum size of the capture output.
    types:
    - uid: integer
    defaultValue: 1073741824
  - name: properties.timeLimitInSeconds
    description: Maximum duration of the capture session in seconds.
    types:
    - uid: integer
    defaultValue: 18000
  - name: properties.storageLocation
    description: The storage location for a packet capture session.
    types:
    - uid: PacketCaptureStorageLocation
  - name: properties.filters
    description: A list of packet capture filters.
    types:
    - uid: PacketCaptureFilter
      isArray: true
- name: ErrorDetails
  description: Common error details representation.
  kind: object
  properties:
  - name: code
    description: Error code.
    types:
    - uid: string
  - name: target
    description: Error target.
    types:
    - uid: string
  - name: message
    description: Error message.
    types:
    - uid: string
- name: ProvisioningState
  description: The current provisioning state.
  kind: enum
  properties:
  - name: Succeeded
    types:
    - uid: string
  - name: Updating
    types:
    - uid: string
  - name: Deleting
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
- name: PacketCaptureMachineScope
  description: A list of AzureVMSS instances which can be included or excluded to run packet capture. If both included and excluded are empty, then the packet capture will run on all instances of AzureVMSS.
  kind: object
  properties:
  - name: include
    description: List of AzureVMSS instances to run packet capture on.
    types:
    - uid: string
      isArray: true
  - name: exclude
    description: List of AzureVMSS instances which has to be excluded from the AzureVMSS from running packet capture.
    types:
    - uid: string
      isArray: true
- name: PacketCaptureTargetType
  description: Target type of the resource provided.
  kind: enum
  properties:
  - name: AzureVM
    types:
    - uid: string
  - name: AzureVMSS
    types:
    - uid: string
- name: PacketCaptureStorageLocation
  description: The storage location for a packet capture session.
  kind: object
  properties:
  - name: storageId
    description: The ID of the storage account to save the packet capture session. Required if no local file path is provided.
    types:
    - uid: string
  - name: storagePath
    description: The URI of the storage path to save the packet capture. Must be a well-formed URI describing the location to save the packet capture.
    types:
    - uid: string
  - name: filePath
    description: A valid local path on the targeting VM. Must include the name of the capture file (*.cap). For linux virtual machine it must start with /var/captures. Required if no storage ID is provided, otherwise optional.
    types:
    - uid: string
- name: PacketCaptureFilter
  description: Filter that is applied to packet capture request. Multiple filters can be applied.
  kind: object
  properties:
  - name: protocol
    description: Protocol to be filtered on.
    types:
    - uid: PcProtocol
    defaultValue: Any
  - name: localIPAddress
    description: 'Local IP Address to be filtered on. Notation: "127.0.0.1" for single address entry. "127.0.0.1-127.0.0.255" for range. "127.0.0.1;127.0.0.5"? for multiple entries. Multiple ranges not currently supported. Mixing ranges with multiple entries not currently supported. Default = null.'
    types:
    - uid: string
  - name: remoteIPAddress
    description: 'Local IP Address to be filtered on. Notation: "127.0.0.1" for single address entry. "127.0.0.1-127.0.0.255" for range. "127.0.0.1;127.0.0.5;" for multiple entries. Multiple ranges not currently supported. Mixing ranges with multiple entries not currently supported. Default = null.'
    types:
    - uid: string
  - name: localPort
    description: 'Local port to be filtered on. Notation: "80" for single port entry."80-85" for range. "80;443;" for multiple entries. Multiple ranges not currently supported. Mixing ranges with multiple entries not currently supported. Default = null.'
    types:
    - uid: string
  - name: remotePort
    description: 'Remote port to be filtered on. Notation: "80" for single port entry."80-85" for range. "80;443;" for multiple entries. Multiple ranges not currently supported. Mixing ranges with multiple entries not currently supported. Default = null.'
    types:
    - uid: string
- name: PcProtocol
  description: Protocol to be filtered on.
  kind: enum
  properties:
  - name: TCP
    types:
    - uid: string
  - name: UDP
    types:
    - uid: string
  - name: Any
    types:
    - uid: string
examples:
- name: List packet captures
  request:
    uri: GET https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkWatchers/nw1/packetCaptures?api-version=2022-01-01
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      GET https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkWatchers/nw1/packetCaptures?api-version=2022-01-01
      ```

      # [Go](#tab/Go)
      ``` go
      package armnetwork_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/network/armnetwork"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/network/resource-manager/Microsoft.Network/stable/2022-01-01/examples/NetworkWatcherPacketCapturesList.json
      func ExamplePacketCapturesClient_NewListPager() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armnetwork.NewPacketCapturesClient("subid", cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	pager := client.NewListPager("rg1", "nw1", nil)
      	for pager.More() {
      		nextResult, err := pager.NextPage(ctx)
      		if err != nil {
      			log.Fatalf("failed to advance page: %v", err)
      		}
      		for _, v := range nextResult.Value {
      			// TODO: use page item
      			_ = v
      		}
      	}
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fnetwork%2Farmnetwork%2Fv1.1.0/sdk/resourcemanager/network/armnetwork/README.md) on how to add the SDK to your project and authenticate.
      # [JavaScript](#tab/JavaScript)
      ``` js
      const { NetworkManagementClient } = require("@azure/arm-network");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Lists all packet capture sessions within the specified resource group.
       *
       * @summary Lists all packet capture sessions within the specified resource group.
       * x-ms-original-file: specification/network/resource-manager/Microsoft.Network/stable/2022-01-01/examples/NetworkWatcherPacketCapturesList.json
       */
      async function listPacketCaptures() {
        const subscriptionId = "subid";
        const resourceGroupName = "rg1";
        const networkWatcherName = "nw1";
        const credential = new DefaultAzureCredential();
        const client = new NetworkManagementClient(credential, subscriptionId);
        const resArray = new Array();
        for await (let item of client.packetCaptures.list(resourceGroupName, networkWatcherName)) {
          resArray.push(item);
        }
        console.log(resArray);
      }

      listPacketCaptures().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-network_29.0.0/sdk/network/arm-network/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "value": [
          {
            "name": "pc1",
            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkWatchers/nw1/packetCaptures/pc1",
            "etag": "W/\"00000000-0000-0000-0000-000000000000\"",
            "properties": {
              "provisioningState": "Updating",
              "target": "/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Compute/virtualMachines/vm1",
              "bytesToCapturePerPacket": 10000,
              "totalBytesPerSession": 100000,
              "timeLimitInSeconds": 100,
              "storageLocation": {
                "storageId": "/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Storage/storageAccounts/pcstore",
                "storagePath": "https://mytestaccountname.blob.core.windows.net/capture/pc1.cap",
                "filePath": "D:\\capture\\pc1.cap"
              },
              "filters": [
                {
                  "protocol": "TCP",
                  "localIPAddress": "10.0.0.4",
                  "localPort": "80"
                }
              ]
            }
          },
          {
            "name": "pc2",
            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkWatchers/nw1/packetCaptures/pc2",
            "etag": "W/\"00000000-0000-0000-0000-000000000000\"",
            "properties": {
              "provisioningState": "Succeeded",
              "target": "/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Compute/virtualMachines/vm1",
              "bytesToCapturePerPacket": 10000,
              "totalBytesPerSession": 100000,
              "timeLimitInSeconds": 100,
              "storageLocation": {
                "storageId": "/subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Storage/storageAccounts/pcstore",
                "storagePath": "https://mytestaccountname.blob.core.windows.net/capture/pc2.cap",
                "filePath": "D:\\capture\\pc2.cap"
              },
              "filters": []
            }
          }
        ]
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow.
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about Network Watcher service - Lists all packet capture sessions within the specified resource group.
errorCodes: []
