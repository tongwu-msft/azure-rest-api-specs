### YamlMime:RESTOperation
uid: management.azure.com.datadog.tagrules.createorupdate
name: Create Or Update
service: Datadog
groupName: Tag Rules
apiVersion: 2021-03-01
summary: Create or update a tag rule set for a given monitor resource.
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Datadog/monitors/{monitorName}/tagRules/{ruleSetName}?api-version=2021-03-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The ID of the target subscription.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group. The name is case insensitive.
  types:
  - uid: string
- name: monitorName
  in: path
  isRequired: true
  description: Monitor resource name
  types:
  - uid: string
- name: ruleSetName
  in: path
  isRequired: true
  description: Rule set name
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The API version to use for this operation.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Success
  types:
  - uid: MonitoringTagRules
- name: Other Status Codes
  description: Default error response.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: properties
    in: body
    description: Definition of the properties for a TagRules resource.
    types:
    - uid: MonitoringTagRulesProperties
requestHeader: []
definitions:
- name: MonitoringTagRulesProperties
  description: Definition of the properties for a TagRules resource.
  kind: object
  properties:
  - name: provisioningState
    isReadyOnly: true
    description: ''
    types:
    - uid: ProvisioningState
  - name: logRules
    description: Set of rules for sending logs for the Monitor resource.
    types:
    - uid: LogRules
  - name: metricRules
    description: Set of rules for sending metrics for the Monitor resource.
    types:
    - uid: MetricRules
- name: systemData
  description: Metadata pertaining to creation and last modification of the resource.
  kind: object
  properties:
  - name: createdBy
    description: The identity that created the resource.
    types:
    - uid: string
  - name: createdByType
    description: The type of identity that created the resource.
    types:
    - uid: createdByType
  - name: createdAt
    description: The timestamp of resource creation (UTC).
    types:
    - uid: string
  - name: lastModifiedBy
    description: The identity that last modified the resource.
    types:
    - uid: string
  - name: lastModifiedByType
    description: The type of identity that last modified the resource.
    types:
    - uid: createdByType
  - name: lastModifiedAt
    description: The timestamp of resource last modification (UTC)
    types:
    - uid: string
- name: MonitoringTagRules
  description: Capture logs and metrics of Azure resources based on ARM tags.
  kind: object
  properties:
  - name: name
    isReadyOnly: true
    description: Name of the rule set.
    types:
    - uid: string
  - name: id
    isReadyOnly: true
    description: The id of the rule set.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the rule set.
    types:
    - uid: string
  - name: properties
    description: Definition of the properties for a TagRules resource.
    types:
    - uid: MonitoringTagRulesProperties
  - name: systemData
    isReadyOnly: true
    description: Metadata pertaining to creation and last modification of the resource.
    types:
    - uid: systemData
- name: ErrorResponse
  description: Error response
  kind: object
  properties:
  - name: error
    description: The error object.
    types:
    - uid: ErrorDetail
- name: ProvisioningState
  kind: enum
  properties:
  - name: Accepted
    types:
    - uid: string
  - name: Creating
    types:
    - uid: string
  - name: Updating
    types:
    - uid: string
  - name: Deleting
    types:
    - uid: string
  - name: Succeeded
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
  - name: Canceled
    types:
    - uid: string
  - name: Deleted
    types:
    - uid: string
  - name: NotSpecified
    types:
    - uid: string
- name: LogRules
  description: Set of rules for sending logs for the Monitor resource.
  kind: object
  properties:
  - name: sendAadLogs
    description: Flag specifying if AAD logs should be sent for the Monitor resource.
    types:
    - uid: boolean
  - name: sendSubscriptionLogs
    description: Flag specifying if Azure subscription logs should be sent for the Monitor resource.
    types:
    - uid: boolean
  - name: sendResourceLogs
    description: Flag specifying if Azure resource logs should be sent for the Monitor resource.
    types:
    - uid: boolean
  - name: filteringTags
    description: List of filtering tags to be used for capturing logs. This only takes effect if SendResourceLogs flag is enabled. If empty, all resources will be captured. If only Exclude action is specified, the rules will apply to the list of all available resources. If Include actions are specified, the rules will only include resources with the associated tags.
    types:
    - uid: FilteringTag
      isArray: true
- name: MetricRules
  description: Set of rules for sending metrics for the Monitor resource.
  kind: object
  properties:
  - name: filteringTags
    description: List of filtering tags to be used for capturing metrics. If empty, all resources will be captured. If only Exclude action is specified, the rules will apply to the list of all available resources. If Include actions are specified, the rules will only include resources with the associated tags.
    types:
    - uid: FilteringTag
      isArray: true
- name: createdByType
  description: The type of identity that created the resource.
  kind: enum
  properties:
  - name: User
    types:
    - uid: string
  - name: Application
    types:
    - uid: string
  - name: ManagedIdentity
    types:
    - uid: string
  - name: Key
    types:
    - uid: string
- name: ErrorDetail
  description: The error detail.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: ErrorDetail
      isArray: true
  - name: additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: FilteringTag
  description: The definition of a filtering tag. Filtering tags are used for capturing resources and include/exclude them from being monitored.
  kind: object
  properties:
  - name: name
    description: The name (also known as the key) of the tag.
    types:
    - uid: string
  - name: value
    description: The value of the tag.
    types:
    - uid: string
  - name: action
    description: Valid actions for a filtering tag. Exclusion takes priority over inclusion.
    types:
    - uid: TagAction
- name: ErrorAdditionalInfo
  description: The resource management error additional info.
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: The additional info type.
    types:
    - uid: string
  - name: info
    isReadyOnly: true
    description: The additional info.
    types:
    - uid: object
- name: TagAction
  description: Valid actions for a filtering tag. Exclusion takes priority over inclusion.
  kind: enum
  properties:
  - name: Include
    types:
    - uid: string
  - name: Exclude
    types:
    - uid: string
examples:
- name: TagRules_CreateOrUpdate
  request:
    uri: PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myResourceGroup/providers/Microsoft.Datadog/monitors/myMonitor/tagRules/default?api-version=2021-03-01
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myResourceGroup/providers/Microsoft.Datadog/monitors/myMonitor/tagRules/default?api-version=2021-03-01
      ```

      # [Go](#tab/Go)
      ``` go
      package armdatadog_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/datadog/armdatadog"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/datadog/resource-manager/Microsoft.Datadog/stable/2021-03-01/examples/TagRules_CreateOrUpdate.json
      func ExampleTagRulesClient_CreateOrUpdate() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armdatadog.NewTagRulesClient("00000000-0000-0000-0000-000000000000", cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	res, err := client.CreateOrUpdate(ctx,
      		"myResourceGroup",
      		"myMonitor",
      		"default",
      		&armdatadog.TagRulesClientCreateOrUpdateOptions{Body: nil})
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fdatadog%2Farmdatadog%2Fv1.0.0/sdk/resourcemanager/datadog/armdatadog/README.md) on how to add the SDK to your project and authenticate.
      # [JavsScirpt](#tab/JavsScirpt)
      ``` js
      const { MicrosoftDatadogClient } = require("@azure/arm-datadog");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Create or update a tag rule set for a given monitor resource.
       *
       * @summary Create or update a tag rule set for a given monitor resource.
       * x-ms-original-file: specification/datadog/resource-manager/Microsoft.Datadog/stable/2021-03-01/examples/TagRules_CreateOrUpdate.json
       */
      async function tagRulesCreateOrUpdate() {
        const subscriptionId = "00000000-0000-0000-0000-000000000000";
        const resourceGroupName = "myResourceGroup";
        const monitorName = "myMonitor";
        const ruleSetName = "default";
        const credential = new DefaultAzureCredential();
        const client = new MicrosoftDatadogClient(credential, subscriptionId);
        const result = await client.tagRules.createOrUpdate(resourceGroupName, monitorName, ruleSetName);
        console.log(result);
      }

      tagRulesCreateOrUpdate().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-datadog_3.0.1/sdk/datadog/arm-datadog/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "name": "default",
        "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myResourceGroup/providers/Microsoft.Datadog/monitors/myMonitor/tagRules/default",
        "type": "Microsoft.Datadog/monitors/tagRules",
        "properties": {
          "logRules": {
            "sendAadLogs": false,
            "sendSubscriptionLogs": true,
            "sendResourceLogs": true,
            "filteringTags": [
              {
                "name": "Environment",
                "value": "Prod",
                "action": "Include"
              },
              {
                "name": "Environment",
                "value": "Dev",
                "action": "Exclude"
              }
            ]
          },
          "metricRules": {
            "filteringTags": []
          }
        }
      }
security: []
metadata:
  description: Learn more about Datadog service - Create or update a tag rule set for a given monitor resource.
errorCodes: []
