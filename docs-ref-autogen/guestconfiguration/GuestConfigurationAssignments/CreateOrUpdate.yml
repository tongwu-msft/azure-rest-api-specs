### YamlMime:RESTOperation
uid: management.azure.com.guestconfiguration.guestconfigurationassignments.createorupdate
name: Create Or Update
service: Guest Configuration
groupName: Guest Configuration Assignments
apiVersion: 2018-06-30-preview
summary: Creates an association between a VM and guest configuration
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Compute/virtualMachines/{vmName}/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/{guestConfigurationAssignmentName}?api-version=2018-06-30-preview
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: Subscription ID which uniquely identify Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The resource group name.
  types:
  - uid: string
  pattern: ^[-\w\._]+$
- name: vmName
  in: path
  isRequired: true
  description: The name of the virtual machine.
  types:
  - uid: string
- name: guestConfigurationAssignmentName
  in: path
  isRequired: true
  description: Name of the guest configuration assignment.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: Client Api Version.
  types:
  - uid: string
responses:
- name: 201 Created
  description: Created. The guest configuration assignment for the VM was created successfully.
  types:
  - uid: GuestConfigurationAssignment
- name: 200 OK
  description: OK. The guest configuration assignment for the VM was updated successfully.
  types:
  - uid: GuestConfigurationAssignment
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: properties
    in: body
    description: Properties of the Guest configuration assignment.
    types:
    - uid: GuestConfigurationAssignmentProperties
requestHeader: []
definitions:
- name: GuestConfigurationAssignmentProperties
  description: Guest configuration assignment properties.
  kind: object
  properties:
  - name: guestConfiguration
    description: The guest configuration to assign.
    types:
    - uid: GuestConfigurationNavigation
  - name: complianceStatus
    isReadyOnly: true
    description: A value indicating compliance status of the virtual machine for the assigned guest configuration.
    types:
    - uid: complianceStatus
  - name: lastComplianceStatusChecked
    isReadyOnly: true
    description: Date and time when last compliance status was checked.
    types:
    - uid: string
  - name: latestReportId
    isReadyOnly: true
    description: 'Id of the latest report for the guest configuration assignment. '
    types:
    - uid: string
  - name: context
    description: 'The source which initiated the guest configuration assignment. Ex: Azure Policy'
    types:
    - uid: string
  - name: assignmentHash
    isReadyOnly: true
    description: Combined hash of the configuration package and parameters.
    types:
    - uid: string
  - name: provisioningState
    isReadyOnly: true
    description: The provisioning state, which only appears in the response.
    types:
    - uid: provisioningState
- name: GuestConfigurationAssignment
  description: Guest configuration assignment is an association between a VM and guest configuration.
  kind: object
  properties:
  - name: properties
    description: Properties of the Guest configuration assignment.
    types:
    - uid: GuestConfigurationAssignmentProperties
  - name: id
    isReadyOnly: true
    description: ARM resource id of the guest configuration assignment.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Name of the guest configuration assignment.
    types:
    - uid: string
  - name: location
    isReadyOnly: true
    description: Region where the VM is located.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource.
    types:
    - uid: string
- name: ErrorResponse
  description: Error response of an operation failure
  kind: object
  properties:
  - name: message
    description: Error message indicating why the operation failed.
    types:
    - uid: string
- name: GuestConfigurationNavigation
  description: Guest configuration is an artifact that encapsulates DSC configuration and its dependencies. The artifact is a zip file containing DSC configuration (as MOF) and dependent resources and other dependencies like modules.
  kind: object
  properties:
  - name: kind
    description: Kind of the guest configuration. For example:DSC
    types:
    - uid: kind
  - name: name
    description: Name of the guest configuration.
    types:
    - uid: string
  - name: version
    description: Version of the guest configuration.
    types:
    - uid: string
  - name: contentUri
    isReadyOnly: true
    description: Uri of the storage where guest configuration package is uploaded.
    types:
    - uid: string
  - name: contentHash
    isReadyOnly: true
    description: Combined hash of the guest configuration package and configuration parameters.
    types:
    - uid: string
  - name: configurationParameter
    description: The configuration parameters for the guest configuration.
    types:
    - uid: ConfigurationParameter
      isArray: true
  - name: configurationSetting
    description: The configuration setting for the guest configuration.
    types:
    - uid: ConfigurationSetting
- name: complianceStatus
  description: A value indicating compliance status of the virtual machine for the assigned guest configuration.
  kind: enum
  properties:
  - name: Compliant
    types:
    - uid: string
  - name: NonCompliant
    types:
    - uid: string
  - name: Pending
    types:
    - uid: string
- name: provisioningState
  description: The provisioning state, which only appears in the response.
  kind: enum
  properties:
  - name: Succeeded
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
  - name: Canceled
    types:
    - uid: string
  - name: Created
    types:
    - uid: string
- name: kind
  description: Kind of the guest configuration. For example:DSC
  kind: enum
  properties:
  - name: DSC
    types:
    - uid: string
- name: ConfigurationParameter
  description: Represents a configuration parameter.
  kind: object
  properties:
  - name: name
    isReadyOnly: true
    description: Name of the configuration parameter.
    types:
    - uid: string
  - name: value
    isReadyOnly: true
    description: Value of the configuration parameter.
    types:
    - uid: string
- name: ConfigurationSetting
  description: Configuration setting of LCM (Local Configuration Manager).
  kind: object
  properties:
  - name: configurationMode
    isReadyOnly: true
    description: Specifies how the LCM(Local Configuration Manager) actually applies the configuration to the target nodes. Possible values are ApplyOnly, ApplyAndMonitor, and ApplyAndAutoCorrect.
    types:
    - uid: configurationMode
  - name: allowModuleOverwrite
    description: If true - new configurations downloaded from the pull service are allowed to overwrite the old ones on the target node. Otherwise, false
    types:
    - uid: allowModuleOverwrite
  - name: actionAfterReboot
    isReadyOnly: true
    description: Specifies what happens after a reboot during the application of a configuration. The possible values are ContinueConfiguration and StopConfiguration
    types:
    - uid: actionAfterReboot
  - name: refreshFrequencyMins
    isReadyOnly: true
    description: The time interval, in minutes, at which the LCM checks a pull service to get updated configurations. This value is ignored if the LCM is not configured in pull mode. The default value is 30.
    types:
    - uid: number
  - name: rebootIfNeeded
    isReadyOnly: true
    description: Set this to true to automatically reboot the node after a configuration that requires reboot is applied. Otherwise, you will have to manually reboot the node for any configuration that requires it. The default value is false. To use this setting when a reboot condition is enacted by something other than DSC (such as Windows Installer), combine this setting with the xPendingReboot module.
    types:
    - uid: rebootIfNeeded
  - name: configurationModeFrequencyMins
    isReadyOnly: true
    description: How often, in minutes, the current configuration is checked and applied. This property is ignored if the ConfigurationMode property is set to ApplyOnly. The default value is 15.
    types:
    - uid: number
- name: configurationMode
  description: Specifies how the LCM(Local Configuration Manager) actually applies the configuration to the target nodes. Possible values are ApplyOnly, ApplyAndMonitor, and ApplyAndAutoCorrect.
  kind: enum
  properties:
  - name: ApplyOnly
    types:
    - uid: string
  - name: ApplyAndMonitor
    types:
    - uid: string
  - name: ApplyAndAutoCorrect
    types:
    - uid: string
- name: allowModuleOverwrite
  description: If true - new configurations downloaded from the pull service are allowed to overwrite the old ones on the target node. Otherwise, false
  kind: enum
  properties:
  - name: "True"
    types:
    - uid: string
  - name: "False"
    types:
    - uid: string
- name: actionAfterReboot
  description: Specifies what happens after a reboot during the application of a configuration. The possible values are ContinueConfiguration and StopConfiguration
  kind: enum
  properties:
  - name: ContinueConfiguration
    types:
    - uid: string
  - name: StopConfiguration
    types:
    - uid: string
- name: rebootIfNeeded
  description: Set this to true to automatically reboot the node after a configuration that requires reboot is applied. Otherwise, you will have to manually reboot the node for any configuration that requires it. The default value is false. To use this setting when a reboot condition is enacted by something other than DSC (such as Windows Installer), combine this setting with the xPendingReboot module.
  kind: enum
  properties:
  - name: "True"
    types:
    - uid: string
  - name: "False"
    types:
    - uid: string
examples:
- name: Create or update guest configuration assignment
  request:
    uri: PUT https://management.azure.com/subscriptions/mySubscriptionId/resourceGroups/myResourceGroupName/providers/Microsoft.Compute/virtualMachines/myVMName/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/SecureProtocol?api-version=2018-06-30-preview
    body: >-
      {
        "location": "westcentralus",
        "name": "multiconfigassignment2",
        "properties": {
          "context": "Azure policy",
          "guestConfiguration": {
            "name": "AuditSecureProtocol",
            "version": "1.0.0.3"
          }
        }
      }
  responses:
  - statusCode: "201"
    body: >-
      {
        "location": "westcentralus",
        "id": null,
        "name": "multiconfigassignment2",
        "properties": {
          "complianceStatus": "Pending",
          "assignmentHash": null,
          "latestReportId": null,
          "lastComplianceStatusChecked": null,
          "context": "Azure policy A",
          "guestConfiguration": {
            "kind": null,
            "name": "AuditSecureProtocol",
            "version": "1.0.0.3",
            "contentUri": null,
            "contentHash": null,
            "configurationParameter": null,
            "configurationSetting": null
          },
          "provisioningState": "Succeeded"
        }
      }
  - statusCode: "200"
    body: >-
      {
        "location": "westcentralus",
        "id": null,
        "name": "multiconfigassignment2",
        "properties": {
          "complianceStatus": "Pending",
          "assignmentHash": null,
          "latestReportId": null,
          "lastComplianceStatusChecked": null,
          "context": "Azure policy A",
          "guestConfiguration": {
            "kind": null,
            "name": "AuditSecureProtocol",
            "version": "1.0.0.3",
            "contentUri": null,
            "contentHash": null,
            "configurationParameter": null,
            "configurationSetting": null
          },
          "provisioningState": "Succeeded"
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
errorCodes: []
