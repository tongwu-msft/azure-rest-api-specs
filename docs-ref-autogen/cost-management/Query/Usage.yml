### YamlMime:RESTOperation
uid: management.azure.com.cost-management.query.usage
name: Usage
service: Cost Management
groupName: Query
apiVersion: 2021-10-01
summary: Query the usage data for scope defined.
consumes:
- application/json
produces:
- application/json
paths:
- content: POST https://management.azure.com/{scope}/providers/Microsoft.CostManagement/query?api-version=2021-10-01
uriParameters:
- name: scope
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: The scope associated with query and export operations. This includes '/subscriptions/{subscriptionId}/' for subscription scope, '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}' for resourceGroup scope, '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}' for Billing Account scope and '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}/departments/{departmentId}' for Department scope, '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}/enrollmentAccounts/{enrollmentAccountId}' for EnrollmentAccount scope, '/providers/Microsoft.Management/managementGroups/{managementGroupId} for Management Group scope, '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}/billingProfiles/{billingProfileId}' for billingProfile scope, '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}/billingProfiles/{billingProfileId}/invoiceSections/{invoiceSectionId}' for invoiceSection scope, and '/providers/Microsoft.Billing/billingAccounts/{billingAccountId}/customers/{customerId}' specific for partners.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: Version of the API to be used with the client request.
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK. The request has succeeded.
  types:
  - uid: QueryResult
- name: 204 No Content
  description: No Content. Resource is not available.
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: type
    in: body
    isRequired: true
    description: The type of the query.
    types:
    - uid: ExportType
  - name: timeframe
    in: body
    isRequired: true
    description: The time frame for pulling data for the query. If custom, then a specific time period must be provided.
    types:
    - uid: TimeframeType
  - name: timePeriod
    in: body
    description: Has time period for pulling data for the query.
    types:
    - uid: QueryTimePeriod
  - name: dataset
    in: body
    isRequired: true
    description: Has definition for data in this query.
    types:
    - uid: QueryDataset
requestHeader: []
definitions:
- name: QueryTimePeriod
  description: The start and end date for pulling data for the query.
  kind: object
  properties:
  - name: from
    description: The start date to pull data from.
    types:
    - uid: string
  - name: to
    description: The end date to pull data to.
    types:
    - uid: string
- name: QueryDataset
  description: The definition of data present in the query.
  kind: object
  properties:
  - name: granularity
    description: The granularity of rows in the query.
    types:
    - uid: GranularityType
  - name: configuration
    description: Has configuration information for the data in the export. The configuration will be ignored if aggregation and grouping are provided.
    types:
    - uid: QueryDatasetConfiguration
  - name: aggregation
    description: Dictionary of aggregation expression to use in the query. The key of each item in the dictionary is the alias for the aggregated column. Query can have up to 2 aggregation clauses.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: QueryAggregation
  - name: grouping
    description: Array of group by expression to use in the query. Query can have up to 2 group by clauses.
    types:
    - uid: QueryGrouping
      isArray: true
  - name: filter
    description: The filter expression to use in the query. Please reference our Query API REST documentation for how to properly format the filter.
    types:
    - uid: QueryFilter
- name: QueryResult
  description: Result of query. It contains all columns listed under groupings and aggregation.
  kind: object
  properties:
  - name: properties.nextLink
    description: The link (url) to the next page of results.
    types:
    - uid: string
  - name: properties.columns
    description: Array of columns
    types:
    - uid: QueryColumn
      isArray: true
  - name: properties.rows
    description: Array of rows
    types:
    - uid: array
      isArray: true
  - name: id
    isReadyOnly: true
    description: Resource Id.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource name.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type.
    types:
    - uid: string
  - name: location
    isReadyOnly: true
    description: Location of the resource.
    types:
    - uid: string
  - name: sku
    isReadyOnly: true
    description: SKU of the resource.
    types:
    - uid: string
  - name: eTag
    isReadyOnly: true
    description: ETag of the resource.
    types:
    - uid: string
  - name: tags
    isReadyOnly: true
    description: Resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: ErrorResponse
  description: "Error response indicates that the service is not able to process the incoming request. The reason is provided in the error message. \n\nSome Error responses: \n\n * 429 TooManyRequests - Request is throttled. Retry after waiting for the time specified in the \"x-ms-ratelimit-microsoft.consumption-retry-after\" header. \n\n * 503 ServiceUnavailable - Service is temporarily unavailable. Retry after waiting for the time specified in the \"Retry-After\" header."
  kind: object
  properties:
  - name: error
    description: The details of the error.
    types:
    - uid: ErrorDetails
- name: QueryDefinition
  description: The definition of a query.
  kind: object
  properties:
  - name: type
    description: The type of the query.
    types:
    - uid: ExportType
  - name: timeframe
    description: The time frame for pulling data for the query. If custom, then a specific time period must be provided.
    types:
    - uid: TimeframeType
  - name: timePeriod
    description: Has time period for pulling data for the query.
    types:
    - uid: QueryTimePeriod
  - name: dataset
    description: Has definition for data in this query.
    types:
    - uid: QueryDataset
- name: GranularityType
  description: The granularity of rows in the forecast.
  kind: enum
  properties:
  - name: Daily
    types:
    - uid: string
- name: QueryDatasetConfiguration
  description: The configuration of dataset in the query.
  kind: object
  properties:
  - name: columns
    description: Array of column names to be included in the query. Any valid query column name is allowed. If not provided, then query includes all columns.
    types:
    - uid: string
      isArray: true
- name: QueryAggregation
  description: The aggregation expression to be used in the query.
  kind: object
  properties:
  - name: name
    description: The name of the column to aggregate.
    types:
    - uid: string
  - name: function
    description: The name of the aggregation function to use.
    types:
    - uid: FunctionType
- name: QueryGrouping
  description: The group by expression to be used in the query.
  kind: object
  properties:
  - name: type
    description: Has type of the column to group.
    types:
    - uid: QueryColumnType
  - name: name
    description: The name of the column to group.
    types:
    - uid: string
- name: QueryFilter
  description: The filter expression to be used in the export.
  kind: object
  properties:
  - name: and
    description: The logical "AND" expression. Must have at least 2 items.
    types:
    - uid: QueryFilter
      isArray: true
  - name: or
    description: The logical "OR" expression. Must have at least 2 items.
    types:
    - uid: QueryFilter
      isArray: true
  - name: dimensions
    description: Has comparison expression for a dimension
    types:
    - uid: QueryComparisonExpression
  - name: tags
    description: Has comparison expression for a tag
    types:
    - uid: QueryComparisonExpression
- name: QueryColumn
  description: QueryColumn properties
  kind: object
  properties:
  - name: name
    description: The name of column.
    types:
    - uid: string
  - name: type
    description: The type of column.
    types:
    - uid: string
- name: ErrorDetails
  description: The details of the error.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: Error message indicating why the operation failed.
    types:
    - uid: string
- name: ExportType
  description: The type of the query.
  kind: enum
  properties:
  - name: Usage
    types:
    - uid: string
  - name: ActualCost
    types:
    - uid: string
  - name: AmortizedCost
    types:
    - uid: string
- name: TimeframeType
  description: The time frame for pulling data for the query. If custom, then a specific time period must be provided.
  kind: enum
  properties:
  - name: MonthToDate
    types:
    - uid: string
  - name: BillingMonthToDate
    types:
    - uid: string
  - name: TheLastMonth
    types:
    - uid: string
  - name: TheLastBillingMonth
    types:
    - uid: string
  - name: WeekToDate
    types:
    - uid: string
  - name: Custom
    types:
    - uid: string
- name: FunctionType
  description: The name of the aggregation function to use.
  kind: enum
  properties:
  - name: Sum
    types:
    - uid: string
- name: QueryColumnType
  description: The type of the column in the export.
  kind: enum
  properties:
  - name: Tag
    types:
    - uid: string
  - name: Dimension
    types:
    - uid: string
- name: QueryComparisonExpression
  description: The comparison expression to be used in the query.
  kind: object
  properties:
  - name: name
    description: The name of the column to use in comparison.
    types:
    - uid: string
  - name: operator
    description: The operator to use for comparison.
    types:
    - uid: QueryOperatorType
  - name: values
    description: Array of values to use for comparison
    types:
    - uid: string
      isArray: true
- name: QueryOperatorType
  description: The operator to use for comparison.
  kind: enum
  properties:
  - name: In
    types:
    - uid: string
examples:
- name: SubscriptionQuery-Legacy
  request:
    uri: POST https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.CostManagement/Query/00000000-0000-0000-0000-000000000000",
        "name": "55312978-ba1b-415c-9304-cfd9c43c0481",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": null,
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              2.10333307059661,
              "ScreenSharingTest-peer",
              20180331,
              "USD"
            ],
            [
              218.68795741935486,
              "Ict_StratAndPlan_GoldSprova_Prod",
              20180331,
              "USD"
            ],
            [
              0.14384913581657052,
              "ssbciotelement01",
              20180401,
              "USD"
            ],
            [
              0.009865586851323632,
              "ict_stratandplan_goldsprova_prod",
              20180429,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: SubscriptionQueryGrouping-Legacy
  request:
    uri: POST https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.CostManagement/Query/00000000-0000-0000-0000-000000000000",
        "name": "55312978-ba1b-415c-9304-cfd9c43c0481",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": null,
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              0.009865586851323632,
              "Ict_StratAndPlan_GoldSprova_Prod_0",
              "USD"
            ],
            [
              218.68795741935486,
              "Ict_StratAndPlan_GoldSprova_Prod_1",
              "USD"
            ],
            [
              2.10333307059661,
              "ScreenSharingTest-peer1",
              "USD"
            ],
            [
              0.14384913581657052,
              "Ssbciotelement01",
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: ResourceGroupQuery-Legacy
  request:
    uri: POST https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/ScreenSharingTest-peer/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/ScreenSharingTest-peer/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "subscriptions/55312978-ba1b-415c-9304-c4b9c43c0481/resourcegroups/ScreenSharingTest-peer/providers/Microsoft.CostManagement/Query/9af9459d-441d-4055-9ed0-83d4c4a363fb",
        "name": "9af9459d-441d-4055-9ed0-83d4c4a363fb",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": null,
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              2.10333307059661,
              "ScreenSharingTest-peer",
              20180417,
              "USD"
            ],
            [
              20.10333307059661,
              "ScreenSharingTest-peer",
              20180418,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: ResourceGroupQueryGrouping-Legacy
  request:
    uri: POST https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/ScreenSharingTest-peer/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "Daily",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceType"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/ScreenSharingTest-peer/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "Daily",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceType"
            }
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/ScreenSharingTest-peer/providers/Microsoft.CostManagement/Query/9af9459d-441d-4055-9ed0-83d4c4a363fb",
        "name": "9af9459d-441d-4055-9ed0-83d4c4a363fb",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": null,
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceType",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              2.10333307059661,
              "Microsoft.SqlServer",
              20180417,
              "USD"
            ],
            [
              20.10333307059661,
              "Microsoft.Compute",
              20180418,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: BillingAccountQuery-Legacy
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/70664866/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/70664866/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }

      ```

      # [Go](#tab/Go)
      ``` go
      package armcostmanagement_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"
      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/costmanagement/armcostmanagement"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/cost-management/resource-manager/Microsoft.CostManagement/stable/2021-10-01/examples/BillingAccountQuery.json
      func ExampleQueryClient_Usage() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armcostmanagement.NewQueryClient(cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	res, err := client.Usage(ctx,
      		"providers/Microsoft.Billing/billingAccounts/70664866",
      		armcostmanagement.QueryDefinition{
      			Type: to.Ptr(armcostmanagement.ExportTypeUsage),
      			Dataset: &armcostmanagement.QueryDataset{
      				Filter: &armcostmanagement.QueryFilter{
      					And: []*armcostmanagement.QueryFilter{
      						{
      							Or: []*armcostmanagement.QueryFilter{
      								{
      									Dimensions: &armcostmanagement.QueryComparisonExpression{
      										Name:     to.Ptr("ResourceLocation"),
      										Operator: to.Ptr(armcostmanagement.QueryOperatorTypeIn),
      										Values: []*string{
      											to.Ptr("East US"),
      											to.Ptr("West Europe")},
      									},
      								},
      								{
      									Tags: &armcostmanagement.QueryComparisonExpression{
      										Name:     to.Ptr("Environment"),
      										Operator: to.Ptr(armcostmanagement.QueryOperatorTypeIn),
      										Values: []*string{
      											to.Ptr("UAT"),
      											to.Ptr("Prod")},
      									},
      								}},
      						},
      						{
      							Dimensions: &armcostmanagement.QueryComparisonExpression{
      								Name:     to.Ptr("ResourceGroup"),
      								Operator: to.Ptr(armcostmanagement.QueryOperatorTypeIn),
      								Values: []*string{
      									to.Ptr("API")},
      							},
      						}},
      				},
      				Granularity: to.Ptr(armcostmanagement.GranularityTypeDaily),
      			},
      			Timeframe: to.Ptr(armcostmanagement.TimeframeTypeMonthToDate),
      		},
      		nil)
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fcostmanagement%2Farmcostmanagement%2Fv1.0.0/sdk/resourcemanager/costmanagement/armcostmanagement/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/70664866/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/70664866/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              20180331,
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              20180331,
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              20180331,
              "USD"
            ],
            [
              0.16677720329728665,
              "gs-stms-dev",
              20180331,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: BillingAccountQueryGrouping-Legacy
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/70664866/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/70664866/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/70664866/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/70664866/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: EnrollmentAccountQuery-Legacy
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/100/enrollmentAccounts/456/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/100/enrollmentAccounts/456/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/70664866/enrollmentAccounts/456/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/70664866/enrollmentAccounts/456/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              20180331,
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              20180331,
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              20180331,
              "USD"
            ],
            [
              0.16677720329728665,
              "gs-stms-dev",
              20180331,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: EnrollmentAccountQueryGrouping-Legacy
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/100/enrollmentAccounts/456/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "Daily",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/100/enrollmentAccounts/456/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "Daily",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/70664866/enrollmentAccounts/456/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/70664866/enrollmentAccounts/456/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              20180331,
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              20180331,
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              20180331,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: DepartmentQuery-Legacy
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/100/departments/123/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/100/departments/123/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/70664866/departments/123/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/70664866/departments/123/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              20180331,
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              20180331,
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              20180331,
              "USD"
            ],
            [
              0.16677720329728665,
              "gs-stms-dev",
              20180331,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: DepartmentQueryGrouping-Legacy
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/100/departments/123/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/100/departments/123/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/70664866/departments/123/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/70664866/departments/123/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: ManagementGroupQuery-Legacy
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Management/managementGroups/MyMgId/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Management/managementGroups/MyMgId/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Management/managementGroups/MyMgId/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Management/managementGroups/MyMgId/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              20180331,
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              20180331,
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              20180331,
              "USD"
            ],
            [
              0.16677720329728665,
              "gs-stms-dev",
              20180331,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: ManagementGroupQueryGrouping-Legacy
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Management/managementGroups/MyMgId/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Management/managementGroups/MyMgId/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Management/managementGroups/MyMgId/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Management/managementGroups/MyMgId/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              20180331,
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              20180331,
              "USD"
            ],
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              20180331,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: BillingAccountQuery-Modern
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/12345:6789/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              20180331,
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              20180331,
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              20180331,
              "USD"
            ],
            [
              0.16677720329728665,
              "gs-stms-dev",
              20180331,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: BillingAccountQueryGrouping-Modern
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/12345:6789/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: BillingProfileQuery-Modern
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              20180331,
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              20180331,
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              20180331,
              "USD"
            ],
            [
              0.16677720329728665,
              "gs-stms-dev",
              20180331,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: BillingProfileQueryGrouping-Modern
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: InvoiceSectionQuery-Modern
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/invoiceSections/9876/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/invoiceSections/9876/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/invoiceSections/9876/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/invoiceSections/9876/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              20180331,
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              20180331,
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              20180331,
              "USD"
            ],
            [
              0.16677720329728665,
              "gs-stms-dev",
              20180331,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: InvoiceSectionQueryGrouping-Modern
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/invoiceSections/9876/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/invoiceSections/9876/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/invoiceSections/9876/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/billingProfiles/13579/invoiceSections/9876/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: CustomerQuery-Modern
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/customers/5678/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/customers/5678/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "MonthToDate",
        "dataset": {
          "granularity": "Daily",
          "filter": {
            "and": [
              {
                "or": [
                  {
                    "dimensions": {
                      "name": "ResourceLocation",
                      "operator": "In",
                      "values": [
                        "East US",
                        "West Europe"
                      ]
                    }
                  },
                  {
                    "tags": {
                      "name": "Environment",
                      "operator": "In",
                      "values": [
                        "UAT",
                        "Prod"
                      ]
                    }
                  }
                ]
              },
              {
                "dimensions": {
                  "name": "ResourceGroup",
                  "operator": "In",
                  "values": [
                    "API"
                  ]
                }
              }
            ]
          }
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/12345:6789/customers/5678/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/customers/5678/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "UsageDate",
              "type": "Number"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              20180331,
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              20180331,
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              20180331,
              "USD"
            ],
            [
              0.16677720329728665,
              "gs-stms-dev",
              20180331,
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
- name: CustomerQueryGrouping-Modern
  request:
    uri: POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/customers/5678/providers/Microsoft.CostManagement/query?api-version=2021-10-01
    body: >-
      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/customers/5678/providers/Microsoft.CostManagement/query?api-version=2021-10-01

      {
        "type": "Usage",
        "timeframe": "TheLastMonth",
        "dataset": {
          "granularity": "None",
          "aggregation": {
            "totalCost": {
              "name": "PreTaxCost",
              "function": "Sum"
            }
          },
          "grouping": [
            {
              "type": "Dimension",
              "name": "ResourceGroup"
            }
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "providers/Microsoft.Billing/billingAccounts/12345:6789/customers/5678/providers/Microsoft.CostManagement/Query/ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "name": "ad67fd91-c131-4bda-9ba9-7187ecb1cebd",
        "type": "microsoft.costmanagement/Query",
        "properties": {
          "nextLink": "https://management.azure.com/providers/Microsoft.Billing/billingAccounts/12345:6789/customers/5678/providers/Microsoft.CostManagement/Query?api-version=2021-10-01&$skiptoken=AQAAAA%3D%3D",
          "columns": [
            {
              "name": "PreTaxCost",
              "type": "Number"
            },
            {
              "name": "ResourceGroup",
              "type": "String"
            },
            {
              "name": "Currency",
              "type": "String"
            }
          ],
          "rows": [
            [
              19.545363672276512,
              "JapanUnifia-Trial",
              "USD"
            ],
            [
              173.41979241290323,
              "RVIIOT-TRIAL",
              "USD"
            ],
            [
              20.35941656262545,
              "VSTSHOL-1595322048000",
              "USD"
            ]
          ]
        }
      }
  - statusCode: "204"
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow.
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: Learn more about Cost Management service - Query the usage data for scope defined.
errorCodes: []
