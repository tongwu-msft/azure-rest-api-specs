### YamlMime:RESTOperation
uid: management.azure.com.defenderforcloud.subassessments.list
name: List
service: Defender for Cloud
groupName: Sub Assessments
apiVersion: 2019-01-01-preview
summary: Get security sub-assessments on all your scanned resources inside a scope
consumes:
- application/json
produces:
- application/json
paths:
- content: GET https://management.azure.com/{scope}/providers/Microsoft.Security/assessments/{assessmentName}/subAssessments?api-version=2019-01-01-preview
uriParameters:
- name: scope
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: Scope of the query, can be subscription (/subscriptions/0b06d9ea-afe6-4779-bd59-30e5c2d9d13f) or management group (/providers/Microsoft.Management/managementGroups/mgName).
  types:
  - uid: string
- name: assessmentName
  in: path
  isRequired: true
  description: The Assessment Key - Unique key for the assessment type
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: API version for the operation
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK
  types:
  - uid: SecuritySubAssessmentList
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: CloudError
requestHeader: []
definitions:
- name: SecuritySubAssessmentList
  description: List of security sub-assessments
  kind: object
  properties:
  - name: value
    isReadyOnly: true
    description: Security sub-assessment on a resource
    types:
    - uid: SecuritySubAssessment
      isArray: true
  - name: nextLink
    isReadyOnly: true
    description: The URI to fetch the next page.
    types:
    - uid: string
- name: CloudError
  description: Common error response for all Azure Resource Manager APIs to return error details for failed operations. (This also follows the OData error response format.).
  kind: object
  properties:
  - name: error.code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: error.message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: error.target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: error.details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: CloudErrorBody
      isArray: true
  - name: error.additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: SecuritySubAssessment
  description: Security sub-assessment on a resource
  kind: object
  properties:
  - name: properties.id
    isReadyOnly: true
    description: Vulnerability ID
    types:
    - uid: string
  - name: properties.displayName
    isReadyOnly: true
    description: User friendly display name of the sub-assessment
    types:
    - uid: string
  - name: properties.status
    description: Status of the sub-assessment
    types:
    - uid: SubAssessmentStatus
  - name: properties.remediation
    isReadyOnly: true
    description: Information on how to remediate this sub-assessment
    types:
    - uid: string
  - name: properties.impact
    isReadyOnly: true
    description: Description of the impact of this sub-assessment
    types:
    - uid: string
  - name: properties.category
    isReadyOnly: true
    description: Category of the sub-assessment
    types:
    - uid: string
  - name: properties.description
    isReadyOnly: true
    description: Human readable description of the assessment status
    types:
    - uid: string
  - name: properties.timeGenerated
    isReadyOnly: true
    description: The date and time the sub-assessment was generated
    types:
    - uid: string
  - name: properties.resourceDetails
    description: Details of the resource that was assessed
    types:
    - uid: OnPremiseResourceDetails
    - uid: AzureResourceDetails
    - uid: OnPremiseSqlResourceDetails
    typesTitle: ResourceDetails
  - name: properties.additionalData
    description: Details of the sub-assessment
    types:
    - uid: SqlServerVulnerabilityProperties
    - uid: ContainerRegistryVulnerabilityProperties
    - uid: ServerVulnerabilityProperties
    typesTitle: AdditionalData
  - name: id
    isReadyOnly: true
    description: Resource Id
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource name
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type
    types:
    - uid: string
- name: CloudErrorBody
  description: The error detail.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: CloudErrorBody
      isArray: true
  - name: additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: ErrorAdditionalInfo
  description: The resource management error additional info.
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: The additional info type.
    types:
    - uid: string
  - name: info
    isReadyOnly: true
    description: The additional info.
    types:
    - uid: object
- name: SubAssessmentStatus
  description: Status of the sub-assessment
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Programmatic code for the status of the assessment
    types:
    - uid: SubAssessmentStatusCode
  - name: cause
    isReadyOnly: true
    description: Programmatic code for the cause of the assessment status
    types:
    - uid: string
  - name: description
    isReadyOnly: true
    description: Human readable description of the assessment status
    types:
    - uid: string
  - name: severity
    isReadyOnly: true
    description: The sub-assessment severity level
    types:
    - uid: severity
- name: SubAssessmentStatusCode
  description: Programmatic code for the status of the assessment
  kind: enum
  properties:
  - name: Healthy
    description: The resource is healthy
    types:
    - uid: string
  - name: Unhealthy
    description: The resource has a security issue that needs to be addressed
    types:
    - uid: string
  - name: NotApplicable
    description: Assessment for this resource did not happen
    types:
    - uid: string
- name: severity
  description: The sub-assessment severity level
  kind: enum
  properties:
  - name: Low
    types:
    - uid: string
  - name: Medium
    types:
    - uid: string
  - name: High
    types:
    - uid: string
- name: OnPremiseResourceDetails
  description: Details of the On Premise resource that was assessed
  kind: object
  properties:
  - name: workspaceId
    description: Azure resource Id of the workspace the machine is attached to
    types:
    - uid: string
  - name: vmuuid
    description: The unique Id of the machine
    types:
    - uid: string
  - name: sourceComputerId
    description: The oms agent Id installed on the machine
    types:
    - uid: string
  - name: machineName
    description: The name of the machine
    types:
    - uid: string
  - name: source
    description: The platform where the assessed resource resides
    types:
    - uid: OnPremise
    typesTitle: string
- name: AzureResourceDetails
  description: Details of the Azure resource that was assessed
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: Azure resource Id of the assessed resource
    types:
    - uid: string
  - name: source
    description: The platform where the assessed resource resides
    types:
    - uid: Azure
    typesTitle: string
- name: OnPremiseSqlResourceDetails
  description: Details of the On Premise Sql resource that was assessed
  kind: object
  properties:
  - name: serverName
    description: The Sql server name installed on the machine
    types:
    - uid: string
  - name: databaseName
    description: The Sql database name installed on the machine
    types:
    - uid: string
  - name: workspaceId
    description: Azure resource Id of the workspace the machine is attached to
    types:
    - uid: string
  - name: vmuuid
    description: The unique Id of the machine
    types:
    - uid: string
  - name: sourceComputerId
    description: The oms agent Id installed on the machine
    types:
    - uid: string
  - name: machineName
    description: The name of the machine
    types:
    - uid: string
  - name: source
    description: The platform where the assessed resource resides
    types:
    - uid: OnPremiseSql
    typesTitle: string
- name: SqlServerVulnerabilityProperties
  description: Details of the resource that was assessed
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: The resource type the sub assessment refers to in its resource details
    types:
    - uid: string
  - name: query
    isReadyOnly: true
    description: The T-SQL query that runs on your SQL database to perform the particular check
    types:
    - uid: string
  - name: assessedResourceType
    description: Sub-assessment resource type
    types:
    - uid: SqlServerVulnerability
    typesTitle: string
- name: ContainerRegistryVulnerabilityProperties
  description: Additional context fields for container registry Vulnerability assessment
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: 'Vulnerability Type. e.g: Vulnerability, Potential Vulnerability, Information Gathered, Vulnerability'
    types:
    - uid: string
  - name: cvss
    isReadyOnly: true
    description: Dictionary from cvss version to cvss details object
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: CVSS
  - name: patchable
    isReadyOnly: true
    description: Indicates whether a patch is available or not
    types:
    - uid: boolean
  - name: cve
    isReadyOnly: true
    description: List of CVEs
    types:
    - uid: CVE
      isArray: true
  - name: publishedTime
    isReadyOnly: true
    description: Published time
    types:
    - uid: string
  - name: vendorReferences
    isReadyOnly: true
    description: Vendor reference
    types:
    - uid: VendorReference
      isArray: true
  - name: repositoryName
    isReadyOnly: true
    description: Name of the repository which the vulnerable image belongs to
    types:
    - uid: string
  - name: imageDigest
    isReadyOnly: true
    description: Digest of the vulnerable image
    types:
    - uid: string
  - name: assessedResourceType
    description: Sub-assessment resource type
    types:
    - uid: ContainerRegistryVulnerability
    typesTitle: string
- name: ServerVulnerabilityProperties
  description: Additional context fields for server vulnerability assessment
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: 'Vulnerability Type. e.g: Vulnerability, Potential Vulnerability, Information Gathered'
    types:
    - uid: string
  - name: cvss
    isReadyOnly: true
    description: Dictionary from cvss version to cvss details object
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: CVSS
  - name: patchable
    isReadyOnly: true
    description: Indicates whether a patch is available or not
    types:
    - uid: boolean
  - name: cve
    isReadyOnly: true
    description: List of CVEs
    types:
    - uid: CVE
      isArray: true
  - name: threat
    isReadyOnly: true
    description: Threat name
    types:
    - uid: string
  - name: publishedTime
    isReadyOnly: true
    description: Published time
    types:
    - uid: string
  - name: vendorReferences
    isReadyOnly: true
    description: Vendor reference
    types:
    - uid: VendorReference
      isArray: true
  - name: assessedResourceType
    description: Sub-assessment resource type
    types:
    - uid: ServerVulnerabilityAssessment
    typesTitle: string
- name: CVSS
  description: CVSS details
  kind: object
  properties:
  - name: base
    isReadyOnly: true
    description: CVSS base
    types:
    - uid: number
- name: CVE
  description: CVE details
  kind: object
  properties:
  - name: title
    isReadyOnly: true
    description: CVE title
    types:
    - uid: string
  - name: link
    isReadyOnly: true
    description: Link url
    types:
    - uid: string
- name: VendorReference
  description: Vendor reference
  kind: object
  properties:
  - name: title
    isReadyOnly: true
    description: Link title
    types:
    - uid: string
  - name: link
    isReadyOnly: true
    description: Link url
    types:
    - uid: string
examples:
- name: List security sub-assessments
  request:
    uri: GET https://management.azure.com/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/providers/Microsoft.Security/assessments/82e20e14-edc5-4373-bfc4-f13121257c37/subAssessments?api-version=2019-01-01-preview
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      GET https://management.azure.com/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/providers/Microsoft.Security/assessments/82e20e14-edc5-4373-bfc4-f13121257c37/subAssessments?api-version=2019-01-01-preview
      ```

      # [Go](#tab/Go)
      ``` go
      package armsecurity_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/security/armsecurity"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/security/resource-manager/Microsoft.Security/preview/2019-01-01-preview/examples/SubAssessments/ListSubAssessments_example.json
      func ExampleSubAssessmentsClient_NewListPager() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armsecurity.NewSubAssessmentsClient(cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	pager := client.NewListPager("subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23",
      		"82e20e14-edc5-4373-bfc4-f13121257c37",
      		nil)
      	for pager.More() {
      		nextResult, err := pager.NextPage(ctx)
      		if err != nil {
      			log.Fatalf("failed to advance page: %v", err)
      		}
      		for _, v := range nextResult.Value {
      			// TODO: use page item
      			_ = v
      		}
      	}
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fsecurity%2Farmsecurity%2Fv0.7.0/sdk/resourcemanager/security/armsecurity/README.md) on how to add the SDK to your project and authenticate.
      # [JavaScript](#tab/JavaScript)
      ``` js
      const { SecurityCenter } = require("@azure/arm-security");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Get security sub-assessments on all your scanned resources inside a scope
       *
       * @summary Get security sub-assessments on all your scanned resources inside a scope
       * x-ms-original-file: specification/security/resource-manager/Microsoft.Security/preview/2019-01-01-preview/examples/SubAssessments/ListSubAssessments_example.json
       */
      async function listSecuritySubAssessments() {
        const subscriptionId = "00000000-0000-0000-0000-000000000000";
        const scope = "subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23";
        const assessmentName = "82e20e14-edc5-4373-bfc4-f13121257c37";
        const credential = new DefaultAzureCredential();
        const client = new SecurityCenter(credential, subscriptionId);
        const resArray = new Array();
        for await (let item of client.subAssessments.list(scope, assessmentName)) {
          resArray.push(item);
        }
        console.log(resArray);
      }

      listSecuritySubAssessments().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-security_5.0.0/sdk/security/arm-security/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "value": [
          {
            "id": "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/ascdemoRG/providers/Microsoft.Sql/servers/sqlserver1demo/providers/Microsoft.Security/assessments/82e20e14-edc5-4373-bfc4-f13121257c37/subassessments/8fbe5054-e97c-3a7a-fda7-c8308ca8d3cf",
            "name": "8fbe5054-e97c-3a7a-fda7-c8308ca8d3cf",
            "type": "Microsoft.Security/assessments/subAssessments",
            "properties": {
              "id": "VA2064",
              "displayName": "Database-level firewall rules should be tracked and maintained at a strict minimum",
              "status": {
                "code": "Healthy",
                "severity": "High",
                "cause": "Unknown"
              },
              "remediation": "Evaluate each of the database-level firewall rules. Remove any rules that grant unnecessary access and set the rest as a baseline. Deviations from the baseline will be identified and brought to your attention in subsequent scans.",
              "impact": "Firewall rules should be strictly configured to allow access only to client computers that have a valid need to connect to the database. Any superfluous entries in the firewall may pose a threat by allowing an unauthorized source access to your database.",
              "category": "SurfaceAreaReduction",
              "description": "The Azure SQL Database-level firewall helps protect your data by preventing all access to your database until you specify which IP addresses have permission. Database-level firewall rules grant access to the specific database based on the originating IP address of each request.\n\nDatabase-level firewall rules for master",
              "timeGenerated": "2019-06-23T12:20:08.7644808Z",
              "resourceDetails": {
                "source": "Azure",
                "id": "/subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/ascdemoRG/providers/Microsoft.Sql/servers/sqlserver1demo/databases/database1"
              },
              "additionalData": {
                "assessedResourceType": "SqlServerVulnerability",
                "type": "AzureDatabase",
                "query": "SELECT name\n    ,start_ip_address\n    ,end_ip_address\nFROM sys.database_firewall_rules",
                "benchmarks": []
              }
            }
          }
        ]
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about Defender for Cloud service - Get security sub-assessments on all your scanned resources inside a scope
errorCodes: []
