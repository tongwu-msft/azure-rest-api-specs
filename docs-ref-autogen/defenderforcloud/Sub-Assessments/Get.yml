### YamlMime:RESTOperation
uid: management.azure.com.defenderforcloud.subassessments.get
name: Get
service: Defender for Cloud
groupName: Sub Assessments
apiVersion: 2019-01-01-preview
summary: Get a security sub-assessment on your scanned resource
consumes:
- application/json
produces:
- application/json
paths:
- content: GET https://management.azure.com/{scope}/providers/Microsoft.Security/assessments/{assessmentName}/subAssessments/{subAssessmentName}?api-version=2019-01-01-preview
uriParameters:
- name: scope
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: Scope of the query, can be subscription (/subscriptions/0b06d9ea-afe6-4779-bd59-30e5c2d9d13f) or management group (/providers/Microsoft.Management/managementGroups/mgName).
  types:
  - uid: string
- name: assessmentName
  in: path
  isRequired: true
  description: The Assessment Key - Unique key for the assessment type
  types:
  - uid: string
- name: subAssessmentName
  in: path
  isRequired: true
  description: The Sub-Assessment Key - Unique key for the sub-assessment type
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: API version for the operation
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK
  types:
  - uid: SecuritySubAssessment
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: CloudError
requestHeader: []
definitions:
- name: SecuritySubAssessment
  description: Security sub-assessment on a resource
  kind: object
  properties:
  - name: properties.id
    isReadyOnly: true
    description: Vulnerability ID
    types:
    - uid: string
  - name: properties.displayName
    isReadyOnly: true
    description: User friendly display name of the sub-assessment
    types:
    - uid: string
  - name: properties.status
    description: Status of the sub-assessment
    types:
    - uid: SubAssessmentStatus
  - name: properties.remediation
    isReadyOnly: true
    description: Information on how to remediate this sub-assessment
    types:
    - uid: string
  - name: properties.impact
    isReadyOnly: true
    description: Description of the impact of this sub-assessment
    types:
    - uid: string
  - name: properties.category
    isReadyOnly: true
    description: Category of the sub-assessment
    types:
    - uid: string
  - name: properties.description
    isReadyOnly: true
    description: Human readable description of the assessment status
    types:
    - uid: string
  - name: properties.timeGenerated
    isReadyOnly: true
    description: The date and time the sub-assessment was generated
    types:
    - uid: string
  - name: properties.resourceDetails
    description: Details of the resource that was assessed
    types:
    - uid: OnPremiseResourceDetails
    - uid: AzureResourceDetails
    - uid: OnPremiseSqlResourceDetails
    typesTitle: ResourceDetails
  - name: properties.additionalData
    description: Details of the sub-assessment
    types:
    - uid: SqlServerVulnerabilityProperties
    - uid: ContainerRegistryVulnerabilityProperties
    - uid: ServerVulnerabilityProperties
    typesTitle: AdditionalData
  - name: id
    isReadyOnly: true
    description: Resource Id
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource name
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type
    types:
    - uid: string
- name: CloudError
  description: Common error response for all Azure Resource Manager APIs to return error details for failed operations. (This also follows the OData error response format.).
  kind: object
  properties:
  - name: error.code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: error.message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: error.target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: error.details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: CloudErrorBody
      isArray: true
  - name: error.additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: SubAssessmentStatus
  description: Status of the sub-assessment
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Programmatic code for the status of the assessment
    types:
    - uid: SubAssessmentStatusCode
  - name: cause
    isReadyOnly: true
    description: Programmatic code for the cause of the assessment status
    types:
    - uid: string
  - name: description
    isReadyOnly: true
    description: Human readable description of the assessment status
    types:
    - uid: string
  - name: severity
    isReadyOnly: true
    description: The sub-assessment severity level
    types:
    - uid: severity
- name: CloudErrorBody
  description: The error detail.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: CloudErrorBody
      isArray: true
  - name: additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: ErrorAdditionalInfo
  description: The resource management error additional info.
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: The additional info type.
    types:
    - uid: string
  - name: info
    isReadyOnly: true
    description: The additional info.
    types:
    - uid: object
- name: SubAssessmentStatusCode
  description: Programmatic code for the status of the assessment
  kind: enum
  properties:
  - name: Healthy
    description: The resource is healthy
    types:
    - uid: string
  - name: Unhealthy
    description: The resource has a security issue that needs to be addressed
    types:
    - uid: string
  - name: NotApplicable
    description: Assessment for this resource did not happen
    types:
    - uid: string
- name: severity
  description: The sub-assessment severity level
  kind: enum
  properties:
  - name: Low
    types:
    - uid: string
  - name: Medium
    types:
    - uid: string
  - name: High
    types:
    - uid: string
- name: OnPremiseResourceDetails
  description: Details of the On Premise resource that was assessed
  kind: object
  properties:
  - name: workspaceId
    description: Azure resource Id of the workspace the machine is attached to
    types:
    - uid: string
  - name: vmuuid
    description: The unique Id of the machine
    types:
    - uid: string
  - name: sourceComputerId
    description: The oms agent Id installed on the machine
    types:
    - uid: string
  - name: machineName
    description: The name of the machine
    types:
    - uid: string
  - name: source
    description: The platform where the assessed resource resides
    types:
    - uid: OnPremise
    typesTitle: string
- name: AzureResourceDetails
  description: Details of the Azure resource that was assessed
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: Azure resource Id of the assessed resource
    types:
    - uid: string
  - name: source
    description: The platform where the assessed resource resides
    types:
    - uid: Azure
    typesTitle: string
- name: OnPremiseSqlResourceDetails
  description: Details of the On Premise Sql resource that was assessed
  kind: object
  properties:
  - name: serverName
    description: The Sql server name installed on the machine
    types:
    - uid: string
  - name: databaseName
    description: The Sql database name installed on the machine
    types:
    - uid: string
  - name: workspaceId
    description: Azure resource Id of the workspace the machine is attached to
    types:
    - uid: string
  - name: vmuuid
    description: The unique Id of the machine
    types:
    - uid: string
  - name: sourceComputerId
    description: The oms agent Id installed on the machine
    types:
    - uid: string
  - name: machineName
    description: The name of the machine
    types:
    - uid: string
  - name: source
    description: The platform where the assessed resource resides
    types:
    - uid: OnPremiseSql
    typesTitle: string
- name: SqlServerVulnerabilityProperties
  description: Details of the resource that was assessed
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: The resource type the sub assessment refers to in its resource details
    types:
    - uid: string
  - name: query
    isReadyOnly: true
    description: The T-SQL query that runs on your SQL database to perform the particular check
    types:
    - uid: string
  - name: assessedResourceType
    description: Sub-assessment resource type
    types:
    - uid: SqlServerVulnerability
    typesTitle: string
- name: ContainerRegistryVulnerabilityProperties
  description: Additional context fields for container registry Vulnerability assessment
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: 'Vulnerability Type. e.g: Vulnerability, Potential Vulnerability, Information Gathered, Vulnerability'
    types:
    - uid: string
  - name: cvss
    isReadyOnly: true
    description: Dictionary from cvss version to cvss details object
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: CVSS
  - name: patchable
    isReadyOnly: true
    description: Indicates whether a patch is available or not
    types:
    - uid: boolean
  - name: cve
    isReadyOnly: true
    description: List of CVEs
    types:
    - uid: CVE
      isArray: true
  - name: publishedTime
    isReadyOnly: true
    description: Published time
    types:
    - uid: string
  - name: vendorReferences
    isReadyOnly: true
    description: Vendor reference
    types:
    - uid: VendorReference
      isArray: true
  - name: repositoryName
    isReadyOnly: true
    description: Name of the repository which the vulnerable image belongs to
    types:
    - uid: string
  - name: imageDigest
    isReadyOnly: true
    description: Digest of the vulnerable image
    types:
    - uid: string
  - name: assessedResourceType
    description: Sub-assessment resource type
    types:
    - uid: ContainerRegistryVulnerability
    typesTitle: string
- name: ServerVulnerabilityProperties
  description: Additional context fields for server vulnerability assessment
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: 'Vulnerability Type. e.g: Vulnerability, Potential Vulnerability, Information Gathered'
    types:
    - uid: string
  - name: cvss
    isReadyOnly: true
    description: Dictionary from cvss version to cvss details object
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: CVSS
  - name: patchable
    isReadyOnly: true
    description: Indicates whether a patch is available or not
    types:
    - uid: boolean
  - name: cve
    isReadyOnly: true
    description: List of CVEs
    types:
    - uid: CVE
      isArray: true
  - name: threat
    isReadyOnly: true
    description: Threat name
    types:
    - uid: string
  - name: publishedTime
    isReadyOnly: true
    description: Published time
    types:
    - uid: string
  - name: vendorReferences
    isReadyOnly: true
    description: Vendor reference
    types:
    - uid: VendorReference
      isArray: true
  - name: assessedResourceType
    description: Sub-assessment resource type
    types:
    - uid: ServerVulnerabilityAssessment
    typesTitle: string
- name: CVSS
  description: CVSS details
  kind: object
  properties:
  - name: base
    isReadyOnly: true
    description: CVSS base
    types:
    - uid: number
- name: CVE
  description: CVE details
  kind: object
  properties:
  - name: title
    isReadyOnly: true
    description: CVE title
    types:
    - uid: string
  - name: link
    isReadyOnly: true
    description: Link url
    types:
    - uid: string
- name: VendorReference
  description: Vendor reference
  kind: object
  properties:
  - name: title
    isReadyOnly: true
    description: Link title
    types:
    - uid: string
  - name: link
    isReadyOnly: true
    description: Link url
    types:
    - uid: string
examples:
- name: Get security recommendation task from security data location
  request:
    uri: GET https://management.azure.com/subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/DEMORG/providers/Microsoft.Compute/virtualMachines/vm2/providers/Microsoft.Security/assessments/1195afff-c881-495e-9bc5-1486211ae03f/subAssessments/95f7da9c-a2a4-1322-0758-fcd24ef09b85?api-version=2019-01-01-preview
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      GET https://management.azure.com/subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/DEMORG/providers/Microsoft.Compute/virtualMachines/vm2/providers/Microsoft.Security/assessments/1195afff-c881-495e-9bc5-1486211ae03f/subAssessments/95f7da9c-a2a4-1322-0758-fcd24ef09b85?api-version=2019-01-01-preview
      ```

      # [Go](#tab/Go)
      ``` go
      package armsecurity_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/security/armsecurity"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/security/resource-manager/Microsoft.Security/preview/2019-01-01-preview/examples/SubAssessments/GetSubAssessment_example.json
      func ExampleSubAssessmentsClient_Get() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armsecurity.NewSubAssessmentsClient(cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	res, err := client.Get(ctx,
      		"subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/DEMORG/providers/Microsoft.Compute/virtualMachines/vm2",
      		"1195afff-c881-495e-9bc5-1486211ae03f",
      		"95f7da9c-a2a4-1322-0758-fcd24ef09b85",
      		nil)
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fsecurity%2Farmsecurity%2Fv0.7.0/sdk/resourcemanager/security/armsecurity/README.md) on how to add the SDK to your project and authenticate.
      # [JavaScript](#tab/JavaScript)
      ``` js
      const { SecurityCenter } = require("@azure/arm-security");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Get a security sub-assessment on your scanned resource
       *
       * @summary Get a security sub-assessment on your scanned resource
       * x-ms-original-file: specification/security/resource-manager/Microsoft.Security/preview/2019-01-01-preview/examples/SubAssessments/GetSubAssessment_example.json
       */
      async function getSecurityRecommendationTaskFromSecurityDataLocation() {
        const subscriptionId = "00000000-0000-0000-0000-000000000000";
        const scope =
          "subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/DEMORG/providers/Microsoft.Compute/virtualMachines/vm2";
        const assessmentName = "1195afff-c881-495e-9bc5-1486211ae03f";
        const subAssessmentName = "95f7da9c-a2a4-1322-0758-fcd24ef09b85";
        const credential = new DefaultAzureCredential();
        const client = new SecurityCenter(credential, subscriptionId);
        const result = await client.subAssessments.get(scope, assessmentName, subAssessmentName);
        console.log(result);
      }

      getSecurityRecommendationTaskFromSecurityDataLocation().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-security_5.0.0/sdk/security/arm-security/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "type": "Microsoft.Security/assessments/subAssessments",
        "id": "/subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/DEMORG/providers/Microsoft.Compute/virtualMachines/vm2/providers/Microsoft.Security/assessments/1195afff-c881-495e-9bc5-1486211ae03f/subassessments/95f7da9c-a2a4-1322-0758-fcd24ef09b85",
        "name": "95f7da9c-a2a4-1322-0758-fcd24ef09b85",
        "properties": {
          "id": "370361",
          "displayName": "PuTTY ssh_agent_channel_data Function Integer Overflow Vulnerability",
          "status": {
            "code": "Unhealthy",
            "severity": "Medium"
          },
          "remediation": "Customers are advised to upgrade toPuTTY 0.68 or later version in order to remediate this vulnerability.",
          "impact": "Successful exploitation could allow remote attackers to have unspecified impact via a large length value in an agent protocol message.",
          "category": "Local",
          "description": "PuTTY ssh_agent_channel_data Function Integer Overflow Vulnerability",
          "timeGenerated": "2021-02-02T12:36:50.779Z",
          "resourceDetails": {
            "source": "Azure",
            "id": "/subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/DEMORG/providers/Microsoft.Compute/virtualMachines/vm2"
          },
          "additionalData": {
            "assessedResourceType": "ServerVulnerability",
            "type": "VirtualMachine",
            "cvss": {
              "2.0": {
                "base": 7.5
              },
              "3.0": {
                "base": 9.8
              }
            },
            "patchable": true,
            "cve": [
              {
                "title": "CVE-2017-6542",
                "link": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6542"
              }
            ],
            "publishedTime": "2017-04-06T10:58:25",
            "threat": "PuTTY is a client program for the SSH, Telnet and Rlogin network protocols",
            "vendorReferences": [
              {
                "title": "CVE-2017-6542",
                "link": "http://www.chiark.greenend.org.uk/~sgtatham/putty/wishlist/vuln-agent-fwd-overflow.html"
              }
            ]
          }
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about Defender for Cloud service - Get a security sub-assessment on your scanned resource
errorCodes: []
