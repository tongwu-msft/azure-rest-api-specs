### YamlMime:RESTOperation
uid: management.azure.com.defenderforcloud.sqlvulnerabilityassessmentscanresults.get
name: Get
service: Defender for Cloud
groupName: Sql Vulnerability Assessment Scan Results
apiVersion: 2020-07-01-preview
summary: Gets the scan results of a single rule in a scan record.
produces:
- application/json
paths:
- content: GET https://management.azure.com/{resourceId}/providers/Microsoft.Security/sqlVulnerabilityAssessments/default/scans/{scanId}/scanResults/{scanResultId}?workspaceId={workspaceId}&api-version=2020-07-01-preview
uriParameters:
- name: resourceId
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: The identifier of the resource.
  types:
  - uid: string
- name: scanId
  in: path
  isRequired: true
  description: The scan Id. Type 'latest' to get the scan results for the latest scan.
  types:
  - uid: string
- name: scanResultId
  in: path
  isRequired: true
  description: The rule Id of the results.
  types:
  - uid: string
- name: workspaceId
  in: query
  isRequired: true
  description: The workspace Id.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The api version.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Returns the scan results.
  types:
  - uid: ScanResult
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: CloudError
requestHeader: []
definitions:
- name: ScanResult
  description: A vulnerability assessment scan result for a single rule.
  kind: object
  properties:
  - name: properties
    description: A vulnerability assessment scan result properties for a single rule.
    types:
    - uid: ScanResultProperties
  - name: id
    isReadyOnly: true
    description: Resource Id
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource name
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type
    types:
    - uid: string
- name: CloudError
  description: Common error response for all Azure Resource Manager APIs to return error details for failed operations. (This also follows the OData error response format.).
  kind: object
  properties:
  - name: error.code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: error.message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: error.target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: error.details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: CloudErrorBody
      isArray: true
  - name: error.additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: ScanResultProperties
  description: A vulnerability assessment scan result properties for a single rule.
  kind: object
  properties:
  - name: ruleId
    description: The rule Id.
    types:
    - uid: string
  - name: status
    description: The rule result status.
    types:
    - uid: RuleStatus
  - name: isTrimmed
    description: Indicated whether the results specified here are trimmed.
    types:
    - uid: boolean
  - name: queryResults
    description: The results of the query that was run.
    types:
    - uid: array
      isArray: true
  - name: remediation
    description: Remediation details.
    types:
    - uid: Remediation
  - name: baselineAdjustedResult
    description: The rule result adjusted with baseline.
    types:
    - uid: BaselineAdjustedResult
  - name: ruleMetadata
    description: vulnerability assessment rule metadata details.
    types:
    - uid: VaRule
- name: CloudErrorBody
  description: The error detail.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: CloudErrorBody
      isArray: true
  - name: additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: ErrorAdditionalInfo
  description: The resource management error additional info.
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: The additional info type.
    types:
    - uid: string
  - name: info
    isReadyOnly: true
    description: The additional info.
    types:
    - uid: object
- name: RuleStatus
  description: The rule result status.
  kind: enum
  properties:
  - name: NonFinding
    description: NonFinding
    types:
    - uid: string
  - name: Finding
    description: Finding
    types:
    - uid: string
  - name: InternalError
    description: InternalError
    types:
    - uid: string
- name: Remediation
  description: Remediation details.
  kind: object
  properties:
  - name: description
    description: Remediation description.
    types:
    - uid: string
  - name: scripts
    description: Remediation script.
    types:
    - uid: string
      isArray: true
  - name: automated
    description: Is remediation automated.
    types:
    - uid: boolean
  - name: portalLink
    description: Optional link to remediate in Azure Portal.
    types:
    - uid: string
- name: BaselineAdjustedResult
  description: The rule result adjusted with baseline.
  kind: object
  properties:
  - name: baseline
    description: Baseline details.
    types:
    - uid: Baseline
  - name: status
    description: The rule result status.
    types:
    - uid: RuleStatus
  - name: resultsNotInBaseline
    description: Results the are not in baseline.
    types:
    - uid: array
      isArray: true
  - name: resultsOnlyInBaseline
    description: Results the are in baseline.
    types:
    - uid: array
      isArray: true
- name: VaRule
  description: vulnerability assessment rule metadata details.
  kind: object
  properties:
  - name: ruleId
    description: The rule Id.
    types:
    - uid: string
  - name: severity
    description: The rule severity.
    types:
    - uid: RuleSeverity
  - name: category
    description: The rule category.
    types:
    - uid: string
  - name: ruleType
    description: The rule type.
    types:
    - uid: RuleType
  - name: title
    description: The rule title.
    types:
    - uid: string
  - name: description
    description: The rule description.
    types:
    - uid: string
  - name: rationale
    description: The rule rationale.
    types:
    - uid: string
  - name: queryCheck
    description: The rule query details.
    types:
    - uid: QueryCheck
  - name: benchmarkReferences
    description: The benchmark references.
    types:
    - uid: BenchmarkReference
      isArray: true
- name: Baseline
  description: Baseline details.
  kind: object
  properties:
  - name: expectedResults
    description: Expected results.
    types:
    - uid: array
      isArray: true
  - name: updatedTime
    description: Baseline update time (UTC).
    types:
    - uid: string
- name: RuleSeverity
  description: The rule severity.
  kind: enum
  properties:
  - name: High
    description: High
    types:
    - uid: string
  - name: Medium
    description: Medium
    types:
    - uid: string
  - name: Low
    description: Low
    types:
    - uid: string
  - name: Informational
    description: Informational
    types:
    - uid: string
  - name: Obsolete
    description: Obsolete
    types:
    - uid: string
- name: RuleType
  description: The rule type.
  kind: enum
  properties:
  - name: Binary
    description: Binary
    types:
    - uid: string
  - name: BaselineExpected
    description: BaselineExpected
    types:
    - uid: string
  - name: PositiveList
    description: PositiveList
    types:
    - uid: string
  - name: NegativeList
    description: NegativeList
    types:
    - uid: string
- name: QueryCheck
  description: The rule query details.
  kind: object
  properties:
  - name: query
    description: The rule query.
    types:
    - uid: string
  - name: expectedResult
    description: Expected result.
    types:
    - uid: array
      isArray: true
  - name: columnNames
    description: Column names of expected result.
    types:
    - uid: string
      isArray: true
- name: BenchmarkReference
  description: The benchmark references.
  kind: object
  properties:
  - name: benchmark
    description: The benchmark name.
    types:
    - uid: string
  - name: reference
    description: The benchmark reference.
    types:
    - uid: string
examples:
- name: Get scan details of a scan record
  request:
    uri: GET https://management.azure.com/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master/providers/Microsoft.Security/sqlVulnerabilityAssessments/default/scans/Scheduled-20200623/scanResults/VA2063?workspaceId=55555555-6666-7777-8888-999999999999&api-version=2020-07-01-preview
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      GET https://management.azure.com/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master/providers/Microsoft.Security/sqlVulnerabilityAssessments/default/scans/Scheduled-20200623/scanResults/VA2063?workspaceId=55555555-6666-7777-8888-999999999999&api-version=2020-07-01-preview
      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;

      /** Samples for SqlVulnerabilityAssessmentScanResults Get. */
      public final class Main {
          /*
           * x-ms-original-file: specification/security/resource-manager/Microsoft.Security/preview/2020-07-01-preview/examples/sqlVulnerabilityAssessmentsScanResultsOperations/ArcMachineScanResults_Get.json
           */
          /**
           * Sample code: Get scan details of a scan record.
           *
           * @param manager Entry point to SecurityManager.
           */
          public static void getScanDetailsOfAScanRecord(com.azure.resourcemanager.security.SecurityManager manager) {
              manager
                  .sqlVulnerabilityAssessmentScanResults()
                  .getWithResponse(
                      "Scheduled-20200623",
                      "VA2063",
                      "55555555-6666-7777-8888-999999999999",
                      "subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master",
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-security_1.0.0-beta.2/sdk/security/azure-resourcemanager-security/README.md) on how to add the SDK to your project and authenticate.
      # [Go](#tab/Go)
      ``` go
      package armsecurity_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/security/armsecurity"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/security/resource-manager/Microsoft.Security/preview/2020-07-01-preview/examples/sqlVulnerabilityAssessmentsScanResultsOperations/ArcMachineScanResults_Get.json
      func ExampleSQLVulnerabilityAssessmentScanResultsClient_Get_getScanDetailsOfAScanRecord() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armsecurity.NewSQLVulnerabilityAssessmentScanResultsClient(cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	res, err := client.Get(ctx, "Scheduled-20200623", "VA2063", "55555555-6666-7777-8888-999999999999", "subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master", nil)
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fsecurity%2Farmsecurity%2Fv0.8.0/sdk/resourcemanager/security/armsecurity/README.md) on how to add the SDK to your project and authenticate.
      # [JavaScript](#tab/JavaScript)
      ``` js
      const { SecurityCenter } = require("@azure/arm-security");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Gets the scan results of a single rule in a scan record.
       *
       * @summary Gets the scan results of a single rule in a scan record.
       * x-ms-original-file: specification/security/resource-manager/Microsoft.Security/preview/2020-07-01-preview/examples/sqlVulnerabilityAssessmentsScanResultsOperations/ArcMachineScanResults_Get.json
       */
      async function getScanDetailsOfAScanRecord() {
        const subscriptionId = "00000000-0000-0000-0000-000000000000";
        const scanId = "Scheduled-20200623";
        const scanResultId = "VA2063";
        const workspaceId = "55555555-6666-7777-8888-999999999999";
        const resourceId =
          "subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master";
        const credential = new DefaultAzureCredential();
        const client = new SecurityCenter(credential, subscriptionId);
        const result = await client.sqlVulnerabilityAssessmentScanResults.get(
          scanId,
          scanResultId,
          workspaceId,
          resourceId
        );
        console.log(result);
      }

      getScanDetailsOfAScanRecord().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-security_6.0.0-beta.1/sdk/security/arm-security/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master/providers/Microsoft.Security/sqlVulnerabilityAssessments/default/scans/Scheduled-20200623/scanResults/VA2063",
        "name": "VA2063",
        "type": "Microsoft.Security/sqlVulnerabilityAssessments/scans/scanResults",
        "properties": {
          "ruleId": "VA2063",
          "status": "Finding",
          "isTrimmed": false,
          "queryResults": [
            [
              "Test",
              "0.0.0.0",
              "125.125.125.125"
            ]
          ],
          "remediation": {
            "description": "Remove server firewall rules that grant excessive access",
            "scripts": [
              "EXECUTE sp_delete_firewall_rule N'Test';"
            ],
            "automated": false,
            "portalLink": "ReviewServerFirewallRules"
          },
          "baselineAdjustedResult": {
            "baseline": {
              "expectedResults": [
                [
                  "Test",
                  "0.0.0.0",
                  "125.125.125.125"
                ]
              ],
              "updatedTime": "2020-02-04T12:49:41.027771+00:00"
            },
            "status": "NonFinding",
            "resultsNotInBaseline": [],
            "resultsOnlyInBaseline": []
          },
          "ruleMetadata": {
            "ruleId": "VA2063",
            "severity": "High",
            "category": "SurfaceAreaReduction",
            "ruleType": "NegativeList",
            "title": "Server-level firewall rules should not grant excessive access",
            "description": "The Azure SQL server-level firewall helps protect your server by preventing all access to your databases until you specify which IP addresses have permission. Server-level firewall rules grant access to all databases that belong to the server based on the originating IP address of each request.\n\nServer-level firewall rules can only be created and managed through Transact-SQL as well as through the Azure portal or PowerShell. For more details please see: https://docs.microsoft.com/en-us/azure/sql-database/sql-database-firewall-configure\n\nThis check verifies that server-level firewall rules do not grant excessive access.",
            "rationale": "Often, administrators add rules that grant excessive access as part of a troubleshooting process � to eliminate the firewall as the source of a problem, they simply create a rule that allows all traffic to pass to the affected server.\n\nGranting excessive access using server firewall rules is a clear security concern, as it violates the principle of least privilege by allowing unnecessary access to your databases. In fact, it's the equivalent of placing the server outside of the firewall.",
            "queryCheck": {
              "query": "SELECT name\n    ,start_ip_address\n    ,end_ip_address\nFROM sys.firewall_rules\nWHERE ( \n        (CONVERT(bigint, parsename(end_ip_address, 1)) +\n         CONVERT(bigint, parsename(end_ip_address, 2)) * 256 + \n         CONVERT(bigint, parsename(end_ip_address, 3)) * 65536 + \n         CONVERT(bigint, parsename(end_ip_address, 4)) * 16777216 ) \n        - \n        (CONVERT(bigint, parsename(start_ip_address, 1)) +\n         CONVERT(bigint, parsename(start_ip_address, 2)) * 256 + \n         CONVERT(bigint, parsename(start_ip_address, 3)) * 65536 + \n         CONVERT(bigint, parsename(start_ip_address, 4)) * 16777216 )\n      ) > 255;",
              "expectedResult": [],
              "columnNames": [
                "Firewall Rule Name",
                "Start Address",
                "End Address"
              ]
            },
            "benchmarkReferences": []
          }
        }
      }
- name: Get scan details of the latest scan record
  request:
    uri: GET https://management.azure.com/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master/providers/Microsoft.Security/sqlVulnerabilityAssessments/default/scans/latest/scanResults/VA2063?workspaceId=55555555-6666-7777-8888-999999999999&api-version=2020-07-01-preview
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      GET https://management.azure.com/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master/providers/Microsoft.Security/sqlVulnerabilityAssessments/default/scans/latest/scanResults/VA2063?workspaceId=55555555-6666-7777-8888-999999999999&api-version=2020-07-01-preview
      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;

      /** Samples for SqlVulnerabilityAssessmentScanResults Get. */
      public final class Main {
          /*
           * x-ms-original-file: specification/security/resource-manager/Microsoft.Security/preview/2020-07-01-preview/examples/sqlVulnerabilityAssessmentsScanResultsOperations/ArcMachineScanResults_GetLatest.json
           */
          /**
           * Sample code: Get scan details of the latest scan record.
           *
           * @param manager Entry point to SecurityManager.
           */
          public static void getScanDetailsOfTheLatestScanRecord(com.azure.resourcemanager.security.SecurityManager manager) {
              manager
                  .sqlVulnerabilityAssessmentScanResults()
                  .getWithResponse(
                      "latest",
                      "VA2063",
                      "55555555-6666-7777-8888-999999999999",
                      "subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master",
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-security_1.0.0-beta.2/sdk/security/azure-resourcemanager-security/README.md) on how to add the SDK to your project and authenticate.
      # [Go](#tab/Go)
      ``` go
      package armsecurity_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/security/armsecurity"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/security/resource-manager/Microsoft.Security/preview/2020-07-01-preview/examples/sqlVulnerabilityAssessmentsScanResultsOperations/ArcMachineScanResults_GetLatest.json
      func ExampleSQLVulnerabilityAssessmentScanResultsClient_Get_getScanDetailsOfTheLatestScanRecord() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armsecurity.NewSQLVulnerabilityAssessmentScanResultsClient(cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	res, err := client.Get(ctx, "latest", "VA2063", "55555555-6666-7777-8888-999999999999", "subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master", nil)
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fsecurity%2Farmsecurity%2Fv0.8.0/sdk/resourcemanager/security/armsecurity/README.md) on how to add the SDK to your project and authenticate.
      # [JavaScript](#tab/JavaScript)
      ``` js
      const { SecurityCenter } = require("@azure/arm-security");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Gets the scan results of a single rule in a scan record.
       *
       * @summary Gets the scan results of a single rule in a scan record.
       * x-ms-original-file: specification/security/resource-manager/Microsoft.Security/preview/2020-07-01-preview/examples/sqlVulnerabilityAssessmentsScanResultsOperations/ArcMachineScanResults_GetLatest.json
       */
      async function getScanDetailsOfTheLatestScanRecord() {
        const subscriptionId = "00000000-0000-0000-0000-000000000000";
        const scanId = "latest";
        const scanResultId = "VA2063";
        const workspaceId = "55555555-6666-7777-8888-999999999999";
        const resourceId =
          "subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master";
        const credential = new DefaultAzureCredential();
        const client = new SecurityCenter(credential, subscriptionId);
        const result = await client.sqlVulnerabilityAssessmentScanResults.get(
          scanId,
          scanResultId,
          workspaceId,
          resourceId
        );
        console.log(result);
      }

      getScanDetailsOfTheLatestScanRecord().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-security_6.0.0-beta.1/sdk/security/arm-security/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/Rg/providers/Microsoft.HybridCompute/machines/MyMachine/sqlServers/server1/databases/master/providers/Microsoft.Security/sqlVulnerabilityAssessments/default/scans/Scheduled-20200623/scanResults/VA2063",
        "name": "VA2063",
        "type": "Microsoft.Security/sqlVulnerabilityAssessments/scans/scanResults",
        "properties": {
          "ruleId": "VA2063",
          "status": "Finding",
          "isTrimmed": false,
          "queryResults": [
            [
              "Test",
              "0.0.0.0",
              "125.125.125.125"
            ]
          ],
          "remediation": {
            "description": "Remove server firewall rules that grant excessive access",
            "scripts": [
              "EXECUTE sp_delete_firewall_rule N'Test';"
            ],
            "automated": false,
            "portalLink": "ReviewServerFirewallRules"
          },
          "baselineAdjustedResult": {
            "baseline": {
              "expectedResults": [
                [
                  "Test",
                  "0.0.0.0",
                  "125.125.125.125"
                ]
              ],
              "updatedTime": "2020-02-04T12:49:41.027771+00:00"
            },
            "status": "NonFinding",
            "resultsNotInBaseline": [],
            "resultsOnlyInBaseline": []
          },
          "ruleMetadata": {
            "ruleId": "VA2063",
            "severity": "High",
            "category": "SurfaceAreaReduction",
            "ruleType": "NegativeList",
            "title": "Server-level firewall rules should not grant excessive access",
            "description": "The Azure SQL server-level firewall helps protect your server by preventing all access to your databases until you specify which IP addresses have permission. Server-level firewall rules grant access to all databases that belong to the server based on the originating IP address of each request.\n\nServer-level firewall rules can only be created and managed through Transact-SQL as well as through the Azure portal or PowerShell. For more details please see: https://docs.microsoft.com/en-us/azure/sql-database/sql-database-firewall-configure\n\nThis check verifies that server-level firewall rules do not grant excessive access.",
            "rationale": "Often, administrators add rules that grant excessive access as part of a troubleshooting process � to eliminate the firewall as the source of a problem, they simply create a rule that allows all traffic to pass to the affected server.\n\nGranting excessive access using server firewall rules is a clear security concern, as it violates the principle of least privilege by allowing unnecessary access to your databases. In fact, it's the equivalent of placing the server outside of the firewall.",
            "queryCheck": {
              "query": "SELECT name\n    ,start_ip_address\n    ,end_ip_address\nFROM sys.firewall_rules\nWHERE ( \n        (CONVERT(bigint, parsename(end_ip_address, 1)) +\n         CONVERT(bigint, parsename(end_ip_address, 2)) * 256 + \n         CONVERT(bigint, parsename(end_ip_address, 3)) * 65536 + \n         CONVERT(bigint, parsename(end_ip_address, 4)) * 16777216 ) \n        - \n        (CONVERT(bigint, parsename(start_ip_address, 1)) +\n         CONVERT(bigint, parsename(start_ip_address, 2)) * 256 + \n         CONVERT(bigint, parsename(start_ip_address, 3)) * 65536 + \n         CONVERT(bigint, parsename(start_ip_address, 4)) * 16777216 )\n      ) > 255;",
              "expectedResult": [],
              "columnNames": [
                "Firewall Rule Name",
                "Start Address",
                "End Address"
              ]
            },
            "benchmarkReferences": []
          }
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about Defender for Cloud service - Gets the scan results of a single rule in a scan record.
errorCodes: []
