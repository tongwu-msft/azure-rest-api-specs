### YamlMime:RESTOperation
uid: management.azure.com.sql.2020-11-01-preview.managedinstances.update
name: Update
service: SQL Database
groupName: Managed Instances
apiVersion: 2020-11-01-preview
summary: Updates a managed instance.
consumes:
- application/json
produces:
- application/json
paths:
- content: PATCH https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Sql/managedInstances/{managedInstanceName}?api-version=2020-11-01-preview
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The subscription ID that identifies an Azure subscription.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group that contains the resource. You can obtain this value from the Azure Resource Manager API or the portal.
  types:
  - uid: string
- name: managedInstanceName
  in: path
  isRequired: true
  description: The name of the managed instance.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The API version to use for the request.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Successfully updated the managed instance.
  types:
  - uid: ManagedInstance
- name: Other Status Codes
  description: >-
    *** Error Responses: ***

     * 400 SubscriptionNotFound - The requested subscription was not found.

     * 400 HkCannotSwitchToInactive - The database cannot proceed with pricing-tier update as it has memory-optimized objects. Please drop such objects and try again.

     * 400 ManagedInstanceInvalidStorageSizeLessThenCurrentSizeUsed - Invalid storage size: Storage size limit ({0} GB) is less that current storage used ({1} GB). Please specify higher storage size limit.

     * 400 InstanceTimezoneUpdateNotSupported - Instance timezone update not supported.

     * 400 CreateManagedInstanceWithNonDefaultTimezoneNotSupported - Create Managed Instance with non-default timezone not supported.

     * 400 ManagedInstanceIpAddressRangeLimit - Cannot perform creation/scaling of the managed instance as there are not enough available IP addresses in the subnet for performing the operation.

     * 400 VnetDelegationNotAllowed - User tried to inject Managed Server to subnet which is delegated.

     * 400 SubnetHasResourcesOfDifferentType - User tried to create MI in subnet that has resources of different type.

     * 400 UpdateManagedServerWithMaintenanceWindowNotAllowed - Update of Managed Instance with maintenance window settings is not allowed.

     * 400 VnetPrepareNIPFailed - User tried to prepare subnet that has a conflict with NetworkIntentPolicy.

     * 400 InvalidUsername - Supplied user name contains invalid characters.

     * 400 ManagedInstanceDeprecatedHardwareFamily - Changing the hardware generation to deprecated {0} generation is not possible.

     * 400 ManagedInstanceBackupStorageTypeNotSupported - Backup storage type parameter is not allowed in the instance update operation.

     * 400 InvalidParameterValue - An invalid value was given to a parameter.

     * 400 InstancePoolNotEnoughCapacity - An instance pool does not have enough capacity

     * 400 ServerNotFound - The requested server was not found.

     * 400 ManagedInstanceZoneRedudantFeatureNotSupported - ZoneRedundant feature is not supported for the selected service tier. For more details visit aka.ms/sqlmi-service-tier-characteristics.

     * 400 ManagedInstanceZoneRedudantFeatureCantBeEnabled - Enabling zoneRedundant feature is not possible once managed instance is created. For more details visit aka.ms/sqlmi-high-availability.

     * 400 ManagedInstanceZoneRedudantFeatureCantBeDisabled - Disabling zoneRedundant feature is not possible once managed instance is created. For more details visit aka.ms/sqlmi-high-availability.

     * 400 TokenTooLong - The provided token is too long.

     * 400 ManagedInstanceSloUpdateFailed - SLO '{0}' operation cannot succeed as the memory usage of '{1}' exceeds the quota.

     * 400 ManagedInstanceLocalStorageUpdateSloDisabled - Update SLO for managed instances with local storage is not supported yet.

     * 400 InvalidLoginName - The provided login name is invalid.

     * 400 RegionDoesNotSupportVersion - A user attempted to create a server of a specified version in a location where that server version isn't supported.

     * 400 PasswordTooShort - The provided password is too short

     * 400 PasswordTooLong - The provided password is too long.

     * 400 PasswordNotComplex - The provided password is not complex enough.

     * 400 GatewayInvalidEdition - '{0}' is not a valid database edition in this version of SQL Server.

     * 400 InvalidSubnetResourceId - The provided subnet resource ID for the managed instance create or update is invalid.

     * 400 SubscriptionNotFound - The requested subscription was not found.

     * 400 InvalidLocation - An invalid location was specified.

     * 400 VnetInWrongRegion - Virtual network is in wrong region.

     * 400 InvalidServerName - Invalid server name specified.

     * 400 VnetAddressRangeError - Virtual network address range is invalid.

     * 400 VnetConfigIsNotAllowed - Virtual network configuration is not allowed.

     * 400 InvalidCollation - Invalid collation.

     * 400 InvalidIdentifier - The identifier contains NULL or an invalid unicode character.

     * 400 ManagedInstanceClassicVnetNotSupported - Managed Instance cannot be joined to a classic virtual network.

     * 400 AlterDbDeactivatedNotSupported - Database Operation failed for Server '{0}', Database '{1}' due to unexpected delay. Please try again.

     * 400 RegionDoesNotAllowProvisioning - The selected location is not accepting new Windows Azure SQL Database servers. This may change at a later time.

     * 400 VnetConfigHasNsg - User tried to inject Managed Server subnet with Network Security Groups.

     * 400 VnetConfigHasNoUdr - User tried to inject Managed Server subnet without default User Defined Route Table.

     * 400 VnetConfigHasInvalidUdr - User tried to inject Managed Server subnet with invalid User Defined Route Table.

     * 400 VnetConfigHasInvalidDns - User tried to inject Managed Server subnet with invalid custom DNS.

     * 400 VnetConfigHasServiceEndpoints - User tried to inject Managed Server subnet with service endpoints.

     * 400 VnetSubnetIsInUse - User tried to inject Managed Server subnet that is not empty.

     * 400 VnetSubnetIsLocked - User tried to inject Managed Server subnet that is in locked scope.

     * 400 VnetSubnetIsGateway - User tried to inject Managed Server subnet that is Gateway subnet.

     * 400 VnetSubnetIsUnknown - User tried to inject Managed Server subnet that does not exist.

     * 400 VnetSubnetConflictWithIntendedPolicy - User tried to inject Managed Server subnet that has a conflict with IntendedPolicy.

     * 400 NameAlreadyExists - The provided name already exists.

     * 400 ManagedInstanceInvalidEditionForSku - The specified edition {0} is not consistent with the specified SKU {1}.

     * 400 ProvisioningDisabled - Displays error message from resources operation authorizer as is, without changes

     * 400 ManagedInstanceInvalidLicenseType - The specified license type {0} is not valid.

     * 400 ManagedInstanceUpdateSloInProgress - "The operation could not be completed because a service tier change is in progress for managed instance '{0}.' Please wait for the operation in progress to complete and try again."

     * 400 VnetResourceNotFound - Resource not found: '{0}'.

     * 400 InvalidTimezone - Invalid timezone.

     * 400 UnableToResolveRemoteServer - The remote partner server name could not be resolved due to an invalid server name or DNS connectivity issues.

     * 400 InstanceCollationUpdateNotSupported - User cannot change instance collation on Managed Instance.

     * 400 CreateManagedInstanceWithNonDefaultCollationNotSupported - User can create a Managed Instance only with collation 'SQL_Latin1_General_CP1_CI_AS'.

     * 400 ManagedInstanceOperationInProgress - The operation could not be completed because {0} operation is in progress. Please wait for the operation in progress to complete and try again.

     * 400 ManagedInstanceExceedMaxAzureStorage - The operation could not be completed because total allocated storage size for General Purpose instance would exceed {0}. Please reduce the number of database files and retry operation.

     * 400 ManagedInstanceHasGeoReplica - The operation could not be completed because instance has configured geo replicated secondary instance.

     * 400 MiGeoRestoreWithWrongBackupStorageRedundancy - Geo-Restore is not allowed for managed instances with LRS/ZRS backup storage redundancy.

     * 400 ProvisioningDisabled - Displays error message from resources operation authorizer as is, without changes

     * 400 AadOnlyAuthenticationIsEnabled - Azure Active Directory Only Authentication is enabled. Please contact your system administrator.

     * 400 ManagementServiceFeatureDisabled - User attempted to use a feature which is disabled.

     * 400 MismatchingResourceGroupNameWithUrl - The provided resource group name did not match the name in the Url.

     * 400 MismatchingSubscriptionWithUrl - The provided subscription did not match the subscription in the Url.

     * 400 InvalidMinimalTlsVersion - Invalid minimal TLS version.

     * 400 InvalidResourceId - Invalid resource identifier.

     * 400 InvalidParameterValue - An invalid value was given to a parameter.

     * 400 AadOnlyAuthenticationIsEnabled - Azure Active Directory Only Authentication is enabled. Please contact your system administrator.

     * 400 InvalidExternalAdministratorLogin - Invalid or missing external administrator login name.

     * 400 InvalidExternalAdministratorSid - Invalid or missing external administrator object id.

     * 400 InvalidExternalAdministratorTenantId - Invalid or missing external administrator tenant id.

     * 400 ExternalAdministratorPrincipalType - Invalid or missing external administrator principal type. Please select from User, Application or Group.

     * 400 MissingExternalAdministratorWithAadOnlyAuth - In order to use Azure AD Only Authentication, please provide details of an external administrator.

     * 400 InvalidMaintenanceWindowSettings - Invalid maintenance window settings.

     * 400 InvalidMaintenanceWindowProperty - Invalid maintenance window property was specified.

     * 400 InvalidMaintenanceWindowPropertyNull - Invalid maintenance window with required properties null.

     * 400 InvalidMaintenanceWindowTypeWithPropertySpecified - Maintenance window type must not have certain properties specified.

     * 404 ServerNotInSubscription - Specified server does not exist on the specified subscription.

     * 404 ManagedInstanceNotInSubscriptionResourceGroup - Specified managed instance does not exist in the specified resource group and subscription.

     * 404 OperationIdNotFound - The operation with Id does not exist.

     * 404 ResourceDoesNotExist - Resource with the name '{0}' does not exist. To continue, specify a valid resource name.

     * 404 ResourceNotFound - The requested resource was not found.

     * 405 InvalidVcoreValue - vCore value {0} is not valid. Please specify a valid vCore value.

     * 405 InvalidHardwareGenerationValue - HardwareGeneration {0} is not valid. Please specify a valid HardwareGeneration value.

     * 405 InvalidStorageSizeValue - "Invalid storage size: {0} GB. Storage size must be specified between {1} and {2} gigabytes, in increments of {3} GB.

     * 409 OperationCancelled - The operation has been cancelled by user.

     * 409 OperationInterrupted - The operation on the resource could not be completed because it was interrupted by another operation on the same resource.

     * 409 ConflictingServerOperation - An operation is currently in progress for the server.

     * 409 SubscriptionDisabled - Subscription is disabled.

     * 409 ServerAlreadyExists - Duplicate server name.

     * 409 ServerOverridePreconditionFailed - Failed to apply server override on category '{0}', because physical db or instance '{1}' in server '{2}' is currently not in 'Ready' or 'Deactivated' state.

     * 409 ServerDisabled - Server is disabled.

     * 409 ManagedInstanceIsBusy - The server '{0}' is currently busy.  Please wait a few minutes before trying again.

     * 409 ServerQuotaExceeded - Server cannot be added to a subscription because it will exceed quota.

     * 409 ConflictingManagedInstanceOperation - An operation is currently in progress for the managed instance.

     * 409 MiDropFailedOnAuthLocks - User tried to drop last Managed Instance in subnet that has Lock applied on resource(s).

     * 409 MiCreateFailedNonDelegatedSubnet - User tried to deploy Managed Instance or Managed Instance pool in subnet that is not delegated to Microsoft.Sql/managedInstances.

     * 429 SubscriptionTooManyCreateUpdateRequests - Requests beyond max requests that can be processed by available resources.

     * 429 SubscriptionTooManyRequests - Requests beyond max requests that can be processed by available resources.

     * 429 ConflictingSubscriptionOperation - An operation is currently in progress for the subscription.

     * 429 SubscriptionTooManyCreateUpdateRequests - Requests beyond max requests that can be processed by available resources.

     * 429 SubscriptionTooManyRequests - Requests beyond max requests that can be processed by available resources.

     * 429 SubscriptionTooManyCreateUpdateRequests - Requests beyond max requests that can be processed by available resources.

     * 429 SubscriptionTooManyRequests - Requests beyond max requests that can be processed by available resources.

     * 429 ConflictingSubscriptionOperation - An operation is currently in progress for the subscription.

     * 500 OperationTimedOut - The operation timed out and automatically rolled back. Please retry the operation.

     * 500 GatewayInternalServerError - The server encountered an unexpected exception.

     * 503 TooManyRequests - Requests beyond max requests that can be processed by available resources.

     * 503 TooManyRequests - Requests beyond max requests that can be processed by available resources.

     * 503 TooManyRequests - Requests beyond max requests that can be processed by available resources.

     * 504 RequestTimeout - Service request exceeded the allowed timeout.

     * 504 RequestTimeout - Service request exceeded the allowed timeout.

     * 504 RequestTimeout - Service request exceeded the allowed timeout.
- name: 202 Accepted
  description: Accepted
requestBody:
- name: default
  parameters:
  - name: sku
    in: body
    description: Managed instance sku
    types:
    - uid: Sku
  - name: identity
    in: body
    description: Managed instance identity
    types:
    - uid: ResourceIdentity
  - name: tags
    in: body
    description: Resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.managedInstanceCreateMode
    in: body
    description: >-
      Specifies the mode of database creation.


      Default: Regular instance creation.


      Restore: Creates an instance by restoring a set of backups to specific point in time. RestorePointInTime and SourceManagedInstanceId must be specified.
    types:
    - uid: ManagedServerCreateMode
  - name: properties.administratorLogin
    in: body
    description: Administrator username for the managed instance. Can only be specified when the managed instance is being created (and is required for creation).
    types:
    - uid: string
  - name: properties.administratorLoginPassword
    in: body
    description: The administrator login password (required for managed instance creation).
    types:
    - uid: string
  - name: properties.subnetId
    in: body
    description: Subnet resource ID for the managed instance.
    types:
    - uid: string
  - name: properties.licenseType
    in: body
    description: The license type. Possible values are 'LicenseIncluded' (regular price inclusive of a new SQL license) and 'BasePrice' (discounted AHB price for bringing your own SQL licenses).
    types:
    - uid: ManagedInstanceLicenseType
  - name: properties.vCores
    in: body
    description: 'The number of vCores. Allowed values: 8, 16, 24, 32, 40, 64, 80.'
    types:
    - uid: integer
  - name: properties.storageSizeInGB
    in: body
    description: 'Storage size in GB. Minimum value: 32. Maximum value: 8192. Increments of 32 GB allowed only.'
    types:
    - uid: integer
  - name: properties.collation
    in: body
    description: Collation of the managed instance.
    types:
    - uid: string
  - name: properties.dnsZonePartner
    in: body
    description: The resource id of another managed instance whose DNS zone this managed instance will share after creation.
    types:
    - uid: string
  - name: properties.publicDataEndpointEnabled
    in: body
    description: Whether or not the public data endpoint is enabled.
    types:
    - uid: boolean
  - name: properties.sourceManagedInstanceId
    in: body
    description: The resource identifier of the source managed instance associated with create operation of this instance.
    types:
    - uid: string
  - name: properties.restorePointInTime
    in: body
    description: Specifies the point in time (ISO8601 format) of the source database that will be restored to create the new database.
    types:
    - uid: string
  - name: properties.proxyOverride
    in: body
    description: Connection type used for connecting to the instance.
    types:
    - uid: ManagedInstanceProxyOverride
  - name: properties.timezoneId
    in: body
    description: >-
      Id of the timezone. Allowed values are timezones supported by Windows.

      Windows keeps details on supported timezones, including the id, in registry under

      KEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones.

      You can get those registry values via SQL Server by querying SELECT name AS timezone_id FROM sys.time_zone_info.

      List of Ids can also be obtained by executing [System.TimeZoneInfo]::GetSystemTimeZones() in PowerShell.

      An example of valid timezone id is "Pacific Standard Time" or "W. Europe Standard Time".
    types:
    - uid: string
  - name: properties.instancePoolId
    in: body
    description: The Id of the instance pool this managed server belongs to.
    types:
    - uid: string
  - name: properties.maintenanceConfigurationId
    in: body
    description: Specifies maintenance configuration id to apply to this managed instance.
    types:
    - uid: string
  - name: properties.minimalTlsVersion
    in: body
    description: "Minimal TLS version. Allowed values: 'None', '1.0', '1.1', '1.2'"
    types:
    - uid: string
  - name: properties.storageAccountType
    in: body
    description: The storage account type used to store backups for this instance. The options are LRS (LocallyRedundantStorage), ZRS (ZoneRedundantStorage) and GRS (GeoRedundantStorage)
    types:
    - uid: StorageAccountType
  - name: properties.zoneRedundant
    in: body
    description: Whether or not the multi-az is enabled.
    types:
    - uid: boolean
  - name: properties.primaryUserAssignedIdentityId
    in: body
    description: The resource id of a user assigned identity to be used by default.
    types:
    - uid: string
  - name: properties.keyId
    in: body
    description: A CMK URI of the key to use for encryption.
    types:
    - uid: string
  - name: properties.administrators
    in: body
    description: The Azure Active Directory administrator of the server.
    types:
    - uid: ManagedInstanceExternalAdministrator
requestHeader: []
definitions:
- name: Sku
  description: An ARM Resource SKU.
  kind: object
  properties:
  - name: name
    description: The name of the SKU, typically, a letter + Number code, e.g. P3.
    types:
    - uid: string
  - name: tier
    description: The tier or edition of the particular SKU, e.g. Basic, Premium.
    types:
    - uid: string
  - name: size
    description: Size of the particular SKU
    types:
    - uid: string
  - name: family
    description: If the service has different generations of hardware, for the same SKU, then that can be captured here.
    types:
    - uid: string
  - name: capacity
    description: Capacity of the particular SKU.
    types:
    - uid: integer
- name: ResourceIdentity
  description: Azure Active Directory identity configuration for a resource.
  kind: object
  properties:
  - name: userAssignedIdentities
    description: The resource ids of the user assigned identities to use
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: UserIdentity
  - name: principalId
    isReadyOnly: true
    description: The Azure Active Directory principal id.
    types:
    - uid: string
  - name: type
    description: The identity type. Set this to 'SystemAssigned' in order to automatically create and assign an Azure Active Directory principal for the resource.
    types:
    - uid: IdentityType
  - name: tenantId
    isReadyOnly: true
    description: The Azure Active Directory tenant id.
    types:
    - uid: string
- name: ManagedInstancePecProperty
  description: A private endpoint connection under a managed instance
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: Resource ID.
    types:
    - uid: string
  - name: properties
    isReadyOnly: true
    description: Private endpoint connection properties
    types:
    - uid: ManagedInstancePrivateEndpointConnectionProperties
- name: ManagedInstanceExternalAdministrator
  description: Properties of a active directory administrator.
  kind: object
  properties:
  - name: administratorType
    description: Type of the sever administrator.
    types:
    - uid: AdministratorType
  - name: principalType
    description: Principal Type of the sever administrator.
    types:
    - uid: PrincipalType
  - name: login
    description: Login name of the server administrator.
    types:
    - uid: string
  - name: sid
    description: SID (object ID) of the server administrator.
    types:
    - uid: string
  - name: tenantId
    description: Tenant ID of the administrator.
    types:
    - uid: string
  - name: azureADOnlyAuthentication
    description: Azure Active Directory only Authentication enabled.
    types:
    - uid: boolean
- name: ManagedInstance
  description: An Azure SQL managed instance.
  kind: object
  properties:
  - name: identity
    description: The Azure Active Directory identity of the managed instance.
    types:
    - uid: ResourceIdentity
  - name: sku
    description: 'Managed instance SKU. Allowed values for sku.name: GP_Gen4, GP_Gen5, BC_Gen4, BC_Gen5'
    types:
    - uid: Sku
  - name: properties.provisioningState
    isReadyOnly: true
    description: ''
    types:
    - uid: Creating
    - uid: Deleting
    - uid: Updating
    - uid: Unknown
    - uid: Succeeded
    - uid: Failed
    typesTitle: enum
  - name: properties.managedInstanceCreateMode
    description: >-
      Specifies the mode of database creation.


      Default: Regular instance creation.


      Restore: Creates an instance by restoring a set of backups to specific point in time. RestorePointInTime and SourceManagedInstanceId must be specified.
    types:
    - uid: ManagedServerCreateMode
  - name: properties.fullyQualifiedDomainName
    isReadyOnly: true
    description: The fully qualified domain name of the managed instance.
    types:
    - uid: string
  - name: properties.administratorLogin
    description: Administrator username for the managed instance. Can only be specified when the managed instance is being created (and is required for creation).
    types:
    - uid: string
  - name: properties.administratorLoginPassword
    description: The administrator login password (required for managed instance creation).
    types:
    - uid: string
  - name: properties.subnetId
    description: Subnet resource ID for the managed instance.
    types:
    - uid: string
  - name: properties.state
    isReadyOnly: true
    description: The state of the managed instance.
    types:
    - uid: string
  - name: properties.licenseType
    description: The license type. Possible values are 'LicenseIncluded' (regular price inclusive of a new SQL license) and 'BasePrice' (discounted AHB price for bringing your own SQL licenses).
    types:
    - uid: ManagedInstanceLicenseType
  - name: properties.vCores
    description: 'The number of vCores. Allowed values: 8, 16, 24, 32, 40, 64, 80.'
    types:
    - uid: integer
  - name: properties.storageSizeInGB
    description: 'Storage size in GB. Minimum value: 32. Maximum value: 8192. Increments of 32 GB allowed only.'
    types:
    - uid: integer
  - name: properties.collation
    description: Collation of the managed instance.
    types:
    - uid: string
  - name: properties.dnsZone
    isReadyOnly: true
    description: The Dns Zone that the managed instance is in.
    types:
    - uid: string
  - name: properties.dnsZonePartner
    description: The resource id of another managed instance whose DNS zone this managed instance will share after creation.
    types:
    - uid: string
  - name: properties.publicDataEndpointEnabled
    description: Whether or not the public data endpoint is enabled.
    types:
    - uid: boolean
  - name: properties.sourceManagedInstanceId
    description: The resource identifier of the source managed instance associated with create operation of this instance.
    types:
    - uid: string
  - name: properties.restorePointInTime
    description: Specifies the point in time (ISO8601 format) of the source database that will be restored to create the new database.
    types:
    - uid: string
  - name: properties.proxyOverride
    description: Connection type used for connecting to the instance.
    types:
    - uid: ManagedInstanceProxyOverride
  - name: properties.timezoneId
    description: >-
      Id of the timezone. Allowed values are timezones supported by Windows.

      Windows keeps details on supported timezones, including the id, in registry under

      KEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones.

      You can get those registry values via SQL Server by querying SELECT name AS timezone_id FROM sys.time_zone_info.

      List of Ids can also be obtained by executing [System.TimeZoneInfo]::GetSystemTimeZones() in PowerShell.

      An example of valid timezone id is "Pacific Standard Time" or "W. Europe Standard Time".
    types:
    - uid: string
  - name: properties.instancePoolId
    description: The Id of the instance pool this managed server belongs to.
    types:
    - uid: string
  - name: properties.maintenanceConfigurationId
    description: Specifies maintenance configuration id to apply to this managed instance.
    types:
    - uid: string
  - name: properties.privateEndpointConnections
    isReadyOnly: true
    description: List of private endpoint connections on a managed instance.
    types:
    - uid: ManagedInstancePecProperty
      isArray: true
  - name: properties.minimalTlsVersion
    description: "Minimal TLS version. Allowed values: 'None', '1.0', '1.1', '1.2'"
    types:
    - uid: string
  - name: properties.storageAccountType
    description: The storage account type used to store backups for this instance. The options are LRS (LocallyRedundantStorage), ZRS (ZoneRedundantStorage) and GRS (GeoRedundantStorage)
    types:
    - uid: StorageAccountType
  - name: properties.zoneRedundant
    description: Whether or not the multi-az is enabled.
    types:
    - uid: boolean
  - name: properties.primaryUserAssignedIdentityId
    description: The resource id of a user assigned identity to be used by default.
    types:
    - uid: string
  - name: properties.keyId
    description: A CMK URI of the key to use for encryption.
    types:
    - uid: string
  - name: properties.administrators
    description: The Azure Active Directory administrator of the server.
    types:
    - uid: ManagedInstanceExternalAdministrator
  - name: location
    description: Resource location.
    types:
    - uid: string
  - name: tags
    description: Resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: id
    isReadyOnly: true
    description: Resource ID.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource name.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type.
    types:
    - uid: string
- name: ManagedInstanceUpdate
  description: An update request for an Azure SQL Database managed instance.
  kind: object
  properties:
  - name: sku
    description: Managed instance sku
    types:
    - uid: Sku
  - name: identity
    description: Managed instance identity
    types:
    - uid: ResourceIdentity
  - name: tags
    description: Resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.provisioningState
    isReadyOnly: true
    description: ''
    types:
    - uid: Creating
    - uid: Deleting
    - uid: Updating
    - uid: Unknown
    - uid: Succeeded
    - uid: Failed
    typesTitle: enum
  - name: properties.managedInstanceCreateMode
    description: >-
      Specifies the mode of database creation.


      Default: Regular instance creation.


      Restore: Creates an instance by restoring a set of backups to specific point in time. RestorePointInTime and SourceManagedInstanceId must be specified.
    types:
    - uid: ManagedServerCreateMode
  - name: properties.fullyQualifiedDomainName
    isReadyOnly: true
    description: The fully qualified domain name of the managed instance.
    types:
    - uid: string
  - name: properties.administratorLogin
    description: Administrator username for the managed instance. Can only be specified when the managed instance is being created (and is required for creation).
    types:
    - uid: string
  - name: properties.administratorLoginPassword
    description: The administrator login password (required for managed instance creation).
    types:
    - uid: string
  - name: properties.subnetId
    description: Subnet resource ID for the managed instance.
    types:
    - uid: string
  - name: properties.state
    isReadyOnly: true
    description: The state of the managed instance.
    types:
    - uid: string
  - name: properties.licenseType
    description: The license type. Possible values are 'LicenseIncluded' (regular price inclusive of a new SQL license) and 'BasePrice' (discounted AHB price for bringing your own SQL licenses).
    types:
    - uid: ManagedInstanceLicenseType
  - name: properties.vCores
    description: 'The number of vCores. Allowed values: 8, 16, 24, 32, 40, 64, 80.'
    types:
    - uid: integer
  - name: properties.storageSizeInGB
    description: 'Storage size in GB. Minimum value: 32. Maximum value: 8192. Increments of 32 GB allowed only.'
    types:
    - uid: integer
  - name: properties.collation
    description: Collation of the managed instance.
    types:
    - uid: string
  - name: properties.dnsZone
    isReadyOnly: true
    description: The Dns Zone that the managed instance is in.
    types:
    - uid: string
  - name: properties.dnsZonePartner
    description: The resource id of another managed instance whose DNS zone this managed instance will share after creation.
    types:
    - uid: string
  - name: properties.publicDataEndpointEnabled
    description: Whether or not the public data endpoint is enabled.
    types:
    - uid: boolean
  - name: properties.sourceManagedInstanceId
    description: The resource identifier of the source managed instance associated with create operation of this instance.
    types:
    - uid: string
  - name: properties.restorePointInTime
    description: Specifies the point in time (ISO8601 format) of the source database that will be restored to create the new database.
    types:
    - uid: string
  - name: properties.proxyOverride
    description: Connection type used for connecting to the instance.
    types:
    - uid: ManagedInstanceProxyOverride
  - name: properties.timezoneId
    description: >-
      Id of the timezone. Allowed values are timezones supported by Windows.

      Windows keeps details on supported timezones, including the id, in registry under

      KEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones.

      You can get those registry values via SQL Server by querying SELECT name AS timezone_id FROM sys.time_zone_info.

      List of Ids can also be obtained by executing [System.TimeZoneInfo]::GetSystemTimeZones() in PowerShell.

      An example of valid timezone id is "Pacific Standard Time" or "W. Europe Standard Time".
    types:
    - uid: string
  - name: properties.instancePoolId
    description: The Id of the instance pool this managed server belongs to.
    types:
    - uid: string
  - name: properties.maintenanceConfigurationId
    description: Specifies maintenance configuration id to apply to this managed instance.
    types:
    - uid: string
  - name: properties.privateEndpointConnections
    isReadyOnly: true
    description: List of private endpoint connections on a managed instance.
    types:
    - uid: ManagedInstancePecProperty
      isArray: true
  - name: properties.minimalTlsVersion
    description: "Minimal TLS version. Allowed values: 'None', '1.0', '1.1', '1.2'"
    types:
    - uid: string
  - name: properties.storageAccountType
    description: The storage account type used to store backups for this instance. The options are LRS (LocallyRedundantStorage), ZRS (ZoneRedundantStorage) and GRS (GeoRedundantStorage)
    types:
    - uid: StorageAccountType
  - name: properties.zoneRedundant
    description: Whether or not the multi-az is enabled.
    types:
    - uid: boolean
  - name: properties.primaryUserAssignedIdentityId
    description: The resource id of a user assigned identity to be used by default.
    types:
    - uid: string
  - name: properties.keyId
    description: A CMK URI of the key to use for encryption.
    types:
    - uid: string
  - name: properties.administrators
    description: The Azure Active Directory administrator of the server.
    types:
    - uid: ManagedInstanceExternalAdministrator
- name: UserIdentity
  description: Azure Active Directory identity configuration for a resource.
  kind: object
  properties:
  - name: principalId
    isReadyOnly: true
    description: The Azure Active Directory principal id.
    types:
    - uid: string
  - name: clientId
    isReadyOnly: true
    description: The Azure Active Directory client id.
    types:
    - uid: string
- name: IdentityType
  description: The identity type. Set this to 'SystemAssigned' in order to automatically create and assign an Azure Active Directory principal for the resource.
  kind: enum
  properties:
  - name: None
    types:
    - uid: string
  - name: SystemAssigned
    types:
    - uid: string
  - name: UserAssigned
    types:
    - uid: string
- name: ManagedInstancePrivateEndpointConnectionProperties
  description: Properties of a private endpoint connection.
  kind: object
  properties:
  - name: privateEndpoint
    description: Private endpoint which the connection belongs to.
    types:
    - uid: ManagedInstancePrivateEndpointProperty
  - name: privateLinkServiceConnectionState
    description: Connection State of the Private Endpoint Connection.
    types:
    - uid: ManagedInstancePrivateLinkServiceConnectionStateProperty
  - name: provisioningState
    isReadyOnly: true
    description: State of the Private Endpoint Connection.
    types:
    - uid: string
- name: AdministratorType
  description: Type of the sever administrator.
  kind: enum
  properties:
  - name: ActiveDirectory
    types:
    - uid: string
- name: PrincipalType
  description: Principal Type of the sever administrator.
  kind: enum
  properties:
  - name: User
    types:
    - uid: string
  - name: Group
    types:
    - uid: string
  - name: Application
    types:
    - uid: string
- name: ManagedServerCreateMode
  description: >-
    Specifies the mode of database creation.



    Default: Regular instance creation.



    Restore: Creates an instance by restoring a set of backups to specific point in time. RestorePointInTime and SourceManagedInstanceId must be specified.
  kind: enum
  properties:
  - name: Default
    types:
    - uid: string
  - name: PointInTimeRestore
    types:
    - uid: string
- name: ManagedInstanceLicenseType
  description: The license type. Possible values are 'LicenseIncluded' (regular price inclusive of a new SQL license) and 'BasePrice' (discounted AHB price for bringing your own SQL licenses).
  kind: enum
  properties:
  - name: LicenseIncluded
    types:
    - uid: string
  - name: BasePrice
    types:
    - uid: string
- name: ManagedInstanceProxyOverride
  description: Connection type used for connecting to the instance.
  kind: enum
  properties:
  - name: Proxy
    types:
    - uid: string
  - name: Redirect
    types:
    - uid: string
  - name: Default
    types:
    - uid: string
- name: StorageAccountType
  description: The storage account type used to store backups for this instance. The options are LRS (LocallyRedundantStorage), ZRS (ZoneRedundantStorage) and GRS (GeoRedundantStorage)
  kind: enum
  properties:
  - name: GRS
    types:
    - uid: string
  - name: LRS
    types:
    - uid: string
  - name: ZRS
    types:
    - uid: string
- name: ManagedInstancePrivateEndpointProperty
  kind: object
  properties:
  - name: id
    description: Resource id of the private endpoint.
    types:
    - uid: string
- name: ManagedInstancePrivateLinkServiceConnectionStateProperty
  kind: object
  properties:
  - name: status
    description: The private link service connection status.
    types:
    - uid: string
  - name: description
    description: The private link service connection description.
    types:
    - uid: string
  - name: actionsRequired
    isReadyOnly: true
    description: The private link service connection description.
    types:
    - uid: string
examples:
- name: Update managed instance with minimal properties
  request:
    uri: PATCH https://management.azure.com/subscriptions/20D7082A-0FC7-4468-82BD-542694D5042B/resourceGroups/testrg/providers/Microsoft.Sql/managedInstances/testinstance?api-version=2020-11-01-preview
    body: >-
      {
        "tags": {
          "tagKey1": "TagValue1"
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "sku": {
          "name": "GP_Gen4",
          "tier": "GeneralPurpose",
          "capacity": 8,
          "family": "Gen4"
        },
        "properties": {
          "fullyQualifiedDomainName": "testinstance.1b4e2caff2530.database.windows.net",
          "administratorLogin": "PLACEHOLDER",
          "subnetId": "/subscriptions/20D7082A-0FC7-4468-82BD-542694D5042B/resourceGroups/testrg/providers/Microsoft.Network/virtualNetworks/vnet1/subnets/subnet1",
          "state": "Ready",
          "vCores": 8,
          "storageSizeInGB": 1024,
          "licenseType": "LicenseIncluded",
          "collation": "SQL_Latin1_General_CP1_CI_AS",
          "publicDataEndpointEnabled": false,
          "proxyOverride": "Default",
          "dnsZone": "1b4e2caff2530",
          "instancePoolId": "/subscriptions/20d7082a-0fc7-4468-82bd-542694d5042b/resourceGroups/testrg/providers/Microsoft.Sql/instancePools/instancePool1",
          "maintenanceConfigurationId": "/subscriptions/20d7082a-0fc7-4468-82bd-542694d5042b/providers/Microsoft.Maintenance/publicMaintenanceConfigurations/SQL_Default"
        },
        "location": "japaneast",
        "tags": {
          "tagKey1": "TagValue1"
        },
        "id": "/subscriptions/20d7082a-0fc7-4468-82bd-542694d5042b/resourceGroups/testrg/providers/Microsoft.Sql/managedInstances/testinstance",
        "name": "testinstance",
        "type": "Microsoft.Sql/managedInstances"
      }
  - statusCode: "202"
- name: Update managed instance with all properties
  request:
    uri: PATCH https://management.azure.com/subscriptions/20D7082A-0FC7-4468-82BD-542694D5042B/resourceGroups/testrg/providers/Microsoft.Sql/managedInstances/testinstance?api-version=2020-11-01-preview
    body: >-
      {
        "tags": {
          "tagKey1": "TagValue1"
        },
        "sku": {
          "name": "GP_Gen4",
          "tier": "GeneralPurpose",
          "capacity": 8
        },
        "properties": {
          "administratorLogin": "dummylogin",
          "administratorLoginPassword": "PLACEHOLDER",
          "proxyOverride": "Redirect",
          "publicDataEndpointEnabled": false,
          "minimalTlsVersion": "1.2",
          "licenseType": "BasePrice",
          "vCores": 8,
          "storageSizeInGB": 448,
          "collation": "SQL_Latin1_General_CP1_CI_AS",
          "maintenanceConfigurationId": "/subscriptions/20D7082A-0FC7-4468-82BD-542694D5042B/providers/Microsoft.Maintenance/publicMaintenanceConfigurations/SQL_JapanEast_MI_1"
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "tags": {
          "tagKey1": "TagValue1"
        },
        "id": "/subscriptions/20D7082A-0FC7-4468-82BD-542694D5042B/resourceGroups/testrg/providers/Microsoft.Sql/managedInstances/testinstance",
        "name": "testinstance",
        "type": "Microsoft.Sql/managedInstances",
        "location": "japaneast",
        "sku": {
          "name": "GP_Gen4",
          "tier": "GeneralPurpose",
          "capacity": 8,
          "family": "Gen4"
        },
        "properties": {
          "fullyQualifiedDomainName": "testinstance.1b4e2caff2530.database.windows.net",
          "administratorLogin": "dummylogin",
          "subnetId": "/subscriptions/20D7082A-0FC7-4468-82BD-542694D5042B/resourceGroups/testrg/providers/Microsoft.Network/virtualNetworks/vnet1/subnets/subnet1",
          "state": "Ready",
          "vCores": 8,
          "storageSizeInGB": 448,
          "licenseType": "BasePrice",
          "collation": "SQL_Latin1_General_CP1_CI_AS",
          "publicDataEndpointEnabled": false,
          "proxyOverride": "Redirect",
          "minimalTlsVersion": "1.2",
          "dnsZone": "1b4e2caff2530",
          "instancePoolId": "/subscriptions/20d7082a-0fc7-4468-82bd-542694d5042b/resourceGroups/testrg/providers/Microsoft.Sql/instancePools/instancePool1",
          "maintenanceConfigurationId": "/subscriptions/20D7082A-0FC7-4468-82BD-542694D5042B/providers/Microsoft.Maintenance/publicMaintenanceConfigurations/SQL_JapanEast_MI_1"
        }
      }
  - statusCode: "202"
- name: Remove maintenance policy from managed instance (select default maintenance policy)
  request:
    uri: PATCH https://management.azure.com/subscriptions/20D7082A-0FC7-4468-82BD-542694D5042B/resourceGroups/testrg/providers/Microsoft.Sql/managedInstances/testinstance?api-version=2020-11-01-preview
    body: >-
      {
        "properties": {
          "maintenanceConfigurationId": "/subscriptions/20d7082a-0fc7-4468-82bd-542694d5042b/providers/Microsoft.Maintenance/publicMaintenanceConfigurations/SQL_Default"
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "sku": {
          "name": "GP_Gen4",
          "tier": "GeneralPurpose",
          "capacity": 8,
          "family": "Gen4"
        },
        "properties": {
          "fullyQualifiedDomainName": "testinstance.1b4e2caff2530.database.windows.net",
          "administratorLogin": "dummylogin",
          "subnetId": "/subscriptions/20D7082A-0FC7-4468-82BD-542694D5042B/resourceGroups/testrg/providers/Microsoft.Network/virtualNetworks/vnet1/subnets/subnet1",
          "state": "Ready",
          "vCores": 8,
          "storageSizeInGB": 1024,
          "licenseType": "LicenseIncluded",
          "collation": "SQL_Latin1_General_CP1_CI_AS",
          "publicDataEndpointEnabled": false,
          "proxyOverride": "Default",
          "dnsZone": "1b4e2caff2530",
          "instancePoolId": "/subscriptions/20d7082a-0fc7-4468-82bd-542694d5042b/resourceGroups/testrg/providers/Microsoft.Sql/instancePools/instancePool1",
          "maintenanceConfigurationId": "/subscriptions/20d7082a-0fc7-4468-82bd-542694d5042b/providers/Microsoft.Maintenance/publicMaintenanceConfigurations/SQL_Default"
        },
        "location": "japaneast",
        "id": "/subscriptions/20d7082a-0fc7-4468-82bd-542694d5042b/resourceGroups/testrg/providers/Microsoft.Sql/managedInstances/testinstance",
        "name": "testinstance",
        "type": "Microsoft.Sql/managedInstances"
      }
  - statusCode: "202"
security: []
errorCodes: []
