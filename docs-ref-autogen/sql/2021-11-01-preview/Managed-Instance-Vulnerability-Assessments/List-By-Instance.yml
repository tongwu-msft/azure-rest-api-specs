### YamlMime:RESTOperation
uid: management.azure.com.sql.2021-11-01-preview.managedinstancevulnerabilityassessments.listbyinstance
name: List By Instance
service: SQL Database
groupName: Managed Instance Vulnerability Assessments
apiVersion: 2021-11-01-preview
summary: Gets the managed instance's vulnerability assessment policies.
consumes:
- application/json
produces:
- application/json
paths:
- content: GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Sql/managedInstances/{managedInstanceName}/vulnerabilityAssessments?api-version=2021-11-01-preview
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The subscription ID that identifies an Azure subscription.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group that contains the resource. You can obtain this value from the Azure Resource Manager API or the portal.
  types:
  - uid: string
- name: managedInstanceName
  in: path
  isRequired: true
  description: The name of the managed instance for which the vulnerability assessments is defined.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The API version to use for the request.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Successfully retrieved the managed instance vulnerability assessment policies.
  types:
  - uid: ManagedInstanceVulnerabilityAssessmentListResult
- name: Other Status Codes
  description: >-
    *** Error Responses: ***

     * 400 InvalidStorageAccountName - The provided storage account is not valid or does not exist.

     * 400 InvalidStorageAccountCredentials - The provided storage account shared access signature or account storage key is not valid.

     * 400 VulnerabilityAssessmentADSIsDisabled - Advanced Data Security should be enabled in order to use Vulnerability Assessment.

     * 400 VulnerabilityAssessmentStorageOutboundFirewallNotAllowed - The storage account is not in the list of Outbound Firewall Rules.

     * 400 VulnerabilityAssessmentInsufficientStorageAccountPermissions - Insufficient permissions on the provided storage account.

     * 400 VulnerabilityAssessmentStorageAccountIsDisabled - The provided storage account is disabled.

     * 404 SubscriptionDoesNotHaveServer - The requested server was not found
requestHeader: []
definitions:
- name: ManagedInstanceVulnerabilityAssessmentListResult
  description: A list of the ManagedInstance's vulnerability assessments.
  kind: object
  properties:
  - name: value
    isReadyOnly: true
    description: Array of results.
    types:
    - uid: ManagedInstanceVulnerabilityAssessment
      isArray: true
  - name: nextLink
    isReadyOnly: true
    description: Link to retrieve next page of results.
    types:
    - uid: string
- name: ManagedInstanceVulnerabilityAssessment
  description: A managed instance vulnerability assessment.
  kind: object
  properties:
  - name: properties.storageContainerPath
    description: A blob storage container path to hold the scan results (e.g. https://myStorage.blob.core.windows.net/VaScans/).
    types:
    - uid: string
  - name: properties.storageContainerSasKey
    description: A shared access signature (SAS Key) that has write access to the blob container specified in 'storageContainerPath' parameter. If 'storageAccountAccessKey' isn't specified, StorageContainerSasKey is required. Applies only if the storage account is not behind a Vnet or a firewall
    types:
    - uid: string
  - name: properties.storageAccountAccessKey
    description: Specifies the identifier key of the storage account for vulnerability assessment scan results. If 'StorageContainerSasKey' isn't specified, storageAccountAccessKey is required. Applies only if the storage account is not behind a Vnet or a firewall
    types:
    - uid: string
  - name: properties.recurringScans
    description: The recurring scans settings
    types:
    - uid: VulnerabilityAssessmentRecurringScansProperties
  - name: id
    isReadyOnly: true
    description: Resource ID.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource name.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type.
    types:
    - uid: string
- name: VulnerabilityAssessmentRecurringScansProperties
  description: Properties of a Vulnerability Assessment recurring scans.
  kind: object
  properties:
  - name: isEnabled
    description: Recurring scans state.
    types:
    - uid: boolean
  - name: emailSubscriptionAdmins
    description: Specifies that the schedule scan notification will be is sent to the subscription administrators.
    types:
    - uid: boolean
    defaultValue: true
  - name: emails
    description: Specifies an array of e-mail addresses to which the scan notification is sent.
    types:
    - uid: string
      isArray: true
examples:
- name: Get a managed instance's vulnerability assessment policies
  request:
    uri: GET https://management.azure.com/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/vulnerabilityaseessmenttest-4799/providers/Microsoft.Sql/managedInstances/vulnerabilityaseessmenttest-6440/vulnerabilityAssessments?api-version=2021-11-01-preview
  responses:
  - statusCode: "200"
    body: >-
      {
        "value": [
          {
            "id": "/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/vulnerabilityaseessmenttest-4799/providers/Microsoft.Sql/managedInstances/vulnerabilityaseessmenttest-6440/vulnerabilityAssessments/default",
            "name": "default",
            "type": "Microsoft.Sql/managedInstances/vulnerabilityAssessments",
            "properties": {
              "recurringScans": {
                "isEnabled": true,
                "emailSubscriptionAdmins": true,
                "emails": [
                  "email1@mail.com",
                  "email2@mail.com"
                ]
              }
            }
          }
        ]
      }
security: []
metadata:
  description: Learn more about SQL Database service - Gets the managed instance's vulnerability assessment policies.
errorCodes: []
