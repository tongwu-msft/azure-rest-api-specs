### YamlMime:RESTOperation
uid: cognitiveservices-qnamaker.qnamaker5.0preview2.knowledgebase.generateanswer
name: Generate Answer
service: Cognitive Services - QnA Maker
groupName: Knowledgebase
apiVersion: v5.0-preview.2
summary: GenerateAnswer call to query knowledgebase (QnA Maker Managed).
consumes:
- application/json
produces:
- application/json
paths:
- content: POST {Endpoint}/qnamaker/v5.0-preview.2/knowledgebases/{kbId}/generateAnswer
uriParameters:
- name: Endpoint
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: Supported Cognitive Services endpoint (e.g., https://< qnamaker-resource-name >.api.cognitiveservices.azure.com).
  types:
  - uid: string
- name: kbId
  in: path
  isRequired: true
  description: Knowledgebase id.
  types:
  - uid: string
responses:
- name: 200 OK
  description: GenerateAnswer call response.
  types:
  - uid: QnASearchResultList
- name: Other Status Codes
  description: Error response.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: qnaId
    in: body
    description: Exact qnaId to fetch from the knowledgebase, this field takes priority over question.
    types:
    - uid: string
  - name: question
    in: body
    description: User question to query against the knowledge base.
    types:
    - uid: string
  - name: top
    in: body
    description: Max number of answers to be returned for the question.
    types:
    - uid: integer
  - name: userId
    in: body
    description: Unique identifier for the user.
    types:
    - uid: string
  - name: isTest
    in: body
    description: Query against the test index.
    types:
    - uid: boolean
  - name: scoreThreshold
    in: body
    description: Minimum threshold score for answers.
    types:
    - uid: number
  - name: context
    in: body
    description: Context object with previous QnA's information.
    types:
    - uid: Context
  - name: rankerType
    in: body
    description: Optional field. Set to 'QuestionOnly' for using a question only Ranker.
    types:
    - uid: string
  - name: strictFilters
    in: body
    description: Find QnAs that are associated with the given list of metadata.
    types:
    - uid: MetadataDTO
      isArray: true
  - name: strictFiltersCompoundOperationType
    in: body
    description: Optional field. Set to 'OR' for using OR operation for strict filters.
    types:
    - uid: StrictFiltersCompoundOperationType
  - name: answerSpanRequest
    in: body
    description: To configure Answer span prediction feature.
    types:
    - uid: AnswerSpanRequest
  - name: includeUnstructuredSources
    in: body
    description: Optional Flag to enable Query over Unstructured Sources.
    types:
    - uid: boolean
requestHeader:
- name: Ocp-Apim-Subscription-Key
  in: header
  isRequired: true
  types:
  - uid: string
definitions:
- name: Context
  description: Context of a QnA
  kind: object
  properties:
  - name: isContextOnly
    description: >-
      To mark if a prompt is relevant only with a previous question or not.

      true - Do not include this QnA as search result for queries without context

      false - ignores context and includes this QnA in search result
    types:
    - uid: boolean
  - name: prompts
    description: List of prompts associated with the answer.
    types:
    - uid: PromptDTO
      isArray: true
- name: MetadataDTO
  description: Name - value pair of metadata.
  kind: object
  properties:
  - name: name
    description: Metadata name.
    types:
    - uid: string
  - name: value
    description: Metadata value.
    types:
    - uid: string
- name: AnswerSpanRequest
  description: To configure Answer span prediction feature.
  kind: object
  properties:
  - name: enable
    description: Enable or Disable Answer Span prediction.
    types:
    - uid: boolean
  - name: scoreThreshold
    description: Minimum threshold score required to include an answer span.
    types:
    - uid: number
  - name: topAnswersWithSpan
    description: Number of Top answers to be considered for span prediction.
    types:
    - uid: integer
- name: QnASearchResultList
  description: Represents List of Question Answers.
  kind: object
  properties:
  - name: answers
    description: Represents Search Result list.
    types:
    - uid: QnASearchResult
      isArray: true
- name: ErrorResponse
  description: Error response. As per Microsoft One API guidelines - https://github.com/Microsoft/api-guidelines/blob/vNext/Guidelines.md#7102-error-condition-responses.
  kind: object
  properties:
  - name: error
    description: The error object.
    types:
    - uid: Error
- name: QueryDTO
  description: POST body schema to query the knowledgebase.
  kind: object
  properties:
  - name: qnaId
    description: Exact qnaId to fetch from the knowledgebase, this field takes priority over question.
    types:
    - uid: string
  - name: question
    description: User question to query against the knowledge base.
    types:
    - uid: string
  - name: top
    description: Max number of answers to be returned for the question.
    types:
    - uid: integer
  - name: userId
    description: Unique identifier for the user.
    types:
    - uid: string
  - name: isTest
    description: Query against the test index.
    types:
    - uid: boolean
  - name: scoreThreshold
    description: Minimum threshold score for answers.
    types:
    - uid: number
  - name: context
    description: Context object with previous QnA's information.
    types:
    - uid: Context
  - name: rankerType
    description: Optional field. Set to 'QuestionOnly' for using a question only Ranker.
    types:
    - uid: string
  - name: strictFilters
    description: Find QnAs that are associated with the given list of metadata.
    types:
    - uid: MetadataDTO
      isArray: true
  - name: strictFiltersCompoundOperationType
    description: Optional field. Set to 'OR' for using OR operation for strict filters.
    types:
    - uid: StrictFiltersCompoundOperationType
  - name: answerSpanRequest
    description: To configure Answer span prediction feature.
    types:
    - uid: AnswerSpanRequest
  - name: includeUnstructuredSources
    description: Optional Flag to enable Query over Unstructured Sources.
    types:
    - uid: boolean
- name: QnASearchResult
  description: Represents Search Result.
  kind: object
  properties:
  - name: questions
    description: List of questions.
    types:
    - uid: string
      isArray: true
  - name: answer
    description: Answer.
    types:
    - uid: string
  - name: score
    description: Search result score.
    types:
    - uid: number
  - name: id
    description: Id of the QnA result.
    types:
    - uid: integer
  - name: source
    description: Source of QnA result.
    types:
    - uid: string
  - name: metadata
    description: List of metadata.
    types:
    - uid: MetadataDTO
      isArray: true
  - name: context
    description: Context object of the QnA
    types:
    - uid: Context
  - name: answerSpan
    description: Answer span object of QnA with respect to user's question.
    types:
    - uid: AnswerSpan
- name: Error
  description: The error object. As per Microsoft One API guidelines - https://github.com/Microsoft/api-guidelines/blob/vNext/Guidelines.md#7102-error-condition-responses.
  kind: object
  properties:
  - name: code
    description: One of a server-defined set of error codes.
    types:
    - uid: ErrorCodeType
  - name: message
    description: A human-readable representation of the error.
    types:
    - uid: string
  - name: target
    description: The target of the error.
    types:
    - uid: string
  - name: details
    description: An array of details about specific errors that led to this reported error.
    types:
    - uid: Error
      isArray: true
  - name: innerError
    description: An object containing more specific information than the current object about the error.
    types:
    - uid: InnerErrorModel
- name: StrictFiltersCompoundOperationType
  description: Optional field. Set to 'OR' for using OR operation for strict filters.
  kind: enum
  properties:
  - name: AND
    types:
    - uid: string
  - name: OR
    types:
    - uid: string
- name: AnswerSpan
  description: Answer span object of QnA with respect to user's question.
  kind: object
  properties:
  - name: text
    description: Predicted text of answer span.
    types:
    - uid: string
  - name: score
    description: Predicted score of answer span.
    types:
    - uid: number
  - name: startIndex
    description: Start index of answer span in answer.
    types:
    - uid: integer
  - name: endIndex
    description: End index of answer span in answer.
    types:
    - uid: integer
- name: ErrorCodeType
  description: One of a server-defined set of error codes.
  kind: enum
  properties:
  - name: BadArgument
    types:
    - uid: string
  - name: Forbidden
    types:
    - uid: string
  - name: NotFound
    types:
    - uid: string
  - name: KbNotFound
    types:
    - uid: string
  - name: Unauthorized
    types:
    - uid: string
  - name: Unspecified
    types:
    - uid: string
  - name: EndpointKeysError
    types:
    - uid: string
  - name: QuotaExceeded
    types:
    - uid: string
  - name: QnaRuntimeError
    types:
    - uid: string
  - name: SKULimitExceeded
    types:
    - uid: string
  - name: OperationNotFound
    types:
    - uid: string
  - name: ServiceError
    types:
    - uid: string
  - name: ValidationFailure
    types:
    - uid: string
  - name: ExtractionFailure
    types:
    - uid: string
- name: InnerErrorModel
  description: An object containing more specific information about the error. As per Microsoft One API guidelines - https://github.com/Microsoft/api-guidelines/blob/vNext/Guidelines.md#7102-error-condition-responses.
  kind: object
  properties:
  - name: code
    description: A more specific error code than was provided by the containing error.
    types:
    - uid: string
  - name: innerError
    description: An object containing more specific information than the current object about the error.
    types:
    - uid: InnerErrorModel
- name: PromptDTO
  description: Prompt for an answer.
  kind: object
  properties:
  - name: displayOrder
    description: Index of the prompt - used in ordering of the prompts
    types:
    - uid: integer
  - name: qnaId
    description: Qna id corresponding to the prompt - if QnaId is present, QnADTO object is ignored.
    types:
    - uid: integer
  - name: qna
    description: QnADTO - Either QnaId or QnADTO needs to be present in a PromptDTO object
    types:
    - uid: Qna
  - name: displayText
    description: Text displayed to represent a follow up question prompt
    types:
    - uid: string
- name: Qna
  description: QnADTO - Either QnaId or QnADTO needs to be present in a PromptDTO object
  kind: object
  properties: []
examples:
- name: Successful query
  request:
    uri: POST {Endpoint}/qnamaker/v5.0-preview.2/knowledgebases/9d091697-fb8c-4ed5-9ac0-35bf8273bfff/generateAnswer
    body: >-
      {
        "question": "How much time it takes to complete quickstart guide?",
        "top": 6,
        "isTest": true,
        "context": {
          "previousQnaId": 9,
          "previousUserQuery": "Where are QnA Maker quickstarts?"
        },
        "scoreThreshold": 20,
        "strictFilters": [
          {
            "name": "category",
            "value": "api"
          }
        ],
        "answerSpanRequest": {
          "enable": true,
          "scoreThreshold": 25,
          "topAnswersWithSpan": 1
        },
        "userId": "sd53lsY="
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST {Endpoint}/qnamaker/v5.0-preview.2/knowledgebases/9d091697-fb8c-4ed5-9ac0-35bf8273bfff/generateAnswer


      {
        "question": "How much time it takes to complete quickstart guide?",
        "top": 6,
        "isTest": true,
        "context": {
          "previousQnaId": 9,
          "previousUserQuery": "Where are QnA Maker quickstarts?"
        },
        "scoreThreshold": 20,
        "strictFilters": [
          {
            "name": "category",
            "value": "api"
          }
        ],
        "answerSpanRequest": {
          "enable": true,
          "scoreThreshold": 25,
          "topAnswersWithSpan": 1
        },
        "userId": "sd53lsY="
      }

      ```

    headers:
    - name: Ocp-Apim-Subscription-Key
      value: '{API key}'
  responses:
  - statusCode: "200"
    body: >-
      {
        "answers": [
          {
            "questions": [
              "Complete a quickstart"
            ],
            "answer": "We offer quickstarts in most popular programming languages, each designed to teach you basic design patterns, and have you running code in less than 10 minutes. See the following list for the quickstart for each feature.\n\n*   [Get started with the LUIS client library](https://docs.microsoft.com/en-us/azure/cognitive-services/qnamaker/quickstarts/quickstart-sdk)\n\n*   [Get started with the LUIS portal](https://docs.microsoft.com/en-us/azure/cognitive-services/qnamaker/quickstarts/create-publish-knowledge-base)\n\n*   [Get started with the LUIS REST APis](https://docs.microsoft.com/en-us/azure/cognitive-services/qnamaker/quickstarts/quickstart-rest-curl)",
            "score": 46.11,
            "id": 9,
            "source": "Editorial",
            "metadata": [],
            "context": {
              "isContextOnly": false,
              "prompts": []
            },
            "answerSpan": {
              "text": "less than 10 minutes",
              "score": 54.92,
              "startIndex": 139,
              "endIndex": 159
            }
          }
        ]
      }
security:
- name: Ocp-Apim-Subscription-Key
  type: apiKey
  in: header
metadata:
  description: >
    Learn more about Cognitive Services - QnA Maker service - GenerateAnswer call to query knowledgebase (QnA Maker Managed).
errorCodes: []
