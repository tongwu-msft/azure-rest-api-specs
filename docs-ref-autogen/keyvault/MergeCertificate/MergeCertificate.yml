### YamlMime:RESTOperation
uid: keyvault.mergecertificate.mergecertificate
name: Merge Certificate
service: Key Vault
groupName: Merge Certificate
apiVersion: "7.1"
summary: "Merges a certificate or a certificate chain with a key pair existing on the server.  \nThe MergeCertificate operation performs the merging of a certificate or certificate chain with a key pair currently available in the service. This operation requires the certificates/create permission."
consumes:
- application/json
produces:
- application/json
paths:
- content: POST {vaultBaseUrl}/certificates/{certificate-name}/pending/merge?api-version=7.1
uriParameters:
- name: vaultBaseUrl
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: The vault name, for example https://myvault.vault.azure.net.
  types:
  - uid: string
- name: certificate-name
  in: path
  isRequired: true
  description: The name of the certificate.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: Client API version.
  types:
  - uid: string
responses:
- name: 201 Created
  description: Merged certificate bundle to the vault.
  types:
  - uid: CertificateBundle
- name: Other Status Codes
  description: Key Vault error response describing why the operation failed.
  types:
  - uid: KeyVaultError
requestBody:
- name: default
  parameters:
  - name: x5c
    in: body
    isRequired: true
    description: The certificate or the certificate chain to merge.
    types:
    - uid: string
      isArray: true
  - name: attributes
    in: body
    description: The attributes of the certificate (optional).
    types:
    - uid: CertificateAttributes
  - name: tags
    in: body
    description: Application specific metadata in the form of key-value pairs.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
requestHeader: []
definitions:
- name: CertificateAttributes
  description: The certificate management attributes.
  kind: object
  properties:
  - name: recoverableDays
    isReadyOnly: true
    description: softDelete data retention days. Value should be >=7 and <=90 when softDelete enabled, otherwise 0.
    types:
    - uid: integer
  - name: recoveryLevel
    isReadyOnly: true
    description: Reflects the deletion recovery level currently in effect for certificates in the current vault. If it contains 'Purgeable', the certificate can be permanently deleted by a privileged user; otherwise, only the system can purge the certificate, at the end of the retention interval.
    types:
    - uid: DeletionRecoveryLevel
  - name: enabled
    description: Determines whether the object is enabled.
    types:
    - uid: boolean
  - name: nbf
    description: Not before date in UTC.
    types:
    - uid: integer
  - name: exp
    description: Expiry date in UTC.
    types:
    - uid: integer
  - name: created
    isReadyOnly: true
    description: Creation time in UTC.
    types:
    - uid: integer
  - name: updated
    isReadyOnly: true
    description: Last updated time in UTC.
    types:
    - uid: integer
- name: CertificateBundle
  description: A certificate bundle consists of a certificate (X509) plus its attributes.
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: The certificate id.
    types:
    - uid: string
  - name: kid
    isReadyOnly: true
    description: The key id.
    types:
    - uid: string
  - name: sid
    isReadyOnly: true
    description: The secret id.
    types:
    - uid: string
  - name: x5t
    isReadyOnly: true
    description: Thumbprint of the certificate.
    types:
    - uid: string
  - name: policy
    isReadyOnly: true
    description: The management policy.
    types:
    - uid: CertificatePolicy
  - name: cer
    description: CER contents of x509 certificate.
    types:
    - uid: string
  - name: contentType
    description: The content type of the secret.
    types:
    - uid: string
  - name: attributes
    description: The certificate attributes.
    types:
    - uid: CertificateAttributes
  - name: tags
    description: Application specific metadata in the form of key-value pairs
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: KeyVaultError
  description: The key vault error exception.
  kind: object
  properties:
  - name: error
    isReadyOnly: true
    description: The key vault server error.
    types:
    - uid: Error
- name: CertificateMergeParameters
  description: The certificate merge parameters
  kind: object
  properties:
  - name: x5c
    description: The certificate or the certificate chain to merge.
    types:
    - uid: string
      isArray: true
  - name: attributes
    description: The attributes of the certificate (optional).
    types:
    - uid: CertificateAttributes
  - name: tags
    description: Application specific metadata in the form of key-value pairs.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: DeletionRecoveryLevel
  description: Reflects the deletion recovery level currently in effect for certificates in the current vault. If it contains 'Purgeable', the certificate can be permanently deleted by a privileged user; otherwise, only the system can purge the certificate, at the end of the retention interval.
  kind: enum
  properties:
  - name: Purgeable
    description: Denotes a vault state in which deletion is an irreversible operation, without the possibility for recovery. This level corresponds to no protection being available against a Delete operation; the data is irretrievably lost upon accepting a Delete operation at the entity level or higher (vault, resource group, subscription etc.)
    types:
    - uid: string
  - name: Recoverable+Purgeable
    description: Denotes a vault state in which deletion is recoverable, and which also permits immediate and permanent deletion (i.e. purge). This level guarantees the recoverability of the deleted entity during the retention interval (90 days), unless a Purge operation is requested, or the subscription is cancelled. System wil permanently delete it after 90 days, if not recovered
    types:
    - uid: string
  - name: Recoverable
    description: Denotes a vault state in which deletion is recoverable without the possibility for immediate and permanent deletion (i.e. purge). This level guarantees the recoverability of the deleted entity during the retention interval(90 days) and while the subscription is still available. System wil permanently delete it after 90 days, if not recovered
    types:
    - uid: string
  - name: Recoverable+ProtectedSubscription
    description: Denotes a vault and subscription state in which deletion is recoverable within retention interval (90 days), immediate and permanent deletion (i.e. purge) is not permitted, and in which the subscription itself  cannot be permanently canceled. System wil permanently delete it after 90 days, if not recovered
    types:
    - uid: string
  - name: CustomizedRecoverable+Purgeable
    description: Denotes a vault state in which deletion is recoverable, and which also permits immediate and permanent deletion (i.e. purge when 7<= SoftDeleteRetentionInDays < 90). This level guarantees the recoverability of the deleted entity during the retention interval, unless a Purge operation is requested, or the subscription is cancelled.
    types:
    - uid: string
  - name: CustomizedRecoverable
    description: Denotes a vault state in which deletion is recoverable without the possibility for immediate and permanent deletion (i.e. purge when 7<= SoftDeleteRetentionInDays < 90).This level guarantees the recoverability of the deleted entity during the retention interval and while the subscription is still available.
    types:
    - uid: string
  - name: CustomizedRecoverable+ProtectedSubscription
    description: Denotes a vault and subscription state in which deletion is recoverable, immediate and permanent deletion (i.e. purge) is not permitted, and in which the subscription itself cannot be permanently canceled when 7<= SoftDeleteRetentionInDays < 90. This level guarantees the recoverability of the deleted entity during the retention interval, and also reflects the fact that the subscription itself cannot be cancelled.
    types:
    - uid: string
- name: CertificatePolicy
  description: Management policy for a certificate.
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: The certificate id.
    types:
    - uid: string
  - name: key_props
    description: Properties of the key backing a certificate.
    types:
    - uid: KeyProperties
  - name: secret_props
    description: Properties of the secret backing a certificate.
    types:
    - uid: SecretProperties
  - name: x509_props
    description: Properties of the X509 component of a certificate.
    types:
    - uid: X509CertificateProperties
  - name: lifetime_actions
    description: Actions that will be performed by Key Vault over the lifetime of a certificate.
    types:
    - uid: LifetimeAction
      isArray: true
  - name: issuer
    description: Parameters for the issuer of the X509 component of a certificate.
    types:
    - uid: IssuerParameters
  - name: attributes
    description: The certificate attributes.
    types:
    - uid: CertificateAttributes
- name: Error
  description: The key vault server error.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: innererror
    isReadyOnly: true
    description: The key vault server error.
    types:
    - uid: Error
- name: KeyProperties
  description: Properties of the key pair backing a certificate.
  kind: object
  properties:
  - name: exportable
    description: Not supported in this version. Indicates if the private key can be exported.
    types:
    - uid: boolean
  - name: kty
    description: The type of key pair to be used for the certificate.
    types:
    - uid: JsonWebKeyType
  - name: key_size
    description: 'The key size in bits. For example: 2048, 3072, or 4096 for RSA.'
    types:
    - uid: integer
  - name: reuse_key
    description: Indicates if the same key pair will be used on certificate renewal.
    types:
    - uid: boolean
  - name: crv
    description: Elliptic curve name. For valid values, see JsonWebKeyCurveName.
    types:
    - uid: JsonWebKeyCurveName
- name: SecretProperties
  description: Properties of the key backing a certificate.
  kind: object
  properties:
  - name: contentType
    description: The media type (MIME type).
    types:
    - uid: string
- name: X509CertificateProperties
  description: Properties of the X509 component of a certificate.
  kind: object
  properties:
  - name: subject
    description: The subject name. Should be a valid X509 distinguished Name.
    types:
    - uid: string
  - name: ekus
    description: The enhanced key usage.
    types:
    - uid: string
      isArray: true
  - name: sans
    description: The subject alternative names.
    types:
    - uid: SubjectAlternativeNames
  - name: key_usage
    description: List of key usages.
    types:
    - uid: string
      isArray: true
  - name: validity_months
    description: The duration that the certificate is valid in months.
    types:
    - uid: integer
- name: LifetimeAction
  description: Action and its trigger that will be performed by Key Vault over the lifetime of a certificate.
  kind: object
  properties:
  - name: trigger
    description: The condition that will execute the action.
    types:
    - uid: Trigger
  - name: action
    description: The action that will be executed.
    types:
    - uid: Action
- name: IssuerParameters
  description: Parameters for the issuer of the X509 component of a certificate.
  kind: object
  properties:
  - name: name
    description: Name of the referenced issuer object or reserved names; for example, 'Self' or 'Unknown'.
    types:
    - uid: string
  - name: cty
    description: Certificate type as supported by the provider (optional); for example 'OV-SSL', 'EV-SSL'
    types:
    - uid: string
  - name: cert_transparency
    description: Indicates if the certificates generated under this policy should be published to certificate transparency logs.
    types:
    - uid: boolean
- name: JsonWebKeyType
  description: The type of key pair to be used for the certificate.
  kind: enum
  properties:
  - name: EC
    types:
    - uid: string
  - name: EC-HSM
    types:
    - uid: string
  - name: RSA
    types:
    - uid: string
  - name: RSA-HSM
    types:
    - uid: string
  - name: oct
    types:
    - uid: string
- name: JsonWebKeyCurveName
  description: Elliptic curve name. For valid values, see JsonWebKeyCurveName.
  kind: enum
  properties:
  - name: P-256
    types:
    - uid: string
  - name: P-384
    types:
    - uid: string
  - name: P-521
    types:
    - uid: string
  - name: P-256K
    types:
    - uid: string
- name: SubjectAlternativeNames
  description: The subject alternate names of a X509 object.
  kind: object
  properties:
  - name: emails
    description: Email addresses.
    types:
    - uid: string
      isArray: true
  - name: dns_names
    description: Domain names.
    types:
    - uid: string
      isArray: true
  - name: upns
    description: User principal names.
    types:
    - uid: string
      isArray: true
- name: Trigger
  description: A condition to be satisfied for an action to be executed.
  kind: object
  properties:
  - name: lifetime_percentage
    description: Percentage of lifetime at which to trigger. Value should be between 1 and 99.
    types:
    - uid: integer
  - name: days_before_expiry
    description: Days before expiry to attempt renewal. Value should be between 1 and validity_in_months multiplied by 27. If validity_in_months is 36, then value should be between 1 and 972 (36 * 27).
    types:
    - uid: integer
- name: Action
  description: The action that will be executed.
  kind: object
  properties:
  - name: action_type
    description: The type of the action.
    types:
    - uid: ActionType
- name: ActionType
  description: The type of the action.
  kind: enum
  properties:
  - name: EmailContacts
    types:
    - uid: string
  - name: AutoRenew
    types:
    - uid: string
examples:
- name: MergeCertificate
  request:
    uri: POST https://myvault.vault.azure.net//certificates/testcert/pending/merge?api-version=7.1
    body: >-
      {
        "x5c": [
          "MIICxTCCAb....trimmed for brevitiy...EPAQj8="
        ]
      }
  responses:
  - statusCode: "201"
    body: >-
      {
        "id": "https://myvault.vault.azure.net/certificates/mycert1/f366e1a9dd774288ad84a45a5f620352",
        "kid": "https:// mykeyvault.vault.azure.net/keys/mycert1/f366e1a9dd774288ad84a45a5f620352",
        "sid": " mykeyvault.vault.azure.net/secrets/mycert1/f366e1a9dd774288ad84a45a5f620352",
        "cer": "……de34534……",
        "x5t": "n14q2wbvyXr71Pcb58NivuiwJKk",
        "attributes": {
          "enabled": true,
          "exp": 1530394215,
          "nbf": 1435699215,
          "created": 1435699919,
          "updated": 1435699919
        },
        "policy": {
          "id": "https:// mykeyvault.vault.azure.net/certificates/mycert1/policy",
          "key_props": {
            "exportable": false,
            "kty": "RSA",
            "key_size": 2048,
            "reuse_key": false
          },
          "secret_props": {
            "contentType": "application/x-pkcs12"
          },
          "x509_props": {
            "subject": "CN=Mycert1",
            "ekus": [
              "1.3.6.1.5.5.7.3.1",
              "1.3.6.1.5.5.7.3.2"
            ],
            "validity_months": 12
          },
          "lifetime_actions": [
            {
              "trigger": {
                "lifetime_percentage": 80
              },
              "action": {
                "action_type": "EmailContacts"
              }
            }
          ],
          "issuer": {
            "name": "Unknown"
          },
          "attributes": {
            "enabled": true,
            "created": 1435699811,
            "updated": 1435699811
          }
        }
      }
security: []
errorCodes: []
