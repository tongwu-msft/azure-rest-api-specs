### YamlMime:RESTOperation
uid: management.azure.com.databricks.vnetpeering.createorupdate
name: Create Or Update
service: Databricks
groupName: v Net Peering
apiVersion: 2018-04-01
summary: Creates vNet Peering for workspace.
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Databricks/workspaces/{workspaceName}/virtualNetworkPeerings/{peeringName}?api-version=2018-04-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The ID of the target subscription.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group. The name is case insensitive.
  types:
  - uid: string
  pattern: ^[-\w\._\(\)]+$
- name: workspaceName
  in: path
  isRequired: true
  description: The name of the workspace.
  types:
  - uid: string
- name: peeringName
  in: path
  isRequired: true
  description: The name of the workspace vNet peering.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The API version to use for this operation.
  types:
  - uid: string
responses:
- name: 201 Created
  description: Created - Returns information about the workspace vNet peering, including provisioning status.
  types:
  - uid: VirtualNetworkPeering
- name: 200 OK
  description: Update succeeded - Returns information about the workspace vNet peering.
  types:
  - uid: VirtualNetworkPeering
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: properties.allowVirtualNetworkAccess
    in: body
    description: Whether the VMs in the local virtual network space would be able to access the VMs in remote virtual network space.
    types:
    - uid: boolean
  - name: properties.allowForwardedTraffic
    in: body
    description: Whether the forwarded traffic from the VMs in the local virtual network will be allowed/disallowed in remote virtual network.
    types:
    - uid: boolean
  - name: properties.allowGatewayTransit
    in: body
    description: If gateway links can be used in remote virtual networking to link to this virtual network.
    types:
    - uid: boolean
  - name: properties.useRemoteGateways
    in: body
    description: If remote gateways can be used on this virtual network. If the flag is set to true, and allowGatewayTransit on remote peering is also true, virtual network will use gateways of remote virtual network for transit. Only one peering can have this flag set to true. This flag cannot be set if virtual network already has a gateway.
    types:
    - uid: boolean
  - name: properties.databricksVirtualNetwork
    in: body
    description: " The remote virtual network should be in the same region. See here to learn more (https://docs.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-peering)."
    types:
    - uid: DatabricksVirtualNetwork
  - name: properties.databricksAddressSpace
    in: body
    description: The reference to the databricks virtual network address space.
    types:
    - uid: AddressSpace
  - name: properties.remoteVirtualNetwork
    in: body
    isRequired: true
    description: " The remote virtual network should be in the same region. See here to learn more (https://docs.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-peering)."
    types:
    - uid: RemoteVirtualNetwork
  - name: properties.remoteAddressSpace
    in: body
    description: The reference to the remote virtual network address space.
    types:
    - uid: AddressSpace
requestHeader: []
definitions:
- name: DatabricksVirtualNetwork
  description: " The remote virtual network should be in the same region. See here to learn more (https://docs.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-peering)."
  kind: object
  properties:
  - name: id
    description: The Id of the databricks virtual network.
    types:
    - uid: string
- name: AddressSpace
  description: AddressSpace contains an array of IP address ranges that can be used by subnets of the virtual network.
  kind: object
  properties:
  - name: addressPrefixes
    description: A list of address blocks reserved for this virtual network in CIDR notation.
    types:
    - uid: string
      isArray: true
- name: RemoteVirtualNetwork
  description: " The remote virtual network should be in the same region. See here to learn more (https://docs.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-peering)."
  kind: object
  properties:
  - name: id
    description: The Id of the remote virtual network.
    types:
    - uid: string
- name: VirtualNetworkPeering
  description: Peerings in a VirtualNetwork resource
  kind: object
  properties:
  - name: name
    isReadyOnly: true
    description: Name of the virtual network peering resource
    types:
    - uid: string
  - name: id
    isReadyOnly: true
    description: Resource ID.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: type of the virtual network peering resource
    types:
    - uid: string
  - name: properties.allowVirtualNetworkAccess
    description: Whether the VMs in the local virtual network space would be able to access the VMs in remote virtual network space.
    types:
    - uid: boolean
  - name: properties.allowForwardedTraffic
    description: Whether the forwarded traffic from the VMs in the local virtual network will be allowed/disallowed in remote virtual network.
    types:
    - uid: boolean
  - name: properties.allowGatewayTransit
    description: If gateway links can be used in remote virtual networking to link to this virtual network.
    types:
    - uid: boolean
  - name: properties.useRemoteGateways
    description: If remote gateways can be used on this virtual network. If the flag is set to true, and allowGatewayTransit on remote peering is also true, virtual network will use gateways of remote virtual network for transit. Only one peering can have this flag set to true. This flag cannot be set if virtual network already has a gateway.
    types:
    - uid: boolean
  - name: properties.databricksVirtualNetwork
    description: " The remote virtual network should be in the same region. See here to learn more (https://docs.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-peering)."
    types:
    - uid: DatabricksVirtualNetwork
  - name: properties.databricksAddressSpace
    description: The reference to the databricks virtual network address space.
    types:
    - uid: AddressSpace
  - name: properties.remoteVirtualNetwork
    description: " The remote virtual network should be in the same region. See here to learn more (https://docs.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-peering)."
    types:
    - uid: RemoteVirtualNetwork
  - name: properties.remoteAddressSpace
    description: The reference to the remote virtual network address space.
    types:
    - uid: AddressSpace
  - name: properties.peeringState
    isReadyOnly: true
    description: The status of the virtual network peering.
    types:
    - uid: peeringState
  - name: properties.provisioningState
    isReadyOnly: true
    description: The provisioning state of the virtual network peering resource.
    types:
    - uid: PeeringProvisioningState
- name: ErrorResponse
  description: Error response.
  kind: object
  properties:
  - name: error
    description: "The code and message for an error.  \nThe error details."
    types:
    - uid: ErrorInfo
- name: peeringState
  description: The status of the virtual network peering.
  kind: enum
  properties:
  - name: Initiated
    types:
    - uid: string
  - name: Connected
    types:
    - uid: string
  - name: Disconnected
    types:
    - uid: string
- name: PeeringProvisioningState
  description: The current provisioning state.
  kind: enum
  properties:
  - name: Succeeded
    types:
    - uid: string
  - name: Updating
    types:
    - uid: string
  - name: Deleting
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
- name: ErrorInfo
  description: The code and message for an error.
  kind: object
  properties:
  - name: code
    description: A machine readable error code.
    types:
    - uid: string
  - name: message
    description: A human readable error message.
    types:
    - uid: string
  - name: details
    description: error details.
    types:
    - uid: ErrorDetail
      isArray: true
  - name: innererror
    description: Inner error details if they exist.
    types:
    - uid: string
- name: ErrorDetail
  description: Error details.
  kind: object
  properties:
  - name: code
    description: The error's code.
    types:
    - uid: string
  - name: message
    description: A human readable error message.
    types:
    - uid: string
  - name: target
    description: Indicates which property in the request is responsible for the error.
    types:
    - uid: string
examples:
- name: Create vNet Peering for Workspace
  request:
    uri: PUT https://management.azure.com/subscriptions/subid/resourceGroups/rg/providers/Microsoft.Databricks/workspaces/myWorkspace/virtualNetworkPeerings/vNetPeeringTest?api-version=2018-04-01
    body: >-
      {
        "properties": {
          "allowForwardedTraffic": false,
          "allowGatewayTransit": false,
          "allowVirtualNetworkAccess": true,
          "remoteVirtualNetwork": {
            "id": "/subscriptions/0140911e-1040-48da-8bc9-b99fb3dd88a6/resourceGroups/subramantest/providers/Microsoft.Network/virtualNetworks/subramanvnet"
          },
          "useRemoteGateways": false
        }
      }
  responses:
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/0140911e-1040-48da-8bc9-b99fb3dd88a6/resourceGroups/subramantest/providers/Microsoft.Databricks/workspaces/adbworkspace/virtualNetworkPeerings/vNetPeeringTest",
        "name": "vNetPeeringTest",
        "properties": {
          "allowVirtualNetworkAccess": true,
          "allowForwardedTraffic": false,
          "allowGatewayTransit": false,
          "useRemoteGateways": false,
          "remoteVirtualNetwork": {
            "id": "/subscriptions/0140911e-1040-48da-8bc9-b99fb3dd88a6/resourceGroups/subramantest/providers/Microsoft.Network/virtualNetworks/subramanvnet"
          },
          "remoteAddressSpace": {
            "addressPrefixes": [
              "10.203.0.0/16"
            ]
          },
          "databricksVirtualNetwork": {
            "id": "/subscriptions/0140911e-1040-48da-8bc9-b99fb3dd88a6/resourceGroups/databricks-rg-adbworkspace-2jsxhmzoyooxm/providers/Microsoft.Network/virtualNetworks/workers-vnet"
          },
          "databricksAddressSpace": {
            "addressPrefixes": [
              "10.139.0.0/16"
            ]
          },
          "peeringState": "Initiated",
          "provisioningState": "Updating"
        }
      }
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/0140911e-1040-48da-8bc9-b99fb3dd88a6/resourceGroups/subramantest/providers/Microsoft.Databricks/workspaces/adbworkspace/virtualNetworkPeerings/vNetPeeringTest",
        "name": "vNetPeeringTest",
        "properties": {
          "allowVirtualNetworkAccess": true,
          "allowForwardedTraffic": false,
          "allowGatewayTransit": false,
          "useRemoteGateways": false,
          "remoteVirtualNetwork": {
            "id": "/subscriptions/0140911e-1040-48da-8bc9-b99fb3dd88a6/resourceGroups/subramantest/providers/Microsoft.Network/virtualNetworks/subramanvnet"
          },
          "remoteAddressSpace": {
            "addressPrefixes": [
              "10.203.0.0/16"
            ]
          },
          "databricksVirtualNetwork": {
            "id": "/subscriptions/0140911e-1040-48da-8bc9-b99fb3dd88a6/resourceGroups/databricks-rg-adbworkspace-2jsxhmzoyooxm/providers/Microsoft.Network/virtualNetworks/workers-vnet"
          },
          "databricksAddressSpace": {
            "addressPrefixes": [
              "10.139.0.0/16"
            ]
          },
          "peeringState": "Initiated",
          "provisioningState": "Updating"
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: Learn more about Databricks service - Creates vNet Peering for workspace.
errorCodes: []
