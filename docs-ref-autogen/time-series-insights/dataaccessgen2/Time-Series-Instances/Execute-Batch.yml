### YamlMime:RESTOperation
uid: time-series-insights.dataaccessgen2.timeseriesinstances.executebatch
name: Execute Batch
service: Time Series Insights
groupName: Time Series Instances
apiVersion: 2020-07-31
summary: Executes a batch get, create, update, delete operation on multiple time series instances.
consumes:
- application/json
produces:
- application/json
paths:
- content: POST https://{environmentFqdn}/timeseries/instances/$batch?api-version=2020-07-31
uriParameters:
- name: environmentFqdn
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: Per environment FQDN, for example 10000000-0000-0000-0000-100000000109.env.timeseries.azure.com. You can obtain this domain name from the response of the Get Environments API, Azure portal, or Azure Resource Manager.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: Version of the API to be used with the client request. Currently supported version is "2020-07-31".
  types:
  - uid: string
responses:
- name: 200 OK
  headers:
  - name: x-ms-request-id
    value: string
  description: Successful operation.
  types:
  - uid: InstancesBatchResponse
- name: Other Status Codes
  headers:
  - name: x-ms-request-id
    value: string
  description: Unexpected error.
  types:
  - uid: TsiError
requestBody:
- name: default
  parameters:
  - name: get
    in: body
    description: Time series IDs or names of time series instances to return.
    types:
    - uid: InstancesRequestBatchGetOrDelete
  - name: put
    in: body
    description: Time series instances to be created or updated.
    types:
    - uid: TimeSeriesInstance
      isArray: true
  - name: update
    in: body
    description: Time series instance to be updated. If instance does not exist, an error is returned.
    types:
    - uid: TimeSeriesInstance
      isArray: true
  - name: delete
    in: body
    description: Time series instances to be deleted. Time series ID or name may be specified.
    types:
    - uid: InstancesRequestBatchGetOrDelete
requestHeader:
- name: x-ms-client-request-id
  in: header
  description: Optional client request ID. Service records this value. Allows the service to trace operation across services, and allows the customer to contact support regarding a particular request.
  types:
  - uid: string
- name: x-ms-client-session-id
  in: header
  description: Optional client session ID. Service records this value. Allows the service to trace a group of related operations across services, and allows the customer to contact support regarding a particular group of requests.
  types:
  - uid: string
definitions:
- name: InstancesRequestBatchGetOrDelete
  description: Request to get or delete instances by time series IDs or time series names. Exactly one of "timeSeriesIds" or "names" must be set.
  kind: object
  properties:
  - name: timeSeriesIds
    description: List of time series IDs of the time series instances to return or delete.
    types:
    - uid: array
      isArray: true
  - name: names
    description: List of names of the time series instances to return or delete.
    types:
    - uid: string
      isArray: true
- name: TimeSeriesInstance
  description: Time series instances are the time series themselves. In most cases, the deviceId or assetId is the unique identifier of the asset in the environment. Instances have descriptive information associated with them called instance fields. At a minimum, instance fields include hierarchy information. They can also include useful, descriptive data like the manufacturer, operator, or the last service date.
  kind: object
  properties:
  - name: timeSeriesId
    description: Time Series ID that uniquely identifies the instance. It matches Time Series ID properties in an environment. Immutable, never null.
    types:
    - uid: TimeSeriesId
      isArray: true
  - name: typeId
    description: This represents the type that this instance belongs to. Never null.
    types:
    - uid: string
  - name: name
    description: Optional name of the instance which is unique in an environment. Names acts as a mutable alias or display name of the time series instance. Mutable, may be null.
    types:
    - uid: string
  - name: description
    description: This optional field contains description about the instance.
    types:
    - uid: string
  - name: hierarchyIds
    description: Set of time series hierarchy IDs that the instance belong to. May be null.
    types:
    - uid: string
      isArray: true
  - name: instanceFields
    description: 'Set of key-value pairs that contain user-defined instance properties. It may be null. Supported property value types are: bool, string, long, double and it cannot be nested or null.'
    types:
    - {}
- name: InstancesBatchResponse
  description: Response of a single operation on a batch of instances. Only one of "get", "put", "update" or "delete" will be set based on the request.
  kind: object
  properties:
  - name: get
    isReadyOnly: true
    description: List of instance or error objects corresponding by position to the "get" array in the request. Instance object is set when operation is successful and error object is set when operation is unsuccessful.
    types:
    - uid: InstanceOrError
      isArray: true
  - name: put
    isReadyOnly: true
    description: List of error objects corresponding by position to the "put" array in the request. Error object is set when operation is unsuccessful.
    types:
    - uid: InstanceOrError
      isArray: true
  - name: update
    isReadyOnly: true
    description: List of error objects corresponding by position to the "update" array in the request. Instance object is set when operation is successful and error object is set when operation is unsuccessful.
    types:
    - uid: InstanceOrError
      isArray: true
  - name: delete
    isReadyOnly: true
    description: List of error objects corresponding by position to the "delete" array in the request. Null means the instance has been deleted, or did not exist. Error object is set when operation is unsuccessful (e.g. when there are events associated with this time series instance).
    types:
    - uid: TsiErrorBody
      isArray: true
- name: TsiError
  description: Information about an API error.
  kind: object
  properties:
  - name: error
    description: A particular API error with an error code and a message.
    types:
    - uid: TsiErrorBody
- name: InstancesBatchRequest
  description: Request to perform a single operation on a batch of instances. Exactly one of "get", "put", "update" or "delete" must be set.
  kind: object
  properties:
  - name: get
    description: Time series IDs or names of time series instances to return.
    types:
    - uid: InstancesRequestBatchGetOrDelete
  - name: put
    description: Time series instances to be created or updated.
    types:
    - uid: TimeSeriesInstance
      isArray: true
  - name: update
    description: Time series instance to be updated. If instance does not exist, an error is returned.
    types:
    - uid: TimeSeriesInstance
      isArray: true
  - name: delete
    description: Time series instances to be deleted. Time series ID or name may be specified.
    types:
    - uid: InstancesRequestBatchGetOrDelete
- name: InstanceOrError
  description: Result of a batch operation on a particular time series instance. Instance object is set when operation is successful (except put operation) and error object is set when operation is unsuccessful.
  kind: object
  properties:
  - name: instance
    isReadyOnly: true
    description: Time series instance object - set when the operation is successful (except put operation).
    types:
    - uid: TimeSeriesInstance
  - name: error
    isReadyOnly: true
    description: Error object - set when the operation is unsuccessful.
    types:
    - uid: TsiErrorBody
- name: TsiErrorBody
  description: A particular API error with an error code and a message.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Language-independent, human-readable string that defines a service-specific error code. This code serves as a more specific indicator for the HTTP error code specified in the response. Can be used to programmatically handle specific error cases.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: Human-readable, language-independent representation of the error. It is intended as an aid to developers and is not suitable for exposure to end users.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: Target of the particular error (for example, the name of the property in error). May be null.
    types:
    - uid: string
  - name: innerError
    isReadyOnly: true
    description: Contains more specific error that narrows down the cause. May be null.
    types:
    - uid: TsiErrorBody
  - name: details
    isReadyOnly: true
    description: Contains additional error information. May be null.
    types:
    - uid: TsiErrorDetails
      isArray: true
- name: TsiErrorDetails
  description: Additional error information.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Language-independent, human-readable string that defines a service-specific error code. This code serves as a more specific indicator for the HTTP error code specified in the response. Can be used to programmatically handle specific error cases.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: Human-readable, language-independent representation of the error. It is intended as an aid to developers and is not suitable for exposure to end users.
    types:
    - uid: string
examples:
- name: InstancesBatchDeleteByIds
  request:
    uri: POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31
    body: >-
      {
        "delete": {
          "timeSeriesIds": [
            [
              "2da181d7-8346-4cf2-bd94-a17742237429",
              "T1"
            ],
            [
              "18672e3d-2beb-4007-9846-042b09ef3c72",
              "T2"
            ]
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31

      {
        "delete": {
          "timeSeriesIds": [
            [
              "2da181d7-8346-4cf2-bd94-a17742237429",
              "T1"
            ],
            [
              "18672e3d-2beb-4007-9846-042b09ef3c72",
              "T2"
            ]
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "delete": [
          null,
          {
            "code": "InvalidInput",
            "message": "Time series instance with ID '[\"18672e3d-2beb-4007-9846-042b09ef3c72\", \"T2\"]' cannot be deleted. There are already ingested events associated with this time series ID.",
            "innerError": {
              "code": "CannotDeleteInstance"
            }
          }
        ]
      }
- name: InstancesBatchDeleteByNames
  request:
    uri: POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31
    body: >-
      {
        "delete": {
          "names": [
            "F2W6.GF",
            "F1W7.GS1"
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31

      {
        "delete": {
          "names": [
            "F2W6.GF",
            "F1W7.GS1"
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "delete": [
          null,
          {
            "code": "InvalidInput",
            "message": "Time series instance with ID '[\"18672e3d-2beb-4007-9846-042b09ef3c72\", \"T2\"]' cannot be deleted. There are already ingested events associated with this time series ID.",
            "innerError": {
              "code": "CannotDeleteInstance"
            }
          }
        ]
      }
- name: InstancesBatchGetByIds
  request:
    uri: POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31
    body: >-
      {
        "get": {
          "timeSeriesIds": [
            [
              "006dfc2d-0324-4937-998c-d16f3b4f1952",
              "T1"
            ]
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31

      {
        "get": {
          "timeSeriesIds": [
            [
              "006dfc2d-0324-4937-998c-d16f3b4f1952",
              "T1"
            ]
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "get": [
          {
            "instance": {
              "typeId": "9b84e946-7b36-4aa0-9d26-71bf48cb2aff",
              "name": "F1W7.GS1",
              "timeSeriesId": [
                "006dfc2d-0324-4937-998c-d16f3b4f1952",
                "T1"
              ],
              "description": "ContosoFarm1W7_GenSpeed1",
              "hierarchyIds": [
                "33d72529-dd73-4c31-93d8-ae4e6cb5605d"
              ],
              "instanceFields": {
                "Name": "GeneratorSpeed",
                "Plant": "Contoso Plant 1",
                "Unit": "W7",
                "System": "Generator System",
                "Status": false,
                "Version": 1.3,
                "Code": 28
              }
            }
          }
        ]
      }
- name: InstancesBatchGetByNames
  request:
    uri: POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31
    body: >-
      {
        "get": {
          "names": [
            "F1W7.GS1"
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31

      {
        "get": {
          "names": [
            "F1W7.GS1"
          ]
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "get": [
          {
            "instance": {
              "typeId": "9b84e946-7b36-4aa0-9d26-71bf48cb2aff",
              "name": "F1W7.GS1",
              "timeSeriesId": [
                "006dfc2d-0324-4937-998c-d16f3b4f1952",
                "T1"
              ],
              "description": "ContosoFarm1W7_GenSpeed1",
              "hierarchyIds": [
                "33d72529-dd73-4c31-93d8-ae4e6cb5605d"
              ],
              "instanceFields": {
                "Name": "GeneratorSpeed",
                "Plant": "Contoso Plant 1",
                "Unit": "W7",
                "System": "Generator System",
                "Status": false,
                "Version": 1.3,
                "Code": 28
              }
            }
          }
        ]
      }
- name: InstancesBatchUpdate
  request:
    uri: POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31
    body: >-
      {
        "update": [
          {
            "typeId": "9b84e946-7b36-4aa0-9d26-71bf48cb2aff",
            "name": "F1W7.GS1",
            "timeSeriesId": [
              "006dfc2d-0324-4937-998c-d16f3b4f1952",
              "T1"
            ],
            "description": "ContosoFarm1W7_GenSpeed1",
            "hierarchyIds": [
              "33d72529-dd73-4c31-93d8-ae4e6cb5605d"
            ],
            "instanceFields": {
              "Name": "GeneratorSpeed",
              "Plant": "Contoso Plant 1",
              "Unit": "W7",
              "System": "Generator System",
              "Status": false,
              "Version": 1.3,
              "Code": 28
            }
          }
        ]
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31

      {
        "update": [
          {
            "typeId": "9b84e946-7b36-4aa0-9d26-71bf48cb2aff",
            "name": "F1W7.GS1",
            "timeSeriesId": [
              "006dfc2d-0324-4937-998c-d16f3b4f1952",
              "T1"
            ],
            "description": "ContosoFarm1W7_GenSpeed1",
            "hierarchyIds": [
              "33d72529-dd73-4c31-93d8-ae4e6cb5605d"
            ],
            "instanceFields": {
              "Name": "GeneratorSpeed",
              "Plant": "Contoso Plant 1",
              "Unit": "W7",
              "System": "Generator System",
              "Status": false,
              "Version": 1.3,
              "Code": 28
            }
          }
        ]
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "update": [
          {
            "error": null
          }
        ]
      }
- name: InstancesBatchPut
  request:
    uri: POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31
    body: >-
      {
        "put": [
          {
            "typeId": "9b84e946-7b36-4aa0-9d26-71bf48cb2aff",
            "name": "F1W7.GS1",
            "timeSeriesId": [
              "006dfc2d-0324-4937-998c-d16f3b4f1952",
              "T1"
            ],
            "description": "ContosoFarm1W7_GenSpeed1",
            "hierarchyIds": [
              "33d72529-dd73-4c31-93d8-ae4e6cb5605d"
            ],
            "instanceFields": {
              "Name": "GeneratorSpeed",
              "Plant": "Contoso Plant 1",
              "Unit": "W7",
              "System": "Generator System",
              "Status": false,
              "Version": 1.3,
              "Code": 28
            }
          }
        ]
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://10000000-0000-0000-0000-100000000109.env.timeseries.azure.com/timeseries/instances/$batch?api-version=2020-07-31

      {
        "put": [
          {
            "typeId": "9b84e946-7b36-4aa0-9d26-71bf48cb2aff",
            "name": "F1W7.GS1",
            "timeSeriesId": [
              "006dfc2d-0324-4937-998c-d16f3b4f1952",
              "T1"
            ],
            "description": "ContosoFarm1W7_GenSpeed1",
            "hierarchyIds": [
              "33d72529-dd73-4c31-93d8-ae4e6cb5605d"
            ],
            "instanceFields": {
              "Name": "GeneratorSpeed",
              "Plant": "Contoso Plant 1",
              "Unit": "W7",
              "System": "Generator System",
              "Status": false,
              "Version": 1.3,
              "Code": 28
            }
          }
        ]
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "put": [
          {
            "error": null
          }
        ]
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about Time Series Insights service - Executes a batch get, create, update, delete operation on multiple time series instances.
errorCodes: []
