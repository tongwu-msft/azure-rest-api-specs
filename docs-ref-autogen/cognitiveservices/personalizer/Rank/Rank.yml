### YamlMime:RESTOperation
uid: personalizer.v1.0.cognitiveservices.personalizer.rank.rank
name: Rank
service: Cognitive Services
groupName: Rank
apiVersion: v1.0
summary: A Personalizer rank request.
consumes:
- application/json
produces:
- application/json
paths:
- content: POST {Endpoint}/personalizer/v1.0/rank
uriParameters:
- name: Endpoint
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: Supported Cognitive Services endpoint.
  types:
  - uid: string
responses:
- name: 201 Created
  description: Success
  types:
  - uid: RankResponse
- name: Other Status Codes
  description: Invalid rank request.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: contextFeatures
    in: body
    description: >-
      Features of the context used for Personalizer as a

      dictionary of dictionaries. This depends on the application, and

      typically includes features about the current user, their

      device, profile information, data about time and date, etc.
    types:
    - uid: object
      isArray: true
  - name: actions
    in: body
    isRequired: true
    description: >-
      The set of actions the Personalizer service can pick from.

      The set should not contain more than 50 actions.

      The order of the actions does not affect the rank result but the order

      should match the sequence your application would have used to display them.
    types:
    - uid: RankableAction
      isArray: true
  - name: excludedActions
    in: body
    description: The set of action ids to exclude from ranking.
    types:
    - uid: string
      isArray: true
  - name: eventId
    in: body
    description: "Optionally pass an eventId that uniquely identifies this Rank event. \nIf null, the service generates a unique eventId. The eventId will be used for\nassociating this request with its reward, as well as seeding the pseudo-random\ngenerator when making a Personalizer call."
    types:
    - uid: string
  - name: deferActivation
    in: body
    description: >-
      Send false if the user will see the rank results, therefore

      Personalizer will expect a Reward call, otherwise it will assign the default

      Reward to the event. Send true if it is possible the user will not see the

      rank results, because the page is rendering later, or the Rank results may be

      overridden by code further downstream.
    types:
    - uid: boolean
requestHeader:
- name: Ocp-Apim-Subscription-Key
  in: header
  isRequired: true
  types:
  - uid: string
definitions:
- name: RankableAction
  description: An action with it's associated features used for ranking.
  kind: object
  properties:
  - name: id
    description: Id of the action.
    types:
    - uid: string
  - name: features
    description: List of dictionaries containing features.
    types:
    - uid: object
      isArray: true
- name: RankResponse
  description: A resulting ordered list of actions that result from a rank request.
  kind: object
  properties:
  - name: ranking
    isReadyOnly: true
    description: The calculated ranking for the current request.
    types:
    - uid: RankedAction
      isArray: true
  - name: eventId
    isReadyOnly: true
    description: The eventId for the round trip from request to response.
    types:
    - uid: string
  - name: rewardActionId
    isReadyOnly: true
    description: "The action chosen by the Personalizer service. This is the action for which to report the reward. This might not be the \nfirst found in 'ranking' if an action in the request in first position was part of the excluded ids."
    types:
    - uid: string
- name: ErrorResponse
  description: Used to return an error to the client
  kind: object
  properties:
  - name: error
    description: The error object.
    types:
    - uid: PersonalizerError
- name: RankRequest
  description: Request a set of actions to be ranked by the Personalizer service.
  kind: object
  properties:
  - name: contextFeatures
    description: >-
      Features of the context used for Personalizer as a

      dictionary of dictionaries. This depends on the application, and

      typically includes features about the current user, their

      device, profile information, data about time and date, etc.
    types:
    - uid: object
      isArray: true
  - name: actions
    description: >-
      The set of actions the Personalizer service can pick from.

      The set should not contain more than 50 actions.

      The order of the actions does not affect the rank result but the order

      should match the sequence your application would have used to display them.
    types:
    - uid: RankableAction
      isArray: true
  - name: excludedActions
    description: The set of action ids to exclude from ranking.
    types:
    - uid: string
      isArray: true
  - name: eventId
    description: "Optionally pass an eventId that uniquely identifies this Rank event. \nIf null, the service generates a unique eventId. The eventId will be used for\nassociating this request with its reward, as well as seeding the pseudo-random\ngenerator when making a Personalizer call."
    types:
    - uid: string
  - name: deferActivation
    description: >-
      Send false if the user will see the rank results, therefore

      Personalizer will expect a Reward call, otherwise it will assign the default

      Reward to the event. Send true if it is possible the user will not see the

      rank results, because the page is rendering later, or the Rank results may be

      overridden by code further downstream.
    types:
    - uid: boolean
    defaultValue: false
- name: RankedAction
  description: A ranked action with its resulting probability.
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: Id of the action
    types:
    - uid: string
  - name: probability
    isReadyOnly: true
    description: Probability of the action
    types:
    - uid: number
- name: PersonalizerError
  description: The error object.
  kind: object
  properties:
  - name: code
    description: High level error code.
    types:
    - uid: ErrorCode
  - name: message
    description: A message explaining the error reported by the service.
    types:
    - uid: string
  - name: target
    description: Error source element.
    types:
    - uid: string
  - name: details
    description: An array of details about specific errors that led to this reported error.
    types:
    - uid: PersonalizerError
      isArray: true
  - name: innerError
    description: Finer error details.
    types:
    - uid: InternalError
- name: ErrorCode
  description: High level error code.
  kind: enum
  properties:
  - name: BadRequest
    description: Request could not be understood by the server.
    types:
    - uid: string
  - name: ResourceNotFound
    description: Requested resource does not exist on the server.
    types:
    - uid: string
  - name: InternalServerError
    description: A generic error has occurred on the server.
    types:
    - uid: string
- name: InternalError
  description: An object containing more specific information than the parent object about the error.
  kind: object
  properties:
  - name: code
    description: Detailed error code.
    types:
    - uid: string
  - name: innererror
    description: The error object.
    types:
    - uid: InternalError
examples:
- name: Successful Rank request
  request:
    uri: POST {Endpoint}/personalizer/v1.0/rank
    body: >-
      {
        "contextFeatures": [
          {
            "timeOfDay": "Morning"
          }
        ],
        "actions": [
          {
            "id": "NewsArticle",
            "features": [
              {
                "type": "News"
              }
            ]
          },
          {
            "id": "SportsArticle",
            "features": [
              {
                "type": "Sports"
              }
            ]
          },
          {
            "id": "EntertainmentArticle",
            "features": [
              {
                "type": "Entertainment"
              }
            ]
          }
        ],
        "excludedActions": [
          "SportsArticle"
        ],
        "eventId": "75269AD0-BFEE-4598-8196-C57383D38E10",
        "deferActivation": false
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST {Endpoint}/personalizer/v1.0/rank


      {
        "contextFeatures": [
          {
            "timeOfDay": "Morning"
          }
        ],
        "actions": [
          {
            "id": "NewsArticle",
            "features": [
              {
                "type": "News"
              }
            ]
          },
          {
            "id": "SportsArticle",
            "features": [
              {
                "type": "Sports"
              }
            ]
          },
          {
            "id": "EntertainmentArticle",
            "features": [
              {
                "type": "Entertainment"
              }
            ]
          }
        ],
        "excludedActions": [
          "SportsArticle"
        ],
        "eventId": "75269AD0-BFEE-4598-8196-C57383D38E10",
        "deferActivation": false
      }

      ```

    headers:
    - name: Ocp-Apim-Subscription-Key
      value: '{API key}'
  responses:
  - statusCode: "201"
    body: >-
      {
        "ranking": [
          {
            "id": "EntertainmentArticle",
            "probability": 0.8
          },
          {
            "id": "SportsArticle",
            "probability": 0
          },
          {
            "id": "NewsArticle",
            "probability": 0.2
          }
        ],
        "eventId": "75269AD0-BFEE-4598-8196-C57383D38E10",
        "rewardActionId": "EntertainmentArticle"
      }
security:
- name: Ocp-Apim-Subscription-Key
  type: apiKey
  in: header
metadata:
  description: >
    Learn more about Cognitive Services service - A Personalizer rank request.
errorCodes: []
