### YamlMime:RESTOperation
uid: management.azure.com.elastic.tagrules.createorupdate
name: Create Or Update
service: Elastic
groupName: Tag Rules
apiVersion: 2020-07-01
summary: Create or update a tag rule set for a given monitor resource.
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Elastic/monitors/{monitorName}/tagRules/{ruleSetName}?api-version=2020-07-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The Azure subscription ID. This is a GUID-formatted string (e.g. 00000000-0000-0000-0000-000000000000)
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group to which the Elastic resource belongs.
  types:
  - uid: string
- name: monitorName
  in: path
  isRequired: true
  description: Monitor resource name
  types:
  - uid: string
- name: ruleSetName
  in: path
  isRequired: true
  description: Tag Rule Set resource name
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The API version to be used with the HTTP request.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Success
  types:
  - uid: MonitoringTagRules
- name: Other Status Codes
  description: Default error response.
  types:
  - uid: ResourceProviderDefaultErrorResponse
requestBody:
- name: default
  parameters:
  - name: properties
    in: body
    description: Properties of the monitoring tag rules.
    types:
    - uid: MonitoringTagRulesProperties
requestHeader: []
definitions:
- name: MonitoringTagRulesProperties
  description: Definition of the properties for a TagRules resource.
  kind: object
  properties:
  - name: provisioningState
    description: "ProvisioningState  \nProvisioning state of the monitoring tag rules."
    types:
    - uid: ProvisioningState
  - name: logRules
    description: Rules for sending logs.
    types:
    - uid: LogRules
- name: systemData
  description: Metadata pertaining to creation and last modification of the resource.
  kind: object
  properties:
  - name: createdBy
    description: The identity that created the resource.
    types:
    - uid: string
  - name: createdByType
    description: The type of identity that created the resource.
    types:
    - uid: createdByType
  - name: createdAt
    description: The timestamp of resource creation (UTC).
    types:
    - uid: string
  - name: lastModifiedBy
    description: The identity that last modified the resource.
    types:
    - uid: string
  - name: lastModifiedByType
    description: The type of identity that last modified the resource.
    types:
    - uid: createdByType
  - name: lastModifiedAt
    description: The timestamp of resource last modification (UTC)
    types:
    - uid: string
- name: MonitoringTagRules
  description: Capture logs and metrics of Azure resources based on ARM tags.
  kind: object
  properties:
  - name: name
    isReadyOnly: true
    description: Name of the rule set.
    types:
    - uid: string
  - name: id
    isReadyOnly: true
    description: The id of the rule set.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the rule set.
    types:
    - uid: string
  - name: properties
    description: Properties of the monitoring tag rules.
    types:
    - uid: MonitoringTagRulesProperties
  - name: systemData
    isReadyOnly: true
    description: The system metadata relating to this resource
    types:
    - uid: systemData
- name: ResourceProviderDefaultErrorResponse
  description: RP default error response.
  kind: object
  properties:
  - name: error
    isReadyOnly: true
    description: "ErrorResponseBody  \nResponse body of Error"
    types:
    - uid: ErrorResponseBody
- name: ProvisioningState
  description: ProvisioningState
  kind: enum
  properties:
  - name: Accepted
    types:
    - uid: string
  - name: Creating
    types:
    - uid: string
  - name: Updating
    types:
    - uid: string
  - name: Deleting
    types:
    - uid: string
  - name: Succeeded
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
  - name: Canceled
    types:
    - uid: string
  - name: Deleted
    types:
    - uid: string
  - name: NotSpecified
    types:
    - uid: string
- name: LogRules
  description: Set of rules for sending logs for the Monitor resource.
  kind: object
  properties:
  - name: sendAadLogs
    description: Flag specifying if AAD logs should be sent for the Monitor resource.
    types:
    - uid: boolean
  - name: sendSubscriptionLogs
    description: Flag specifying if subscription logs should be sent for the Monitor resource.
    types:
    - uid: boolean
  - name: sendActivityLogs
    description: Flag specifying if activity logs from Azure resources should be sent for the Monitor resource.
    types:
    - uid: boolean
  - name: filteringTags
    description: List of filtering tags to be used for capturing logs. This only takes effect if SendActivityLogs flag is enabled. If empty, all resources will be captured. If only Exclude action is specified, the rules will apply to the list of all available resources. If Include actions are specified, the rules will only include resources with the associated tags.
    types:
    - uid: FilteringTag
      isArray: true
- name: createdByType
  description: The type of identity that created the resource.
  kind: enum
  properties:
  - name: User
    types:
    - uid: string
  - name: Application
    types:
    - uid: string
  - name: ManagedIdentity
    types:
    - uid: string
  - name: Key
    types:
    - uid: string
- name: ErrorResponseBody
  description: ErrorResponseBody
  kind: object
  properties:
  - name: code
    description: Error code.
    types:
    - uid: string
  - name: message
    description: Error message.
    types:
    - uid: string
  - name: target
    description: Error target.
    types:
    - uid: string
  - name: details
    description: Error details.
    types:
    - uid: ErrorResponseBody
      isArray: true
- name: FilteringTag
  description: The definition of a filtering tag. Filtering tags are used for capturing resources and include/exclude them from being monitored.
  kind: object
  properties:
  - name: name
    description: The name (also known as the key) of the tag.
    types:
    - uid: string
  - name: value
    description: The value of the tag.
    types:
    - uid: string
  - name: action
    description: Valid actions for a filtering tag.
    types:
    - uid: TagAction
- name: TagAction
  description: Valid actions for a filtering tag. Exclusion takes priority over inclusion.
  kind: enum
  properties:
  - name: Include
    types:
    - uid: string
  - name: Exclude
    types:
    - uid: string
examples:
- name: TagRules_CreateOrUpdate
  request:
    uri: PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myResourceGroup/providers/Microsoft.Elastic/monitors/myMonitor/tagRules/default?api-version=2020-07-01
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myResourceGroup/providers/Microsoft.Elastic/monitors/myMonitor/tagRules/default?api-version=2020-07-01
      ```

      # [Go](#tab/Go)
      ``` go
      package armelastic_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/elastic/armelastic"
      )

      // x-ms-original-file: specification/elastic/resource-manager/Microsoft.Elastic/stable/2020-07-01/examples/TagRules_CreateOrUpdate.json
      func ExampleTagRulesClient_CreateOrUpdate() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client := armelastic.NewTagRulesClient("<subscription-id>", cred, nil)
      	res, err := client.CreateOrUpdate(ctx,
      		"<resource-group-name>",
      		"<monitor-name>",
      		"<rule-set-name>",
      		&armelastic.TagRulesCreateOrUpdateOptions{Body: nil})
      	if err != nil {
      		log.Fatal(err)
      	}
      	log.Printf("MonitoringTagRules.ID: %s\n", *res.ID)
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Felastic%2Farmelastic%2Fv0.1.0/sdk/resourcemanager/elastic/armelastic/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "name": "default",
        "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myResourceGroup/providers/Microsoft.Datadog/monitors/myMonitor/tagRules/default",
        "type": "Microsoft.Datadog/monitors/tagRules",
        "properties": {
          "provisioningState": "Succeeded",
          "logRules": {
            "sendAadLogs": false,
            "sendSubscriptionLogs": true,
            "sendActivityLogs": true,
            "filteringTags": [
              {
                "name": "Environment",
                "value": "Prod",
                "action": "Include"
              },
              {
                "name": "Environment",
                "value": "Dev",
                "action": "Exclude"
              }
            ]
          }
        }
      }
security: []
metadata:
  description: >
    Learn more about Elastic service - Create or update a tag rule set for a given monitor resource.
errorCodes: []
