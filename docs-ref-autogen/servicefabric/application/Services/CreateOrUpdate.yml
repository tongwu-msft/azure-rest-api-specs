### YamlMime:RESTOperation
uid: management.azure.com.servicefabric.application.services.createorupdate
name: Create Or Update
service: Service Fabric
groupName: Services
apiVersion: 2019-11-01-preview
summary: "Creates or updates a Service Fabric service resource.  \nCreate or update a Service Fabric service resource with the specified name."
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ServiceFabric/clusters/{clusterName}/applications/{applicationName}/services/{serviceName}?api-version=2019-11-01-preview
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The customer subscription identifier.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group.
  types:
  - uid: string
- name: clusterName
  in: path
  isRequired: true
  description: The name of the cluster resource.
  types:
  - uid: string
- name: applicationName
  in: path
  isRequired: true
  description: The name of the application resource.
  types:
  - uid: string
- name: serviceName
  in: path
  isRequired: true
  description: The name of the service resource in the format of {applicationName}~{serviceName}.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The version of the Service Fabric resource provider API. This is a required parameter and it's value must be "2019-11-01-preview" for this specification.
  types:
  - uid: string
responses:
- name: 202 Accepted
  description: The request was accepted and the operation will complete asynchronously.
  types:
  - uid: ServiceResource
- name: Other Status Codes
  description: The detailed error response.
  types:
  - uid: ErrorModel
requestBody:
- name: default
  parameters:
  - name: properties.serviceKind
    in: body
    isRequired: true
    description: The kind of service (Stateless or Stateful).
    types:
    - uid: ServiceKind
  - name: properties.serviceTypeName
    in: body
    description: The name of the service type
    types:
    - uid: string
  - name: properties.partitionDescription
    in: body
    description: Describes how the service is partitioned.
    types:
    - uid: NamedPartitionSchemeDescription
    - uid: SingletonPartitionSchemeDescription
    - uid: UniformInt64RangePartitionSchemeDescription
    typesTitle: PartitionSchemeDescription
  - name: properties.servicePackageActivationMode
    in: body
    description: The activation Mode of the service package
    types:
    - uid: ArmServicePackageActivationMode
  - name: location
    in: body
    description: It will be deprecated in New API, resource location depends on the parent resource.
    types:
    - uid: string
  - name: tags
    in: body
    description: Azure resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.placementConstraints
    in: body
    description: 'The placement constraints as a string. Placement constraints are boolean expressions on node properties and allow for restricting a service to particular nodes based on the service requirements. For example, to place a service on nodes where NodeType is blue specify the following: "NodeColor == blue)".'
    types:
    - uid: string
  - name: properties.correlationScheme
    in: body
    description: A list that describes the correlation of the service with other services.
    types:
    - uid: ServiceCorrelationDescription
      isArray: true
  - name: properties.serviceLoadMetrics
    in: body
    description: The service load metrics is given as an array of ServiceLoadMetricDescription objects.
    types:
    - uid: ServiceLoadMetricDescription
      isArray: true
  - name: properties.servicePlacementPolicies
    in: body
    description: A list that describes the correlation of the service with other services.
    types:
    - uid: ServicePlacementPolicyDescription
      isArray: true
  - name: properties.defaultMoveCost
    in: body
    description: Specifies the move cost for the service.
    types:
    - uid: MoveCost
requestHeader: []
definitions:
- name: ServiceCorrelationDescription
  description: Creates a particular correlation between services.
  kind: object
  properties:
  - name: scheme
    description: The ServiceCorrelationScheme which describes the relationship between this service and the service specified via ServiceName.
    types:
    - uid: ServiceCorrelationScheme
  - name: serviceName
    description: The name of the service that the correlation relationship is established with.
    types:
    - uid: string
- name: ServiceLoadMetricDescription
  description: Specifies a metric to load balance a service during runtime.
  kind: object
  properties:
  - name: name
    description: The name of the metric. If the service chooses to report load during runtime, the load metric name should match the name that is specified in Name exactly. Note that metric names are case sensitive.
    types:
    - uid: string
  - name: weight
    description: The service load metric relative weight, compared to other metrics configured for this service, as a number.
    types:
    - uid: ServiceLoadMetricWeight
  - name: primaryDefaultLoad
    description: Used only for Stateful services. The default amount of load, as a number, that this service creates for this metric when it is a Primary replica.
    types:
    - uid: integer
  - name: secondaryDefaultLoad
    description: Used only for Stateful services. The default amount of load, as a number, that this service creates for this metric when it is a Secondary replica.
    types:
    - uid: integer
  - name: defaultLoad
    description: Used only for Stateless services. The default amount of load, as a number, that this service creates for this metric.
    types:
    - uid: integer
- name: ServiceResource
  description: The service resource.
  kind: object
  properties:
  - name: properties.provisioningState
    isReadyOnly: true
    description: The current deployment or provisioning state, which only appears in the response
    types:
    - uid: string
  - name: properties.serviceKind
    description: The kind of service (Stateless or Stateful).
    types:
    - uid: ServiceKind
  - name: properties.serviceTypeName
    description: The name of the service type
    types:
    - uid: string
  - name: properties.partitionDescription
    description: Describes how the service is partitioned.
    types:
    - uid: NamedPartitionSchemeDescription
    - uid: SingletonPartitionSchemeDescription
    - uid: UniformInt64RangePartitionSchemeDescription
    typesTitle: PartitionSchemeDescription
  - name: properties.servicePackageActivationMode
    description: The activation Mode of the service package
    types:
    - uid: ArmServicePackageActivationMode
  - name: id
    isReadyOnly: true
    description: Azure resource identifier.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Azure resource name.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Azure resource type.
    types:
    - uid: string
  - name: location
    description: It will be deprecated in New API, resource location depends on the parent resource.
    types:
    - uid: string
  - name: tags
    description: Azure resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: etag
    isReadyOnly: true
    description: Azure resource etag.
    types:
    - uid: string
  - name: properties.placementConstraints
    description: 'The placement constraints as a string. Placement constraints are boolean expressions on node properties and allow for restricting a service to particular nodes based on the service requirements. For example, to place a service on nodes where NodeType is blue specify the following: "NodeColor == blue)".'
    types:
    - uid: string
  - name: properties.correlationScheme
    description: A list that describes the correlation of the service with other services.
    types:
    - uid: ServiceCorrelationDescription
      isArray: true
  - name: properties.serviceLoadMetrics
    description: The service load metrics is given as an array of ServiceLoadMetricDescription objects.
    types:
    - uid: ServiceLoadMetricDescription
      isArray: true
  - name: properties.servicePlacementPolicies
    description: A list that describes the correlation of the service with other services.
    types:
    - uid: ServicePlacementPolicyDescription
      isArray: true
  - name: properties.defaultMoveCost
    description: Specifies the move cost for the service.
    types:
    - uid: MoveCost
- name: ErrorModel
  description: The structure of the error.
  kind: object
  properties:
  - name: error
    description: The error details.
    types:
    - uid: ErrorModelError
- name: NamedPartitionSchemeDescription
  description: Describes the named partition scheme of the service.
  kind: object
  properties:
  - name: count
    description: The number of partitions.
    types:
    - uid: integer
  - name: names
    description: Array of size specified by the ‘count’ parameter, for the names of the partitions.
    types:
    - uid: string
      isArray: true
  - name: partitionScheme
    description: Specifies how the service is partitioned.
    types:
    - uid: Named
    typesTitle: string
- name: SingletonPartitionSchemeDescription
  description: Describes the partition scheme of a singleton-partitioned, or non-partitioned service.
  kind: object
  properties:
  - name: partitionScheme
    description: Specifies how the service is partitioned.
    types:
    - uid: Singleton
    typesTitle: string
- name: UniformInt64RangePartitionSchemeDescription
  description: Describes a partitioning scheme where an integer range is allocated evenly across a number of partitions.
  kind: object
  properties:
  - name: count
    description: The number of partitions.
    types:
    - uid: integer
  - name: lowKey
    description: >-
      String indicating the lower bound of the partition key range that

      should be split between the partition ‘count’
    types:
    - uid: string
  - name: highKey
    description: >-
      String indicating the upper bound of the partition key range that

      should be split between the partition ‘count’
    types:
    - uid: string
  - name: partitionScheme
    description: Specifies how the service is partitioned.
    types:
    - uid: UniformInt64Range
    typesTitle: string
- name: ServiceCorrelationScheme
  description: The service correlation scheme.
  kind: enum
  properties:
  - name: Invalid
    description: An invalid correlation scheme. Cannot be used. The value is zero.
    types:
    - uid: string
  - name: Affinity
    description: Indicates that this service has an affinity relationship with another service. Provided for backwards compatibility, consider preferring the Aligned or NonAlignedAffinity options. The value is 1.
    types:
    - uid: string
  - name: AlignedAffinity
    description: Aligned affinity ensures that the primaries of the partitions of the affinitized services are collocated on the same nodes. This is the default and is the same as selecting the Affinity scheme. The value is 2.
    types:
    - uid: string
  - name: NonAlignedAffinity
    description: Non-Aligned affinity guarantees that all replicas of each service will be placed on the same nodes. Unlike Aligned Affinity, this does not guarantee that replicas of particular role will be collocated. The value is 3.
    types:
    - uid: string
- name: ServiceLoadMetricWeight
  description: Determines the metric weight relative to the other metrics that are configured for this service. During runtime, if two metrics end up in conflict, the Cluster Resource Manager prefers the metric with the higher weight.
  kind: enum
  properties:
  - name: Zero
    description: Disables resource balancing for this metric. This value is zero.
    types:
    - uid: string
  - name: Low
    description: Specifies the metric weight of the service load as Low. The value is 1.
    types:
    - uid: string
  - name: Medium
    description: Specifies the metric weight of the service load as Medium. The value is 2.
    types:
    - uid: string
  - name: High
    description: Specifies the metric weight of the service load as High. The value is 3.
    types:
    - uid: string
- name: ServiceKind
  description: The kind of service (Stateless or Stateful).
  kind: enum
  properties:
  - name: Invalid
    description: Indicates the service kind is invalid. All Service Fabric enumerations have the invalid type. The value is zero.
    types:
    - uid: string
  - name: Stateless
    description: Does not use Service Fabric to make its state highly available or reliable. The value is 1.
    types:
    - uid: string
  - name: Stateful
    description: Uses Service Fabric to make its state or part of its state highly available and reliable. The value is 2.
    types:
    - uid: string
- name: ArmServicePackageActivationMode
  description: The activation Mode of the service package
  kind: enum
  properties:
  - name: SharedProcess
    description: Indicates the application package activation mode will use shared process.
    types:
    - uid: string
  - name: ExclusiveProcess
    description: Indicates the application package activation mode will use exclusive process.
    types:
    - uid: string
- name: MoveCost
  description: Specifies the move cost for the service.
  kind: enum
  properties:
  - name: Zero
    description: Zero move cost. This value is zero.
    types:
    - uid: string
  - name: Low
    description: Specifies the move cost of the service as Low. The value is 1.
    types:
    - uid: string
  - name: Medium
    description: Specifies the move cost of the service as Medium. The value is 2.
    types:
    - uid: string
  - name: High
    description: Specifies the move cost of the service as High. The value is 3.
    types:
    - uid: string
- name: ErrorModelError
  description: The error details.
  kind: object
  properties:
  - name: code
    description: The error code.
    types:
    - uid: string
  - name: message
    description: The error message.
    types:
    - uid: string
- name: PartitionScheme
  description: Enumerates the ways that a service can be partitioned.
  kind: enum
  properties:
  - name: Invalid
    description: Indicates the partition kind is invalid. All Service Fabric enumerations have the invalid type. The value is zero.
    types:
    - uid: string
  - name: Singleton
    description: Indicates that the partition is based on string names, and is a SingletonPartitionSchemeDescription object, The value is 1.
    types:
    - uid: string
  - name: UniformInt64Range
    description: Indicates that the partition is based on Int64 key ranges, and is a UniformInt64RangePartitionSchemeDescription object. The value is 2.
    types:
    - uid: string
  - name: Named
    description: Indicates that the partition is based on string names, and is a NamedPartitionSchemeDescription object. The value is 3
    types:
    - uid: string
examples:
- name: Put a service with minimum parameters
  request:
    uri: PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/resRg/providers/Microsoft.ServiceFabric/clusters/myCluster/applications/myApp/services/myService?api-version=2019-11-01-preview
    body: >-
      {
        "properties": {
          "serviceKind": "Stateless",
          "serviceTypeName": "myServiceType",
          "partitionDescription": {
            "partitionScheme": "Singleton"
          },
          "instanceCount": 1
        }
      }
  responses:
  - statusCode: "202"
    headers:
    - name: Retry-After
      value: "10"
    - name: Location
      value: http://10.91.140.224/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.ServiceFabric/locations/eastus/operationResults/5bc615c3-6c5b-4593-80e1-008f55376ec7?api-version=2019-11-01-preview
    body: >-
      {
        "type": "services",
        "location": "eastus",
        "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/resRg/providers/Microsoft.ServiceFabric/clusters/myCluster/applications/myApp/services/myService",
        "name": "myCluster",
        "tags": {},
        "etag": "W/\"636462502183671256\"",
        "properties": {
          "provisioningState": "Updating",
          "serviceKind": "Stateless",
          "serviceTypeName": "myServiceType",
          "partitionDescription": {
            "partitionScheme": "Singleton"
          },
          "instanceCount": 1
        }
      }
- name: Put a service with maximum parameters
  request:
    uri: PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/resRg/providers/Microsoft.ServiceFabric/clusters/myCluster/applications/myApp/services/myService?api-version=2019-11-01-preview
    body: >-
      {
        "properties": {
          "serviceKind": "Stateless",
          "placementConstraints": "NodeType==frontend",
          "serviceTypeName": "myServiceType",
          "partitionDescription": {
            "partitionScheme": "Singleton"
          },
          "serviceLoadMetrics": [
            {
              "name": "metric1",
              "weight": "Low"
            }
          ],
          "correlationScheme": [
            {
              "serviceName": "fabric:/app1/app1~svc1",
              "scheme": "Affinity"
            }
          ],
          "servicePlacementPolicies": [],
          "defaultMoveCost": "Medium",
          "instanceCount": 5,
          "servicePackageActivationMode": "SharedProcess"
        }
      }
  responses:
  - statusCode: "202"
    headers:
    - name: Retry-After
      value: "10"
    - name: Location
      value: http://10.91.140.224/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.ServiceFabric/locations/eastus/operationResults/2e633105-aadc-4928-9164-d76b974170a3?api-version=2019-11-01-preview
    body: >-
      {
        "type": "services",
        "location": "eastus",
        "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/resRg/providers/Microsoft.ServiceFabric/clusters/myCluster/applications/myApp/services/myService",
        "name": "myCluster",
        "tags": {},
        "etag": "W/\"636462502183671258\"",
        "properties": {
          "provisioningState": "Updating",
          "serviceKind": "Stateless",
          "placementConstraints": "NodeType==frontend",
          "serviceTypeName": "myServiceType",
          "partitionDescription": {
            "partitionScheme": "Singleton"
          },
          "serviceLoadMetrics": [
            {
              "name": "metric1",
              "weight": "Low"
            }
          ],
          "servicePlacementPolicies": [],
          "defaultMoveCost": "Medium",
          "instanceCount": 5,
          "servicePackageActivationMode": "SharedProcess"
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
errorCodes: []
