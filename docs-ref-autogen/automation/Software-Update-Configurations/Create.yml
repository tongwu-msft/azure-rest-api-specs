### YamlMime:RESTOperation
uid: management.azure.com.automation.softwareupdateconfigurations.create
name: Create
service: Automation
groupName: Software Update Configurations
apiVersion: 2019-06-01
summary: Create a new software update configuration with the name given in the URI.
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Automation/automationAccounts/{automationAccountName}/softwareUpdateConfigurations/{softwareUpdateConfigurationName}?api-version=2019-06-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: Gets subscription credentials which uniquely identify Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: Name of an Azure Resource group.
  types:
  - uid: string
  pattern: ^[-\w\._]+$
- name: automationAccountName
  in: path
  isRequired: true
  description: The name of the automation account.
  types:
  - uid: string
- name: softwareUpdateConfigurationName
  in: path
  isRequired: true
  description: The name of the software update configuration to be created.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: Client Api Version.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Software update configuration with the same name and properties already exists.
  types:
  - uid: softwareUpdateConfiguration
- name: 201 Created
  description: Software update configuration is created.
  types:
  - uid: softwareUpdateConfiguration
- name: Other Status Codes
  description: Automation error response describing why the operation failed.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: properties.updateConfiguration
    in: body
    isRequired: true
    description: update specific properties for the Software update configuration
    types:
    - uid: updateConfiguration
  - name: properties.scheduleInfo
    in: body
    isRequired: true
    description: Schedule information for the Software update configuration
    types:
    - uid: SUCScheduleProperties
  - name: properties.error
    in: body
    description: Details of provisioning error
    types:
    - uid: ErrorResponse
  - name: properties.tasks
    in: body
    description: Tasks information for the Software update configuration.
    types:
    - uid: softwareUpdateConfigurationTasks
requestHeader:
- name: clientRequestId
  in: header
  description: Identifies this specific client request.
  types:
  - uid: string
definitions:
- name: updateConfiguration
  description: Update specific properties of the software update configuration.
  kind: object
  properties:
  - name: operatingSystem
    description: operating system of target machines
    types:
    - uid: OperatingSystemType
  - name: windows
    description: Windows specific update configuration.
    types:
    - uid: WindowsProperties
  - name: linux
    description: Linux specific update configuration.
    types:
    - uid: LinuxProperties
  - name: duration
    description: Maximum time allowed for the software update configuration run. Duration needs to be specified using the format PT[n]H[n]M[n]S as per ISO8601
    types:
    - uid: string
  - name: azureVirtualMachines
    description: List of azure resource Ids for azure virtual machines targeted by the software update configuration.
    types:
    - uid: string
      isArray: true
  - name: nonAzureComputerNames
    description: List of names of non-azure machines targeted by the software update configuration.
    types:
    - uid: string
      isArray: true
  - name: targets
    description: Group targets for the software update configuration.
    types:
    - uid: TargetProperties
- name: SUCScheduleProperties
  description: Definition of schedule parameters.
  kind: object
  properties:
  - name: startTime
    description: Gets or sets the start time of the schedule.
    types:
    - uid: string
  - name: startTimeOffsetMinutes
    isReadyOnly: true
    description: Gets the start time's offset in minutes.
    types:
    - uid: number
  - name: expiryTime
    description: Gets or sets the end time of the schedule.
    types:
    - uid: string
  - name: expiryTimeOffsetMinutes
    description: Gets or sets the expiry time's offset in minutes.
    types:
    - uid: number
  - name: isEnabled
    description: Gets or sets a value indicating whether this schedule is enabled.
    types:
    - uid: boolean
    defaultValue: false
  - name: nextRun
    description: Gets or sets the next run time of the schedule.
    types:
    - uid: string
  - name: nextRunOffsetMinutes
    description: Gets or sets the next run time's offset in minutes.
    types:
    - uid: number
  - name: interval
    description: Gets or sets the interval of the schedule.
    types:
    - uid: integer
  - name: frequency
    description: Gets or sets the frequency of the schedule.
    types:
    - uid: ScheduleFrequency
  - name: timeZone
    description: Gets or sets the time zone of the schedule.
    types:
    - uid: string
  - name: advancedSchedule
    description: Gets or sets the advanced schedule.
    types:
    - uid: AdvancedSchedule
  - name: creationTime
    description: Gets or sets the creation time.
    types:
    - uid: string
  - name: lastModifiedTime
    description: Gets or sets the last modified time.
    types:
    - uid: string
  - name: description
    description: Gets or sets the description.
    types:
    - uid: string
- name: ErrorResponse
  description: Error response of an operation failure
  kind: object
  properties:
  - name: code
    description: Error code
    types:
    - uid: string
  - name: message
    description: Error message indicating why the operation failed.
    types:
    - uid: string
- name: softwareUpdateConfigurationTasks
  description: Task properties of the software update configuration.
  kind: object
  properties:
  - name: preTask
    description: Pre task properties.
    types:
    - uid: taskProperties
  - name: postTask
    description: Post task properties.
    types:
    - uid: taskProperties
- name: softwareUpdateConfiguration
  description: Software update configuration properties.
  kind: object
  properties:
  - name: name
    isReadyOnly: true
    description: Resource name.
    types:
    - uid: string
  - name: id
    isReadyOnly: true
    description: Resource Id.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type
    types:
    - uid: string
  - name: properties.updateConfiguration
    description: update specific properties for the Software update configuration
    types:
    - uid: updateConfiguration
  - name: properties.scheduleInfo
    description: Schedule information for the Software update configuration
    types:
    - uid: SUCScheduleProperties
  - name: properties.provisioningState
    isReadyOnly: true
    description: Provisioning state for the software update configuration, which only appears in the response.
    types:
    - uid: string
  - name: properties.error
    description: Details of provisioning error
    types:
    - uid: ErrorResponse
  - name: properties.creationTime
    isReadyOnly: true
    description: Creation time of the resource, which only appears in the response.
    types:
    - uid: string
  - name: properties.createdBy
    isReadyOnly: true
    description: CreatedBy property, which only appears in the response.
    types:
    - uid: string
  - name: properties.lastModifiedTime
    isReadyOnly: true
    description: Last time resource was modified, which only appears in the response.
    types:
    - uid: string
  - name: properties.lastModifiedBy
    isReadyOnly: true
    description: LastModifiedBy property, which only appears in the response.
    types:
    - uid: string
  - name: properties.tasks
    description: Tasks information for the Software update configuration.
    types:
    - uid: softwareUpdateConfigurationTasks
- name: OperatingSystemType
  description: operating system of target machines
  kind: enum
  properties:
  - name: Windows
    types:
    - uid: string
  - name: Linux
    types:
    - uid: string
- name: WindowsProperties
  description: Windows specific update configuration.
  kind: object
  properties:
  - name: includedUpdateClassifications
    description: Update classification included in the software update configuration. A comma separated string with required values
    types:
    - uid: WindowsUpdateClasses
  - name: excludedKbNumbers
    description: KB numbers excluded from the software update configuration.
    types:
    - uid: string
      isArray: true
  - name: includedKbNumbers
    description: KB numbers included from the software update configuration.
    types:
    - uid: string
      isArray: true
  - name: rebootSetting
    description: Reboot setting for the software update configuration.
    types:
    - uid: string
- name: LinuxProperties
  description: Linux specific update configuration.
  kind: object
  properties:
  - name: includedPackageClassifications
    description: Update classifications included in the software update configuration.
    types:
    - uid: LinuxUpdateClasses
  - name: excludedPackageNameMasks
    description: packages excluded from the software update configuration.
    types:
    - uid: string
      isArray: true
  - name: includedPackageNameMasks
    description: packages included from the software update configuration.
    types:
    - uid: string
      isArray: true
  - name: rebootSetting
    description: Reboot setting for the software update configuration.
    types:
    - uid: string
- name: TargetProperties
  description: Group specific to the update configuration.
  kind: object
  properties:
  - name: azureQueries
    description: List of Azure queries in the software update configuration.
    types:
    - uid: AzureQueryProperties
      isArray: true
  - name: nonAzureQueries
    description: List of non Azure queries in the software update configuration.
    types:
    - uid: NonAzureQueryProperties
      isArray: true
- name: ScheduleFrequency
  description: Gets or sets the frequency of the schedule.
  kind: enum
  properties:
  - name: OneTime
    types:
    - uid: string
  - name: Day
    types:
    - uid: string
  - name: Hour
    types:
    - uid: string
  - name: Week
    types:
    - uid: string
  - name: Month
    types:
    - uid: string
  - name: Minute
    description: The minimum allowed interval for Minute schedules is 15 minutes.
    types:
    - uid: string
- name: AdvancedSchedule
  description: The properties of the create Advanced Schedule.
  kind: object
  properties:
  - name: weekDays
    description: Days of the week that the job should execute on.
    types:
    - uid: string
      isArray: true
  - name: monthDays
    description: Days of the month that the job should execute on. Must be between 1 and 31.
    types:
    - uid: integer
      isArray: true
  - name: monthlyOccurrences
    description: Occurrences of days within a month.
    types:
    - uid: AdvancedScheduleMonthlyOccurrence
      isArray: true
- name: taskProperties
  description: Task properties of the software update configuration.
  kind: object
  properties:
  - name: parameters
    description: Gets or sets the parameters of the task.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: source
    description: Gets or sets the name of the runbook.
    types:
    - uid: string
- name: WindowsUpdateClasses
  description: Update classification included in the software update configuration. A comma separated string with required values
  kind: enum
  properties:
  - name: Unclassified
    types:
    - uid: string
  - name: Critical
    types:
    - uid: string
  - name: Security
    types:
    - uid: string
  - name: UpdateRollup
    types:
    - uid: string
  - name: FeaturePack
    types:
    - uid: string
  - name: ServicePack
    types:
    - uid: string
  - name: Definition
    types:
    - uid: string
  - name: Tools
    types:
    - uid: string
  - name: Updates
    types:
    - uid: string
- name: LinuxUpdateClasses
  description: Update classifications included in the software update configuration.
  kind: enum
  properties:
  - name: Unclassified
    types:
    - uid: string
  - name: Critical
    types:
    - uid: string
  - name: Security
    types:
    - uid: string
  - name: Other
    types:
    - uid: string
- name: AzureQueryProperties
  description: Azure query for the update configuration.
  kind: object
  properties:
  - name: scope
    description: List of Subscription or Resource Group ARM Ids.
    types:
    - uid: string
      isArray: true
  - name: locations
    description: List of locations to scope the query to.
    types:
    - uid: string
      isArray: true
  - name: tagSettings
    description: Tag settings for the VM.
    types:
    - uid: TagSettingsProperties
- name: NonAzureQueryProperties
  description: Non Azure query for the update configuration.
  kind: object
  properties:
  - name: functionAlias
    description: Log Analytics Saved Search name.
    types:
    - uid: string
  - name: workspaceId
    description: Workspace Id for Log Analytics in which the saved Search is resided.
    types:
    - uid: string
- name: AdvancedScheduleMonthlyOccurrence
  description: The properties of the create advanced schedule monthly occurrence.
  kind: object
  properties:
  - name: occurrence
    description: Occurrence of the week within the month. Must be between 1 and 5
    types:
    - uid: integer
  - name: day
    description: Day of the occurrence. Must be one of monday, tuesday, wednesday, thursday, friday, saturday, sunday.
    types:
    - uid: ScheduleDay
- name: TagSettingsProperties
  description: Tag filter information for the VM.
  kind: object
  properties:
  - name: tags
    description: Dictionary of tags with its list of values.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: array
  - name: filterOperator
    description: Filter VMs by Any or All specified tags.
    types:
    - uid: TagOperators
- name: ScheduleDay
  description: Day of the occurrence. Must be one of monday, tuesday, wednesday, thursday, friday, saturday, sunday.
  kind: enum
  properties:
  - name: Monday
    types:
    - uid: string
  - name: Tuesday
    types:
    - uid: string
  - name: Wednesday
    types:
    - uid: string
  - name: Thursday
    types:
    - uid: string
  - name: Friday
    types:
    - uid: string
  - name: Saturday
    types:
    - uid: string
  - name: Sunday
    types:
    - uid: string
- name: TagOperators
  description: Filter VMs by Any or All specified tags.
  kind: enum
  properties:
  - name: All
    types:
    - uid: string
  - name: Any
    types:
    - uid: string
examples:
- name: Create software update configuration
  request:
    uri: PUT https://management.azure.com/subscriptions/51766542-3ed7-4a72-a187-0c8ab644ddab/resourceGroups/mygroup/providers/Microsoft.Automation/automationAccounts/myaccount/softwareUpdateConfigurations/testpatch?api-version=2019-06-01
    body: >-
      {
        "properties": {
          "updateConfiguration": {
            "operatingSystem": "Windows",
            "duration": "PT2H0M",
            "windows": {
              "excludedKbNumbers": [
                "168934",
                "168973"
              ],
              "includedUpdateClassifications": "Critical",
              "rebootSetting": "IfRequired"
            },
            "azureVirtualMachines": [
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-01",
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-02",
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-03"
            ],
            "nonAzureComputerNames": [
              "box1.contoso.com",
              "box2.contoso.com"
            ],
            "targets": {
              "azureQueries": [
                {
                  "scope": [
                    "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources",
                    "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067"
                  ],
                  "tagSettings": {
                    "tags": {
                      "tag1": [
                        "tag1Value1",
                        "tag1Value2",
                        "tag1Value3"
                      ],
                      "tag2": [
                        "tag2Value1",
                        "tag2Value2",
                        "tag2Value3"
                      ]
                    },
                    "filterOperator": "All"
                  },
                  "locations": [
                    "Japan East",
                    "UK South"
                  ]
                }
              ],
              "nonAzureQueries": [
                {
                  "functionAlias": "SavedSearch1",
                  "workspaceId": "WorkspaceId1"
                },
                {
                  "functionAlias": "SavedSearch2",
                  "workspaceId": "WorkspaceId2"
                }
              ]
            }
          },
          "scheduleInfo": {
            "frequency": "Hour",
            "startTime": "2017-10-19T12:22:57+00:00",
            "timeZone": "America/Los_Angeles",
            "interval": 1,
            "expiryTime": "2018-11-09T11:22:57+00:00",
            "advancedSchedule": {
              "weekDays": [
                "Monday",
                "Thursday"
              ]
            }
          },
          "tasks": {
            "preTask": {
              "source": "HelloWorld",
              "parameters": {
                "COMPUTERNAME": "Computer1"
              }
            },
            "postTask": {
              "source": "GetCache",
              "parameters": null
            }
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT https://management.azure.com/subscriptions/51766542-3ed7-4a72-a187-0c8ab644ddab/resourceGroups/mygroup/providers/Microsoft.Automation/automationAccounts/myaccount/softwareUpdateConfigurations/testpatch?api-version=2019-06-01

      {
        "properties": {
          "updateConfiguration": {
            "operatingSystem": "Windows",
            "duration": "PT2H0M",
            "windows": {
              "excludedKbNumbers": [
                "168934",
                "168973"
              ],
              "includedUpdateClassifications": "Critical",
              "rebootSetting": "IfRequired"
            },
            "azureVirtualMachines": [
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-01",
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-02",
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-03"
            ],
            "nonAzureComputerNames": [
              "box1.contoso.com",
              "box2.contoso.com"
            ],
            "targets": {
              "azureQueries": [
                {
                  "scope": [
                    "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources",
                    "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067"
                  ],
                  "tagSettings": {
                    "tags": {
                      "tag1": [
                        "tag1Value1",
                        "tag1Value2",
                        "tag1Value3"
                      ],
                      "tag2": [
                        "tag2Value1",
                        "tag2Value2",
                        "tag2Value3"
                      ]
                    },
                    "filterOperator": "All"
                  },
                  "locations": [
                    "Japan East",
                    "UK South"
                  ]
                }
              ],
              "nonAzureQueries": [
                {
                  "functionAlias": "SavedSearch1",
                  "workspaceId": "WorkspaceId1"
                },
                {
                  "functionAlias": "SavedSearch2",
                  "workspaceId": "WorkspaceId2"
                }
              ]
            }
          },
          "scheduleInfo": {
            "frequency": "Hour",
            "startTime": "2017-10-19T12:22:57+00:00",
            "timeZone": "America/Los_Angeles",
            "interval": 1,
            "expiryTime": "2018-11-09T11:22:57+00:00",
            "advancedSchedule": {
              "weekDays": [
                "Monday",
                "Thursday"
              ]
            }
          },
          "tasks": {
            "preTask": {
              "source": "HelloWorld",
              "parameters": {
                "COMPUTERNAME": "Computer1"
              }
            },
            "postTask": {
              "source": "GetCache",
              "parameters": null
            }
          }
        }
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.resourcemanager.automation.models.AdvancedSchedule;
      import com.azure.resourcemanager.automation.models.AzureQueryProperties;
      import com.azure.resourcemanager.automation.models.NonAzureQueryProperties;
      import com.azure.resourcemanager.automation.models.OperatingSystemType;
      import com.azure.resourcemanager.automation.models.ScheduleFrequency;
      import com.azure.resourcemanager.automation.models.SoftwareUpdateConfigurationTasks;
      import com.azure.resourcemanager.automation.models.SucScheduleProperties;
      import com.azure.resourcemanager.automation.models.TagOperators;
      import com.azure.resourcemanager.automation.models.TagSettingsProperties;
      import com.azure.resourcemanager.automation.models.TargetProperties;
      import com.azure.resourcemanager.automation.models.TaskProperties;
      import com.azure.resourcemanager.automation.models.UpdateConfiguration;
      import com.azure.resourcemanager.automation.models.WindowsProperties;
      import com.azure.resourcemanager.automation.models.WindowsUpdateClasses;
      import java.time.Duration;
      import java.time.OffsetDateTime;
      import java.util.Arrays;
      import java.util.HashMap;
      import java.util.Map;

      /** Samples for SoftwareUpdateConfigurations Create. */
      public final class Main {
          /*
           * x-ms-original-file: specification/automation/resource-manager/Microsoft.Automation/stable/2019-06-01/examples/softwareUpdateConfiguration/createSoftwareUpdateConfiguration.json
           */
          /**
           * Sample code: Create software update configuration.
           *
           * @param manager Entry point to AutomationManager.
           */
          public static void createSoftwareUpdateConfiguration(
              com.azure.resourcemanager.automation.AutomationManager manager) {
              manager
                  .softwareUpdateConfigurations()
                  .define("testpatch")
                  .withExistingAutomationAccount("mygroup", "myaccount")
                  .withUpdateConfiguration(
                      new UpdateConfiguration()
                          .withOperatingSystem(OperatingSystemType.WINDOWS)
                          .withWindows(
                              new WindowsProperties()
                                  .withIncludedUpdateClassifications(WindowsUpdateClasses.CRITICAL)
                                  .withExcludedKbNumbers(Arrays.asList("168934", "168973"))
                                  .withRebootSetting("IfRequired"))
                          .withDuration(Duration.parse("PT2H0M"))
                          .withAzureVirtualMachines(
                              Arrays
                                  .asList(
                                      "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-01",
                                      "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-02",
                                      "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-03"))
                          .withNonAzureComputerNames(Arrays.asList("box1.contoso.com", "box2.contoso.com"))
                          .withTargets(
                              new TargetProperties()
                                  .withAzureQueries(
                                      Arrays
                                          .asList(
                                              new AzureQueryProperties()
                                                  .withScope(
                                                      Arrays
                                                          .asList(
                                                              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources",
                                                              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067"))
                                                  .withLocations(Arrays.asList("Japan East", "UK South"))
                                                  .withTagSettings(
                                                      new TagSettingsProperties()
                                                          .withTags(
                                                              mapOf(
                                                                  "tag1",
                                                                  Arrays.asList("tag1Value1", "tag1Value2", "tag1Value3"),
                                                                  "tag2",
                                                                  Arrays.asList("tag2Value1", "tag2Value2", "tag2Value3")))
                                                          .withFilterOperator(TagOperators.ALL))))
                                  .withNonAzureQueries(
                                      Arrays
                                          .asList(
                                              new NonAzureQueryProperties()
                                                  .withFunctionAlias("SavedSearch1")
                                                  .withWorkspaceId("WorkspaceId1"),
                                              new NonAzureQueryProperties()
                                                  .withFunctionAlias("SavedSearch2")
                                                  .withWorkspaceId("WorkspaceId2")))))
                  .withScheduleInfo(
                      new SucScheduleProperties()
                          .withStartTime(OffsetDateTime.parse("2017-10-19T12:22:57+00:00"))
                          .withExpiryTime(OffsetDateTime.parse("2018-11-09T11:22:57+00:00"))
                          .withInterval(1L)
                          .withFrequency(ScheduleFrequency.HOUR)
                          .withTimeZone("America/Los_Angeles")
                          .withAdvancedSchedule(new AdvancedSchedule().withWeekDays(Arrays.asList("Monday", "Thursday"))))
                  .withTasks(
                      new SoftwareUpdateConfigurationTasks()
                          .withPreTask(
                              new TaskProperties()
                                  .withParameters(mapOf("COMPUTERNAME", "Computer1"))
                                  .withSource("HelloWorld"))
                          .withPostTask(new TaskProperties().withSource("GetCache")))
                  .create();
          }

          @SuppressWarnings("unchecked")
          private static <T> Map<String, T> mapOf(Object... inputs) {
              Map<String, T> map = new HashMap<>();
              for (int i = 0; i < inputs.length; i += 2) {
                  String key = (String) inputs[i];
                  T value = (T) inputs[i + 1];
                  map.put(key, value);
              }
              return map;
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-automation_1.0.0-beta.2/sdk/automation/azure-resourcemanager-automation/README.md) on how to add the SDK to your project and authenticate.
      # [Go](#tab/Go)
      ``` go
      package armautomation_test

      import (
      	"context"
      	"log"

      	"time"

      	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"
      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/automation/armautomation"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/automation/resource-manager/Microsoft.Automation/stable/2019-06-01/examples/softwareUpdateConfiguration/createSoftwareUpdateConfiguration.json
      func ExampleSoftwareUpdateConfigurationsClient_Create() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armautomation.NewSoftwareUpdateConfigurationsClient("51766542-3ed7-4a72-a187-0c8ab644ddab", cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	res, err := client.Create(ctx,
      		"mygroup",
      		"myaccount",
      		"testpatch",
      		armautomation.SoftwareUpdateConfiguration{
      			Properties: &armautomation.SoftwareUpdateConfigurationProperties{
      				ScheduleInfo: &armautomation.SUCScheduleProperties{
      					AdvancedSchedule: &armautomation.AdvancedSchedule{
      						WeekDays: []*string{
      							to.Ptr("Monday"),
      							to.Ptr("Thursday")},
      					},
      					ExpiryTime: to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2018-11-09T11:22:57+00:00"); return t }()),
      					Frequency:  to.Ptr(armautomation.ScheduleFrequencyHour),
      					Interval:   to.Ptr[int64](1),
      					StartTime:  to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2017-10-19T12:22:57+00:00"); return t }()),
      					TimeZone:   to.Ptr("America/Los_Angeles"),
      				},
      				Tasks: &armautomation.SoftwareUpdateConfigurationTasks{
      					PostTask: &armautomation.TaskProperties{
      						Source: to.Ptr("GetCache"),
      					},
      					PreTask: &armautomation.TaskProperties{
      						Parameters: map[string]*string{
      							"COMPUTERNAME": to.Ptr("Computer1"),
      						},
      						Source: to.Ptr("HelloWorld"),
      					},
      				},
      				UpdateConfiguration: &armautomation.UpdateConfiguration{
      					AzureVirtualMachines: []*string{
      						to.Ptr("/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-01"),
      						to.Ptr("/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-02"),
      						to.Ptr("/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-03")},
      					Duration: to.Ptr("PT2H0M"),
      					NonAzureComputerNames: []*string{
      						to.Ptr("box1.contoso.com"),
      						to.Ptr("box2.contoso.com")},
      					OperatingSystem: to.Ptr(armautomation.OperatingSystemTypeWindows),
      					Targets: &armautomation.TargetProperties{
      						AzureQueries: []*armautomation.AzureQueryProperties{
      							{
      								Locations: []*string{
      									to.Ptr("Japan East"),
      									to.Ptr("UK South")},
      								Scope: []*string{
      									to.Ptr("/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources"),
      									to.Ptr("/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067")},
      								TagSettings: &armautomation.TagSettingsProperties{
      									FilterOperator: to.Ptr(armautomation.TagOperatorsAll),
      									Tags: map[string][]*string{
      										"tag1": {
      											to.Ptr("tag1Value1"),
      											to.Ptr("tag1Value2"),
      											to.Ptr("tag1Value3")},
      										"tag2": {
      											to.Ptr("tag2Value1"),
      											to.Ptr("tag2Value2"),
      											to.Ptr("tag2Value3")},
      									},
      								},
      							}},
      						NonAzureQueries: []*armautomation.NonAzureQueryProperties{
      							{
      								FunctionAlias: to.Ptr("SavedSearch1"),
      								WorkspaceID:   to.Ptr("WorkspaceId1"),
      							},
      							{
      								FunctionAlias: to.Ptr("SavedSearch2"),
      								WorkspaceID:   to.Ptr("WorkspaceId2"),
      							}},
      					},
      					Windows: &armautomation.WindowsProperties{
      						ExcludedKbNumbers: []*string{
      							to.Ptr("168934"),
      							to.Ptr("168973")},
      						IncludedUpdateClassifications: to.Ptr(armautomation.WindowsUpdateClassesCritical),
      						RebootSetting:                 to.Ptr("IfRequired"),
      					},
      				},
      			},
      		},
      		&armautomation.SoftwareUpdateConfigurationsClientCreateOptions{ClientRequestID: nil})
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fautomation%2Farmautomation%2Fv0.7.0/sdk/resourcemanager/automation/armautomation/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "name": "testpatch",
        "id": "/subscriptions/51766542-3ed7-4a72-a187-0c8ab644ddab/resourceGroups/mygroup/providers/Microsoft.Automation/automationAccounts/myaccount/softwareUpdateConfigurations/testpatch",
        "properties": {
          "updateConfiguration": {
            "operatingSystem": "Windows",
            "windows": {
              "includedUpdateClassifications": "Critical",
              "excludedKbNumbers": [
                "168934",
                "168973"
              ]
            },
            "linux": {},
            "targets": {
              "azureQueries": [
                {
                  "scope": [
                    "/subscriptions/422b6c61-95b0-4213-b3be-7282315df71d/resourceGroups/a-stasku-rg0",
                    "/subscriptions/422b6c61-95b0-4213-b3be-7282315df71d"
                  ],
                  "tagSettings": {
                    "tags": {
                      "tag1": [
                        "tag1Value1",
                        "tag1Value2"
                      ],
                      "tag2": [
                        "tag2Value1",
                        "tag2Value2"
                      ]
                    },
                    "filterOperator": "All"
                  },
                  "locations": [
                    "Japan East",
                    "UK South"
                  ]
                }
              ]
            },
            "duration": "PT2H",
            "azureVirtualMachines": [
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-01",
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-02",
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-03"
            ],
            "nonAzureComputerNames": [
              "box1.contoso.com",
              "box2.contoso.com"
            ]
          },
          "scheduleInfo": {
            "description": "",
            "startTime": "2017-10-19T12:22:00-07:00",
            "startTimeOffsetMinutes": -420,
            "expiryTime": "2018-11-09T11:22:00-08:00",
            "expiryTimeOffsetMinutes": -480,
            "isEnabled": true,
            "nextRun": "2017-10-19T12:22:00-07:00",
            "nextRunOffsetMinutes": -420,
            "interval": 1,
            "frequency": "Week",
            "creationTime": "2017-10-19T18:54:50.5233333+00:00",
            "lastModifiedTime": "2017-10-19T18:54:50.5233333+00:00",
            "timeZone": "America/Los_Angeles",
            "advancedSchedule": {}
          },
          "tasks": {
            "preTask": {
              "source": "HelloWorld",
              "parameters": {
                "COMPUTERNAME": "Computer1"
              }
            },
            "postTask": {
              "source": "GetCache",
              "parameters": null
            }
          },
          "provisioningState": "Provisioning",
          "error": {},
          "creationTime": "2017-10-19T18:54:50.5233333+00:00",
          "createdBy": "adam@contoso.com",
          "lastModifiedBy": "adam@contoso.com",
          "lastModifiedTime": "2017-10-19T18:54:50.68+00:00"
        }
      }
  - statusCode: "201"
    body: >-
      {
        "name": "testpatch",
        "id": "/subscriptions/51766542-3ed7-4a72-a187-0c8ab644ddab/resourceGroups/mygroup/providers/Microsoft.Automation/automationAccounts/myaccount/softwareUpdateConfigurations/testpatch",
        "properties": {
          "updateConfiguration": {
            "operatingSystem": "Windows",
            "windows": {
              "includedUpdateClassifications": "Critical",
              "excludedKbNumbers": [
                "168934",
                "168973"
              ]
            },
            "linux": {},
            "targets": {
              "azureQueries": [
                {
                  "scope": [
                    "/subscriptions/422b6c61-95b0-4213-b3be-7282315df71d/resourceGroups/a-stasku-rg0",
                    "/subscriptions/422b6c61-95b0-4213-b3be-7282315df71d"
                  ],
                  "tagSettings": {
                    "tags": {
                      "tag1": [
                        "tag1Value1",
                        "tag1Value2"
                      ],
                      "tag2": [
                        "tag2Value1",
                        "tag2Value2"
                      ]
                    },
                    "filterOperator": "All"
                  },
                  "locations": [
                    "Japan East",
                    "UK South"
                  ]
                }
              ]
            },
            "duration": "PT2H",
            "azureVirtualMachines": [
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-01",
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-02",
              "/subscriptions/5ae68d89-69a4-454f-b5ce-e443cc4e0067/resourceGroups/myresources/providers/Microsoft.Compute/virtualMachines/vm-03"
            ],
            "nonAzureComputerNames": [
              "box1.contoso.com",
              "box2.contoso.com"
            ]
          },
          "scheduleInfo": {
            "description": "",
            "startTime": "2017-10-19T12:22:00-07:00",
            "startTimeOffsetMinutes": -420,
            "expiryTime": "2018-11-09T11:22:00-08:00",
            "expiryTimeOffsetMinutes": -480,
            "isEnabled": true,
            "nextRun": "2017-10-19T12:22:00-07:00",
            "nextRunOffsetMinutes": -420,
            "interval": 1,
            "frequency": "Week",
            "creationTime": "2017-10-19T18:54:50.5233333+00:00",
            "lastModifiedTime": "2017-10-19T18:54:50.5233333+00:00",
            "timeZone": "America/Los_Angeles"
          },
          "tasks": {
            "preTask": {
              "source": "HelloWorld",
              "parameters": {
                "COMPUTERNAME": "Computer1"
              }
            },
            "postTask": {
              "source": "GetCache",
              "parameters": null
            }
          },
          "provisioningState": "Provisioning",
          "error": {},
          "creationTime": "2017-10-19T18:54:50.5233333+00:00",
          "lastModifiedBy": "",
          "lastModifiedTime": "2017-10-19T18:54:50.68+00:00"
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about Automation service - Create a new software update configuration with the name given in the URI.
errorCodes: []
