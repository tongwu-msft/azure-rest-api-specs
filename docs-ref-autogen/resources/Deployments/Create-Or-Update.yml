### YamlMime:RESTOperation
uid: management.azure.com.resources.deployments.createorupdate
name: Create Or Update
service: Resource Management
groupName: Deployments
apiVersion: 2021-04-01
summary: "Deploys resources to a resource group.  \nYou can provide the template and parameters directly in the request or link to JSON files."
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}?api-version=2021-04-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The Microsoft Azure subscription ID.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group to deploy the resources to. The name is case insensitive. The resource group must already exist.
  types:
  - uid: string
  pattern: ^[-\w\._\(\)]+$
- name: deploymentName
  in: path
  isRequired: true
  description: The name of the deployment.
  types:
  - uid: string
  pattern: ^[-\w\._\(\)]+$
- name: api-version
  in: query
  isRequired: true
  description: The API version to use for this operation.
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK - Returns information about the deployment, including provisioning status.
  types:
  - uid: DeploymentExtended
- name: 201 Created
  description: Created - Returns information about the deployment, including provisioning status.
  types:
  - uid: DeploymentExtended
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: CloudError
requestBody:
- name: default
  parameters:
  - name: location
    in: body
    description: The location to store the deployment data.
    types:
    - uid: string
  - name: properties
    in: body
    isRequired: true
    description: The deployment properties.
    types:
    - uid: DeploymentProperties
  - name: tags
    in: body
    description: Deployment tags
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
requestHeader: []
definitions:
- name: DeploymentProperties
  description: Deployment properties.
  kind: object
  properties:
  - name: template
    description: The template content. You use this element when you want to pass the template syntax directly in the request rather than link to an existing template. It can be a JObject or well-formed JSON string. Use either the templateLink property or the template property, but not both.
    types:
    - uid: object
  - name: templateLink
    description: The URI of the template. Use either the templateLink property or the template property, but not both.
    types:
    - uid: TemplateLink
  - name: parameters
    description: Name and value pairs that define the deployment parameters for the template. You use this element when you want to provide the parameter values directly in the request rather than link to an existing parameter file. Use either the parametersLink property or the parameters property, but not both. It can be a JObject or a well formed JSON string.
    types:
    - uid: object
  - name: parametersLink
    description: The URI of parameters file. You use this element to link to an existing parameters file. Use either the parametersLink property or the parameters property, but not both.
    types:
    - uid: ParametersLink
  - name: mode
    description: The mode that is used to deploy resources. This value can be either Incremental or Complete. In Incremental mode, resources are deployed without deleting existing resources that are not included in the template. In Complete mode, resources are deployed and existing resources in the resource group that are not included in the template are deleted. Be careful when using Complete mode as you may unintentionally delete resources.
    types:
    - uid: DeploymentMode
  - name: debugSetting
    description: The debug setting of the deployment.
    types:
    - uid: DebugSetting
  - name: onErrorDeployment
    description: The deployment on error behavior.
    types:
    - uid: OnErrorDeployment
  - name: expressionEvaluationOptions
    description: Specifies whether template expressions are evaluated within the scope of the parent template or nested template. Only applicable to nested templates. If not specified, default value is outer.
    types:
    - uid: ExpressionEvaluationOptions
- name: DeploymentExtended
  description: Deployment information.
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: The ID of the deployment.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the deployment.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the deployment.
    types:
    - uid: string
  - name: location
    description: the location of the deployment.
    types:
    - uid: string
  - name: properties
    description: Deployment properties.
    types:
    - uid: DeploymentPropertiesExtended
  - name: tags
    description: Deployment tags
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: CloudError
  description: An error response for a resource management request.
  kind: object
  properties:
  - name: error
    description: "Error Response  \nCommon error response for all Azure Resource Manager APIs to return error details for failed operations. (This also follows the OData error response format.)"
    types:
    - uid: ErrorResponse
- name: Deployment
  description: Deployment operation parameters.
  kind: object
  properties:
  - name: location
    description: The location to store the deployment data.
    types:
    - uid: string
  - name: properties
    description: The deployment properties.
    types:
    - uid: DeploymentProperties
  - name: tags
    description: Deployment tags
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: TemplateLink
  description: Entity representing the reference to the template.
  kind: object
  properties:
  - name: uri
    description: The URI of the template to deploy. Use either the uri or id property, but not both.
    types:
    - uid: string
  - name: id
    description: The resource id of a Template Spec. Use either the id or uri property, but not both.
    types:
    - uid: string
  - name: relativePath
    description: The relativePath property can be used to deploy a linked template at a location relative to the parent. If the parent template was linked with a TemplateSpec, this will reference an artifact in the TemplateSpec.  If the parent was linked with a URI, the child deployment will be a combination of the parent and relativePath URIs
    types:
    - uid: string
  - name: contentVersion
    description: If included, must match the ContentVersion in the template.
    types:
    - uid: string
  - name: queryString
    description: The query string (for example, a SAS token) to be used with the templateLink URI.
    types:
    - uid: string
- name: ParametersLink
  description: Entity representing the reference to the deployment parameters.
  kind: object
  properties:
  - name: uri
    description: The URI of the parameters file.
    types:
    - uid: string
  - name: contentVersion
    description: If included, must match the ContentVersion in the template.
    types:
    - uid: string
- name: DeploymentMode
  description: The mode that is used to deploy resources. This value can be either Incremental or Complete. In Incremental mode, resources are deployed without deleting existing resources that are not included in the template. In Complete mode, resources are deployed and existing resources in the resource group that are not included in the template are deleted. Be careful when using Complete mode as you may unintentionally delete resources.
  kind: enum
  properties:
  - name: Incremental
    types:
    - uid: string
  - name: Complete
    types:
    - uid: string
- name: DebugSetting
  description: The debug setting.
  kind: object
  properties:
  - name: detailLevel
    description: Specifies the type of information to log for debugging. The permitted values are none, requestContent, responseContent, or both requestContent and responseContent separated by a comma. The default is none. When setting this value, carefully consider the type of information you are passing in during deployment. By logging information about the request or response, you could potentially expose sensitive data that is retrieved through the deployment operations.
    types:
    - uid: string
- name: OnErrorDeployment
  description: Deployment on error behavior.
  kind: object
  properties:
  - name: type
    description: The deployment on error behavior type. Possible values are LastSuccessful and SpecificDeployment.
    types:
    - uid: OnErrorDeploymentType
  - name: deploymentName
    description: The deployment to be used on error case.
    types:
    - uid: string
- name: ExpressionEvaluationOptions
  description: Specifies whether template expressions are evaluated within the scope of the parent template or nested template.
  kind: object
  properties:
  - name: scope
    description: The scope to be used for evaluation of parameters, variables and functions in a nested template.
    types:
    - uid: ExpressionEvaluationOptionsScopeType
- name: DeploymentPropertiesExtended
  description: Deployment properties with additional details.
  kind: object
  properties:
  - name: provisioningState
    isReadyOnly: true
    description: Denotes the state of provisioning.
    types:
    - uid: ProvisioningState
  - name: correlationId
    isReadyOnly: true
    description: The correlation ID of the deployment.
    types:
    - uid: string
  - name: timestamp
    isReadyOnly: true
    description: The timestamp of the template deployment.
    types:
    - uid: string
  - name: duration
    isReadyOnly: true
    description: The duration of the template deployment.
    types:
    - uid: string
  - name: outputs
    isReadyOnly: true
    description: Key/value pairs that represent deployment output.
    types:
    - uid: object
  - name: providers
    isReadyOnly: true
    description: The list of resource providers needed for the deployment.
    types:
    - uid: Provider
      isArray: true
  - name: dependencies
    isReadyOnly: true
    description: The list of deployment dependencies.
    types:
    - uid: Dependency
      isArray: true
  - name: templateLink
    isReadyOnly: true
    description: The URI referencing the template.
    types:
    - uid: TemplateLink
  - name: parameters
    isReadyOnly: true
    description: 'Deployment parameters. '
    types:
    - uid: object
  - name: parametersLink
    isReadyOnly: true
    description: 'The URI referencing the parameters. '
    types:
    - uid: ParametersLink
  - name: mode
    isReadyOnly: true
    description: The deployment mode. Possible values are Incremental and Complete.
    types:
    - uid: DeploymentMode
  - name: debugSetting
    isReadyOnly: true
    description: The debug setting of the deployment.
    types:
    - uid: DebugSetting
  - name: onErrorDeployment
    isReadyOnly: true
    description: The deployment on error behavior.
    types:
    - uid: OnErrorDeploymentExtended
  - name: templateHash
    isReadyOnly: true
    description: The hash produced for the template.
    types:
    - uid: string
  - name: outputResources
    isReadyOnly: true
    description: Array of provisioned resources.
    types:
    - uid: ResourceReference
      isArray: true
  - name: validatedResources
    isReadyOnly: true
    description: Array of validated resources.
    types:
    - uid: ResourceReference
      isArray: true
  - name: error
    isReadyOnly: true
    description: "Error Response  \nThe deployment error."
    types:
    - uid: ErrorResponse
- name: ErrorResponse
  description: Error Response
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: ErrorResponse
      isArray: true
  - name: additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: OnErrorDeploymentType
  description: The deployment on error behavior type. Possible values are LastSuccessful and SpecificDeployment.
  kind: enum
  properties:
  - name: LastSuccessful
    types:
    - uid: string
  - name: SpecificDeployment
    types:
    - uid: string
- name: ExpressionEvaluationOptionsScopeType
  description: The scope to be used for evaluation of parameters, variables and functions in a nested template.
  kind: enum
  properties:
  - name: NotSpecified
    types:
    - uid: string
  - name: Outer
    types:
    - uid: string
  - name: Inner
    types:
    - uid: string
- name: ProvisioningState
  description: Denotes the state of provisioning.
  kind: enum
  properties:
  - name: NotSpecified
    types:
    - uid: string
  - name: Accepted
    types:
    - uid: string
  - name: Running
    types:
    - uid: string
  - name: Ready
    types:
    - uid: string
  - name: Creating
    types:
    - uid: string
  - name: Created
    types:
    - uid: string
  - name: Deleting
    types:
    - uid: string
  - name: Deleted
    types:
    - uid: string
  - name: Canceled
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
  - name: Succeeded
    types:
    - uid: string
  - name: Updating
    types:
    - uid: string
- name: Provider
  description: Resource provider information.
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: The provider ID.
    types:
    - uid: string
  - name: namespace
    description: The namespace of the resource provider.
    types:
    - uid: string
  - name: registrationState
    isReadyOnly: true
    description: The registration state of the resource provider.
    types:
    - uid: string
  - name: registrationPolicy
    isReadyOnly: true
    description: The registration policy of the resource provider.
    types:
    - uid: string
  - name: resourceTypes
    isReadyOnly: true
    description: The collection of provider resource types.
    types:
    - uid: ProviderResourceType
      isArray: true
  - name: providerAuthorizationConsentState
    description: The provider authorization consent state.
    types:
    - uid: ProviderAuthorizationConsentState
- name: Dependency
  description: Deployment dependency information.
  kind: object
  properties:
  - name: dependsOn
    description: The list of dependencies.
    types:
    - uid: BasicDependency
      isArray: true
  - name: id
    description: The ID of the dependency.
    types:
    - uid: string
  - name: resourceType
    description: The dependency resource type.
    types:
    - uid: string
  - name: resourceName
    description: The dependency resource name.
    types:
    - uid: string
- name: OnErrorDeploymentExtended
  description: Deployment on error behavior with additional details.
  kind: object
  properties:
  - name: provisioningState
    isReadyOnly: true
    description: The state of the provisioning for the on error deployment.
    types:
    - uid: string
  - name: type
    description: The deployment on error behavior type. Possible values are LastSuccessful and SpecificDeployment.
    types:
    - uid: OnErrorDeploymentType
  - name: deploymentName
    description: The deployment to be used on error case.
    types:
    - uid: string
- name: ResourceReference
  description: The resource Id model.
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: The fully qualified resource Id.
    types:
    - uid: string
- name: ErrorAdditionalInfo
  description: The resource management error additional info.
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: The additional info type.
    types:
    - uid: string
  - name: info
    isReadyOnly: true
    description: The additional info.
    types:
    - uid: object
- name: ProviderResourceType
  description: Resource type managed by the resource provider.
  kind: object
  properties:
  - name: resourceType
    description: The resource type.
    types:
    - uid: string
  - name: locations
    description: The collection of locations where this resource type can be created.
    types:
    - uid: string
      isArray: true
  - name: locationMappings
    description: The location mappings that are supported by this resource type.
    types:
    - uid: ProviderExtendedLocation
      isArray: true
  - name: aliases
    description: The aliases that are supported by this resource type.
    types:
    - uid: Alias
      isArray: true
  - name: apiVersions
    description: The API version.
    types:
    - uid: string
      isArray: true
  - name: defaultApiVersion
    isReadyOnly: true
    description: The default API version.
    types:
    - uid: string
  - name: zoneMappings
    description: ''
    types:
    - uid: ZoneMapping
      isArray: true
  - name: apiProfiles
    isReadyOnly: true
    description: The API profiles for the resource provider.
    types:
    - uid: ApiProfile
      isArray: true
  - name: capabilities
    description: The additional capabilities offered by this resource type.
    types:
    - uid: string
  - name: properties
    description: The properties.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: ProviderAuthorizationConsentState
  description: The provider authorization consent state.
  kind: enum
  properties:
  - name: NotSpecified
    types:
    - uid: string
  - name: Required
    types:
    - uid: string
  - name: NotRequired
    types:
    - uid: string
  - name: Consented
    types:
    - uid: string
- name: BasicDependency
  description: Deployment dependency information.
  kind: object
  properties:
  - name: id
    description: The ID of the dependency.
    types:
    - uid: string
  - name: resourceType
    description: The dependency resource type.
    types:
    - uid: string
  - name: resourceName
    description: The dependency resource name.
    types:
    - uid: string
- name: ProviderExtendedLocation
  description: 'The provider extended location. '
  kind: object
  properties:
  - name: location
    description: The azure location.
    types:
    - uid: string
  - name: type
    description: The extended location type.
    types:
    - uid: string
  - name: extendedLocations
    description: The extended locations for the azure location.
    types:
    - uid: string
      isArray: true
- name: Alias
  description: 'The alias type. '
  kind: object
  properties:
  - name: name
    description: The alias name.
    types:
    - uid: string
  - name: paths
    description: The paths for an alias.
    types:
    - uid: AliasPath
      isArray: true
  - name: type
    description: The type of the alias.
    types:
    - uid: AliasType
  - name: defaultPath
    description: The default path for an alias.
    types:
    - uid: string
  - name: defaultPattern
    description: The default pattern for an alias.
    types:
    - uid: AliasPattern
  - name: defaultMetadata
    isReadyOnly: true
    description: The default alias path metadata. Applies to the default path and to any alias path that doesn't have metadata
    types:
    - uid: AliasPathMetadata
- name: ZoneMapping
  kind: object
  properties:
  - name: location
    description: The location of the zone mapping.
    types:
    - uid: string
  - name: zones
    description: ''
    types:
    - uid: string
      isArray: true
- name: ApiProfile
  kind: object
  properties:
  - name: profileVersion
    isReadyOnly: true
    description: The profile version.
    types:
    - uid: string
  - name: apiVersion
    isReadyOnly: true
    description: The API version.
    types:
    - uid: string
- name: AliasPath
  description: The type of the paths for alias.
  kind: object
  properties:
  - name: path
    description: The path of an alias.
    types:
    - uid: string
  - name: apiVersions
    description: The API versions.
    types:
    - uid: string
      isArray: true
  - name: pattern
    description: The pattern for an alias path.
    types:
    - uid: AliasPattern
  - name: metadata
    isReadyOnly: true
    description: The metadata of the alias path. If missing, fall back to the default metadata of the alias.
    types:
    - uid: AliasPathMetadata
- name: AliasType
  description: The type of the alias.
  kind: enum
  properties:
  - name: NotSpecified
    description: Alias type is unknown (same as not providing alias type).
    types:
    - uid: string
  - name: PlainText
    description: Alias value is not secret.
    types:
    - uid: string
  - name: Mask
    description: Alias value is secret.
    types:
    - uid: string
- name: AliasPattern
  description: The type of the pattern for an alias path.
  kind: object
  properties:
  - name: phrase
    description: The alias pattern phrase.
    types:
    - uid: string
  - name: variable
    description: The alias pattern variable.
    types:
    - uid: string
  - name: type
    description: The type of alias pattern
    types:
    - uid: AliasPatternType
- name: AliasPathMetadata
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: The type of the token that the alias path is referring to.
    types:
    - uid: AliasPathTokenType
  - name: attributes
    isReadyOnly: true
    description: The attributes of the token that the alias path is referring to.
    types:
    - uid: AliasPathAttributes
- name: AliasPatternType
  description: The type of alias pattern
  kind: enum
  properties:
  - name: NotSpecified
    description: NotSpecified is not allowed.
    types:
    - uid: string
  - name: Extract
    description: Extract is the only allowed value.
    types:
    - uid: string
- name: AliasPathTokenType
  description: The type of the token that the alias path is referring to.
  kind: enum
  properties:
  - name: NotSpecified
    description: The token type is not specified.
    types:
    - uid: string
  - name: Any
    description: The token type can be anything.
    types:
    - uid: string
  - name: String
    description: The token type is string.
    types:
    - uid: string
  - name: Object
    description: The token type is object.
    types:
    - uid: string
  - name: Array
    description: The token type is array.
    types:
    - uid: string
  - name: Integer
    description: The token type is integer.
    types:
    - uid: string
  - name: Number
    description: The token type is number.
    types:
    - uid: string
  - name: Boolean
    description: The token type is boolean.
    types:
    - uid: string
- name: AliasPathAttributes
  description: The attributes of the token that the alias path is referring to.
  kind: enum
  properties:
  - name: None
    description: The token that the alias path is referring to has no attributes.
    types:
    - uid: string
  - name: Modifiable
    description: The token that the alias path is referring to is modifiable by policies with 'modify' effect.
    types:
    - uid: string
examples:
- name: Create a deployment that will redeploy the last successful deployment on failure
  request:
    uri: PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment?api-version=2021-04-01
    body: >-
      {
        "properties": {
          "templateLink": {
            "uri": "https://example.com/exampleTemplate.json"
          },
          "parameters": {},
          "mode": "Complete",
          "onErrorDeployment": {
            "type": "LastSuccessful"
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment?api-version=2021-04-01

      {
        "properties": {
          "templateLink": {
            "uri": "https://example.com/exampleTemplate.json"
          },
          "parameters": {},
          "mode": "Complete",
          "onErrorDeployment": {
            "type": "LastSuccessful"
          }
        }
      }

      ```

      # [JavaScript](#tab/JavaScript)
      ``` js
      const { ResourceManagementClient } = require("@azure/arm-resources");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to You can provide the template and parameters directly in the request or link to JSON files.
       *
       * @summary You can provide the template and parameters directly in the request or link to JSON files.
       * x-ms-original-file: specification/resources/resource-manager/Microsoft.Resources/stable/2021-04-01/examples/PutDeploymentWithOnErrorDeploymentLastSuccessful.json
       */
      async function createADeploymentThatWillRedeployTheLastSuccessfulDeploymentOnFailure() {
        const subscriptionId = "00000000-0000-0000-0000-000000000000";
        const resourceGroupName = "my-resource-group";
        const deploymentName = "my-deployment";
        const parameters = {
          properties: {
            mode: "Complete",
            onErrorDeployment: { type: "LastSuccessful" },
            parameters: {},
            templateLink: { uri: "https://example.com/exampleTemplate.json" },
          },
        };
        const credential = new DefaultAzureCredential();
        const client = new ResourceManagementClient(credential, subscriptionId);
        const result = await client.deployments.beginCreateOrUpdateAndWait(
          resourceGroupName,
          deploymentName,
          parameters
        );
        console.log(result);
      }

      createADeploymentThatWillRedeployTheLastSuccessfulDeploymentOnFailure().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-resources_5.0.1/sdk/resources/arm-resources/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment",
        "name": "my-deployment",
        "type": "Microsoft.Resources/deployments",
        "properties": {
          "templateLink": {
            "uri": "https://example.com/exampleTemplate.json",
            "contentVersion": "1.0.0.0"
          },
          "parameters": {},
          "mode": "Complete",
          "provisioningState": "Accepted",
          "timestamp": "2019-03-01T00:00:00.0000000Z",
          "duration": "PT0.8204881S",
          "correlationId": "00000000-0000-0000-0000-000000000000",
          "providers": [
            {
              "namespace": "Microsoft.Network",
              "resourceTypes": [
                {
                  "resourceType": "virtualNetworks",
                  "locations": [
                    "centralus"
                  ]
                },
                {
                  "resourceType": "virtualNetworks/subnets",
                  "locations": [
                    "centralus"
                  ]
                }
              ]
            }
          ],
          "dependencies": [
            {
              "dependsOn": [
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks",
                  "resourceName": "VNet1"
                }
              ],
              "id": "{resourceid}",
              "resourceType": "Microsoft.Network/virtualNetworks/subnets",
              "resourceName": "VNet1/Subnet1"
            },
            {
              "dependsOn": [
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks",
                  "resourceName": "VNet1"
                },
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks/subnets",
                  "resourceName": "VNet1/Subnet1"
                }
              ],
              "id": "{resourceid}",
              "resourceType": "Microsoft.Network/virtualNetworks/subnets",
              "resourceName": "VNet1/Subnet2"
            }
          ],
          "onErrorDeployment": {
            "type": "LastSuccessful",
            "deploymentName": "{nameOfLastSuccesfulDeployment}"
          }
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment",
        "name": "my-deployment",
        "type": "Microsoft.Resources/deployments",
        "properties": {
          "templateLink": {
            "uri": "https://example.com/exampleTemplate.json",
            "contentVersion": "1.0.0.0"
          },
          "parameters": {},
          "mode": "Complete",
          "provisioningState": "Accepted",
          "timestamp": "2019-03-01T00:00:00.0000000Z",
          "duration": "PT0.8204881S",
          "correlationId": "00000000-0000-0000-0000-000000000000",
          "providers": [
            {
              "namespace": "Microsoft.Network",
              "resourceTypes": [
                {
                  "resourceType": "virtualNetworks",
                  "locations": [
                    "centralus"
                  ]
                },
                {
                  "resourceType": "virtualNetworks/subnets",
                  "locations": [
                    "centralus"
                  ]
                }
              ]
            }
          ],
          "dependencies": [
            {
              "dependsOn": [
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks",
                  "resourceName": "VNet1"
                }
              ],
              "id": "{resourceid}",
              "resourceType": "Microsoft.Network/virtualNetworks/subnets",
              "resourceName": "VNet1/Subnet1"
            },
            {
              "dependsOn": [
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks",
                  "resourceName": "VNet1"
                },
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks/subnets",
                  "resourceName": "VNet1/Subnet1"
                }
              ],
              "id": "{resourceid}",
              "resourceType": "Microsoft.Network/virtualNetworks/subnets",
              "resourceName": "VNet1/Subnet2"
            }
          ],
          "onErrorDeployment": {
            "type": "LastSuccessful",
            "deploymentName": "{nameOfLastSuccesfulDeployment}"
          }
        }
      }
- name: Create a deployment that will redeploy another deployment on failure
  request:
    uri: PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment?api-version=2021-04-01
    body: >-
      {
        "properties": {
          "templateLink": {
            "uri": "https://example.com/exampleTemplate.json"
          },
          "parameters": {},
          "mode": "Complete",
          "onErrorDeployment": {
            "type": "SpecificDeployment",
            "deploymentName": "name-of-deployment-to-use"
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment?api-version=2021-04-01

      {
        "properties": {
          "templateLink": {
            "uri": "https://example.com/exampleTemplate.json"
          },
          "parameters": {},
          "mode": "Complete",
          "onErrorDeployment": {
            "type": "SpecificDeployment",
            "deploymentName": "name-of-deployment-to-use"
          }
        }
      }

      ```

      # [JavaScript](#tab/JavaScript)
      ``` js
      const { ResourceManagementClient } = require("@azure/arm-resources");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to You can provide the template and parameters directly in the request or link to JSON files.
       *
       * @summary You can provide the template and parameters directly in the request or link to JSON files.
       * x-ms-original-file: specification/resources/resource-manager/Microsoft.Resources/stable/2021-04-01/examples/PutDeploymentWithOnErrorDeploymentSpecificDeployment.json
       */
      async function createADeploymentThatWillRedeployAnotherDeploymentOnFailure() {
        const subscriptionId = "00000000-0000-0000-0000-000000000000";
        const resourceGroupName = "my-resource-group";
        const deploymentName = "my-deployment";
        const parameters = {
          properties: {
            mode: "Complete",
            onErrorDeployment: {
              type: "SpecificDeployment",
              deploymentName: "name-of-deployment-to-use",
            },
            parameters: {},
            templateLink: { uri: "https://example.com/exampleTemplate.json" },
          },
        };
        const credential = new DefaultAzureCredential();
        const client = new ResourceManagementClient(credential, subscriptionId);
        const result = await client.deployments.beginCreateOrUpdateAndWait(
          resourceGroupName,
          deploymentName,
          parameters
        );
        console.log(result);
      }

      createADeploymentThatWillRedeployAnotherDeploymentOnFailure().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-resources_5.0.1/sdk/resources/arm-resources/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment",
        "name": "my-deployment",
        "type": "Microsoft.Resources/deployments",
        "properties": {
          "templateLink": {
            "uri": "https://example.com/exampleTemplate.json",
            "contentVersion": "1.0.0.0"
          },
          "parameters": {},
          "mode": "Complete",
          "provisioningState": "Accepted",
          "timestamp": "2019-03-01T00:00:00.0000000Z",
          "duration": "PT0.8204881S",
          "correlationId": "00000000-0000-0000-0000-000000000000",
          "providers": [
            {
              "namespace": "Microsoft.Network",
              "resourceTypes": [
                {
                  "resourceType": "virtualNetworks",
                  "locations": [
                    "centralus"
                  ]
                },
                {
                  "resourceType": "virtualNetworks/subnets",
                  "locations": [
                    "centralus"
                  ]
                }
              ]
            }
          ],
          "dependencies": [
            {
              "dependsOn": [
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks",
                  "resourceName": "VNet1"
                }
              ],
              "id": "{resourceid}",
              "resourceType": "Microsoft.Network/virtualNetworks/subnets",
              "resourceName": "VNet1/Subnet1"
            },
            {
              "dependsOn": [
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks",
                  "resourceName": "VNet1"
                },
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks/subnets",
                  "resourceName": "VNet1/Subnet1"
                }
              ],
              "id": "{resourceid}",
              "resourceType": "Microsoft.Network/virtualNetworks/subnets",
              "resourceName": "VNet1/Subnet2"
            }
          ],
          "onErrorDeployment": {
            "type": "SpecificDeployment",
            "deploymentName": "name-of-deployment-to-use"
          }
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment",
        "name": "my-deployment",
        "type": "Microsoft.Resources/deployments",
        "properties": {
          "templateLink": {
            "uri": "https://example.com/exampleTemplate.json",
            "contentVersion": "1.0.0.0"
          },
          "parameters": {},
          "mode": "Complete",
          "provisioningState": "Accepted",
          "timestamp": "2019-03-01T00:00:00.0000000Z",
          "duration": "PT0.8204881S",
          "correlationId": "00000000-0000-0000-0000-000000000000",
          "providers": [
            {
              "namespace": "Microsoft.Network",
              "resourceTypes": [
                {
                  "resourceType": "virtualNetworks",
                  "locations": [
                    "centralus"
                  ]
                },
                {
                  "resourceType": "virtualNetworks/subnets",
                  "locations": [
                    "centralus"
                  ]
                }
              ]
            }
          ],
          "dependencies": [
            {
              "dependsOn": [
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks",
                  "resourceName": "VNet1"
                }
              ],
              "id": "{resourceid}",
              "resourceType": "Microsoft.Network/virtualNetworks/subnets",
              "resourceName": "VNet1/Subnet1"
            },
            {
              "dependsOn": [
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks",
                  "resourceName": "VNet1"
                },
                {
                  "id": "{resourceid}",
                  "resourceType": "Microsoft.Network/virtualNetworks/subnets",
                  "resourceName": "VNet1/Subnet1"
                }
              ],
              "id": "{resourceid}",
              "resourceType": "Microsoft.Network/virtualNetworks/subnets",
              "resourceName": "VNet1/Subnet2"
            }
          ],
          "onErrorDeployment": {
            "type": "SpecificDeployment",
            "deploymentName": "name-of-deployment-to-use"
          }
        }
      }
- name: Create a deployment that will deploy a templateSpec with the given resourceId
  request:
    uri: PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000001/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment?api-version=2021-04-01
    body: >-
      {
        "properties": {
          "templateLink": {
            "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/TemplateSpecs/TemplateSpec-Name/versions/v1"
          },
          "parameters": {},
          "mode": "Incremental"
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000001/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment?api-version=2021-04-01

      {
        "properties": {
          "templateLink": {
            "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/TemplateSpecs/TemplateSpec-Name/versions/v1"
          },
          "parameters": {},
          "mode": "Incremental"
        }
      }

      ```

      # [JavaScript](#tab/JavaScript)
      ``` js
      const { ResourceManagementClient } = require("@azure/arm-resources");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to You can provide the template and parameters directly in the request or link to JSON files.
       *
       * @summary You can provide the template and parameters directly in the request or link to JSON files.
       * x-ms-original-file: specification/resources/resource-manager/Microsoft.Resources/stable/2021-04-01/examples/PutDeploymentResourceGroupTemplateSpecsWithId.json
       */
      async function createADeploymentThatWillDeployATemplateSpecWithTheGivenResourceId() {
        const subscriptionId = "00000000-0000-0000-0000-000000000001";
        const resourceGroupName = "my-resource-group";
        const deploymentName = "my-deployment";
        const parameters = {
          properties: {
            mode: "Incremental",
            parameters: {},
            templateLink: {
              id: "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/TemplateSpecs/TemplateSpec-Name/versions/v1",
            },
          },
        };
        const credential = new DefaultAzureCredential();
        const client = new ResourceManagementClient(credential, subscriptionId);
        const result = await client.deployments.beginCreateOrUpdateAndWait(
          resourceGroupName,
          deploymentName,
          parameters
        );
        console.log(result);
      }

      createADeploymentThatWillDeployATemplateSpecWithTheGivenResourceId().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-resources_5.0.1/sdk/resources/arm-resources/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment",
        "name": "my-deployment",
        "type": "Microsoft.Resources/deployments",
        "properties": {
          "templateLink": {
            "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/TemplateSpecs/TemplateSpec-Name/versions/v1",
            "contentVersion": "1.0.0.0"
          },
          "templateHash": "0000000000000000000",
          "parameters": {},
          "mode": "Incremental",
          "provisioningState": "Succeeded",
          "timestamp": "2020-06-05T01:20:01.723776Z",
          "duration": "PT22.8356799S",
          "correlationId": "00000000-0000-0000-0000-000000000000",
          "providers": [
            {
              "namespace": "Microsoft.Storage",
              "resourceTypes": [
                {
                  "resourceType": "storageAccounts",
                  "locations": [
                    "eastus"
                  ]
                }
              ]
            }
          ],
          "dependencies": [],
          "outputResources": [
            {
              "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Storage/storageAccounts/my-storage-account"
            }
          ]
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment",
        "name": "my-deployment",
        "type": "Microsoft.Resources/deployments",
        "properties": {
          "templateLink": {
            "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/TemplateSpecs/TemplateSpec-Name/versions/v1",
            "contentVersion": "1.0.0.0"
          },
          "templateHash": "0000000000000000000",
          "parameters": {},
          "mode": "Incremental",
          "provisioningState": "Accepted",
          "timestamp": "2020-06-05T01:20:01.723776Z",
          "duration": "PT22.8356799S",
          "correlationId": "00000000-0000-0000-0000-000000000000",
          "providers": [
            {
              "namespace": "Microsoft.Storage",
              "resourceTypes": [
                {
                  "resourceType": "storageAccounts",
                  "locations": [
                    "eastus"
                  ]
                }
              ]
            }
          ],
          "dependencies": []
        }
      }
- name: Create a deployment that will deploy a template with a uri and queryString
  request:
    uri: PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000001/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment?api-version=2021-04-01
    body: >-
      {
        "properties": {
          "templateLink": {
            "uri": "https://example.com/exampleTemplate.json",
            "queryString": "sv=2019-02-02&st=2019-04-29T22%3A18%3A26Z&se=2019-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=xxxxxxxx0xxxxxxxxxxxxx%2bxxxxxxxxxxxxxxxxxxxx%3d"
          },
          "parameters": {},
          "mode": "Incremental"
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000001/resourcegroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment?api-version=2021-04-01

      {
        "properties": {
          "templateLink": {
            "uri": "https://example.com/exampleTemplate.json",
            "queryString": "sv=2019-02-02&st=2019-04-29T22%3A18%3A26Z&se=2019-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=xxxxxxxx0xxxxxxxxxxxxx%2bxxxxxxxxxxxxxxxxxxxx%3d"
          },
          "parameters": {},
          "mode": "Incremental"
        }
      }

      ```

      # [Go](#tab/Go)
      ``` go
      package armresources_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"
      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/resources/armresources"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/resources/resource-manager/Microsoft.Resources/stable/2021-04-01/examples/PutDeploymentResourceGroup.json
      func ExampleDeploymentsClient_BeginCreateOrUpdate() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armresources.NewDeploymentsClient("00000000-0000-0000-0000-000000000001", cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	poller, err := client.BeginCreateOrUpdate(ctx,
      		"my-resource-group",
      		"my-deployment",
      		armresources.Deployment{
      			Properties: &armresources.DeploymentProperties{
      				Mode:       to.Ptr(armresources.DeploymentModeIncremental),
      				Parameters: map[string]interface{}{},
      				TemplateLink: &armresources.TemplateLink{
      					QueryString: to.Ptr("sv=2019-02-02&st=2019-04-29T22%3A18%3A26Z&se=2019-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=xxxxxxxx0xxxxxxxxxxxxx%2bxxxxxxxxxxxxxxxxxxxx%3d"),
      					URI:         to.Ptr("https://example.com/exampleTemplate.json"),
      				},
      			},
      		},
      		nil)
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	res, err := poller.PollUntilDone(ctx, nil)
      	if err != nil {
      		log.Fatalf("failed to pull the result: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fresources%2Farmresources%2Fv1.0.0/sdk/resourcemanager/resources/armresources/README.md) on how to add the SDK to your project and authenticate.
      # [JavaScript](#tab/JavaScript)
      ``` js
      const { ResourceManagementClient } = require("@azure/arm-resources");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to You can provide the template and parameters directly in the request or link to JSON files.
       *
       * @summary You can provide the template and parameters directly in the request or link to JSON files.
       * x-ms-original-file: specification/resources/resource-manager/Microsoft.Resources/stable/2021-04-01/examples/PutDeploymentResourceGroup.json
       */
      async function createADeploymentThatWillDeployATemplateWithAUriAndQueryString() {
        const subscriptionId = "00000000-0000-0000-0000-000000000001";
        const resourceGroupName = "my-resource-group";
        const deploymentName = "my-deployment";
        const parameters = {
          properties: {
            mode: "Incremental",
            parameters: {},
            templateLink: {
              queryString:
                "sv=2019-02-02&st=2019-04-29T22%3A18%3A26Z&se=2019-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=xxxxxxxx0xxxxxxxxxxxxx%2bxxxxxxxxxxxxxxxxxxxx%3d",
              uri: "https://example.com/exampleTemplate.json",
            },
          },
        };
        const credential = new DefaultAzureCredential();
        const client = new ResourceManagementClient(credential, subscriptionId);
        const result = await client.deployments.beginCreateOrUpdateAndWait(
          resourceGroupName,
          deploymentName,
          parameters
        );
        console.log(result);
      }

      createADeploymentThatWillDeployATemplateWithAUriAndQueryString().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-resources_5.0.1/sdk/resources/arm-resources/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment",
        "name": "my-deployment",
        "type": "Microsoft.Resources/deployments",
        "properties": {
          "templateLink": {
            "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/TemplateSpecs/TemplateSpec-Name/versions/v1",
            "contentVersion": "1.0.0.0"
          },
          "templateHash": "0000000000000000000",
          "parameters": {},
          "mode": "Incremental",
          "provisioningState": "Succeeded",
          "timestamp": "2020-06-05T01:20:01.723776Z",
          "duration": "PT22.8356799S",
          "correlationId": "00000000-0000-0000-0000-000000000000",
          "providers": [
            {
              "namespace": "Microsoft.Storage",
              "resourceTypes": [
                {
                  "resourceType": "storageAccounts",
                  "locations": [
                    "eastus"
                  ]
                }
              ]
            }
          ],
          "dependencies": [],
          "outputResources": [
            {
              "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Storage/storageAccounts/my-storage-account"
            }
          ]
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/deployments/my-deployment",
        "name": "my-deployment",
        "type": "Microsoft.Resources/deployments",
        "properties": {
          "templateLink": {
            "id": "/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/my-resource-group/providers/Microsoft.Resources/TemplateSpecs/TemplateSpec-Name/versions/v1",
            "contentVersion": "1.0.0.0"
          },
          "templateHash": "0000000000000000000",
          "parameters": {},
          "mode": "Incremental",
          "provisioningState": "Accepted",
          "timestamp": "2020-06-05T01:20:01.723776Z",
          "duration": "PT22.8356799S",
          "correlationId": "00000000-0000-0000-0000-000000000000",
          "providers": [
            {
              "namespace": "Microsoft.Storage",
              "resourceTypes": [
                {
                  "resourceType": "storageAccounts",
                  "locations": [
                    "eastus"
                  ]
                }
              ]
            }
          ],
          "dependencies": []
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: "Deploys resources to a resource group.  \nYou can provide the template and parameters directly in the request or link to JSON files."
errorCodes: []
