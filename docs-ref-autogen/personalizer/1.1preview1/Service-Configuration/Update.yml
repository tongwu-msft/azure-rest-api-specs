### YamlMime:RESTOperation
uid: personalizer.v1.1-preview.1.personalizer.1.1preview1.serviceconfiguration.update
name: Update
service: Cognitive Services - Personalizer
groupName: Service Configuration
apiVersion: v1.1-preview.1
summary: "Update Service Configuration.  \nUpdate the Personalizer service configuration."
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT {Endpoint}/personalizer/v1.1-preview.1/configurations/service
uriParameters:
- name: Endpoint
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: Supported Cognitive Services endpoint.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Success
  types:
  - uid: ServiceConfiguration
- name: Other Status Codes
  description: Updating defaultReward, rewardWaitTime and rewardAggregation when changing learning mode from Online to Apprentice mode and vice versa is not allowed. Make the mode change and then change the additional settings with an additional API call.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: rewardWaitTime
    in: body
    isRequired: true
    description: >-
      The time span waited until a request is marked with the default reward

      and should be between 5 seconds and 2 days.

      For example, PT5M (5 mins). For information about the time format,

      see http://en.wikipedia.org/wiki/ISO_8601#Durations
    types:
    - uid: string
  - name: defaultReward
    in: body
    isRequired: true
    description: The reward given if a reward is not received within the specified wait time.
    types:
    - uid: number
  - name: rewardAggregation
    in: body
    isRequired: true
    description: The function used to process rewards, if multiple reward scores are received before rewardWaitTime is over.
    types:
    - uid: string
  - name: explorationPercentage
    in: body
    isRequired: true
    description: The percentage of rank responses that will use exploration.
    types:
    - uid: number
  - name: modelExportFrequency
    in: body
    isRequired: true
    description: >-
      Personalizer will start using the most updated trained model for online ranks automatically every specified time period.

      For example, PT5M (5 mins). For information about the time format,

      see http://en.wikipedia.org/wiki/ISO_8601#Durations
    types:
    - uid: string
  - name: logMirrorEnabled
    in: body
    description: Flag indicates whether log mirroring is enabled.
    types:
    - uid: boolean
  - name: logMirrorSasUri
    in: body
    description: Azure storage account container SAS URI for log mirroring.
    types:
    - uid: string
  - name: logRetentionDays
    in: body
    isRequired: true
    description: Number of days historical logs are to be maintained. -1 implies the logs will never be deleted.
    types:
    - uid: integer
  - name: lastConfigurationEditDate
    in: body
    description: Last time model training configuration was updated
    types:
    - uid: string
  - name: learningMode
    in: body
    description: Learning Modes for Personalizer
    types:
    - uid: LearningMode
  - name: isAutoOptimizationEnabled
    in: body
    description: Flag indicating whether Personalizer will automatically optimize Learning Settings by running Offline Evaluations periodically.
    types:
    - uid: boolean
  - name: autoOptimizationFrequency
    in: body
    description: >-
      Frequency of automatic optimization. Only relevant if IsAutoOptimizationEnabled is true.

      For example, PT5M (5 mins). For information about the time format,

      \r\nsee http://en.wikipedia.org/wiki/ISO_8601#Durations
    types:
    - uid: string
  - name: autoOptimizationStartDate
    in: body
    description: Date when the first automatic optimization evaluation must be performed. Only relevant if IsAutoOptimizationEnabled is true.
    types:
    - uid: string
requestHeader: []
definitions:
- name: ServiceConfiguration
  description: The configuration of the service.
  kind: object
  properties:
  - name: rewardWaitTime
    description: >-
      The time span waited until a request is marked with the default reward

      and should be between 5 seconds and 2 days.

      For example, PT5M (5 mins). For information about the time format,

      see http://en.wikipedia.org/wiki/ISO_8601#Durations
    types:
    - uid: string
  - name: defaultReward
    description: The reward given if a reward is not received within the specified wait time.
    types:
    - uid: number
  - name: rewardAggregation
    description: The function used to process rewards, if multiple reward scores are received before rewardWaitTime is over.
    types:
    - uid: string
  - name: explorationPercentage
    description: The percentage of rank responses that will use exploration.
    types:
    - uid: number
  - name: modelExportFrequency
    description: >-
      Personalizer will start using the most updated trained model for online ranks automatically every specified time period.

      For example, PT5M (5 mins). For information about the time format,

      see http://en.wikipedia.org/wiki/ISO_8601#Durations
    types:
    - uid: string
  - name: logMirrorEnabled
    description: Flag indicates whether log mirroring is enabled.
    types:
    - uid: boolean
  - name: logMirrorSasUri
    description: Azure storage account container SAS URI for log mirroring.
    types:
    - uid: string
  - name: logRetentionDays
    description: Number of days historical logs are to be maintained. -1 implies the logs will never be deleted.
    types:
    - uid: integer
  - name: lastConfigurationEditDate
    description: Last time model training configuration was updated
    types:
    - uid: string
  - name: learningMode
    description: Learning Modes for Personalizer
    types:
    - uid: LearningMode
  - name: isAutoOptimizationEnabled
    description: Flag indicating whether Personalizer will automatically optimize Learning Settings by running Offline Evaluations periodically.
    types:
    - uid: boolean
  - name: autoOptimizationFrequency
    description: >-
      Frequency of automatic optimization. Only relevant if IsAutoOptimizationEnabled is true.

      For example, PT5M (5 mins). For information about the time format,

      \r\nsee http://en.wikipedia.org/wiki/ISO_8601#Durations
    types:
    - uid: string
  - name: autoOptimizationStartDate
    description: Date when the first automatic optimization evaluation must be performed. Only relevant if IsAutoOptimizationEnabled is true.
    types:
    - uid: string
- name: ErrorResponse
  description: Used to return an error to the client
  kind: object
  properties:
  - name: error
    description: The error object.
    types:
    - uid: PersonalizerError
- name: LearningMode
  description: Learning Modes for Personalizer
  kind: enum
  properties:
  - name: Online
    types:
    - uid: string
  - name: Apprentice
    types:
    - uid: string
  - name: LoggingOnly
    types:
    - uid: string
- name: PersonalizerError
  description: The error object.
  kind: object
  properties:
  - name: code
    description: Error Codes returned by Personalizer
    types:
    - uid: PersonalizerErrorCode
  - name: message
    description: A message explaining the error reported by the service.
    types:
    - uid: string
  - name: target
    description: Error source element.
    types:
    - uid: string
  - name: details
    description: An array of details about specific errors that led to this reported error.
    types:
    - uid: PersonalizerError
      isArray: true
  - name: innerError
    description: An object containing more specific information than the parent object about the error.
    types:
    - uid: InternalError
- name: PersonalizerErrorCode
  description: Error Codes returned by Personalizer
  kind: enum
  properties:
  - name: BadRequest
    description: Request could not be understood by the server.
    types:
    - uid: string
  - name: InvalidServiceConfiguration
    description: Invalid service configuration.
    types:
    - uid: string
  - name: InvalidLearningModeServiceConfiguration
    description: Updating defaultReward, rewardWaitTime and rewardAggregation when changing learning mode from Online to Apprentice mode and vice versa is not allowed. Make the mode change and then change the additional settings with an additional API call.
    types:
    - uid: string
  - name: InvalidPolicyConfiguration
    description: Invalid policy configuration.
    types:
    - uid: string
  - name: InvalidPolicyContract
    description: Invalid policy contract.
    types:
    - uid: string
  - name: InvalidEvaluationContract
    description: Invalid evaluation contract.
    types:
    - uid: string
  - name: DuplicateCustomPolicyNames
    description: Custom policy names should be unique.
    types:
    - uid: string
  - name: NoLogsExistInDateRange
    description: No logs exist in date range.
    types:
    - uid: string
  - name: LogsSizeExceedAllowedLimit
    description: Total size of logs exceed allowed limit.
    types:
    - uid: string
  - name: InvalidRewardRequest
    description: Invalid reward request.
    types:
    - uid: string
  - name: InvalidEventIdToActivate
    description: Invalid activate event request.
    types:
    - uid: string
  - name: InvalidRankRequest
    description: Invalid request.
    types:
    - uid: string
  - name: InvalidExportLogsRequest
    description: Invalid request.
    types:
    - uid: string
  - name: InvalidContainer
    description: SAS Uri must be the Uri to a container that has write permissions.
    types:
    - uid: string
  - name: InvalidModelMetadata
    description: Invalid model metadata.
    types:
    - uid: string
  - name: ApprenticeModeNeverTurnedOn
    description: Apprentice mode never turned on.
    types:
    - uid: string
  - name: MissingAppId
    description: AppId is missing in the header.
    types:
    - uid: string
  - name: InvalidRewardWaitTime
    description: Reward wait time should be between 5 seconds and 2 days
    types:
    - uid: string
  - name: InvalidMultiSlotApiAccess
    description: Multi-slot feature is currently disabled. Please follow multi-slot Personalizer documentation to update your loop settings to enable multi-slot functionality.
    types:
    - uid: string
  - name: ModelFileAccessDenied
    description: Key vault Key used for customer managed key cannot be accessed.
    types:
    - uid: string
  - name: ProblemTypeIncompatibleWithAutoOptimization
    description: Auto-optimization is not compatible with multi-slot personalization.
    types:
    - uid: string
  - name: ResourceNotFound
    description: Requested resource does not exist on the server.
    types:
    - uid: string
  - name: FrontEndNotFound
    description: Front end not found.
    types:
    - uid: string
  - name: EvaluationNotFound
    description: Offline Evaluation not found.
    types:
    - uid: string
  - name: LearningSettingsNotFound
    description: Learning Settings not found in evaluation.
    types:
    - uid: string
  - name: EvaluationModelNotFound
    description: Model not found in evaluation.
    types:
    - uid: string
  - name: LogsPropertiesNotFound
    description: Log properties not found.
    types:
    - uid: string
  - name: ModelRankingError
    description: Error while ranking actions using model. Please verify the learning settings are valid.
    types:
    - uid: string
  - name: InternalServerError
    description: A generic error has occurred on the server.
    types:
    - uid: string
  - name: RankNullResponse
    description: Rank call returned null response.
    types:
    - uid: string
  - name: UpdateConfigurationFailed
    description: Failed to update configuration.
    types:
    - uid: string
  - name: ModelResetFailed
    description: Model reset failed.
    types:
    - uid: string
  - name: ModelPublishFailed
    description: Model publish failed.
    types:
    - uid: string
  - name: ModelMetadataUpdateFailed
    description: Model metadata update failed.
    types:
    - uid: string
  - name: OperationNotAllowed
    description: This operation is not allowed at this time.
    types:
    - uid: string
- name: InternalError
  description: An object containing more specific information than the parent object about the error.
  kind: object
  properties:
  - name: code
    description: Detailed error code.
    types:
    - uid: string
  - name: innererror
    description: An object containing more specific information than the parent object about the error.
    types:
    - uid: InternalError
examples:
- name: Successful ServiceConfiguration_Update request
  request:
    uri: PUT {Endpoint}/personalizer/v1.1-preview.1/configurations/service
    body: >-
      {
        "rewardWaitTime": "PT10M",
        "defaultReward": 0,
        "rewardAggregation": "earliest",
        "explorationPercentage": 0.2,
        "modelExportFrequency": "PT5M",
        "logMirrorEnabled": true,
        "logMirrorSasUri": "https://testblob.blob.core.windows.net/container?se=2020-08-13T00%3A00Z&sp=rwl&spr=https&sv=2018-11-09&sr=c&sig=signature",
        "logRetentionDays": 7,
        "lastConfigurationEditDate": "0001-01-01T00:00:00Z",
        "learningMode": "Online",
        "isAutoOptimizationEnabled": true,
        "autoOptimizationFrequency": "P7D",
        "autoOptimizationStartDate": "2019-01-19T00:00:00Z"
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT {Endpoint}/personalizer/v1.1-preview.1/configurations/service

      {
        "rewardWaitTime": "PT10M",
        "defaultReward": 0,
        "rewardAggregation": "earliest",
        "explorationPercentage": 0.2,
        "modelExportFrequency": "PT5M",
        "logMirrorEnabled": true,
        "logMirrorSasUri": "https://testblob.blob.core.windows.net/container?se=2020-08-13T00%3A00Z&sp=rwl&spr=https&sv=2018-11-09&sr=c&sig=signature",
        "logRetentionDays": 7,
        "lastConfigurationEditDate": "0001-01-01T00:00:00Z",
        "learningMode": "Online",
        "isAutoOptimizationEnabled": true,
        "autoOptimizationFrequency": "P7D",
        "autoOptimizationStartDate": "2019-01-19T00:00:00Z"
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "rewardWaitTime": "PT10M",
        "defaultReward": 0,
        "rewardAggregation": "earliest",
        "explorationPercentage": 0.2,
        "modelExportFrequency": "PT5M",
        "logMirrorEnabled": true,
        "logMirrorSasUri": "https://testblob.blob.core.windows.net/container?se=2020-08-13T00%3A00Z&sp=rwl&spr=https&sv=2018-11-09&sr=c&sig=signature",
        "logRetentionDays": 7,
        "lastConfigurationEditDate": "0001-01-01T00:00:00Z",
        "learningMode": "Online",
        "isAutoOptimizationEnabled": true,
        "autoOptimizationFrequency": "P7D",
        "autoOptimizationStartDate": "2019-01-19T00:00:00Z"
      }
security: []
metadata:
  description: "Learn more about Cognitive Services - Personalizer service - Update Service Configuration.  \nUpdate the Personalizer service configuration."
errorCodes: []
