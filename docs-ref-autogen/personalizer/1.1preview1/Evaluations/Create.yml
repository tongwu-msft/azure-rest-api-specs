### YamlMime:RESTOperation
uid: localhost:5001.personalizer.v1.1-preview.1.personalizer.1.1preview1.evaluations.create
name: Create
service: Cognitive Services - Personalizer
groupName: Evaluations
apiVersion: v1.1-preview.1
summary: "Create Offline Evaluation.  \nSubmit a new Offline Evaluation job."
consumes:
- application/json
produces:
- application/json
paths:
- content: POST {Endpoint}/personalizer/v1.1-preview.1/evaluations
uriParameters:
- name: Endpoint
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: Supported Cognitive Services endpoint.
  types:
  - uid: string
responses:
- name: 201 Created
  headers:
  - name: Location
    value: string
  description: Success
  types:
  - uid: Evaluation
- name: Other Status Codes
  description: Invalid evaluation contract.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: enableOfflineExperimentation
    in: body
    description: True if the evaluation should explore for a more optimal learning settings.
    types:
    - uid: boolean
  - name: name
    in: body
    isRequired: true
    description: The name of the evaluation.
    types:
    - uid: string
  - name: startTime
    in: body
    isRequired: true
    description: The start time of the evaluation.
    types:
    - uid: string
  - name: endTime
    in: body
    isRequired: true
    description: The end time of the evaluation.
    types:
    - uid: string
  - name: policies
    in: body
    isRequired: true
    description: Additional learning settings to evaluate.
    types:
    - uid: PolicyContract
      isArray: true
requestHeader:
- name: Ocp-Apim-Subscription-Key
  in: header
  isRequired: true
  types:
  - uid: string
definitions:
- name: PolicyContract
  description: Learning settings specifying how to train the model.
  kind: object
  properties:
  - name: name
    description: Name of the learning settings.
    types:
    - uid: string
  - name: arguments
    description: Arguments of the learning settings.
    types:
    - uid: string
- name: Evaluation
  description: A counterfactual evaluation.
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: The ID of the evaluation.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the evaluation.
    types:
    - uid: string
  - name: startTime
    isReadyOnly: true
    description: The start time of the evaluation.
    types:
    - uid: string
  - name: endTime
    isReadyOnly: true
    description: The end time of the evaluation.
    types:
    - uid: string
  - name: jobId
    isReadyOnly: true
    description: The ID of the job processing the evaluation.
    types:
    - uid: string
  - name: status
    isReadyOnly: true
    description: The status of the job processing the evaluation.
    types:
    - uid: EvaluationJobStatus
  - name: policyResults
    description: The results of the evaluation.
    types:
    - uid: PolicyResult
      isArray: true
  - name: featureImportance
    description: ''
    types:
    - uid: array
      isArray: true
  - name: evaluationType
    description: ''
    types:
    - uid: EvaluationType
  - name: optimalPolicy
    description: ''
    types:
    - uid: string
  - name: creationTime
    description: ''
    types:
    - uid: string
- name: ErrorResponse
  description: Used to return an error to the client
  kind: object
  properties:
  - name: error
    description: The error object.
    types:
    - uid: PersonalizerError
- name: EvaluationContract
  description: A counterfactual evaluation.
  kind: object
  properties:
  - name: enableOfflineExperimentation
    description: True if the evaluation should explore for a more optimal learning settings.
    types:
    - uid: boolean
  - name: name
    description: The name of the evaluation.
    types:
    - uid: string
  - name: startTime
    description: The start time of the evaluation.
    types:
    - uid: string
  - name: endTime
    description: The end time of the evaluation.
    types:
    - uid: string
  - name: policies
    description: Additional learning settings to evaluate.
    types:
    - uid: PolicyContract
      isArray: true
- name: EvaluationJobStatus
  description: The status of the job processing the evaluation.
  kind: enum
  properties:
  - name: completed
    types:
    - uid: string
  - name: pending
    types:
    - uid: string
  - name: failed
    types:
    - uid: string
  - name: notSubmitted
    types:
    - uid: string
  - name: timeout
    types:
    - uid: string
  - name: optimalPolicyApplied
    types:
    - uid: string
  - name: onlinePolicyRetained
    types:
    - uid: string
- name: PolicyResult
  description: This class contains the Learning Settings information and the results of the Offline Evaluation using that policy.
  kind: object
  properties:
  - name: name
    isReadyOnly: true
    description: The name of the Learning Settings.
    types:
    - uid: string
  - name: arguments
    isReadyOnly: true
    description: The arguments of the Learning Settings.
    types:
    - uid: string
  - name: policySource
    isReadyOnly: true
    description: The source of the Learning Settings.
    types:
    - uid: PolicySource
  - name: summary
    isReadyOnly: true
    description: The aggregate results of the Offline Evaluation.
    types:
    - uid: PolicyResultSummary
      isArray: true
  - name: totalSummary
    isReadyOnly: true
    description: ''
    types:
    - uid: TotalSummary
- name: EvaluationType
  kind: enum
  properties:
  - name: Manual
    types:
    - uid: string
  - name: Auto
    types:
    - uid: string
- name: PersonalizerError
  description: The error object.
  kind: object
  properties:
  - name: code
    description: Error Codes returned by Personalizer
    types:
    - uid: PersonalizerErrorCode
  - name: message
    description: A message explaining the error reported by the service.
    types:
    - uid: string
  - name: target
    description: Error source element.
    types:
    - uid: string
  - name: details
    description: An array of details about specific errors that led to this reported error.
    types:
    - uid: PersonalizerError
      isArray: true
  - name: innerError
    description: An object containing more specific information than the parent object about the error.
    types:
    - uid: InternalError
- name: PolicySource
  description: The source of the Learning Settings.
  kind: enum
  properties:
  - name: Online
    types:
    - uid: string
  - name: Baseline
    types:
    - uid: string
  - name: Random
    types:
    - uid: string
  - name: Custom
    types:
    - uid: string
  - name: OfflineExperimentation
    types:
    - uid: string
- name: PolicyResultSummary
  description: This class contains the summary of evaluating a policy on a counterfactual evaluation.
  kind: object
  properties:
  - name: timeStamp
    isReadyOnly: true
    description: Timestamp of the aggregation.
    types:
    - uid: string
  - name: ipsEstimatorNumerator
    isReadyOnly: true
    description: Numerator for IPS estimator.
    types:
    - uid: number
  - name: ipsEstimatorDenominator
    isReadyOnly: true
    description: Denominator for IPS estimator.
    types:
    - uid: number
  - name: snipsEstimatorDenominator
    isReadyOnly: true
    description: Denominator for SNIPS estimator.
    types:
    - uid: number
  - name: aggregateTimeWindow
    isReadyOnly: true
    description: >-
      Time window for aggregation.

      For example, PT5M (5 mins). For information about the time format,

      see http://en.wikipedia.org/wiki/ISO_8601#Durations
    types:
    - uid: string
  - name: nonZeroProbability
    description: Probability of non-zero values for the Policy evaluation.
    types:
    - uid: number
  - name: sumOfSquares
    isReadyOnly: true
    description: Sum of Squares for the Policy evaluation results.
    types:
    - uid: number
  - name: confidenceInterval
    isReadyOnly: true
    description: Gaussian confidence interval for the Policy evaluation.
    types:
    - uid: number
  - name: averageReward
    isReadyOnly: true
    description: Average reward.
    types:
    - uid: number
- name: TotalSummary
  kind: object
  properties:
  - name: timeStamp
    isReadyOnly: true
    description: Timestamp of the aggregation.
    types:
    - uid: string
  - name: ipsEstimatorNumerator
    isReadyOnly: true
    description: Numerator for IPS estimator.
    types:
    - uid: number
  - name: ipsEstimatorDenominator
    isReadyOnly: true
    description: Denominator for IPS estimator.
    types:
    - uid: number
  - name: snipsEstimatorDenominator
    isReadyOnly: true
    description: Denominator for SNIPS estimator.
    types:
    - uid: number
  - name: aggregateTimeWindow
    isReadyOnly: true
    description: >-
      Time window for aggregation.

      For example, PT5M (5 mins). For information about the time format,

      see http://en.wikipedia.org/wiki/ISO_8601#Durations
    types:
    - uid: string
  - name: nonZeroProbability
    description: Probability of non-zero values for the Policy evaluation.
    types:
    - uid: number
  - name: sumOfSquares
    isReadyOnly: true
    description: Sum of Squares for the Policy evaluation results.
    types:
    - uid: number
  - name: confidenceInterval
    isReadyOnly: true
    description: Gaussian confidence interval for the Policy evaluation.
    types:
    - uid: number
  - name: averageReward
    isReadyOnly: true
    description: Average reward.
    types:
    - uid: number
- name: PersonalizerErrorCode
  description: Error Codes returned by Personalizer
  kind: enum
  properties:
  - name: BadRequest
    description: Request could not be understood by the server.
    types:
    - uid: string
  - name: InvalidServiceConfiguration
    description: Invalid service configuration.
    types:
    - uid: string
  - name: InvalidLearningModeServiceConfiguration
    description: Updating defaultReward, rewardWaitTime and rewardAggregation when changing learning mode from Online to Apprentice mode and vice versa is not allowed. Make the mode change and then change the additional settings with an additional API call.
    types:
    - uid: string
  - name: InvalidPolicyConfiguration
    description: Invalid policy configuration.
    types:
    - uid: string
  - name: InvalidPolicyContract
    description: Invalid policy contract.
    types:
    - uid: string
  - name: InvalidEvaluationContract
    description: Invalid evaluation contract.
    types:
    - uid: string
  - name: DuplicateCustomPolicyNames
    description: Custom policy names should be unique.
    types:
    - uid: string
  - name: NoLogsExistInDateRange
    description: No logs exist in date range.
    types:
    - uid: string
  - name: LogsSizeExceedAllowedLimit
    description: Total size of logs exceed allowed limit.
    types:
    - uid: string
  - name: InvalidRewardRequest
    description: Invalid reward request.
    types:
    - uid: string
  - name: InvalidEventIdToActivate
    description: Invalid activate event request.
    types:
    - uid: string
  - name: InvalidRankRequest
    description: Invalid request.
    types:
    - uid: string
  - name: InvalidExportLogsRequest
    description: Invalid request.
    types:
    - uid: string
  - name: InvalidContainer
    description: SAS Uri must be the Uri to a container that has write permissions.
    types:
    - uid: string
  - name: InvalidModelMetadata
    description: Invalid model metadata.
    types:
    - uid: string
  - name: ApprenticeModeNeverTurnedOn
    description: Apprentice mode never turned on.
    types:
    - uid: string
  - name: MissingAppId
    description: AppId is missing in the header.
    types:
    - uid: string
  - name: InvalidRewardWaitTime
    description: Reward wait time should be between 5 seconds and 2 days
    types:
    - uid: string
  - name: InvalidMultiSlotApiAccess
    description: Multi-slot feature is currently disabled. Please follow multi-slot Personalizer documentation to update your loop settings to enable multi-slot functionality.
    types:
    - uid: string
  - name: ModelFileAccessDenied
    description: Key vault Key used for customer managed key cannot be accessed.
    types:
    - uid: string
  - name: ProblemTypeIncompatibleWithAutoOptimization
    description: Auto-optimization is not compatible with multi-slot personalization.
    types:
    - uid: string
  - name: ResourceNotFound
    description: Requested resource does not exist on the server.
    types:
    - uid: string
  - name: FrontEndNotFound
    description: Front end not found.
    types:
    - uid: string
  - name: EvaluationNotFound
    description: Offline Evaluation not found.
    types:
    - uid: string
  - name: LearningSettingsNotFound
    description: Learning Settings not found in evaluation.
    types:
    - uid: string
  - name: EvaluationModelNotFound
    description: Model not found in evaluation.
    types:
    - uid: string
  - name: LogsPropertiesNotFound
    description: Log properties not found.
    types:
    - uid: string
  - name: ModelRankingError
    description: Error while ranking actions using model. Please verify the learning settings are valid.
    types:
    - uid: string
  - name: InternalServerError
    description: A generic error has occurred on the server.
    types:
    - uid: string
  - name: RankNullResponse
    description: Rank call returned null response.
    types:
    - uid: string
  - name: UpdateConfigurationFailed
    description: Failed to update configuration.
    types:
    - uid: string
  - name: ModelResetFailed
    description: Model reset failed.
    types:
    - uid: string
  - name: ModelPublishFailed
    description: Model publish failed.
    types:
    - uid: string
  - name: ModelMetadataUpdateFailed
    description: Model metadata update failed.
    types:
    - uid: string
  - name: OperationNotAllowed
    description: This operation is not allowed at this time.
    types:
    - uid: string
- name: InternalError
  description: An object containing more specific information than the parent object about the error.
  kind: object
  properties:
  - name: code
    description: Detailed error code.
    types:
    - uid: string
  - name: innererror
    description: An object containing more specific information than the parent object about the error.
    types:
    - uid: InternalError
examples:
- name: Successful Evaluations_Create request
  request:
    uri: POST {Endpoint}/personalizer/v1.1-preview.1/evaluations
    body: >-
      {
        "enableOfflineExperimentation": true,
        "name": "myFirstEvaluation",
        "startTime": "2018-12-19T00:00:00Z",
        "endTime": "2019-01-19T00:00:00Z",
        "policies": [
          {
            "name": "Custom learning settings 1",
            "arguments": "--cb_explore_adf --epsilon 0.2 --dsjson --cb_type ips -l 0.5 --l1 1E-07 --power_t 0.5"
          }
        ]
      }
    headers:
    - name: Ocp-Apim-Subscription-Key
      value: '{API key}'
  responses:
  - statusCode: "201"
    headers:
    - name: Location
      value: '{endpoint}/personalizer/v1.1-preview.1/evaluations/{evaluationId}'
    body: >-
      {
        "id": "b58c6d92-b727-48c1-9487-4be2782c9e0a",
        "name": "myFirstEvaluation",
        "startTime": "2018-12-19T00:00:00Z",
        "endTime": "2019-01-19T00:00:00Z",
        "status": "pending",
        "policyResults": [
          {
            "name": "Custom learning settings 1",
            "arguments": "--cb_explore_adf --epsilon 0.2 --dsjson --cb_type ips -l 0.5 --l1 1E-07 --power_t 0.5",
            "policySource": "Online"
          }
        ],
        "featureImportance": [],
        "evaluationType": "Manual",
        "optimalPolicy": "",
        "creationTime": "2019-01-20T00:00:00Z"
      }
security:
- name: Ocp-Apim-Subscription-Key
  type: apiKey
  in: header
metadata:
  description: "Learn more about Cognitive Services - Personalizer service - Create Offline Evaluation.  \nSubmit a new Offline Evaluation job."
errorCodes: []
