### YamlMime:RESTOperation
uid: management.azure.com.site-recovery.replicationprotectionintents.create
name: Create
service: Recovery Services - Site Recovery
groupName: Replication Protection Intents
apiVersion: 2021-08-01
summary: "Create protection intent Resource.  \nThe operation to create an ASR replication protection intent item."
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.RecoveryServices/vaults/{resourceName}/replicationProtectionIntents/{intentObjectName}?api-version=2021-08-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The subscription Id.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group where the recovery services vault is present.
  types:
  - uid: string
- name: resourceName
  in: path
  isRequired: true
  description: The name of the recovery services vault.
  types:
  - uid: string
- name: intentObjectName
  in: path
  isRequired: true
  description: A name for the replication protection item.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: Client Api Version.
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK
  types:
  - uid: ReplicationProtectionIntent
requestBody:
- name: default
  parameters:
  - name: properties
    in: body
    description: Create protection intent input properties.
    types:
    - uid: CreateProtectionIntentProperties
requestHeader: []
definitions:
- name: CreateProtectionIntentProperties
  description: Create protection intent input properties.
  kind: object
  properties:
  - name: providerSpecificDetails
    description: The ReplicationProviderInput. For A2A provider, it will be A2ACreateProtectionIntentInput object.
    types:
    - uid: A2ACreateProtectionIntentInput
    typesTitle: CreateProtectionIntentProviderSpecificDetails
- name: ReplicationProtectionIntent
  description: Replication protection intent.
  kind: object
  properties:
  - name: properties
    description: The custom data.
    types:
    - uid: ReplicationProtectionIntentProperties
  - name: id
    isReadyOnly: true
    description: Resource Id
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource Name
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource Type
    types:
    - uid: string
  - name: location
    description: Resource Location
    types:
    - uid: string
- name: CreateProtectionIntentInput
  description: Create protection intent input.
  kind: object
  properties:
  - name: properties
    description: Create protection intent input properties.
    types:
    - uid: CreateProtectionIntentProperties
- name: ReplicationProtectionIntentProperties
  description: Replication protection intent custom data details.
  kind: object
  properties:
  - name: friendlyName
    description: The name.
    types:
    - uid: string
  - name: jobId
    isReadyOnly: true
    description: The job Id.
    types:
    - uid: string
  - name: jobState
    isReadyOnly: true
    description: The job state.
    types:
    - uid: string
  - name: isActive
    isReadyOnly: true
    description: A value indicating whether the intent object is active.
    types:
    - uid: boolean
  - name: creationTimeUTC
    isReadyOnly: true
    description: The creation time in UTC.
    types:
    - uid: string
  - name: providerSpecificDetails
    description: The Replication provider custom settings.
    types:
    - uid: A2AReplicationIntentDetails
    typesTitle: ReplicationProtectionIntentProviderSpecificSettings
- name: A2ACreateProtectionIntentInput
  description: A2A create protection intent input.
  kind: object
  properties:
  - name: fabricObjectId
    description: The fabric specific object Id of the virtual machine.
    types:
    - uid: string
  - name: primaryLocation
    description: The primary location for the virtual machine.
    types:
    - uid: string
  - name: recoveryLocation
    description: The recovery location for the virtual machine.
    types:
    - uid: string
  - name: recoverySubscriptionId
    description: The recovery subscription Id of the virtual machine.
    types:
    - uid: string
  - name: recoveryAvailabilityType
    description: The recovery availability type of the virtual machine.
    types:
    - uid: A2ARecoveryAvailabilityType
  - name: protectionProfileCustomInput
    description: The protection profile custom inputs.
    types:
    - uid: ExistingProtectionProfile
    - uid: NewProtectionProfile
    typesTitle: ProtectionProfileCustomDetails
  - name: recoveryResourceGroupId
    description: The recovery resource group Id. Valid for V2 scenarios.
    types:
    - uid: string
  - name: primaryStagingStorageAccountCustomInput
    description: The primary staging storage account input.
    types:
    - uid: ExistingStorageAccount
    typesTitle: StorageAccountCustomDetails
  - name: recoveryAvailabilitySetCustomInput
    description: The recovery availability set input.
    types:
    - uid: ExistingRecoveryAvailabilitySet
    typesTitle: RecoveryAvailabilitySetCustomDetails
  - name: recoveryVirtualNetworkCustomInput
    description: The recovery virtual network input.
    types:
    - uid: ExistingRecoveryVirtualNetwork
    - uid: NewRecoveryVirtualNetwork
    typesTitle: RecoveryVirtualNetworkCustomDetails
  - name: recoveryProximityPlacementGroupCustomInput
    description: The recovery proximity placement group custom input.
    types:
    - uid: ExistingRecoveryProximityPlacementGroup
    typesTitle: RecoveryProximityPlacementGroupCustomDetails
  - name: autoProtectionOfDataDisk
    description: A value indicating whether the auto protection is enabled.
    types:
    - uid: AutoProtectionOfDataDisk
  - name: vmDisks
    description: The list of vm disk inputs.
    types:
    - uid: A2AProtectionIntentDiskInputDetails
      isArray: true
  - name: vmManagedDisks
    description: The list of vm managed disk inputs.
    types:
    - uid: A2AProtectionIntentManagedDiskInputDetails
      isArray: true
  - name: multiVmGroupName
    description: The multi vm group name.
    types:
    - uid: string
  - name: multiVmGroupId
    description: The multi vm group id.
    types:
    - uid: string
  - name: recoveryBootDiagStorageAccount
    description: The boot diagnostic storage account.
    types:
    - uid: ExistingStorageAccount
    typesTitle: StorageAccountCustomDetails
  - name: diskEncryptionInfo
    description: The recovery disk encryption information (for two pass flows).
    types:
    - uid: DiskEncryptionInfo
  - name: recoveryAvailabilityZone
    description: The recovery availability zone.
    types:
    - uid: string
  - name: agentAutoUpdateStatus
    description: A value indicating whether the auto update is enabled.
    types:
    - uid: AgentAutoUpdateStatus
  - name: automationAccountAuthenticationType
    description: A value indicating the authentication type for automation account. The default value is "RunAsAccount".
    types:
    - uid: AutomationAccountAuthenticationType
    defaultValue: RunAsAccount
  - name: automationAccountArmId
    description: The automation account arm id.
    types:
    - uid: string
  - name: instanceType
    description: The class type.
    types:
    - uid: A2A
    typesTitle: string
- name: A2ARecoveryAvailabilityType
  description: The recovery availability type of the virtual machine.
  kind: enum
  properties:
  - name: Single
    types:
    - uid: string
  - name: AvailabilitySet
    types:
    - uid: string
  - name: AvailabilityZone
    types:
    - uid: string
- name: AutoProtectionOfDataDisk
  description: A value indicating whether the auto protection is enabled.
  kind: enum
  properties:
  - name: Disabled
    types:
    - uid: string
  - name: Enabled
    types:
    - uid: string
- name: A2AProtectionIntentDiskInputDetails
  description: Azure VM unmanaged disk input details.
  kind: object
  properties:
  - name: diskUri
    description: The disk Uri.
    types:
    - uid: string
  - name: recoveryAzureStorageAccountCustomInput
    description: The recovery VHD storage account input.
    types:
    - uid: ExistingStorageAccount
    typesTitle: StorageAccountCustomDetails
  - name: primaryStagingStorageAccountCustomInput
    description: The primary staging storage account input.
    types:
    - uid: ExistingStorageAccount
    typesTitle: StorageAccountCustomDetails
- name: A2AProtectionIntentManagedDiskInputDetails
  description: Azure VM managed disk input details.
  kind: object
  properties:
  - name: diskId
    description: The disk Id.
    types:
    - uid: string
  - name: primaryStagingStorageAccountCustomInput
    description: The primary staging storage account input.
    types:
    - uid: ExistingStorageAccount
    typesTitle: StorageAccountCustomDetails
  - name: recoveryResourceGroupCustomInput
    description: The recovery resource group input.
    types:
    - uid: ExistingRecoveryRecoveryResourceGroup
    typesTitle: RecoveryResourceGroupCustomDetails
  - name: recoveryReplicaDiskAccountType
    description: The replica disk type. Its an optional value and will be same as source disk type if not user provided.
    types:
    - uid: string
  - name: recoveryTargetDiskAccountType
    description: The target disk type after failover. Its an optional value and will be same as source disk type if not user provided.
    types:
    - uid: string
  - name: recoveryDiskEncryptionSetId
    description: The recovery disk encryption set Id.
    types:
    - uid: string
  - name: diskEncryptionInfo
    description: The recovery disk encryption information (for one / single pass flows).
    types:
    - uid: DiskEncryptionInfo
- name: DiskEncryptionInfo
  description: Recovery disk encryption info (BEK and KEK).
  kind: object
  properties:
  - name: diskEncryptionKeyInfo
    description: The recovery KeyVault reference for secret.
    types:
    - uid: DiskEncryptionKeyInfo
  - name: keyEncryptionKeyInfo
    description: The recovery KeyVault reference for key.
    types:
    - uid: KeyEncryptionKeyInfo
- name: AgentAutoUpdateStatus
  description: A value indicating whether the auto update is enabled.
  kind: enum
  properties:
  - name: Disabled
    types:
    - uid: string
  - name: Enabled
    types:
    - uid: string
- name: AutomationAccountAuthenticationType
  description: A value indicating the type authentication to use for automation Account.
  kind: enum
  properties:
  - name: RunAsAccount
    types:
    - uid: string
  - name: SystemAssignedIdentity
    types:
    - uid: string
- name: A2AReplicationIntentDetails
  description: A2A provider specific settings.
  kind: object
  properties:
  - name: fabricObjectId
    description: The fabric specific object Id of the virtual machine.
    types:
    - uid: string
  - name: primaryLocation
    description: The primary location for the virtual machine.
    types:
    - uid: string
  - name: recoveryLocation
    description: The recovery location for the virtual machine.
    types:
    - uid: string
  - name: recoverySubscriptionId
    description: The recovery subscription Id of the virtual machine.
    types:
    - uid: string
  - name: vmDisks
    description: The list of vm disk details.
    types:
    - uid: A2AProtectionIntentDiskInputDetails
      isArray: true
  - name: vmManagedDisks
    description: The list of vm managed disk details.
    types:
    - uid: A2AProtectionIntentManagedDiskInputDetails
      isArray: true
  - name: recoveryResourceGroupId
    description: The recovery resource group id.
    types:
    - uid: string
  - name: protectionProfile
    description: The protection profile custom details.
    types:
    - uid: ExistingProtectionProfile
    - uid: NewProtectionProfile
    typesTitle: ProtectionProfileCustomDetails
  - name: primaryStagingStorageAccount
    description: The primary staging storage account details.
    types:
    - uid: ExistingStorageAccount
    typesTitle: StorageAccountCustomDetails
  - name: recoveryAvailabilitySet
    description: The recovery availability set details.
    types:
    - uid: ExistingRecoveryAvailabilitySet
    typesTitle: RecoveryAvailabilitySetCustomDetails
  - name: recoveryVirtualNetwork
    description: The recovery virtual network details.
    types:
    - uid: ExistingRecoveryVirtualNetwork
    - uid: NewRecoveryVirtualNetwork
    typesTitle: RecoveryVirtualNetworkCustomDetails
  - name: recoveryProximityPlacementGroup
    description: The recovery proximity placement group custom details.
    types:
    - uid: ExistingRecoveryProximityPlacementGroup
    typesTitle: RecoveryProximityPlacementGroupCustomDetails
  - name: autoProtectionOfDataDisk
    description: A value indicating whether the auto protection is enabled.
    types:
    - uid: AutoProtectionOfDataDisk
  - name: multiVmGroupName
    description: The multi vm group name.
    types:
    - uid: string
  - name: multiVmGroupId
    description: The multi vm group id.
    types:
    - uid: string
  - name: recoveryBootDiagStorageAccount
    description: The boot diagnostic storage account.
    types:
    - uid: ExistingStorageAccount
    typesTitle: StorageAccountCustomDetails
  - name: diskEncryptionInfo
    description: The recovery disk encryption information (for two pass flows).
    types:
    - uid: DiskEncryptionInfo
  - name: recoveryAvailabilityZone
    description: The recovery availability zone.
    types:
    - uid: string
  - name: recoveryAvailabilityType
    description: The recovery availability type of the virtual machine.
    types:
    - uid: string
  - name: agentAutoUpdateStatus
    description: A value indicating whether the auto update is enabled.
    types:
    - uid: AgentAutoUpdateStatus
  - name: automationAccountArmId
    description: The automation account arm id.
    types:
    - uid: string
  - name: automationAccountAuthenticationType
    description: A value indicating the type authentication to use for automation Account.
    types:
    - uid: AutomationAccountAuthenticationType
    defaultValue: RunAsAccount
  - name: instanceType
    description: Gets the Instance type.
    types:
    - uid: A2A
    typesTitle: string
- name: ExistingProtectionProfile
  description: Existing storage account input.
  kind: object
  properties:
  - name: protectionProfileId
    description: The protection profile Arm Id. Throw error, if resource does not exists.
    types:
    - uid: string
  - name: resourceType
    description: The class type.
    types:
    - uid: Existing
    typesTitle: string
- name: NewProtectionProfile
  description: New Protection profile input.
  kind: object
  properties:
  - name: policyName
    description: The protection profile input.
    types:
    - uid: string
  - name: recoveryPointHistory
    description: The duration in minutes until which the recovery points need to be stored.
    types:
    - uid: integer
  - name: crashConsistentFrequencyInMinutes
    description: The crash consistent snapshot frequency (in minutes).
    types:
    - uid: integer
  - name: appConsistentFrequencyInMinutes
    description: The app consistent snapshot frequency (in minutes).
    types:
    - uid: integer
  - name: multiVmSyncStatus
    description: A value indicating whether multi-VM sync has to be enabled. Value should be 'Enabled' or 'Disabled'.
    types:
    - uid: SetMultiVmSyncStatus
  - name: resourceType
    description: The class type.
    types:
    - uid: New
    typesTitle: string
- name: ExistingStorageAccount
  description: Existing storage account input.
  kind: object
  properties:
  - name: azureStorageAccountId
    description: The storage account Arm Id. Throw error, if resource does not exists.
    types:
    - uid: string
  - name: resourceType
    description: The class type.
    types:
    - uid: Existing
    typesTitle: string
- name: ExistingRecoveryAvailabilitySet
  description: Existing recovery availability set input.
  kind: object
  properties:
  - name: recoveryAvailabilitySetId
    description: The recovery availability set Id. Will throw error, if resource does not exist.
    types:
    - uid: string
  - name: resourceType
    description: The class type.
    types:
    - uid: Existing
    typesTitle: string
- name: ExistingRecoveryVirtualNetwork
  description: Existing recovery virtual network input.
  kind: object
  properties:
  - name: recoveryVirtualNetworkId
    description: The recovery virtual network Id. Will throw error, if resource does not exist.
    types:
    - uid: string
  - name: recoverySubnetName
    description: The recovery subnet name.
    types:
    - uid: string
  - name: resourceType
    description: The class type.
    types:
    - uid: Existing
    typesTitle: string
- name: NewRecoveryVirtualNetwork
  description: Recovery virtual network input to create new virtual network from given source network.
  kind: object
  properties:
  - name: recoveryVirtualNetworkResourceGroupName
    description: The name of the resource group to be used to create the recovery virtual network. If absent, target network would be created in the same resource group as target VM.
    types:
    - uid: string
  - name: recoveryVirtualNetworkName
    description: The recovery virtual network name.
    types:
    - uid: string
  - name: resourceType
    description: The class type.
    types:
    - uid: New
    typesTitle: string
- name: ExistingRecoveryProximityPlacementGroup
  description: Existing recovery proximity placement group input.
  kind: object
  properties:
  - name: recoveryProximityPlacementGroupId
    description: The recovery proximity placement group Id. Will throw error, if resource does not exist.
    types:
    - uid: string
  - name: resourceType
    description: The class type.
    types:
    - uid: Existing
    typesTitle: string
- name: DiskEncryptionKeyInfo
  description: Disk Encryption Key Information (BitLocker Encryption Key (BEK) on Windows).
  kind: object
  properties:
  - name: secretIdentifier
    description: The secret url / identifier.
    types:
    - uid: string
  - name: keyVaultResourceArmId
    description: The KeyVault resource ARM id for secret.
    types:
    - uid: string
- name: KeyEncryptionKeyInfo
  description: Key Encryption Key (KEK) information.
  kind: object
  properties:
  - name: keyIdentifier
    description: The key URL / identifier.
    types:
    - uid: string
  - name: keyVaultResourceArmId
    description: The KeyVault resource ARM Id for key.
    types:
    - uid: string
- name: SetMultiVmSyncStatus
  description: A value indicating whether multi-VM sync has to be enabled. Value should be 'Enabled' or 'Disabled'.
  kind: enum
  properties:
  - name: Enable
    types:
    - uid: string
  - name: Disable
    types:
    - uid: string
- name: ExistingRecoveryRecoveryResourceGroup
  description: Existing recovery resource group input.
  kind: object
  properties:
  - name: recoveryResourceGroupId
    description: The recovery resource group Id. Valid for V2 scenarios.
    types:
    - uid: string
  - name: resourceType
    description: The class type.
    types:
    - uid: Existing
    typesTitle: string
examples:
- name: Create protection intent Resource.
  request:
    uri: PUT https://management.azure.com/subscriptions/509099b2-9d2c-4636-b43e-bd5cafb6be69/resourceGroups/resourceGroupPS1/providers/Microsoft.RecoveryServices/vaults/vault1/replicationProtectionIntents/vm1?api-version=2021-08-01
    body: >-
      {
        "properties": {
          "providerSpecificDetails": {
            "instanceType": "A2A",
            "fabricObjectId": "/subscriptions/509099b2-9d2c-4636-b43e-bd5cafb6be69/resourceGroups/removeOne/providers/Microsoft.Compute/virtualMachines/vmPpgAv5",
            "primaryLocation": "eastUs2",
            "recoveryLocation": "westus2",
            "recoverySubscriptionId": "ed5bcdf6-d61e-47bd-8ea9-f2bd379a2640",
            "recoveryAvailabilityType": "Single",
            "recoveryResourceGroupId": "/subscriptions/509099b2-9d2c-4636-b43e-bd5cafb6be69/resourceGroups/removeOne-asr"
          }
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT https://management.azure.com/subscriptions/509099b2-9d2c-4636-b43e-bd5cafb6be69/resourceGroups/resourceGroupPS1/providers/Microsoft.RecoveryServices/vaults/vault1/replicationProtectionIntents/vm1?api-version=2021-08-01

      {
        "properties": {
          "providerSpecificDetails": {
            "instanceType": "A2A",
            "fabricObjectId": "/subscriptions/509099b2-9d2c-4636-b43e-bd5cafb6be69/resourceGroups/removeOne/providers/Microsoft.Compute/virtualMachines/vmPpgAv5",
            "primaryLocation": "eastUs2",
            "recoveryLocation": "westus2",
            "recoverySubscriptionId": "ed5bcdf6-d61e-47bd-8ea9-f2bd379a2640",
            "recoveryAvailabilityType": "Single",
            "recoveryResourceGroupId": "/subscriptions/509099b2-9d2c-4636-b43e-bd5cafb6be69/resourceGroups/removeOne-asr"
          }
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/Subscriptions/509099b2-9d2c-4636-b43e-bd5cafb6be69/resourceGroups/2007vttp/providers/Microsoft.RecoveryServices/vaults/tp2007vt/replicationProtectionIntents/vm1",
        "name": "vm1",
        "type": "Microsoft.RecoveryServices/vaults/replicationProtectionIntents",
        "properties": {
          "friendlyName": "vm1",
          "jobId": "/Subscriptions/d90d145a-4cdd-45a3-b2c4-971d69775278/resourceGroups/a2acl-rg-vault-prod-gip-ccy/providers/Microsoft.RecoveryServices/vaults/a2acl-vault-prod-gip-ccy/replicationJobs/02004ea7-d498-4bb4-bdeb-cdb611706867",
          "jobState": "InProgress",
          "providerSpecificDetails": {
            "instanceType": "A2A",
            "recoveryAvailabilityType": "Single"
          }
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account.
metadata:
  description: >
    Create protection intent Resource.

    The operation to create an ASR replication protection intent item.
errorCodes: []
