### YamlMime:RESTOperation
uid: management.azure.com.securityinsights.stable.alertruletemplates.list
name: List
service: Sentinel
groupName: Alert Rule Templates
apiVersion: 2020-01-01
summary: Gets all alert rule templates.
consumes:
- application/json
produces:
- application/json
paths:
- content: GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/alertRuleTemplates?api-version=2020-01-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: Azure subscription ID
  types:
  - uid: string
  pattern: ^[0-9A-Fa-f]{8}-([0-9A-Fa-f]{4}-){3}[0-9A-Fa-f]{12}$
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group within the user's subscription. The name is case insensitive.
  types:
  - uid: string
  pattern: ^[-\w\._\(\)]+$
- name: workspaceName
  in: path
  isRequired: true
  description: The name of the workspace.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: API version for the operation
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK, Operation successfully completed
  types:
  - uid: AlertRuleTemplatesList
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: CloudError
requestHeader: []
definitions:
- name: AlertRuleTemplatesList
  description: List all the alert rule templates.
  kind: object
  properties:
  - name: nextLink
    isReadyOnly: true
    description: URL to fetch the next set of alert rule templates.
    types:
    - uid: string
  - name: value
    description: Array of alert rule templates.
    types:
    - uid: FusionAlertRuleTemplate
      isArray: true
    - uid: MicrosoftSecurityIncidentCreationAlertRuleTemplate
      isArray: true
    - uid: ScheduledAlertRuleTemplate
      isArray: true
    typesTitle: AlertRuleTemplate[]
- name: CloudError
  description: An error response for a resource management request.
  kind: object
  properties:
  - name: error
    description: "Error Response  \nThe error object of the CloudError response"
    types:
    - uid: ErrorResponse
- name: ErrorResponse
  description: Error Response
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: ErrorResponse
      isArray: true
  - name: additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: FusionAlertRuleTemplate
  description: Represents Fusion alert rule template.
  kind: object
  properties:
  - name: properties.alertRulesCreatedByTemplateCount
    description: the number of alert rules that were created by this template
    types:
    - uid: integer
  - name: properties.createdDateUTC
    isReadyOnly: true
    description: The time that this alert rule template has been added.
    types:
    - uid: string
  - name: properties.description
    description: The description of the alert rule template.
    types:
    - uid: string
  - name: properties.displayName
    description: The display name for alert rule template.
    types:
    - uid: string
  - name: properties.requiredDataConnectors
    description: The required data connectors for this template
    types:
    - uid: AlertRuleTemplateDataSource
      isArray: true
  - name: properties.status
    description: The alert rule template status.
    types:
    - uid: TemplateStatus
  - name: properties.severity
    description: The severity for alerts created by this alert rule.
    types:
    - uid: AlertSeverity
  - name: properties.tactics
    description: The tactics of the alert rule template
    types:
    - uid: string
      isArray: true
  - name: kind
    description: The alert rule kind
    types:
    - uid: Fusion
    typesTitle: string
  - name: id
    isReadyOnly: true
    description: Azure resource Id
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Azure resource name
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Azure resource type
    types:
    - uid: string
- name: MicrosoftSecurityIncidentCreationAlertRuleTemplate
  description: Represents MicrosoftSecurityIncidentCreation rule template.
  kind: object
  properties:
  - name: properties.alertRulesCreatedByTemplateCount
    description: the number of alert rules that were created by this template
    types:
    - uid: integer
  - name: properties.createdDateUTC
    isReadyOnly: true
    description: The time that this alert rule template has been added.
    types:
    - uid: string
  - name: properties.description
    description: The description of the alert rule template.
    types:
    - uid: string
  - name: properties.displayName
    description: The display name for alert rule template.
    types:
    - uid: string
  - name: properties.requiredDataConnectors
    description: The required data connectors for this template
    types:
    - uid: AlertRuleTemplateDataSource
      isArray: true
  - name: properties.status
    description: The alert rule template status.
    types:
    - uid: TemplateStatus
  - name: properties.displayNamesFilter
    description: the alerts' displayNames on which the cases will be generated
    types:
    - uid: string
      isArray: true
  - name: properties.displayNamesExcludeFilter
    description: the alerts' displayNames on which the cases will not be generated
    types:
    - uid: string
      isArray: true
  - name: properties.productFilter
    description: The alerts' productName on which the cases will be generated
    types:
    - uid: MicrosoftSecurityProductName
  - name: properties.severitiesFilter
    description: the alerts' severities on which the cases will be generated
    types:
    - uid: string
      isArray: true
  - name: kind
    description: The alert rule kind
    types:
    - uid: MicrosoftSecurityIncidentCreation
    typesTitle: string
  - name: id
    isReadyOnly: true
    description: Azure resource Id
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Azure resource name
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Azure resource type
    types:
    - uid: string
- name: ScheduledAlertRuleTemplate
  description: Represents scheduled alert rule template.
  kind: object
  properties:
  - name: properties.alertRulesCreatedByTemplateCount
    description: the number of alert rules that were created by this template
    types:
    - uid: integer
  - name: properties.createdDateUTC
    isReadyOnly: true
    description: The time that this alert rule template has been added.
    types:
    - uid: string
  - name: properties.description
    description: The description of the alert rule template.
    types:
    - uid: string
  - name: properties.displayName
    description: The display name for alert rule template.
    types:
    - uid: string
  - name: properties.requiredDataConnectors
    description: The required data connectors for this template
    types:
    - uid: AlertRuleTemplateDataSource
      isArray: true
  - name: properties.status
    description: The alert rule template status.
    types:
    - uid: TemplateStatus
  - name: properties.query
    description: The query that creates alerts for this rule.
    types:
    - uid: string
  - name: properties.queryFrequency
    description: The frequency (in ISO 8601 duration format) for this alert rule to run.
    types:
    - uid: string
  - name: properties.queryPeriod
    description: The period (in ISO 8601 duration format) that this alert rule looks at.
    types:
    - uid: string
  - name: properties.severity
    description: The severity for alerts created by this alert rule.
    types:
    - uid: AlertSeverity
  - name: properties.triggerOperator
    description: The operation against the threshold that triggers alert rule.
    types:
    - uid: TriggerOperator
  - name: properties.triggerThreshold
    description: The threshold triggers this alert rule.
    types:
    - uid: integer
  - name: properties.tactics
    description: The tactics of the alert rule template
    types:
    - uid: string
      isArray: true
  - name: kind
    description: The alert rule kind
    types:
    - uid: Scheduled
    typesTitle: string
  - name: id
    isReadyOnly: true
    description: Azure resource Id
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Azure resource name
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Azure resource type
    types:
    - uid: string
- name: ErrorAdditionalInfo
  description: The resource management error additional info.
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: The additional info type.
    types:
    - uid: string
  - name: info
    isReadyOnly: true
    description: The additional info.
    types:
    - uid: object
- name: AlertRuleTemplateDataSource
  description: alert rule template data sources
  kind: object
  properties:
  - name: connectorId
    description: The connector id that provides the following data types
    types:
    - uid: string
  - name: dataTypes
    description: The data types used by the alert rule template
    types:
    - uid: string
      isArray: true
- name: TemplateStatus
  description: The alert rule template status.
  kind: enum
  properties:
  - name: Installed
    description: Alert rule template installed. and can not use more then once
    types:
    - uid: string
  - name: Available
    description: Alert rule template is available.
    types:
    - uid: string
  - name: NotAvailable
    description: Alert rule template is not available
    types:
    - uid: string
- name: AlertSeverity
  description: The severity of the alert
  kind: enum
  properties:
  - name: High
    description: High severity
    types:
    - uid: string
  - name: Medium
    description: Medium severity
    types:
    - uid: string
  - name: Low
    description: Low severity
    types:
    - uid: string
  - name: Informational
    description: Informational severity
    types:
    - uid: string
- name: AlertRuleKind
  description: The kind of the alert rule
  kind: enum
  properties:
  - name: Scheduled
    types:
    - uid: string
  - name: MicrosoftSecurityIncidentCreation
    types:
    - uid: string
  - name: Fusion
    types:
    - uid: string
- name: MicrosoftSecurityProductName
  description: The alerts' productName on which the cases will be generated
  kind: enum
  properties:
  - name: Microsoft Cloud App Security
    types:
    - uid: string
  - name: Azure Security Center
    types:
    - uid: string
  - name: Azure Advanced Threat Protection
    types:
    - uid: string
  - name: Azure Active Directory Identity Protection
    types:
    - uid: string
  - name: Azure Security Center for IoT
    types:
    - uid: string
- name: TriggerOperator
  description: The operation against the threshold that triggers alert rule.
  kind: enum
  properties:
  - name: GreaterThan
    types:
    - uid: string
  - name: LessThan
    types:
    - uid: string
  - name: Equal
    types:
    - uid: string
  - name: NotEqual
    types:
    - uid: string
examples:
- name: Get all alert rule templates.
  request:
    uri: GET https://management.azure.com/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/alertRuleTemplates?api-version=2020-01-01
  responses:
  - statusCode: "200"
    body: >-
      {
        "value": [
          {
            "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/AlertRuleTemplates/65360bb0-8986-4ade-a89d-af3cf44d28aa",
            "name": "65360bb0-8986-4ade-a89d-af3cf44d28aa",
            "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
            "kind": "Scheduled",
            "properties": {
              "severity": "Low",
              "query": "let timeframe = 1d;\nAWSCloudTrail\n| where TimeGenerated >= ago(timeframe)\n| where EventName == \"CreateNetworkAclEntry\"\n    or EventName == \"CreateRoute\"\n| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements\n| extend AccountCustomEntity = UserIdentityUserName, IPCustomEntity = SourceIpAddress",
              "queryFrequency": "P1D",
              "queryPeriod": "P1D",
              "triggerOperator": "GreaterThan",
              "triggerThreshold": 0,
              "displayName": "Changes to Amazon VPC settings",
              "description": "This alert monitors changes to Amazon VPC (Virtual Private Cloud) settings such as new ACL entries and routes in route tables.\nMore information: https://medium.com/@GorillaStack/the-most-important-aws-cloudtrail-security-events-to-track-a5b9873f8255 \nand https://aws.amazon.com/vpc/",
              "tactics": [
                "PrivilegeEscalation",
                "LateralMovement"
              ],
              "createdDateUTC": "2019-02-27T00:00:00Z",
              "status": "Available",
              "requiredDataConnectors": [
                {
                  "connectorId": "AWS",
                  "dataTypes": [
                    "AWSCloudTrail"
                  ]
                }
              ],
              "alertRulesCreatedByTemplateCount": 0
            }
          },
          {
            "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/AlertRuleTemplates/f71aba3d-28fb-450b-b192-4e76a83015c8",
            "name": "f71aba3d-28fb-450b-b192-4e76a83015c8",
            "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
            "kind": "Fusion",
            "properties": {
              "displayName": "Advanced Multi-Stage Attack Detection",
              "description": "Place holder: Fusion uses graph powered machine learning algorithms to correlate between millions of lower fidelity anomalous activities from different products such as Azure AD Identity Protection, and Microsoft Cloud App Security, to combine them into a manageable number of interesting security cases.\n",
              "tactics": [
                "Persistence",
                "LateralMovement",
                "Exfiltration",
                "CommandAndControl"
              ],
              "createdDateUTC": "2019-07-25T00:00:00Z",
              "status": "Available",
              "severity": "High",
              "alertRulesCreatedByTemplateCount": 0
            }
          },
          {
            "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/AlertRuleTemplates/b3cfc7c0-092c-481c-a55b-34a3979758cb",
            "name": "b3cfc7c0-092c-481c-a55b-34a3979758cb",
            "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
            "kind": "MicrosoftSecurityIncidentCreation",
            "properties": {
              "productFilter": "Microsoft Cloud App Security",
              "displayName": "Create incidents based on Microsoft Cloud App Security alerts",
              "description": "Create incidents based on all alerts generated in Microsoft Cloud App Security",
              "createdDateUTC": "2019-07-16T00:00:00Z",
              "status": "Available",
              "alertRulesCreatedByTemplateCount": 0
            }
          }
        ]
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: Learn more about Sentinel service - Gets all alert rule templates.
errorCodes: []
