### YamlMime:RESTOperation
uid: management.azure.com.securityinsights.preview.alertruletemplates.list
name: List
service: Sentinel
groupName: Alert Rule Templates
apiVersion: 2022-07-01-preview
summary: Gets all alert rule templates.
consumes:
- application/json
produces:
- application/json
paths:
- content: GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/alertRuleTemplates?api-version=2022-07-01-preview
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The ID of the target subscription.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group. The name is case insensitive.
  types:
  - uid: string
- name: workspaceName
  in: path
  isRequired: true
  description: The name of the workspace.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The API version to use for this operation.
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK
  types:
  - uid: AlertRuleTemplatesList
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: CloudError
requestHeader: []
definitions:
- name: AlertRuleTemplatesList
  description: List all the alert rule templates.
  kind: object
  properties:
  - name: nextLink
    isReadyOnly: true
    description: URL to fetch the next set of alert rule templates.
    types:
    - uid: string
  - name: value
    description: Array of alert rule templates.
    types:
    - uid: MLBehaviorAnalyticsAlertRuleTemplate
      isArray: true
    - uid: FusionAlertRuleTemplate
      isArray: true
    - uid: ThreatIntelligenceAlertRuleTemplate
      isArray: true
    - uid: MicrosoftSecurityIncidentCreationAlertRuleTemplate
      isArray: true
    - uid: ScheduledAlertRuleTemplate
      isArray: true
    - uid: NrtAlertRuleTemplate
      isArray: true
    typesTitle: AlertRuleTemplate[]
- name: CloudError
  description: Error response structure.
  kind: object
  properties:
  - name: error
    description: Error data
    types:
    - uid: CloudErrorBody
- name: CloudErrorBody
  description: Error details.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: An identifier for the error. Codes are invariant and are intended to be consumed programmatically.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: A message describing the error, intended to be suitable for display in a user interface.
    types:
    - uid: string
- name: MLBehaviorAnalyticsAlertRuleTemplate
  description: Represents MLBehaviorAnalytics alert rule template.
  kind: object
  properties:
  - name: properties.severity
    description: The severity for alerts created by this alert rule.
    types:
    - uid: AlertSeverity
  - name: kind
    description: The kind of the alert rule
    types:
    - uid: MLBehaviorAnalytics
    typesTitle: string
  - name: id
    isReadyOnly: true
    description: Fully qualified resource ID for the resource. Ex - /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{resourceType}/{resourceName}
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource. E.g. "Microsoft.Compute/virtualMachines" or "Microsoft.Storage/storageAccounts"
    types:
    - uid: string
  - name: systemData
    isReadyOnly: true
    description: Azure Resource Manager metadata containing createdBy and modifiedBy information.
    types:
    - uid: systemData
  - name: properties.tactics
    description: The tactics of the alert rule
    types:
    - uid: string
      isArray: true
  - name: properties.techniques
    description: The techniques of the alert rule
    types:
    - uid: string
      isArray: true
  - name: alertRulesCreatedByTemplateCount
    description: the number of alert rules that were created by this template
    types:
    - uid: integer
  - name: lastUpdatedDateUTC
    isReadyOnly: true
    description: The last time that this alert rule template has been updated.
    types:
    - uid: string
  - name: createdDateUTC
    isReadyOnly: true
    description: The time that this alert rule template has been added.
    types:
    - uid: string
  - name: description
    description: The description of the alert rule template.
    types:
    - uid: string
  - name: displayName
    description: The display name for alert rule template.
    types:
    - uid: string
  - name: requiredDataConnectors
    description: The required data sources for this template
    types:
    - uid: AlertRuleTemplateDataSource
      isArray: true
  - name: status
    description: The alert rule template status.
    types:
    - uid: TemplateStatus
- name: FusionAlertRuleTemplate
  description: Represents Fusion alert rule template.
  kind: object
  properties:
  - name: properties.alertRulesCreatedByTemplateCount
    description: the number of alert rules that were created by this template
    types:
    - uid: integer
  - name: properties.createdDateUTC
    isReadyOnly: true
    description: The time that this alert rule template has been added.
    types:
    - uid: string
  - name: properties.lastUpdatedDateUTC
    isReadyOnly: true
    description: The time that this alert rule template was last updated.
    types:
    - uid: string
  - name: properties.description
    description: The description of the alert rule template.
    types:
    - uid: string
  - name: properties.displayName
    description: The display name for alert rule template.
    types:
    - uid: string
  - name: properties.requiredDataConnectors
    description: The required data connectors for this template
    types:
    - uid: AlertRuleTemplateDataSource
      isArray: true
  - name: properties.status
    description: The alert rule template status.
    types:
    - uid: TemplateStatus
  - name: properties.severity
    description: The severity for alerts created by this alert rule.
    types:
    - uid: AlertSeverity
  - name: properties.tactics
    description: The tactics of the alert rule template
    types:
    - uid: string
      isArray: true
  - name: properties.techniques
    description: The techniques of the alert rule
    types:
    - uid: string
      isArray: true
  - name: properties.sourceSettings
    description: All supported source signal configurations consumed in fusion detection.
    types:
    - uid: FusionTemplateSourceSetting
      isArray: true
  - name: kind
    description: The kind of the alert rule
    types:
    - uid: Fusion
    typesTitle: string
  - name: id
    isReadyOnly: true
    description: Fully qualified resource ID for the resource. Ex - /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{resourceType}/{resourceName}
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource. E.g. "Microsoft.Compute/virtualMachines" or "Microsoft.Storage/storageAccounts"
    types:
    - uid: string
  - name: systemData
    isReadyOnly: true
    description: Azure Resource Manager metadata containing createdBy and modifiedBy information.
    types:
    - uid: systemData
- name: ThreatIntelligenceAlertRuleTemplate
  description: Represents Threat Intelligence alert rule template.
  kind: object
  properties:
  - name: properties.severity
    description: The severity for alerts created by this alert rule.
    types:
    - uid: AlertSeverity
  - name: kind
    description: The kind of the alert rule
    types:
    - uid: ThreatIntelligence
    typesTitle: string
  - name: id
    isReadyOnly: true
    description: Fully qualified resource ID for the resource. Ex - /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{resourceType}/{resourceName}
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource. E.g. "Microsoft.Compute/virtualMachines" or "Microsoft.Storage/storageAccounts"
    types:
    - uid: string
  - name: systemData
    isReadyOnly: true
    description: Azure Resource Manager metadata containing createdBy and modifiedBy information.
    types:
    - uid: systemData
  - name: properties.tactics
    description: The tactics of the alert rule
    types:
    - uid: string
      isArray: true
  - name: properties.techniques
    description: The techniques of the alert rule
    types:
    - uid: string
      isArray: true
  - name: alertRulesCreatedByTemplateCount
    description: the number of alert rules that were created by this template
    types:
    - uid: integer
  - name: lastUpdatedDateUTC
    isReadyOnly: true
    description: The last time that this alert rule template has been updated.
    types:
    - uid: string
  - name: createdDateUTC
    isReadyOnly: true
    description: The time that this alert rule template has been added.
    types:
    - uid: string
  - name: description
    description: The description of the alert rule template.
    types:
    - uid: string
  - name: displayName
    description: The display name for alert rule template.
    types:
    - uid: string
  - name: requiredDataConnectors
    description: The required data sources for this template
    types:
    - uid: AlertRuleTemplateDataSource
      isArray: true
  - name: status
    description: The alert rule template status.
    types:
    - uid: TemplateStatus
- name: MicrosoftSecurityIncidentCreationAlertRuleTemplate
  description: Represents MicrosoftSecurityIncidentCreation rule template.
  kind: object
  properties:
  - name: properties.displayNamesFilter
    description: the alerts' displayNames on which the cases will be generated
    types:
    - uid: string
      isArray: true
  - name: properties.displayNamesExcludeFilter
    description: the alerts' displayNames on which the cases will not be generated
    types:
    - uid: string
      isArray: true
  - name: properties.productFilter
    description: The alerts' productName on which the cases will be generated
    types:
    - uid: MicrosoftSecurityProductName
  - name: properties.severitiesFilter
    description: the alerts' severities on which the cases will be generated
    types:
    - uid: string
      isArray: true
  - name: kind
    description: The kind of the alert rule
    types:
    - uid: MicrosoftSecurityIncidentCreation
    typesTitle: string
  - name: id
    isReadyOnly: true
    description: Fully qualified resource ID for the resource. Ex - /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{resourceType}/{resourceName}
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource. E.g. "Microsoft.Compute/virtualMachines" or "Microsoft.Storage/storageAccounts"
    types:
    - uid: string
  - name: systemData
    isReadyOnly: true
    description: Azure Resource Manager metadata containing createdBy and modifiedBy information.
    types:
    - uid: systemData
  - name: properties.alertRulesCreatedByTemplateCount
    description: the number of alert rules that were created by this template
    types:
    - uid: integer
  - name: properties.lastUpdatedDateUTC
    isReadyOnly: true
    description: The last time that this alert rule template has been updated.
    types:
    - uid: string
  - name: properties.createdDateUTC
    isReadyOnly: true
    description: The time that this alert rule template has been added.
    types:
    - uid: string
  - name: properties.description
    description: The description of the alert rule template.
    types:
    - uid: string
  - name: properties.displayName
    description: The display name for alert rule template.
    types:
    - uid: string
  - name: properties.requiredDataConnectors
    description: The required data sources for this template
    types:
    - uid: AlertRuleTemplateDataSource
      isArray: true
  - name: properties.status
    description: The alert rule template status.
    types:
    - uid: TemplateStatus
- name: ScheduledAlertRuleTemplate
  description: Represents scheduled alert rule template.
  kind: object
  properties:
  - name: properties.alertRulesCreatedByTemplateCount
    description: the number of alert rules that were created by this template
    types:
    - uid: integer
  - name: properties.createdDateUTC
    isReadyOnly: true
    description: The time that this alert rule template has been added.
    types:
    - uid: string
  - name: properties.lastUpdatedDateUTC
    isReadyOnly: true
    description: The time that this alert rule template was last updated.
    types:
    - uid: string
  - name: properties.description
    description: The description of the alert rule template.
    types:
    - uid: string
  - name: properties.displayName
    description: The display name for alert rule template.
    types:
    - uid: string
  - name: properties.requiredDataConnectors
    description: The required data connectors for this template
    types:
    - uid: AlertRuleTemplateDataSource
      isArray: true
  - name: properties.status
    description: The alert rule template status.
    types:
    - uid: TemplateStatus
  - name: properties.query
    description: The query that creates alerts for this rule.
    types:
    - uid: string
  - name: properties.queryFrequency
    description: The frequency (in ISO 8601 duration format) for this alert rule to run.
    types:
    - uid: string
  - name: properties.queryPeriod
    description: The period (in ISO 8601 duration format) that this alert rule looks at.
    types:
    - uid: string
  - name: properties.severity
    description: The severity for alerts created by this alert rule.
    types:
    - uid: AlertSeverity
  - name: properties.triggerOperator
    description: The operation against the threshold that triggers alert rule.
    types:
    - uid: TriggerOperator
  - name: properties.triggerThreshold
    description: The threshold triggers this alert rule.
    types:
    - uid: integer
  - name: properties.tactics
    description: The tactics of the alert rule template
    types:
    - uid: string
      isArray: true
  - name: properties.techniques
    description: The techniques of the alert rule
    types:
    - uid: string
      isArray: true
  - name: properties.version
    description: The version of this template - in format <a.b.c>, where all are numbers. For example <1.0.2>.
    types:
    - uid: string
  - name: properties.eventGroupingSettings
    description: The event grouping settings.
    types:
    - uid: EventGroupingSettings
  - name: properties.customDetails
    description: Dictionary of string key-value pairs of columns to be attached to the alert
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.entityMappings
    description: Array of the entity mappings of the alert rule
    types:
    - uid: EntityMapping
      isArray: true
  - name: properties.alertDetailsOverride
    description: The alert details override settings
    types:
    - uid: AlertDetailsOverride
  - name: kind
    description: The kind of the alert rule
    types:
    - uid: Scheduled
    typesTitle: string
  - name: id
    isReadyOnly: true
    description: Fully qualified resource ID for the resource. Ex - /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{resourceType}/{resourceName}
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource. E.g. "Microsoft.Compute/virtualMachines" or "Microsoft.Storage/storageAccounts"
    types:
    - uid: string
  - name: systemData
    isReadyOnly: true
    description: Azure Resource Manager metadata containing createdBy and modifiedBy information.
    types:
    - uid: systemData
- name: NrtAlertRuleTemplate
  description: Represents NRT alert rule template.
  kind: object
  properties:
  - name: kind
    description: The kind of the alert rule
    types:
    - uid: NRT
    typesTitle: string
  - name: id
    isReadyOnly: true
    description: Fully qualified resource ID for the resource. Ex - /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{resourceType}/{resourceName}
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource. E.g. "Microsoft.Compute/virtualMachines" or "Microsoft.Storage/storageAccounts"
    types:
    - uid: string
  - name: systemData
    isReadyOnly: true
    description: Azure Resource Manager metadata containing createdBy and modifiedBy information.
    types:
    - uid: systemData
  - name: properties.tactics
    description: The tactics of the alert rule
    types:
    - uid: string
      isArray: true
  - name: properties.techniques
    description: The techniques of the alert rule
    types:
    - uid: string
      isArray: true
  - name: alertRulesCreatedByTemplateCount
    description: the number of alert rules that were created by this template
    types:
    - uid: integer
  - name: lastUpdatedDateUTC
    isReadyOnly: true
    description: The last time that this alert rule template has been updated.
    types:
    - uid: string
  - name: createdDateUTC
    isReadyOnly: true
    description: The time that this alert rule template has been added.
    types:
    - uid: string
  - name: description
    description: The description of the alert rule template.
    types:
    - uid: string
  - name: displayName
    description: The display name for alert rule template.
    types:
    - uid: string
  - name: requiredDataConnectors
    description: The required data sources for this template
    types:
    - uid: AlertRuleTemplateDataSource
      isArray: true
  - name: status
    description: The alert rule template status.
    types:
    - uid: TemplateStatus
  - name: properties.query
    description: The query that creates alerts for this rule.
    types:
    - uid: string
  - name: properties.severity
    description: The severity for alerts created by this alert rule.
    types:
    - uid: AlertSeverity
  - name: properties.version
    description: The version of this template - in format <a.b.c>, where all are numbers. For example <1.0.2>.
    types:
    - uid: string
  - name: properties.customDetails
    description: Dictionary of string key-value pairs of columns to be attached to the alert
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.entityMappings
    description: Array of the entity mappings of the alert rule
    types:
    - uid: EntityMapping
      isArray: true
  - name: properties.alertDetailsOverride
    description: The alert details override settings
    types:
    - uid: AlertDetailsOverride
- name: AlertSeverity
  description: The severity for alerts created by this alert rule.
  kind: enum
  properties:
  - name: High
    description: High severity
    types:
    - uid: string
  - name: Medium
    description: Medium severity
    types:
    - uid: string
  - name: Low
    description: Low severity
    types:
    - uid: string
  - name: Informational
    description: Informational severity
    types:
    - uid: string
- name: systemData
  description: Metadata pertaining to creation and last modification of the resource.
  kind: object
  properties:
  - name: createdBy
    description: The identity that created the resource.
    types:
    - uid: string
  - name: createdByType
    description: The type of identity that created the resource.
    types:
    - uid: createdByType
  - name: createdAt
    description: The timestamp of resource creation (UTC).
    types:
    - uid: string
  - name: lastModifiedBy
    description: The identity that last modified the resource.
    types:
    - uid: string
  - name: lastModifiedByType
    description: The type of identity that last modified the resource.
    types:
    - uid: createdByType
  - name: lastModifiedAt
    description: The timestamp of resource last modification (UTC)
    types:
    - uid: string
- name: AlertRuleTemplateDataSource
  description: alert rule template data sources
  kind: object
  properties:
  - name: connectorId
    description: The connector id that provides the following data types
    types:
    - uid: string
  - name: dataTypes
    description: The data types used by the alert rule template
    types:
    - uid: string
      isArray: true
- name: TemplateStatus
  description: The alert rule template status.
  kind: enum
  properties:
  - name: Installed
    description: Alert rule template installed. and can not use more then once
    types:
    - uid: string
  - name: Available
    description: Alert rule template is available.
    types:
    - uid: string
  - name: NotAvailable
    description: Alert rule template is not available
    types:
    - uid: string
- name: FusionTemplateSourceSetting
  description: Represents a source signal consumed in Fusion detection.
  kind: object
  properties:
  - name: sourceName
    description: The name of a source signal consumed in Fusion detection.
    types:
    - uid: string
  - name: sourceSubTypes
    description: All supported source subtypes under this source signal consumed in fusion detection.
    types:
    - uid: FusionTemplateSourceSubType
      isArray: true
- name: MicrosoftSecurityProductName
  description: The alerts' productName on which the cases will be generated
  kind: enum
  properties:
  - name: Microsoft Cloud App Security
    types:
    - uid: string
  - name: Azure Security Center
    types:
    - uid: string
  - name: Azure Advanced Threat Protection
    types:
    - uid: string
  - name: Azure Active Directory Identity Protection
    types:
    - uid: string
  - name: Azure Security Center for IoT
    types:
    - uid: string
  - name: Office 365 Advanced Threat Protection
    types:
    - uid: string
  - name: Microsoft Defender Advanced Threat Protection
    types:
    - uid: string
- name: TriggerOperator
  description: The operation against the threshold that triggers alert rule.
  kind: enum
  properties:
  - name: GreaterThan
    types:
    - uid: string
  - name: LessThan
    types:
    - uid: string
  - name: Equal
    types:
    - uid: string
  - name: NotEqual
    types:
    - uid: string
- name: EventGroupingSettings
  description: Event grouping settings property bag.
  kind: object
  properties:
  - name: aggregationKind
    description: The event grouping aggregation kinds
    types:
    - uid: EventGroupingAggregationKind
- name: EntityMapping
  description: Single entity mapping for the alert rule
  kind: object
  properties:
  - name: entityType
    description: The V3 type of the mapped entity
    types:
    - uid: EntityMappingType
  - name: fieldMappings
    description: array of field mappings for the given entity mapping
    types:
    - uid: FieldMapping
      isArray: true
- name: AlertDetailsOverride
  description: Settings for how to dynamically override alert static details
  kind: object
  properties:
  - name: alertDisplayNameFormat
    description: the format containing columns name(s) to override the alert name
    types:
    - uid: string
  - name: alertDescriptionFormat
    description: the format containing columns name(s) to override the alert description
    types:
    - uid: string
  - name: alertTacticsColumnName
    description: the column name to take the alert tactics from
    types:
    - uid: string
  - name: alertSeverityColumnName
    description: the column name to take the alert severity from
    types:
    - uid: string
- name: createdByType
  description: The type of identity that created the resource.
  kind: enum
  properties:
  - name: User
    types:
    - uid: string
  - name: Application
    types:
    - uid: string
  - name: ManagedIdentity
    types:
    - uid: string
  - name: Key
    types:
    - uid: string
- name: FusionTemplateSourceSubType
  description: Represents a source subtype under a source signal consumed in Fusion detection.
  kind: object
  properties:
  - name: sourceSubTypeName
    description: The name of source subtype under a source signal consumed in Fusion detection.
    types:
    - uid: string
  - name: sourceSubTypeDisplayName
    isReadyOnly: true
    description: The display name of source subtype under a source signal consumed in Fusion detection.
    types:
    - uid: string
  - name: severityFilter
    description: Severity configuration available for a source subtype consumed in fusion detection.
    types:
    - uid: FusionTemplateSubTypeSeverityFilter
- name: EventGroupingAggregationKind
  description: The event grouping aggregation kinds
  kind: enum
  properties:
  - name: SingleAlert
    types:
    - uid: string
  - name: AlertPerResult
    types:
    - uid: string
- name: EntityMappingType
  description: The V3 type of the mapped entity
  kind: enum
  properties:
  - name: Account
    description: User account entity type
    types:
    - uid: string
  - name: Host
    description: Host entity type
    types:
    - uid: string
  - name: IP
    description: IP address entity type
    types:
    - uid: string
  - name: Malware
    description: Malware entity type
    types:
    - uid: string
  - name: File
    description: System file entity type
    types:
    - uid: string
  - name: Process
    description: Process entity type
    types:
    - uid: string
  - name: CloudApplication
    description: Cloud app entity type
    types:
    - uid: string
  - name: DNS
    description: DNS entity type
    types:
    - uid: string
  - name: AzureResource
    description: Azure resource entity type
    types:
    - uid: string
  - name: FileHash
    description: File-hash entity type
    types:
    - uid: string
  - name: RegistryKey
    description: Registry key entity type
    types:
    - uid: string
  - name: RegistryValue
    description: Registry value entity type
    types:
    - uid: string
  - name: SecurityGroup
    description: Security group entity type
    types:
    - uid: string
  - name: URL
    description: URL entity type
    types:
    - uid: string
  - name: Mailbox
    description: Mailbox entity type
    types:
    - uid: string
  - name: MailCluster
    description: Mail cluster entity type
    types:
    - uid: string
  - name: MailMessage
    description: Mail message entity type
    types:
    - uid: string
  - name: SubmissionMail
    description: Submission mail entity type
    types:
    - uid: string
- name: FieldMapping
  description: A single field mapping of the mapped entity
  kind: object
  properties:
  - name: identifier
    description: the V3 identifier of the entity
    types:
    - uid: string
  - name: columnName
    description: the column name to be mapped to the identifier
    types:
    - uid: string
- name: FusionTemplateSubTypeSeverityFilter
  description: Represents severity configurations available for a source subtype consumed in Fusion detection.
  kind: object
  properties:
  - name: isSupported
    description: Determines whether severity configuration is supported for this source subtype consumed in Fusion detection.
    types:
    - uid: boolean
  - name: severityFilters
    description: List of all supported severities for this source subtype consumed in Fusion detection.
    types:
    - uid: string
      isArray: true
examples:
- name: Get all alert rule templates.
  request:
    uri: GET https://management.azure.com/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/alertRuleTemplates?api-version=2022-07-01-preview
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      GET https://management.azure.com/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/alertRuleTemplates?api-version=2022-07-01-preview
      ```

      # [JavaScript](#tab/JavaScript)
      ``` js
      const { SecurityInsights } = require("@azure/arm-securityinsight");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Gets all alert rule templates.
       *
       * @summary Gets all alert rule templates.
       * x-ms-original-file: specification/securityinsights/resource-manager/Microsoft.SecurityInsights/preview/2022-07-01-preview/examples/alertRuleTemplates/GetAlertRuleTemplates.json
       */
      async function getAllAlertRuleTemplates() {
        const subscriptionId = "d0cfe6b2-9ac0-4464-9919-dccaee2e48c0";
        const resourceGroupName = "myRg";
        const workspaceName = "myWorkspace";
        const credential = new DefaultAzureCredential();
        const client = new SecurityInsights(credential, subscriptionId);
        const resArray = new Array();
        for await (let item of client.alertRuleTemplates.list(resourceGroupName, workspaceName)) {
          resArray.push(item);
        }
        console.log(resArray);
      }

      getAllAlertRuleTemplates().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-securityinsight_1.0.0-beta.4/sdk/securityinsight/arm-securityinsight/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "value": [
          {
            "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalIinsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/AlertRuleTemplates/65360bb0-8986-4ade-a89d-af3cf44d28aa",
            "name": "65360bb0-8986-4ade-a89d-af3cf44d28aa",
            "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
            "kind": "Scheduled",
            "properties": {
              "severity": "Low",
              "query": "let timeframe = 1d;\nAWSCloudTrail\n| where TimeGenerated >= ago(timeframe)\n| where EventName == \"CreateNetworkAclEntry\"\n    or EventName == \"CreateRoute\"\n| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements\n| extend AccountCustomEntity = UserIdentityUserName, IPCustomEntity = SourceIpAddress",
              "queryFrequency": "P1D",
              "queryPeriod": "P1D",
              "triggerOperator": "GreaterThan",
              "triggerThreshold": 0,
              "displayName": "Changes to Amazon VPC settings",
              "description": "This alert monitors changes to Amazon VPC (Virtual Private Cloud) settings such as new ACL entries and routes in route tables.\nMore information: https://medium.com/@GorillaStack/the-most-important-aws-cloudtrail-security-events-to-track-a5b9873f8255 \nand https://aws.amazon.com/vpc/",
              "tactics": [
                "PrivilegeEscalation",
                "LateralMovement"
              ],
              "techniques": [
                "T1037",
                "T1021"
              ],
              "lastUpdatedDateUTC": "2020-02-27T00:00:00Z",
              "createdDateUTC": "2019-02-27T00:00:00Z",
              "status": "Available",
              "version": "1.0.1",
              "requiredDataConnectors": [
                {
                  "connectorId": "AWS",
                  "dataTypes": [
                    "AWSCloudTrail"
                  ]
                }
              ],
              "alertRulesCreatedByTemplateCount": 0
            }
          },
          {
            "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalIinsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/AlertRuleTemplates/f71aba3d-28fb-450b-b192-4e76a83015c8",
            "name": "f71aba3d-28fb-450b-b192-4e76a83015c8",
            "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
            "kind": "Fusion",
            "properties": {
              "displayName": "Advanced Multi-Stage Attack Detection",
              "description": "Microsoft Sentinel uses Fusion, a correlation engine based on scalable machine learning algorithms, to automatically detect multistage attacks by identifying combinations of anomalous behaviors and suspicious activities that are observed at various stages of the kill chain. On the basis of these discoveries, Azure Sentinel generates incidents that would otherwise be very difficult to catch. By design, these incidents are low-volume, high-fidelity, and high-severity, which is why this detection is turned ON by default.\n\nSince Fusion correlates multiple signals from various products to detect advanced multistage attacks, successful Fusion detections are presented as Fusion incidents on the Microsoft Sentinel Incidents page. This rule covers the following detections:\n- Fusion for emerging threats\n- Fusion for ransomware\n- Scenario-based Fusion detections (122 scenarios)\n\nTo enable these detections, we recommend you configure the following data connectors for best results:\n- Out-of-the-box anomaly detections\n- Azure Active Directory Identity Protection\n- Azure Defender\n- Azure Defender for IoT\n- Microsoft 365 Defender\n- Microsoft Cloud App Security    \n- Microsoft Defender for Endpoint\n- Microsoft Defender for Identity\n- Microsoft Defender for Office 365\n- Palo Alto Networks\n- Scheduled analytics rules, both built-in and those created by your security analysts. Analytics rules must contain kill-chain (tactics) and entity mapping information in order to be used by Fusion.\n\nFor the full description of each detection that is supported by Fusion, go to https://aka.ms/SentinelFusion.",
              "tactics": [
                "Collection",
                "CommandAndControl",
                "CredentialAccess",
                "DefenseEvasion",
                "Discovery",
                "Execution",
                "Exfiltration",
                "Impact",
                "InitialAccess",
                "LateralMovement",
                "Persistence",
                "PrivilegeEscalation"
              ],
              "sourceSettings": [
                {
                  "sourceName": "Anomalies",
                  "sourceSubTypes": null
                },
                {
                  "sourceName": "Alert providers",
                  "sourceSubTypes": [
                    {
                      "sourceSubTypeName": "Azure Active Directory Identity Protection",
                      "severityFilter": {
                        "enabled": true,
                        "isSupported": true,
                        "severityFilters": [
                          "Informational",
                          "Low",
                          "Medium",
                          "High"
                        ]
                      }
                    },
                    {
                      "sourceSubTypeName": "Azure Defender",
                      "severityFilter": {
                        "enabled": true,
                        "isSupported": true,
                        "severityFilters": [
                          "Informational",
                          "Low",
                          "Medium",
                          "High"
                        ]
                      }
                    },
                    {
                      "sourceSubTypeName": "Azure Defender for IoT",
                      "severityFilter": {
                        "enabled": true,
                        "isSupported": true,
                        "severityFilters": [
                          "Informational",
                          "Low",
                          "Medium",
                          "High"
                        ]
                      }
                    },
                    {
                      "sourceSubTypeName": "Microsoft 365 Defender",
                      "severityFilter": {
                        "enabled": true,
                        "isSupported": true,
                        "severityFilters": [
                          "Informational",
                          "Low",
                          "Medium",
                          "High"
                        ]
                      }
                    },
                    {
                      "sourceSubTypeName": "Microsoft Cloud App Security",
                      "severityFilter": {
                        "enabled": true,
                        "isSupported": true,
                        "severityFilters": [
                          "Informational",
                          "Low",
                          "Medium",
                          "High"
                        ]
                      }
                    },
                    {
                      "sourceSubTypeName": "Microsoft Defender for Endpoint",
                      "severityFilter": {
                        "enabled": true,
                        "isSupported": true,
                        "severityFilters": [
                          "Informational",
                          "Low",
                          "Medium",
                          "High"
                        ]
                      }
                    },
                    {
                      "sourceSubTypeName": "Microsoft Defender for Identity",
                      "severityFilter": {
                        "enabled": true,
                        "isSupported": true,
                        "severityFilters": [
                          "Informational",
                          "Low",
                          "Medium",
                          "High"
                        ]
                      }
                    },
                    {
                      "sourceSubTypeName": "Microsoft Defender for Office 365",
                      "severityFilter": {
                        "enabled": true,
                        "isSupported": true,
                        "severityFilters": [
                          "Informational",
                          "Low",
                          "Medium",
                          "High"
                        ]
                      }
                    },
                    {
                      "sourceSubTypeName": "Azure Sentinel scheduled analytics rules",
                      "severityFilter": {
                        "enabled": true,
                        "isSupported": true,
                        "severityFilters": [
                          "Informational",
                          "Low",
                          "Medium",
                          "High"
                        ]
                      }
                    }
                  ]
                },
                {
                  "sourceName": "Raw logs from other sources",
                  "sourceSubTypes": [
                    {
                      "sourceSubTypeName": "Palo Alto Networks",
                      "severityFilter": {
                        "enabled": false,
                        "isSupported": false,
                        "severityFilters": null
                      }
                    }
                  ]
                }
              ],
              "lastUpdatedDateUTC": "2021-06-09T00:00:00Z",
              "createdDateUTC": "2019-07-25T00:00:00Z",
              "status": "Available",
              "severity": "High",
              "alertRulesCreatedByTemplateCount": 0
            }
          },
          {
            "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalIinsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/AlertRuleTemplates/b3cfc7c0-092c-481c-a55b-34a3979758cb",
            "name": "b3cfc7c0-092c-481c-a55b-34a3979758cb",
            "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
            "kind": "MicrosoftSecurityIncidentCreation",
            "properties": {
              "productFilter": "Microsoft Cloud App Security",
              "displayName": "Create incidents based on Microsoft Cloud App Security alerts",
              "description": "Create incidents based on all alerts generated in Microsoft Cloud App Security",
              "lastUpdatedDateUTC": "2020-02-27T00:00:00Z",
              "createdDateUTC": "2019-07-16T00:00:00Z",
              "status": "Available",
              "alertRulesCreatedByTemplateCount": 0
            }
          }
        ]
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about Sentinel service - Gets all alert rule templates.
errorCodes: []
