### YamlMime:RESTOperation
uid: management.azure.com.securityinsights.preview.securitymlanalyticssettings.createorupdate
name: Create Or Update
service: Sentinel
groupName: Security ML Analytics Settings
apiVersion: 2022-07-01-preview
summary: Creates or updates the Security ML Analytics Settings.
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/securityMLAnalyticsSettings/{settingsResourceName}?api-version=2022-07-01-preview
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The ID of the target subscription.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group. The name is case insensitive.
  types:
  - uid: string
- name: workspaceName
  in: path
  isRequired: true
  description: The name of the workspace.
  types:
  - uid: string
- name: settingsResourceName
  in: path
  isRequired: true
  description: Security ML Analytics Settings resource name
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The API version to use for this operation.
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK
  types:
  - uid: AnomalySecurityMLAnalyticsSettings
  typesTitle: SecurityMLAnalyticsSetting
- name: 201 Created
  description: Created
  types:
  - uid: AnomalySecurityMLAnalyticsSettings
  typesTitle: SecurityMLAnalyticsSetting
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: CloudError
requestBody:
- name: AnomalySecurityMLAnalyticsSettings
  description: Represents Anomaly Security ML Analytics Settings
  parameters:
  - name: properties.description
    in: body
    description: The description of the SecurityMLAnalyticsSettings.
    types:
    - uid: string
  - name: properties.displayName
    in: body
    isRequired: true
    description: The display name for settings created by this SecurityMLAnalyticsSettings.
    types:
    - uid: string
  - name: properties.enabled
    in: body
    isRequired: true
    description: Determines whether this settings is enabled or disabled.
    types:
    - uid: boolean
  - name: properties.requiredDataConnectors
    in: body
    description: The required data sources for this SecurityMLAnalyticsSettings
    types:
    - uid: SecurityMLAnalyticsSettingsDataSource
      isArray: true
  - name: properties.tactics
    in: body
    description: The tactics of the SecurityMLAnalyticsSettings
    types:
    - uid: string
      isArray: true
  - name: properties.techniques
    in: body
    description: The techniques of the SecurityMLAnalyticsSettings
    types:
    - uid: string
      isArray: true
  - name: properties.anomalyVersion
    in: body
    isRequired: true
    description: The anomaly version of the AnomalySecurityMLAnalyticsSettings.
    types:
    - uid: string
  - name: properties.customizableObservations
    in: body
    description: The customizable observations of the AnomalySecurityMLAnalyticsSettings.
    types:
    - uid: object
  - name: properties.frequency
    in: body
    isRequired: true
    description: The frequency that this SecurityMLAnalyticsSettings will be run.
    types:
    - uid: string
  - name: properties.settingsStatus
    in: body
    isRequired: true
    description: The anomaly SecurityMLAnalyticsSettings status
    types:
    - uid: SettingsStatus
  - name: properties.isDefaultSettings
    in: body
    isRequired: true
    description: Determines whether this anomaly security ml analytics settings is a default settings
    types:
    - uid: boolean
  - name: properties.anomalySettingsVersion
    in: body
    description: The anomaly settings version of the Anomaly security ml analytics settings that dictates whether job version gets updated or not.
    types:
    - uid: integer
  - name: properties.settingsDefinitionId
    in: body
    description: The anomaly settings definition Id
    types:
    - uid: string
  - name: kind
    in: body
    isRequired: true
    description: The kind of security ML Analytics Settings
    types:
    - uid: Anomaly
    typesTitle: string
  - name: etag
    in: body
    description: Etag of the azure resource
    types:
    - uid: string
requestHeader: []
definitions:
- name: AnomalySecurityMLAnalyticsSettings
  description: Represents Anomaly Security ML Analytics Settings
  kind: object
  properties:
  - name: properties.description
    description: The description of the SecurityMLAnalyticsSettings.
    types:
    - uid: string
  - name: properties.displayName
    description: The display name for settings created by this SecurityMLAnalyticsSettings.
    types:
    - uid: string
  - name: properties.enabled
    description: Determines whether this settings is enabled or disabled.
    types:
    - uid: boolean
  - name: properties.lastModifiedUtc
    isReadyOnly: true
    description: The last time that this SecurityMLAnalyticsSettings has been modified.
    types:
    - uid: string
  - name: properties.requiredDataConnectors
    description: The required data sources for this SecurityMLAnalyticsSettings
    types:
    - uid: SecurityMLAnalyticsSettingsDataSource
      isArray: true
  - name: properties.tactics
    description: The tactics of the SecurityMLAnalyticsSettings
    types:
    - uid: string
      isArray: true
  - name: properties.techniques
    description: The techniques of the SecurityMLAnalyticsSettings
    types:
    - uid: string
      isArray: true
  - name: properties.anomalyVersion
    description: The anomaly version of the AnomalySecurityMLAnalyticsSettings.
    types:
    - uid: string
  - name: properties.customizableObservations
    description: The customizable observations of the AnomalySecurityMLAnalyticsSettings.
    types:
    - uid: object
  - name: properties.frequency
    description: The frequency that this SecurityMLAnalyticsSettings will be run.
    types:
    - uid: string
  - name: properties.settingsStatus
    description: The anomaly SecurityMLAnalyticsSettings status
    types:
    - uid: SettingsStatus
  - name: properties.isDefaultSettings
    description: Determines whether this anomaly security ml analytics settings is a default settings
    types:
    - uid: boolean
  - name: properties.anomalySettingsVersion
    description: The anomaly settings version of the Anomaly security ml analytics settings that dictates whether job version gets updated or not.
    types:
    - uid: integer
  - name: properties.settingsDefinitionId
    description: The anomaly settings definition Id
    types:
    - uid: string
  - name: kind
    description: The kind of security ML Analytics Settings
    types:
    - uid: Anomaly
    typesTitle: string
  - name: etag
    description: Etag of the azure resource
    types:
    - uid: string
  - name: id
    isReadyOnly: true
    description: Fully qualified resource ID for the resource. Ex - /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{resourceType}/{resourceName}
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource. E.g. "Microsoft.Compute/virtualMachines" or "Microsoft.Storage/storageAccounts"
    types:
    - uid: string
  - name: systemData
    isReadyOnly: true
    description: Azure Resource Manager metadata containing createdBy and modifiedBy information.
    types:
    - uid: systemData
- name: systemData
  description: Metadata pertaining to creation and last modification of the resource.
  kind: object
  properties:
  - name: createdBy
    description: The identity that created the resource.
    types:
    - uid: string
  - name: createdByType
    description: The type of identity that created the resource.
    types:
    - uid: createdByType
  - name: createdAt
    description: The timestamp of resource creation (UTC).
    types:
    - uid: string
  - name: lastModifiedBy
    description: The identity that last modified the resource.
    types:
    - uid: string
  - name: lastModifiedByType
    description: The type of identity that last modified the resource.
    types:
    - uid: createdByType
  - name: lastModifiedAt
    description: The timestamp of resource last modification (UTC)
    types:
    - uid: string
- name: CloudError
  description: Error response structure.
  kind: object
  properties:
  - name: error
    description: Error data
    types:
    - uid: CloudErrorBody
- name: SecurityMLAnalyticsSettingsDataSource
  description: security ml analytics settings data sources
  kind: object
  properties:
  - name: connectorId
    description: The connector id that provides the following data types
    types:
    - uid: string
  - name: dataTypes
    description: The data types used by the security ml analytics settings
    types:
    - uid: string
      isArray: true
- name: SettingsStatus
  description: The anomaly SecurityMLAnalyticsSettings status
  kind: enum
  properties:
  - name: Production
    description: Anomaly settings status in Production mode
    types:
    - uid: string
  - name: Flighting
    description: Anomaly settings status in Flighting mode
    types:
    - uid: string
- name: createdByType
  description: The type of identity that created the resource.
  kind: enum
  properties:
  - name: User
    types:
    - uid: string
  - name: Application
    types:
    - uid: string
  - name: ManagedIdentity
    types:
    - uid: string
  - name: Key
    types:
    - uid: string
- name: CloudErrorBody
  description: Error details.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: An identifier for the error. Codes are invariant and are intended to be consumed programmatically.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: A message describing the error, intended to be suitable for display in a user interface.
    types:
    - uid: string
examples:
- name: Creates or updates a Anomaly Security ML Analytics Settings.
  request:
    uri: PUT https://management.azure.com/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/securityMLAnalyticsSettings/f209187f-1d17-4431-94af-c141bf5f23db?api-version=2022-07-01-preview
    body: >-
      {
        "kind": "Anomaly",
        "etag": "\"260090e2-0000-0d00-0000-5d6fb8670000\"",
        "properties": {
          "displayName": "Login from unusual region",
          "description": "When account logs from a source region that has rarely been logged in from during the last 14 days, an anomaly is triggered.",
          "enabled": true,
          "requiredDataConnectors": [
            {
              "connectorId": "AWS",
              "dataTypes": [
                "AWSCloudTrail"
              ]
            }
          ],
          "tactics": [
            "Exfiltration",
            "CommandAndControl"
          ],
          "techniques": [
            "T1037",
            "T1021"
          ],
          "anomalyVersion": "1.0.5",
          "customizableObservations": {
            "multiSelectObservations": null,
            "singleSelectObservations": [
              {
                "supportedValues": [
                  "Palo Alto Networks",
                  "Fortinet",
                  "Check Point"
                ],
                "value": [
                  "Palo Alto Networks"
                ],
                "supportedValuesKql": null,
                "valuesKql": null,
                "name": "Device vendor",
                "description": "Select device vendor of network connection logs from CommonSecurityLog",
                "sequenceNumber": 1,
                "rerun": "RerunAlways"
              }
            ],
            "prioritizeExcludeObservations": null,
            "thresholdObservations": [
              {
                "minimum": "1",
                "maximum": "100",
                "value": "25",
                "name": "Daily data transfer threshold in MB",
                "description": "Suppress anomalies when daily data transfered (in MB) per hour is less than the chosen value",
                "sequenceNumber": 1,
                "rerun": "RerunAlways"
              },
              {
                "minimum": "2",
                "maximum": "10",
                "value": "3",
                "name": "Number of standard deviations",
                "description": "Triggers anomalies when number of standard deviations is greater than the chosen value",
                "sequenceNumber": 2,
                "rerun": "RerunAlways"
              }
            ],
            "singleValueObservations": null
          },
          "frequency": "PT1H",
          "settingsStatus": "Production",
          "isDefaultSettings": true,
          "anomalySettingsVersion": 0,
          "settingsDefinitionId": "f209187f-1d17-4431-94af-c141bf5f23db"
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT https://management.azure.com/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/securityMLAnalyticsSettings/f209187f-1d17-4431-94af-c141bf5f23db?api-version=2022-07-01-preview

      {
        "kind": "Anomaly",
        "etag": "\"260090e2-0000-0d00-0000-5d6fb8670000\"",
        "properties": {
          "displayName": "Login from unusual region",
          "description": "When account logs from a source region that has rarely been logged in from during the last 14 days, an anomaly is triggered.",
          "enabled": true,
          "requiredDataConnectors": [
            {
              "connectorId": "AWS",
              "dataTypes": [
                "AWSCloudTrail"
              ]
            }
          ],
          "tactics": [
            "Exfiltration",
            "CommandAndControl"
          ],
          "techniques": [
            "T1037",
            "T1021"
          ],
          "anomalyVersion": "1.0.5",
          "customizableObservations": {
            "multiSelectObservations": null,
            "singleSelectObservations": [
              {
                "supportedValues": [
                  "Palo Alto Networks",
                  "Fortinet",
                  "Check Point"
                ],
                "value": [
                  "Palo Alto Networks"
                ],
                "supportedValuesKql": null,
                "valuesKql": null,
                "name": "Device vendor",
                "description": "Select device vendor of network connection logs from CommonSecurityLog",
                "sequenceNumber": 1,
                "rerun": "RerunAlways"
              }
            ],
            "prioritizeExcludeObservations": null,
            "thresholdObservations": [
              {
                "minimum": "1",
                "maximum": "100",
                "value": "25",
                "name": "Daily data transfer threshold in MB",
                "description": "Suppress anomalies when daily data transfered (in MB) per hour is less than the chosen value",
                "sequenceNumber": 1,
                "rerun": "RerunAlways"
              },
              {
                "minimum": "2",
                "maximum": "10",
                "value": "3",
                "name": "Number of standard deviations",
                "description": "Triggers anomalies when number of standard deviations is greater than the chosen value",
                "sequenceNumber": 2,
                "rerun": "RerunAlways"
              }
            ],
            "singleValueObservations": null
          },
          "frequency": "PT1H",
          "settingsStatus": "Production",
          "isDefaultSettings": true,
          "anomalySettingsVersion": 0,
          "settingsDefinitionId": "f209187f-1d17-4431-94af-c141bf5f23db"
        }
      }

      ```

      # [JavaScript](#tab/JavaScript)
      ``` js
      const { SecurityInsights } = require("@azure/arm-securityinsight");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Creates or updates the Security ML Analytics Settings.
       *
       * @summary Creates or updates the Security ML Analytics Settings.
       * x-ms-original-file: specification/securityinsights/resource-manager/Microsoft.SecurityInsights/preview/2022-07-01-preview/examples/securityMLAnalyticsSettings/CreateAnomalySecurityMLAnalyticsSetting.json
       */
      async function createsOrUpdatesAAnomalySecurityMlAnalyticsSettings() {
        const subscriptionId = "d0cfe6b2-9ac0-4464-9919-dccaee2e48c0";
        const resourceGroupName = "myRg";
        const workspaceName = "myWorkspace";
        const settingsResourceName = "f209187f-1d17-4431-94af-c141bf5f23db";
        const securityMLAnalyticsSetting = {
          description:
            "When account logs from a source region that has rarely been logged in from during the last 14 days, an anomaly is triggered.",
          anomalySettingsVersion: 0,
          anomalyVersion: "1.0.5",
          customizableObservations: {
            multiSelectObservations: null,
            prioritizeExcludeObservations: null,
            singleSelectObservations: [
              {
                name: "Device vendor",
                description: "Select device vendor of network connection logs from CommonSecurityLog",
                rerun: "RerunAlways",
                sequenceNumber: 1,
                supportedValues: ["Palo Alto Networks", "Fortinet", "Check Point"],
                supportedValuesKql: null,
                value: ["Palo Alto Networks"],
                valuesKql: null,
              },
            ],
            singleValueObservations: null,
            thresholdObservations: [
              {
                name: "Daily data transfer threshold in MB",
                description:
                  "Suppress anomalies when daily data transfered (in MB) per hour is less than the chosen value",
                maximum: "100",
                minimum: "1",
                rerun: "RerunAlways",
                sequenceNumber: 1,
                value: "25",
              },
              {
                name: "Number of standard deviations",
                description:
                  "Triggers anomalies when number of standard deviations is greater than the chosen value",
                maximum: "10",
                minimum: "2",
                rerun: "RerunAlways",
                sequenceNumber: 2,
                value: "3",
              },
            ],
          },
          displayName: "Login from unusual region",
          enabled: true,
          etag: '"260090e2-0000-0d00-0000-5d6fb8670000"',
          frequency: "PT1H",
          isDefaultSettings: true,
          kind: "Anomaly",
          requiredDataConnectors: [{ connectorId: "AWS", dataTypes: ["AWSCloudTrail"] }],
          settingsDefinitionId: "f209187f-1d17-4431-94af-c141bf5f23db",
          settingsStatus: "Production",
          tactics: ["Exfiltration", "CommandAndControl"],
          techniques: ["T1037", "T1021"],
        };
        const credential = new DefaultAzureCredential();
        const client = new SecurityInsights(credential, subscriptionId);
        const result = await client.securityMLAnalyticsSettings.createOrUpdate(
          resourceGroupName,
          workspaceName,
          settingsResourceName,
          securityMLAnalyticsSetting
        );
        console.log(result);
      }

      createsOrUpdatesAAnomalySecurityMlAnalyticsSettings().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-securityinsight_1.0.0-beta.4/sdk/securityinsight/arm-securityinsight/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalIinsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/securityMLAnalyticsSettings/f209187f-1d17-4431-94af-c141bf5f23db",
        "name": "f209187f-1d17-4431-94af-c141bf5f23db",
        "etag": "\"01005144-0000-0d00-0000-6058632c0000\"",
        "kind": "Anomaly",
        "type": "Microsoft.SecurityInsights/securityMLAnalyticsSettings",
        "properties": {
          "displayName": "Login from unusual region",
          "description": "When account logs from a source region that has rarely been logged in from during the last 14 days, an anomaly is triggered.",
          "enabled": true,
          "lastModifiedUtc": "2021-10-20T13:17:11.5340061Z",
          "requiredDataConnectors": [
            {
              "connectorId": "AWS",
              "dataTypes": [
                "AWSCloudTrail"
              ]
            }
          ],
          "tactics": [
            "Exfiltration",
            "CommandAndControl"
          ],
          "techniques": [
            "T1037",
            "T1021"
          ],
          "anomalyVersion": "1.0.5",
          "customizableObservations": {
            "multiSelectObservations": null,
            "singleSelectObservations": [
              {
                "supportedValues": [
                  "Palo Alto Networks",
                  "Fortinet",
                  "Check Point"
                ],
                "value": [
                  "Palo Alto Networks"
                ],
                "supportedValuesKql": null,
                "valuesKql": null,
                "name": "Device vendor",
                "description": "Select device vendor of network connection logs from CommonSecurityLog",
                "sequenceNumber": 1,
                "rerun": "RerunAlways"
              }
            ],
            "prioritizeExcludeObservations": null,
            "thresholdObservations": [
              {
                "minimum": "1",
                "maximum": "100",
                "value": "25",
                "name": "Daily data transfer threshold in MB",
                "description": "Suppress anomalies when daily data transfered (in MB) per hour is less than the chosen value",
                "sequenceNumber": 1,
                "rerun": "RerunAlways"
              },
              {
                "minimum": "2",
                "maximum": "10",
                "value": "3",
                "name": "Number of standard deviations",
                "description": "Triggers anomalies when number of standard deviations is greater than the chosen value",
                "sequenceNumber": 2,
                "rerun": "RerunAlways"
              }
            ],
            "singleValueObservations": null
          },
          "frequency": "PT1H",
          "settingsStatus": "Production",
          "isDefaultSettings": true,
          "anomalySettingsVersion": 0,
          "settingsDefinitionId": "f209187f-1d17-4431-94af-c141bf5f23db"
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalIinsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/securityMLAnalyticsSettings/f209187f-1d17-4431-94af-c141bf5f23db",
        "name": "f209187f-1d17-4431-94af-c141bf5f23db",
        "etag": "\"01007444-0000-0d00-0000-605863a70000\"",
        "kind": "Anomaly",
        "type": "Microsoft.SecurityInsights/securityMLAnalyticsSettings",
        "properties": {
          "displayName": "Login from unusual region",
          "description": "When account logs from a source region that has rarely been logged in from during the last 14 days, an anomaly is triggered.",
          "enabled": true,
          "lastModifiedUtc": "2021-10-20T13:17:11.5340061Z",
          "requiredDataConnectors": [
            {
              "connectorId": "AWS",
              "dataTypes": [
                "AWSCloudTrail"
              ]
            }
          ],
          "tactics": [
            "Exfiltration",
            "CommandAndControl"
          ],
          "techniques": [
            "T1037",
            "T1021"
          ],
          "anomalyVersion": "1.0.5",
          "customizableObservations": {
            "multiSelectObservations": null,
            "singleSelectObservations": [
              {
                "supportedValues": [
                  "Palo Alto Networks",
                  "Fortinet",
                  "Check Point"
                ],
                "value": [
                  "Palo Alto Networks"
                ],
                "supportedValuesKql": null,
                "valuesKql": null,
                "name": "Device vendor",
                "description": "Select device vendor of network connection logs from CommonSecurityLog",
                "sequenceNumber": 1,
                "rerun": "RerunAlways"
              }
            ],
            "prioritizeExcludeObservations": null,
            "thresholdObservations": [
              {
                "minimum": "1",
                "maximum": "100",
                "value": "25",
                "name": "Daily data transfer threshold in MB",
                "description": "Suppress anomalies when daily data transfered (in MB) per hour is less than the chosen value",
                "sequenceNumber": 1,
                "rerun": "RerunAlways"
              },
              {
                "minimum": "2",
                "maximum": "10",
                "value": "3",
                "name": "Number of standard deviations",
                "description": "Triggers anomalies when number of standard deviations is greater than the chosen value",
                "sequenceNumber": 2,
                "rerun": "RerunAlways"
              }
            ],
            "singleValueObservations": null
          },
          "frequency": "PT1H",
          "settingsStatus": "Production",
          "isDefaultSettings": true,
          "anomalySettingsVersion": 0,
          "settingsDefinitionId": "f209187f-1d17-4431-94af-c141bf5f23db"
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about Sentinel service - Creates or updates the Security ML Analytics Settings.
errorCodes: []
