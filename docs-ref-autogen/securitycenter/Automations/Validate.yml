### YamlMime:RESTOperation
uid: management.azure.com.securitycenter.automations.validate
name: Validate
service: Security Center
groupName: Automations
apiVersion: 2019-01-01-preview
summary: Validates the security automation model before create or update. Any validation errors are returned to the client.
consumes:
- application/json
produces:
- application/json
paths:
- content: POST https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Security/automations/{automationName}/validate?api-version=2019-01-01-preview
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: Azure subscription ID
  types:
  - uid: string
  pattern: ^[0-9A-Fa-f]{8}-([0-9A-Fa-f]{4}-){3}[0-9A-Fa-f]{12}$
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group within the user's subscription. The name is case insensitive.
  types:
  - uid: string
  pattern: ^[-\w\._\(\)]+$
- name: automationName
  in: path
  isRequired: true
  description: The security automation name.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: API version for the operation
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK
  types:
  - uid: AutomationValidationStatus
- name: Other Status Codes
  description: Error response that describes why the operation failed.
  types:
  - uid: CloudError
requestBody:
- name: default
  parameters:
  - name: properties.description
    in: body
    description: The security automation description.
    types:
    - uid: string
  - name: properties.isEnabled
    in: body
    description: Indicates whether the security automation is enabled.
    types:
    - uid: boolean
  - name: properties.scopes
    in: body
    description: A collection of scopes on which the security automations logic is applied. Supported scopes are the subscription itself or a resource group under that subscription. The automation will only apply on defined scopes.
    types:
    - uid: AutomationScope
      isArray: true
  - name: properties.sources
    in: body
    description: A collection of the source event types which evaluate the security automation set of rules.
    types:
    - uid: AutomationSource
      isArray: true
  - name: properties.actions
    in: body
    description: A collection of the actions which are triggered if all the configured rules evaluations, within at least one rule set, are true.
    types:
    - uid: AutomationActionLogicApp
      isArray: true
    - uid: AutomationActionEventHub
      isArray: true
    - uid: AutomationActionWorkspace
      isArray: true
    typesTitle: AutomationAction[]
  - name: location
    in: body
    description: Location where the resource is stored
    types:
    - uid: string
  - name: kind
    in: body
    description: Kind of the resource
    types:
    - uid: string
  - name: etag
    in: body
    description: Entity tag is used for comparing two or more entities from the same requested resource.
    types:
    - uid: string
  - name: tags
    in: body
    description: A list of key value pairs that describe the resource.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
requestHeader: []
definitions:
- name: AutomationScope
  description: A single automation scope.
  kind: object
  properties:
  - name: description
    description: The resources scope description.
    types:
    - uid: string
  - name: scopePath
    description: The resources scope path. Can be the subscription on which the automation is defined on or a resource group under that subscription (fully qualified Azure resource IDs).
    types:
    - uid: string
- name: AutomationSource
  description: The source event types which evaluate the security automation set of rules. For example - security alerts and security assessments. To learn more about the supported security events data models schemas - please visit https://aka.ms/ASCAutomationSchemas.
  kind: object
  properties:
  - name: eventSource
    description: A valid event source type.
    types:
    - uid: EventSource
  - name: ruleSets
    description: A set of rules which evaluate upon event interception. A logical disjunction is applied between defined rule sets (logical 'or').
    types:
    - uid: AutomationRuleSet
      isArray: true
- name: AutomationValidationStatus
  description: The security automation model state property bag.
  kind: object
  properties:
  - name: isValid
    description: Indicates whether the model is valid or not.
    types:
    - uid: boolean
  - name: message
    description: The validation message.
    types:
    - uid: string
- name: CloudError
  description: Common error response for all Azure Resource Manager APIs to return error details for failed operations. (This also follows the OData error response format.).
  kind: object
  properties:
  - name: error.code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: error.message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: error.target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: error.details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: CloudErrorBody
      isArray: true
  - name: error.additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: Automation
  description: The security automation resource.
  kind: object
  properties:
  - name: properties.description
    description: The security automation description.
    types:
    - uid: string
  - name: properties.isEnabled
    description: Indicates whether the security automation is enabled.
    types:
    - uid: boolean
  - name: properties.scopes
    description: A collection of scopes on which the security automations logic is applied. Supported scopes are the subscription itself or a resource group under that subscription. The automation will only apply on defined scopes.
    types:
    - uid: AutomationScope
      isArray: true
  - name: properties.sources
    description: A collection of the source event types which evaluate the security automation set of rules.
    types:
    - uid: AutomationSource
      isArray: true
  - name: properties.actions
    description: A collection of the actions which are triggered if all the configured rules evaluations, within at least one rule set, are true.
    types:
    - uid: AutomationActionLogicApp
      isArray: true
    - uid: AutomationActionEventHub
      isArray: true
    - uid: AutomationActionWorkspace
      isArray: true
    typesTitle: AutomationAction[]
  - name: id
    isReadyOnly: true
    description: Resource Id
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource name
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type
    types:
    - uid: string
  - name: location
    description: Location where the resource is stored
    types:
    - uid: string
  - name: kind
    description: Kind of the resource
    types:
    - uid: string
  - name: etag
    description: Entity tag is used for comparing two or more entities from the same requested resource.
    types:
    - uid: string
  - name: tags
    description: A list of key value pairs that describe the resource.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: EventSource
  description: A valid event source type.
  kind: enum
  properties:
  - name: Assessments
    types:
    - uid: string
  - name: AssessmentsSnapshot
    types:
    - uid: string
  - name: SubAssessments
    types:
    - uid: string
  - name: SubAssessmentsSnapshot
    types:
    - uid: string
  - name: Alerts
    types:
    - uid: string
  - name: SecureScores
    types:
    - uid: string
  - name: SecureScoresSnapshot
    types:
    - uid: string
  - name: SecureScoreControls
    types:
    - uid: string
  - name: SecureScoreControlsSnapshot
    types:
    - uid: string
  - name: RegulatoryComplianceAssessment
    types:
    - uid: string
  - name: RegulatoryComplianceAssessmentSnapshot
    types:
    - uid: string
- name: AutomationRuleSet
  description: A rule set which evaluates all its rules upon an event interception. Only when all the included rules in the rule set will be evaluated as 'true', will the event trigger the defined actions.
  kind: object
  properties:
  - name: rules
    description: A rule which is evaluated upon event interception. The rule is configured by comparing a specific value from the event model to an expected value. This comparison is done by using one of the supported operators set.
    types:
    - uid: AutomationTriggeringRule
      isArray: true
- name: AutomationActionLogicApp
  description: The logic app action that should be triggered. To learn more about Microsoft Defender for Cloud's Workflow Automation capabilities, visit https://aka.ms/ASCWorkflowAutomationLearnMore
  kind: object
  properties:
  - name: logicAppResourceId
    description: The triggered Logic App Azure Resource ID. This can also reside on other subscriptions, given that you have permissions to trigger the Logic App
    types:
    - uid: string
  - name: uri
    description: The Logic App trigger URI endpoint (it will not be included in any response).
    types:
    - uid: string
  - name: actionType
    description: The type of the action that will be triggered by the Automation
    types:
    - uid: LogicApp
    typesTitle: string
- name: AutomationActionEventHub
  description: The target Event Hub to which event data will be exported. To learn more about Microsoft Defender for Cloud continuous export capabilities, visit https://aka.ms/ASCExportLearnMore
  kind: object
  properties:
  - name: eventHubResourceId
    description: The target Event Hub Azure Resource ID.
    types:
    - uid: string
  - name: sasPolicyName
    isReadyOnly: true
    description: The target Event Hub SAS policy name.
    types:
    - uid: string
  - name: connectionString
    description: The target Event Hub connection string (it will not be included in any response).
    types:
    - uid: string
  - name: actionType
    description: The type of the action that will be triggered by the Automation
    types:
    - uid: EventHub
    typesTitle: string
- name: AutomationActionWorkspace
  description: The Log Analytics Workspace to which event data will be exported. Security alerts data will reside in the 'SecurityAlert' table and the assessments data will reside in the 'SecurityRecommendation' table (under the 'Security'/'SecurityCenterFree' solutions). Note that in order to view the data in the workspace, the Security Center Log Analytics free/standard solution needs to be enabled on that workspace. To learn more about Microsoft Defender for Cloud continuous export capabilities, visit https://aka.ms/ASCExportLearnMore
  kind: object
  properties:
  - name: workspaceResourceId
    description: The fully qualified Log Analytics Workspace Azure Resource ID.
    types:
    - uid: string
  - name: actionType
    description: The type of the action that will be triggered by the Automation
    types:
    - uid: Workspace
    typesTitle: string
- name: CloudErrorBody
  description: The error detail.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: The error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: The error message.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: The error target.
    types:
    - uid: string
  - name: details
    isReadyOnly: true
    description: The error details.
    types:
    - uid: CloudErrorBody
      isArray: true
  - name: additionalInfo
    isReadyOnly: true
    description: The error additional info.
    types:
    - uid: ErrorAdditionalInfo
      isArray: true
- name: ErrorAdditionalInfo
  description: The resource management error additional info.
  kind: object
  properties:
  - name: type
    isReadyOnly: true
    description: The additional info type.
    types:
    - uid: string
  - name: info
    isReadyOnly: true
    description: The additional info.
    types:
    - uid: object
- name: AutomationTriggeringRule
  description: A rule which is evaluated upon event interception. The rule is configured by comparing a specific value from the event model to an expected value. This comparison is done by using one of the supported operators set.
  kind: object
  properties:
  - name: propertyJPath
    description: The JPath of the entity model property that should be checked.
    types:
    - uid: string
  - name: propertyType
    description: The data type of the compared operands (string, integer, floating point number or a boolean [true/false]]
    types:
    - uid: PropertyType
  - name: expectedValue
    description: The expected value.
    types:
    - uid: string
  - name: operator
    description: A valid comparer operator to use. A case-insensitive comparison will be applied for String PropertyType.
    types:
    - uid: Operator
- name: PropertyType
  description: The data type of the compared operands (string, integer, floating point number or a boolean [true/false]]
  kind: enum
  properties:
  - name: String
    types:
    - uid: string
  - name: Integer
    types:
    - uid: string
  - name: Number
    types:
    - uid: string
  - name: Boolean
    types:
    - uid: string
- name: Operator
  description: A valid comparer operator to use. A case-insensitive comparison will be applied for String PropertyType.
  kind: enum
  properties:
  - name: Equals
    description: Applies for decimal and non-decimal operands
    types:
    - uid: string
  - name: GreaterThan
    description: Applies only for decimal operands
    types:
    - uid: string
  - name: GreaterThanOrEqualTo
    description: Applies only for decimal operands
    types:
    - uid: string
  - name: LesserThan
    description: Applies only for decimal operands
    types:
    - uid: string
  - name: LesserThanOrEqualTo
    description: Applies only for decimal operands
    types:
    - uid: string
  - name: NotEquals
    description: Applies  for decimal and non-decimal operands
    types:
    - uid: string
  - name: Contains
    description: Applies only for non-decimal operands
    types:
    - uid: string
  - name: StartsWith
    description: Applies only for non-decimal operands
    types:
    - uid: string
  - name: EndsWith
    description: Applies only for non-decimal operands
    types:
    - uid: string
examples:
- name: Validate the security automation model before create or update
  request:
    uri: POST https://management.azure.com/subscriptions/a5caac9c-5c04-49af-b3d0-e204f40345d5/resourceGroups/exampleResourceGroup/providers/Microsoft.Security/automations/exampleAutomation/validate?api-version=2019-01-01-preview
    body: >-
      {
        "location": "Central US",
        "tags": {},
        "properties": {
          "description": "An example of a security automation that triggers one LogicApp resource (myTest1) on any security assessment of type customAssessment",
          "isEnabled": true,
          "scopes": [
            {
              "description": "A description that helps to identify this scope - for example: security assessments that relate to the resource group myResourceGroup within the subscription a5caac9c-5c04-49af-b3d0-e204f40345d5",
              "scopePath": "/subscriptions/a5caac9c-5c04-49af-b3d0-e204f40345d5/resourceGroups/myResourceGroup"
            }
          ],
          "sources": [
            {
              "eventSource": "Assessments",
              "ruleSets": [
                {
                  "rules": [
                    {
                      "propertyJPath": "$.Entity.AssessmentType",
                      "propertyType": "String",
                      "expectedValue": "customAssessment",
                      "operator": "Equals"
                    }
                  ]
                }
              ]
            }
          ],
          "actions": [
            {
              "logicAppResourceId": "/subscriptions/e54a4a18-5b94-4f90-9471-bd3decad8a2e/resourceGroups/sample/providers/Microsoft.Logic/workflows/MyTest1",
              "actionType": "LogicApp",
              "uri": "https://exampleTriggerUri1.com"
            }
          ]
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/subscriptions/a5caac9c-5c04-49af-b3d0-e204f40345d5/resourceGroups/exampleResourceGroup/providers/Microsoft.Security/automations/exampleAutomation/validate?api-version=2019-01-01-preview

      {
        "location": "Central US",
        "tags": {},
        "properties": {
          "description": "An example of a security automation that triggers one LogicApp resource (myTest1) on any security assessment of type customAssessment",
          "isEnabled": true,
          "scopes": [
            {
              "description": "A description that helps to identify this scope - for example: security assessments that relate to the resource group myResourceGroup within the subscription a5caac9c-5c04-49af-b3d0-e204f40345d5",
              "scopePath": "/subscriptions/a5caac9c-5c04-49af-b3d0-e204f40345d5/resourceGroups/myResourceGroup"
            }
          ],
          "sources": [
            {
              "eventSource": "Assessments",
              "ruleSets": [
                {
                  "rules": [
                    {
                      "propertyJPath": "$.Entity.AssessmentType",
                      "propertyType": "String",
                      "expectedValue": "customAssessment",
                      "operator": "Equals"
                    }
                  ]
                }
              ]
            }
          ],
          "actions": [
            {
              "logicAppResourceId": "/subscriptions/e54a4a18-5b94-4f90-9471-bd3decad8a2e/resourceGroups/sample/providers/Microsoft.Logic/workflows/MyTest1",
              "actionType": "LogicApp",
              "uri": "https://exampleTriggerUri1.com"
            }
          ]
        }
      }

      ```

      # [Go](#tab/Go)
      ``` go
      package armsecurity_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"
      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/security/armsecurity"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/security/resource-manager/Microsoft.Security/preview/2019-01-01-preview/examples/Automations/ValidateAutomation_example.json
      func ExampleAutomationsClient_Validate() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armsecurity.NewAutomationsClient("a5caac9c-5c04-49af-b3d0-e204f40345d5", cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	res, err := client.Validate(ctx,
      		"exampleResourceGroup",
      		"exampleAutomation",
      		armsecurity.Automation{
      			Location: to.Ptr("Central US"),
      			Tags:     map[string]*string{},
      			Properties: &armsecurity.AutomationProperties{
      				Description: to.Ptr("An example of a security automation that triggers one LogicApp resource (myTest1) on any security assessment of type customAssessment"),
      				Actions: []armsecurity.AutomationActionClassification{
      					&armsecurity.AutomationActionLogicApp{
      						ActionType:         to.Ptr(armsecurity.ActionTypeLogicApp),
      						LogicAppResourceID: to.Ptr("/subscriptions/e54a4a18-5b94-4f90-9471-bd3decad8a2e/resourceGroups/sample/providers/Microsoft.Logic/workflows/MyTest1"),
      						URI:                to.Ptr("https://exampleTriggerUri1.com"),
      					}},
      				IsEnabled: to.Ptr(true),
      				Scopes: []*armsecurity.AutomationScope{
      					{
      						Description: to.Ptr("A description that helps to identify this scope - for example: security assessments that relate to the resource group myResourceGroup within the subscription a5caac9c-5c04-49af-b3d0-e204f40345d5"),
      						ScopePath:   to.Ptr("/subscriptions/a5caac9c-5c04-49af-b3d0-e204f40345d5/resourceGroups/myResourceGroup"),
      					}},
      				Sources: []*armsecurity.AutomationSource{
      					{
      						EventSource: to.Ptr(armsecurity.EventSourceAssessments),
      						RuleSets: []*armsecurity.AutomationRuleSet{
      							{
      								Rules: []*armsecurity.AutomationTriggeringRule{
      									{
      										ExpectedValue: to.Ptr("customAssessment"),
      										Operator:      to.Ptr(armsecurity.OperatorEquals),
      										PropertyJPath: to.Ptr("$.Entity.AssessmentType"),
      										PropertyType:  to.Ptr(armsecurity.PropertyTypeString),
      									}},
      							}},
      					}},
      			},
      		},
      		nil)
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fsecurity%2Farmsecurity%2Fv0.7.0/sdk/resourcemanager/security/armsecurity/README.md) on how to add the SDK to your project and authenticate.
      # [JavaScript](#tab/JavaScript)
      ``` js
      const { SecurityCenter } = require("@azure/arm-security");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Validates the security automation model before create or update. Any validation errors are returned to the client.
       *
       * @summary Validates the security automation model before create or update. Any validation errors are returned to the client.
       * x-ms-original-file: specification/security/resource-manager/Microsoft.Security/preview/2019-01-01-preview/examples/Automations/ValidateAutomation_example.json
       */
      async function validateTheSecurityAutomationModelBeforeCreateOrUpdate() {
        const subscriptionId = "a5caac9c-5c04-49af-b3d0-e204f40345d5";
        const resourceGroupName = "exampleResourceGroup";
        const automationName = "exampleAutomation";
        const automation = {
          description:
            "An example of a security automation that triggers one LogicApp resource (myTest1) on any security assessment of type customAssessment",
          actions: [
            {
              actionType: "LogicApp",
              logicAppResourceId:
                "/subscriptions/e54a4a18-5b94-4f90-9471-bd3decad8a2e/resourceGroups/sample/providers/Microsoft.Logic/workflows/MyTest1",
              uri: "https://exampleTriggerUri1.com",
            },
          ],
          isEnabled: true,
          location: "Central US",
          scopes: [
            {
              description:
                "A description that helps to identify this scope - for example: security assessments that relate to the resource group myResourceGroup within the subscription a5caac9c-5c04-49af-b3d0-e204f40345d5",
              scopePath:
                "/subscriptions/a5caac9c-5c04-49af-b3d0-e204f40345d5/resourceGroups/myResourceGroup",
            },
          ],
          sources: [
            {
              eventSource: "Assessments",
              ruleSets: [
                {
                  rules: [
                    {
                      expectedValue: "customAssessment",
                      operator: "Equals",
                      propertyJPath: "$.Entity.AssessmentType",
                      propertyType: "String",
                    },
                  ],
                },
              ],
            },
          ],
          tags: {},
        };
        const credential = new DefaultAzureCredential();
        const client = new SecurityCenter(credential, subscriptionId);
        const result = await client.automations.validate(resourceGroupName, automationName, automation);
        console.log(result);
      }

      validateTheSecurityAutomationModelBeforeCreateOrUpdate().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-security_5.0.0/sdk/security/arm-security/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "isValid": true,
        "message": "Validation Successful"
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Validates the security automation model before create or update. Any validation errors are returned to the client.
errorCodes: []
