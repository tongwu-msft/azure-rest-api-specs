### YamlMime:RESTOperation
uid: management.azure.com.datamigration.services.createorupdate
name: Create Or Update
service: Data Migration
groupName: Services
apiVersion: 2022-01-30-preview
summary: "Create or update DMS Instance  \nThe services resource is the top-level resource that represents the Database Migration Service. The PUT method creates a new service or updates an existing one. When a service is updated, existing child resources (i.e. tasks) are unaffected. Services currently support a single kind, \"vm\", which refers to a VM-based service, although other kinds may be added in the future. This method can change the kind, SKU, and network of the service, but if tasks are currently running (i.e. the service is busy), this will fail with 400 Bad Request (\"ServiceIsBusy\"). The provider will reply when successful with 200 OK or 201 Created. Long-running operations use the provisioningState property."
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{groupName}/providers/Microsoft.DataMigration/services/{serviceName}?api-version=2022-01-30-preview
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: Subscription ID that identifies an Azure subscription.
  types:
  - uid: string
- name: groupName
  in: path
  isRequired: true
  description: Name of the resource group
  types:
  - uid: string
- name: serviceName
  in: path
  isRequired: true
  description: Name of the service
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: Version of the API
  types:
  - uid: string
responses:
- name: 200 OK
  description: Service updated
  types:
  - uid: DataMigrationService
- name: 201 Created
  description: Service created (use provisioningState)
  types:
  - uid: DataMigrationService
- name: 202 Accepted
  description: Update accepted
- name: Other Status Codes
  description: Error
  types:
  - uid: ApiError
requestBody:
- name: default
  parameters:
  - name: etag
    in: body
    description: HTTP strong entity tag value. Ignored if submitted
    types:
    - uid: string
  - name: kind
    in: body
    description: The resource kind. Only 'vm' (the default) is supported.
    types:
    - uid: string
  - name: sku
    in: body
    description: Service SKU
    types:
    - uid: ServiceSku
  - name: properties.publicKey
    in: body
    description: The public key of the service, used to encrypt secrets sent to the service
    types:
    - uid: string
  - name: properties.virtualSubnetId
    in: body
    description: The ID of the Microsoft.Network/virtualNetworks/subnets resource to which the service should be joined
    types:
    - uid: string
  - name: properties.virtualNicId
    in: body
    description: The ID of the Microsoft.Network/networkInterfaces resource which the service have
    types:
    - uid: string
  - name: properties.autoStopDelay
    in: body
    description: The time delay before the service is auto-stopped when idle.
    types:
    - uid: string
  - name: properties.deleteResourcesOnStop
    in: body
    description: Whether service resources should be deleted when stopped. (Turned on by default)
    types:
    - uid: boolean
  - name: location
    in: body
    description: ''
    types:
    - uid: string
  - name: tags
    in: body
    description: ''
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
requestHeader: []
definitions:
- name: ServiceSku
  description: An Azure SKU instance
  kind: object
  properties:
  - name: name
    description: The unique name of the SKU, such as 'P3'
    types:
    - uid: string
  - name: tier
    description: The tier of the SKU, such as 'Basic', 'General Purpose', or 'Business Critical'
    types:
    - uid: string
  - name: family
    description: The SKU family, used when the service has multiple performance classes within a tier, such as 'A', 'D', etc. for virtual machines
    types:
    - uid: string
  - name: size
    description: The size of the SKU, used when the name alone does not denote a service size or when a SKU has multiple performance classes within a family, e.g. 'A1' for virtual machines
    types:
    - uid: string
  - name: capacity
    description: The capacity of the SKU, if it supports scaling
    types:
    - uid: integer
- name: SystemData
  kind: object
  properties:
  - name: createdBy
    description: ''
    types:
    - uid: string
  - name: createdByType
    description: ''
    types:
    - uid: createdByType
  - name: createdAt
    description: ''
    types:
    - uid: string
  - name: lastModifiedBy
    description: ''
    types:
    - uid: string
  - name: lastModifiedByType
    description: ''
    types:
    - uid: createdByType
  - name: lastModifiedAt
    description: ''
    types:
    - uid: string
- name: DataMigrationService
  description: A Database Migration Service resource
  kind: object
  properties:
  - name: etag
    description: HTTP strong entity tag value. Ignored if submitted
    types:
    - uid: string
  - name: kind
    description: The resource kind. Only 'vm' (the default) is supported.
    types:
    - uid: string
  - name: sku
    description: Service SKU
    types:
    - uid: ServiceSku
  - name: systemData
    isReadyOnly: true
    description: Metadata pertaining to creation and last modification of the resource.
    types:
    - uid: SystemData
  - name: properties.provisioningState
    isReadyOnly: true
    description: The resource's provisioning state
    types:
    - uid: ServiceProvisioningState
  - name: properties.publicKey
    description: The public key of the service, used to encrypt secrets sent to the service
    types:
    - uid: string
  - name: properties.virtualSubnetId
    description: The ID of the Microsoft.Network/virtualNetworks/subnets resource to which the service should be joined
    types:
    - uid: string
  - name: properties.virtualNicId
    description: The ID of the Microsoft.Network/networkInterfaces resource which the service have
    types:
    - uid: string
  - name: properties.autoStopDelay
    description: The time delay before the service is auto-stopped when idle.
    types:
    - uid: string
  - name: properties.deleteResourcesOnStop
    description: Whether service resources should be deleted when stopped. (Turned on by default)
    types:
    - uid: boolean
  - name: location
    description: ''
    types:
    - uid: string
  - name: tags
    description: ''
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: id
    isReadyOnly: true
    description: ''
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: ''
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: ''
    types:
    - uid: string
- name: ApiError
  description: Error information.
  kind: object
  properties:
  - name: error
    description: Error information in OData format
    types:
    - uid: ODataError
  - name: systemData
    isReadyOnly: true
    description: Metadata pertaining to creation and last modification of the resource.
    types:
    - uid: SystemData
- name: createdByType
  kind: enum
  properties:
  - name: User
    types:
    - uid: string
  - name: Application
    types:
    - uid: string
  - name: ManagedIdentity
    types:
    - uid: string
  - name: Key
    types:
    - uid: string
- name: ServiceProvisioningState
  description: The resource's provisioning state
  kind: enum
  properties:
  - name: Accepted
    types:
    - uid: string
  - name: Deleting
    types:
    - uid: string
  - name: Deploying
    types:
    - uid: string
  - name: Stopped
    types:
    - uid: string
  - name: Stopping
    types:
    - uid: string
  - name: Starting
    types:
    - uid: string
  - name: FailedToStart
    types:
    - uid: string
  - name: FailedToStop
    types:
    - uid: string
  - name: Succeeded
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
- name: ODataError
  description: Error information in OData format.
  kind: object
  properties:
  - name: code
    description: The machine-readable description of the error, such as 'InvalidRequest' or 'InternalServerError'
    types:
    - uid: string
  - name: message
    description: The human-readable description of the error
    types:
    - uid: string
  - name: details
    description: Inner errors that caused this error
    types:
    - uid: ODataError
      isArray: true
examples:
- name: Services_CreateOrUpdate
  request:
    uri: PUT https://management.azure.com/subscriptions/fc04246f-04c5-437e-ac5e-206a19e7193f/resourceGroups/DmsSdkRg/providers/Microsoft.DataMigration/services/DmsSdkService?api-version=2022-01-30-preview
    body: >-
      {
        "properties": {
          "virtualSubnetId": "/subscriptions/fc04246f-04c5-437e-ac5e-206a19e7193f/resourceGroups/DmsSdkTestNetwork/providers/Microsoft.Network/virtualNetworks/DmsSdkTestNetwork/subnets/default"
        },
        "sku": {
          "name": "Basic_1vCore"
        },
        "location": "southcentralus"
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "properties": {
          "provisioningState": "Accepted",
          "virtualSubnetId": "/subscriptions/fc04246f-04c5-437e-ac5e-206a19e7193f/resourceGroups/DmsSdkTestNetwork/providers/Microsoft.Network/virtualNetworks/DmsSdkTestNetwork/subnets/default"
        },
        "etag": "9QuK/U0GvTJpjIrlOzITXVy68+bmmQ3bFkHudLxmkUw=",
        "id": "/subscriptions/fc04246f-04c5-437e-ac5e-206a19e7193f/resourceGroups/DmsSdkRg/providers/Microsoft.DataMigration/services/DmsSdkService",
        "location": "southcentralus",
        "name": "DmsSdkService",
        "sku": {
          "name": "Basic_1vCore",
          "size": "1 vCore",
          "tier": "Basic"
        },
        "type": "Microsoft.DataMigration/services"
      }
  - statusCode: "201"
    body: >-
      {
        "properties": {
          "provisioningState": "Accepted",
          "virtualSubnetId": "/subscriptions/fc04246f-04c5-437e-ac5e-206a19e7193f/resourceGroups/DmsSdkTestNetwork/providers/Microsoft.Network/virtualNetworks/DmsSdkTestNetwork/subnets/default"
        },
        "etag": "9QuK/U0GvTJpjIrlOzITXVy68+bmmQ3bFkHudLxmkUw=",
        "id": "/subscriptions/fc04246f-04c5-437e-ac5e-206a19e7193f/resourceGroups/DmsSdkRg/providers/Microsoft.DataMigration/services/DmsSdkService",
        "location": "southcentralus",
        "name": "DmsSdkService",
        "sku": {
          "name": "Basic_1vCore",
          "size": "1 vCore",
          "tier": "Basic"
        },
        "type": "Microsoft.DataMigration/services"
      }
  - statusCode: "202"
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: "Create or update DMS Instance  \nThe services resource is the top-level resource that represents the Database Migration Service."
errorCodes: []
