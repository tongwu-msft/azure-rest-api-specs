### YamlMime:RESTOperation
uid: management.azure.com.datamigration.databasemigrationssqlvm.get
name: Get
service: Data Migration
groupName: Database Migrations SQL VM
apiVersion: 2022-01-30-preview
summary: Retrieve the specified database migration for a given SQL VM.
consumes:
- application/json
produces:
- application/json
paths:
- content: GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.SqlVirtualMachine/sqlVirtualMachines/{sqlVirtualMachineName}/providers/Microsoft.DataMigration/databaseMigrations/{targetDbName}?api-version=2022-01-30-preview
- content: GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.SqlVirtualMachine/sqlVirtualMachines/{sqlVirtualMachineName}/providers/Microsoft.DataMigration/databaseMigrations/{targetDbName}?migrationOperationId={migrationOperationId}&$expand={$expand}&api-version=2022-01-30-preview
  isOptional: true
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: Subscription ID that identifies an Azure subscription.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: Name of the resource group that contains the resource. You can obtain this value from the Azure Resource Manager API or the portal.
  types:
  - uid: string
- name: sqlVirtualMachineName
  in: path
  isRequired: true
  types:
  - uid: string
- name: targetDbName
  in: path
  isRequired: true
  description: The name of the target database.
  types:
  - uid: string
- name: migrationOperationId
  in: query
  description: Optional migration operation ID. If this is provided, then details of migration operation for that ID are retrieved. If not provided (default), then details related to most recent or current operation are retrieved.
  types:
  - uid: string
  format: uuid
- name: $expand
  in: query
  description: The child resources to include in the response.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: API version to use for the request.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Successfully retrieved the Database Migration resource.
  types:
  - uid: DatabaseMigrationSqlVm
- name: Other Status Codes
  description: >-
    *** Error Responses: ***

     * 400 InvalidParameterValue - An invalid value was provided for parameter '{0}'.

     * 400 GenericUser - User Failure when calling other Resource Provider.

     * 400 OperationIdNotFound - Operation ID '{0}' not found.

     * 400 OperationTypeNotFound - Operation Type '{0}' not found.

     * 400 InvalidArgument - Invalid argument '{0}'.

     * 400 TestConnectionFailed - Failed to test connections using provided Integration Runtime. Error details: '{0}'

     * 400 CutoverNotAllowedMigrationCompleteError - Cutover is not allowed as migration for database '{0}' is already complete

     * 400 IntegrationRuntimeIsNotOnline - Integration Runtime '{0}' is not online for resource group '{1}' subscription '{2}'

     * 400 InvalidStorageAccount - Invalid storage account: '{0}'. Only BlockBlobStorage kind is supported for premium tier.

     * 400 InvalidLocation - Invalid Location: '{0}'. Location should match selected Azure target location '{1}'.

     * 400 MigrationNotReadyForCancelError - Database '{0}' is not ready for Cancel operation

     * 400 RestoreJobCompletedDuringCancel - Migration cannot be canceled as Restore Job was completed during the cancel process. Target server:'{0}', Target database: '{1}'.

     * 400 SqlVmGenericUserError - {0}

     * 400 RequestFailed - Request to the resource '{0}' failed. Error code : '{1}'. HTTP status code : '{2}'. Error message : '{3}'.

     * 400 InvalidContainerName - Invalid storage account container name: '{0}'. Container name 'backup' is not supported in SQL Managed Instance.

     * 400 IntegrationRuntimeIsNotSelfHosted - Integration Runtime is not self-hosted for subscription '{0}' resource group '{1}' and name '{2}'

     * 400 MigrationNotReadyForCutoverError - Database '{0}' is not ready for Cutover operation

     * 400 CutoverFailedOrCancelled - Cutover failed or cancelled for database '{0}'. Error details: '{1}'

     * 400 MigrationCancelFailed - Cancel could not be performed on operation '{0}' for database '{1}'. This can happen if the migration with MigrationId '{0}' is already completed or canceled. Please check the migration for details.

     * 403 AccessDenied - Access denied.

     * 404 ResourceNotFound - The requested resource was not found.

     * 404 SubscriptionDoesNotExist - Subscription id does not exist.

     * 404 ResourceDoesNotExist - Resource does not exist.

     * 405 SubscriptionNotReady - Subscription is not in Ready state.

     * 409 OperationInProgress - Operation in progress on resource already.

     * 409 OperationCanceled - Operation Cancelled.

     * 409 ResourceAlreadyExists - Resource already exists.

     * 409 SubscriptionOperationInProgress - An operation on subscription is already in progress

     * 500 UnExpectedErrorOccurred - Unexpected error occurred.

     * 500 OperationTimeout - Operation timed out.

     * 500 GenericSystem - System Failure when calling other Resource Provider.

     * 500 CancelVmRestoreJobFailed - Failed to cancel VM restore job. Target server:'{0}', Target database: '{1}', Error details: '{2}'.

     * 500 AdfCleanupFailureAfterMigration - Failed to clean up ADF resources after migration has completed successfully. Target server:'{0}', Target database: '{1}', Error details: '{2}'.

     * 500 CancelMigrationFailed - Failed to cancel migration. Target server:'{0}', Target database: '{1}', Migration Id: '{2}', Error details: '{3}'.
requestHeader: []
definitions:
- name: DatabaseMigrationSqlVm
  description: Database Migration Resource for SQL Virtual Machine.
  kind: object
  properties:
  - name: systemData
    isReadyOnly: true
    description: Metadata pertaining to creation and last modification of the resource.
    types:
    - uid: SystemData
  - name: properties
    description: Database Migration Resource properties for SQL Virtual Machine.
    types:
    - uid: DatabaseMigrationPropertiesSqlVm
  - name: id
    isReadyOnly: true
    description: ''
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: ''
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: ''
    types:
    - uid: string
- name: SystemData
  kind: object
  properties:
  - name: createdBy
    description: ''
    types:
    - uid: string
  - name: createdByType
    description: ''
    types:
    - uid: createdByType
  - name: createdAt
    description: ''
    types:
    - uid: string
  - name: lastModifiedBy
    description: ''
    types:
    - uid: string
  - name: lastModifiedByType
    description: ''
    types:
    - uid: createdByType
  - name: lastModifiedAt
    description: ''
    types:
    - uid: string
- name: DatabaseMigrationPropertiesSqlVm
  description: Database Migration Resource properties for SQL Virtual Machine.
  kind: object
  properties:
  - name: migrationStatusDetails
    isReadyOnly: true
    description: Detailed migration status. Not included by default.
    types:
    - uid: MigrationStatusDetails
  - name: targetDatabaseCollation
    description: Database collation to be used for the target database.
    types:
    - uid: string
  - name: provisioningError
    description: Error message for migration provisioning failure, if any.
    types:
    - uid: string
  - name: backupConfiguration
    description: Backup configuration info.
    types:
    - uid: BackupConfiguration
  - name: offlineConfiguration
    description: Offline configuration.
    types:
    - uid: OfflineConfiguration
  - name: kind
    description: ''
    types:
    - uid: SqlVm
    typesTitle: string
  - name: scope
    description: Resource Id of the target resource (SQL VM or SQL Managed Instance).
    types:
    - uid: string
  - name: provisioningState
    isReadyOnly: true
    description: Provisioning State of migration. ProvisioningState as Succeeded implies that validations have been performed and migration has started.
    types:
    - uid: string
  - name: migrationStatus
    isReadyOnly: true
    description: Migration status.
    types:
    - uid: string
  - name: startedOn
    isReadyOnly: true
    description: Database migration start time.
    types:
    - uid: string
  - name: endedOn
    isReadyOnly: true
    description: Database migration end time.
    types:
    - uid: string
  - name: sourceSqlConnection
    description: Source SQL Server connection details.
    types:
    - uid: SqlConnectionInformation
  - name: sourceDatabaseName
    description: Name of the source database.
    types:
    - uid: string
  - name: migrationService
    description: Resource Id of the Migration Service.
    types:
    - uid: string
  - name: migrationOperationId
    description: ID tracking current migration operation.
    types:
    - uid: string
  - name: migrationFailureError
    isReadyOnly: true
    description: Error details in case of migration failure.
    types:
    - uid: ErrorInfo
- name: createdByType
  kind: enum
  properties:
  - name: User
    types:
    - uid: string
  - name: Application
    types:
    - uid: string
  - name: ManagedIdentity
    types:
    - uid: string
  - name: Key
    types:
    - uid: string
- name: MigrationStatusDetails
  description: Detailed status of current migration.
  kind: object
  properties:
  - name: migrationState
    isReadyOnly: true
    description: Current State of Migration.
    types:
    - uid: string
  - name: fullBackupSetInfo
    isReadyOnly: true
    description: Details of full backup set.
    types:
    - uid: SqlBackupSetInfo
  - name: lastRestoredBackupSetInfo
    isReadyOnly: true
    description: Last applied backup set information.
    types:
    - uid: SqlBackupSetInfo
  - name: activeBackupSets
    isReadyOnly: true
    description: Backup sets that are currently active.
    types:
    - uid: SqlBackupSetInfo
      isArray: true
  - name: invalidFiles
    isReadyOnly: true
    description: Files that are not valid backup files.
    types:
    - uid: string
      isArray: true
  - name: blobContainerName
    isReadyOnly: true
    description: Name of blob container.
    types:
    - uid: string
  - name: isFullBackupRestored
    isReadyOnly: true
    description: Whether full backup has been applied to the target database or not.
    types:
    - uid: boolean
  - name: restoreBlockingReason
    isReadyOnly: true
    description: Restore blocking reason, if any
    types:
    - uid: string
  - name: completeRestoreErrorMessage
    isReadyOnly: true
    description: Complete restore error message, if any
    types:
    - uid: string
  - name: fileUploadBlockingErrors
    isReadyOnly: true
    description: File upload blocking errors, if any.
    types:
    - uid: string
      isArray: true
  - name: currentRestoringFilename
    isReadyOnly: true
    description: File name that is currently being restored.
    types:
    - uid: string
  - name: lastRestoredFilename
    isReadyOnly: true
    description: Last restored file name.
    types:
    - uid: string
  - name: pendingLogBackupsCount
    isReadyOnly: true
    description: Total pending log backups.
    types:
    - uid: integer
- name: BackupConfiguration
  description: Backup Configuration
  kind: object
  properties:
  - name: sourceLocation
    description: Source location of backups.
    types:
    - uid: SourceLocation
  - name: targetLocation
    description: Target location for copying backups.
    types:
    - uid: TargetLocation
- name: OfflineConfiguration
  description: Offline configuration
  kind: object
  properties:
  - name: offline
    description: Offline migration
    types:
    - uid: boolean
  - name: lastBackupName
    description: Last backup name for offline migration. This is optional for migrations from file share. If it is not provided, then the service will determine the last backup file name based on latest backup files present in file share.
    types:
    - uid: string
- name: SqlConnectionInformation
  description: Source SQL Connection
  kind: object
  properties:
  - name: dataSource
    description: Data source.
    types:
    - uid: string
  - name: authentication
    description: Authentication type.
    types:
    - uid: string
  - name: userName
    description: User name to connect to source SQL.
    types:
    - uid: string
  - name: password
    description: Password to connect to source SQL.
    types:
    - uid: string
  - name: encryptConnection
    description: Whether to encrypt connection or not.
    types:
    - uid: boolean
  - name: trustServerCertificate
    description: Whether to trust server certificate or not.
    types:
    - uid: boolean
- name: ErrorInfo
  description: Error details
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: Error message.
    types:
    - uid: string
- name: SqlBackupSetInfo
  description: Information of backup set
  kind: object
  properties:
  - name: backupSetId
    isReadyOnly: true
    description: Backup set id.
    types:
    - uid: string
  - name: firstLSN
    isReadyOnly: true
    description: First LSN of the backup set.
    types:
    - uid: string
  - name: lastLSN
    isReadyOnly: true
    description: Last LSN of the backup set.
    types:
    - uid: string
  - name: backupType
    isReadyOnly: true
    description: Backup type.
    types:
    - uid: string
  - name: listOfBackupFiles
    isReadyOnly: true
    description: List of files in the backup set.
    types:
    - uid: SqlBackupFileInfo
      isArray: true
  - name: backupStartDate
    isReadyOnly: true
    description: Backup start date.
    types:
    - uid: string
  - name: backupFinishDate
    isReadyOnly: true
    description: Backup end time.
    types:
    - uid: string
  - name: isBackupRestored
    isReadyOnly: true
    description: Whether this backup set has been restored or not.
    types:
    - uid: boolean
  - name: hasBackupChecksums
    isReadyOnly: true
    description: Has Backup Checksums
    types:
    - uid: boolean
  - name: familyCount
    isReadyOnly: true
    description: Media family count
    types:
    - uid: integer
  - name: ignoreReasons
    isReadyOnly: true
    description: The reasons why the backup set is ignored
    types:
    - uid: string
      isArray: true
- name: SourceLocation
  description: Source Location details of backups.
  kind: object
  properties:
  - name: fileShare
    description: Source File share.
    types:
    - uid: SqlFileShare
  - name: azureBlob
    description: Source Azure Blob.
    types:
    - uid: AzureBlob
- name: TargetLocation
  description: Target Location details for optional copy of backups
  kind: object
  properties:
  - name: storageAccountResourceId
    description: Resource Id of the storage account copying backups.
    types:
    - uid: string
  - name: accountKey
    description: Storage Account Key.
    types:
    - uid: string
- name: SqlBackupFileInfo
  description: Information of backup file
  kind: object
  properties:
  - name: fileName
    isReadyOnly: true
    description: File name.
    types:
    - uid: string
  - name: status
    isReadyOnly: true
    description: Status of the file. (Initial, Uploading, Uploaded, Restoring, Restored or Skipped)
    types:
    - uid: string
  - name: totalSize
    isReadyOnly: true
    description: File size in bytes
    types:
    - uid: integer
  - name: dataRead
    isReadyOnly: true
    description: Bytes read
    types:
    - uid: integer
  - name: dataWritten
    isReadyOnly: true
    description: Bytes written
    types:
    - uid: integer
  - name: copyThroughput
    isReadyOnly: true
    description: Copy throughput in KBps
    types:
    - uid: number
  - name: copyDuration
    isReadyOnly: true
    description: Copy Duration in seconds
    types:
    - uid: integer
  - name: familySequenceNumber
    isReadyOnly: true
    description: Media family sequence number
    types:
    - uid: integer
- name: SqlFileShare
  description: File share
  kind: object
  properties:
  - name: path
    description: Location as SMB share or local drive where backups are placed.
    types:
    - uid: string
  - name: username
    description: Username to access the file share location for backups.
    types:
    - uid: string
  - name: password
    description: Password for username to access file share location.
    types:
    - uid: string
- name: AzureBlob
  description: Azure Blob Details
  kind: object
  properties:
  - name: storageAccountResourceId
    description: Resource Id of the storage account where backups are stored.
    types:
    - uid: string
  - name: accountKey
    description: Storage Account Key.
    types:
    - uid: string
  - name: blobContainerName
    description: Blob container name where backups are stored.
    types:
    - uid: string
examples:
- name: Get Sql VM database Migration without the expand parameter.
  request:
    uri: GET https://management.azure.com/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/testrg/providers/Microsoft.SqlVirtualMachine/sqlVirtualMachines/testvm/providers/Microsoft.DataMigration/databaseMigrations/db1?api-version=2022-01-30-preview
  responses:
  - statusCode: "200"
    body: >-
      {
        "properties": {
          "kind": "SqlVm",
          "scope": "/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/testrg/providers/Microsoft.SqlVirtualMachine/sqlVirtualMachines/testvm",
          "migrationStatus": "InProgress",
          "startedOn": "0001-01-01T08:00:00Z",
          "endedOn": "0001-01-01T08:00:00Z",
          "sourceDatabaseName": "sourcename",
          "migrationOperationId": "858ba109-5ab7-4fa1-8aea-bea487cacdcd"
        },
        "id": "/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/testrg/providers/Microsoft.SqlVirtualMachine/sqlVirtualMachines/testvm/providers/Microsoft.DataMigration/databaseMigrations/targetdb",
        "name": "targetdb",
        "type": "Microsoft.DataMigration/dataMigrations"
      }
- name: Get Sql VM database Migration with the expand parameter.
  request:
    uri: GET https://management.azure.com/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/testrg/providers/Microsoft.SqlVirtualMachine/sqlVirtualMachines/testvm/providers/Microsoft.DataMigration/databaseMigrations/db1?$expand=MigrationStatusDetails&api-version=2022-01-30-preview
  responses:
  - statusCode: "200"
    body: >-
      {
        "properties": {
          "kind": "SqlVm",
          "scope": "/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/testrg/providers/Microsoft.SqlVirtualMachine/sqlVirtualMachines/testvm",
          "migrationStatus": "InProgress",
          "migrationStatusDetails": {
            "migrationState": "WaitForFullBackupUploadOperation",
            "activeBackupSets": [],
            "isFullBackupRestored": false
          },
          "startedOn": "0001-01-01T08:00:00Z",
          "endedOn": "0001-01-01T08:00:00Z",
          "sourceDatabaseName": "sourcename",
          "migrationOperationId": "858ba109-5ab7-4fa1-8aea-bea487cacdcd"
        },
        "id": "/subscriptions/00000000-1111-2222-3333-444444444444/resourceGroups/testrg/providers/Microsoft.SqlVirtualMachine/sqlVirtualMachines/testvm/providers/Microsoft.DataMigration/databaseMigrations/targetdb",
        "name": "targetdb",
        "type": "Microsoft.DataMigration/dataMigrations"
      }
security: []
metadata:
  description: Learn more about Data Migration service - Retrieve the specified database migration for a given SQL VM.
errorCodes: []
