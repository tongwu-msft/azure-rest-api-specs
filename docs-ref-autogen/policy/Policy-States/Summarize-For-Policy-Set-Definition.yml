### YamlMime:RESTOperation
uid: management.azure.com.policy.policystates.summarizeforpolicysetdefinition
name: Summarize For Policy Set Definition
service: Policy
groupName: Policy States
apiVersion: 2019-10-01
summary: Summarizes policy states for the subscription level policy set definition.
produces:
- application/json
paths:
- content: POST https://management.azure.com/subscriptions/{subscriptionId}/providers/Microsoft.Authorization/policySetDefinitions/{policySetDefinitionName}/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01
- content: POST https://management.azure.com/subscriptions/{subscriptionId}/providers/Microsoft.Authorization/policySetDefinitions/{policySetDefinitionName}/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top={$top}&$from={$from}&$to={$to}&$filter={$filter}
  isOptional: true
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: Microsoft Azure subscription ID.
  types:
  - uid: string
- name: authorizationNamespace
  in: path
  isRequired: true
  description: The namespace for Microsoft Authorization resource provider; only "Microsoft.Authorization" is allowed.
  types:
  - uid: AuthorizationNamespaceType
- name: policySetDefinitionName
  in: path
  isRequired: true
  description: Policy set definition name.
  types:
  - uid: string
- name: policyStatesSummaryResource
  in: path
  isRequired: true
  description: The virtual resource under PolicyStates resource type for summarize action. In a given time range, 'latest' represents the latest policy state(s) and is the only allowed value.
  types:
  - uid: PolicyStatesSummaryResourceType
- name: api-version
  in: query
  isRequired: true
  description: Client Api Version.
  types:
  - uid: string
- name: $top
  in: query
  description: Maximum number of records to return.
  types:
  - uid: integer
  format: int32
- name: $from
  in: query
  description: ISO 8601 formatted timestamp specifying the start time of the interval to query. When not specified, the service uses ($to - 1-day).
  types:
  - uid: string
  format: date-time
- name: $to
  in: query
  description: ISO 8601 formatted timestamp specifying the end time of the interval to query. When not specified, the service uses request time.
  types:
  - uid: string
  format: date-time
- name: $filter
  in: query
  description: OData filter expression.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Summarize results.
  types:
  - uid: SummarizeResults
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: QueryFailure
requestHeader: []
definitions:
- name: PolicyStatesSummaryResourceType
  description: The virtual resource under PolicyStates resource type for summarize action. In a given time range, 'latest' represents the latest policy state(s) and is the only allowed value.
  kind: enum
  properties:
  - name: latest
    types:
    - uid: string
- name: AuthorizationNamespaceType
  description: The namespace for Microsoft Authorization resource provider; only "Microsoft.Authorization" is allowed.
  kind: enum
  properties:
  - name: Microsoft.Authorization
    types:
    - uid: string
- name: SummarizeResults
  description: Summarize action results.
  kind: object
  properties:
  - name: '@odata.context'
    description: OData context string; used by OData clients to resolve type information based on metadata.
    types:
    - uid: string
  - name: '@odata.count'
    description: OData entity count; represents the number of summaries returned; always set to 1.
    types:
    - uid: integer
  - name: value
    description: Summarize action results.
    types:
    - uid: Summary
      isArray: true
- name: QueryFailure
  description: Error response.
  kind: object
  properties:
  - name: error
    description: Error definition.
    types:
    - uid: Error
- name: Summary
  description: Summary results.
  kind: object
  properties:
  - name: '@odata.id'
    description: OData entity ID; always set to null since summaries do not have an entity ID.
    types:
    - uid: string
  - name: '@odata.context'
    description: OData context string; used by OData clients to resolve type information based on metadata.
    types:
    - uid: string
  - name: results
    description: Compliance summary for all policy assignments.
    types:
    - uid: SummaryResults
  - name: policyAssignments
    description: Policy assignments summary.
    types:
    - uid: PolicyAssignmentSummary
      isArray: true
- name: Error
  description: Error definition.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Service specific error code which serves as the substatus for the HTTP error code.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: Description of the error.
    types:
    - uid: string
- name: SummaryResults
  description: Compliance summary on a particular summary level.
  kind: object
  properties:
  - name: queryResultsUri
    description: HTTP POST URI for queryResults action on Microsoft.PolicyInsights to retrieve raw results for the compliance summary. This property will not be available by default in future API versions, but could be queried explicitly.
    types:
    - uid: string
  - name: nonCompliantResources
    description: Number of non-compliant resources.
    types:
    - uid: integer
  - name: nonCompliantPolicies
    description: Number of non-compliant policies.
    types:
    - uid: integer
  - name: resourceDetails
    description: The resources summary at this level.
    types:
    - uid: ComplianceDetail
      isArray: true
  - name: policyDetails
    description: The policy artifact summary at this level. For query scope level, it represents policy assignment summary. For policy assignment level, it represents policy definitions summary.
    types:
    - uid: ComplianceDetail
      isArray: true
  - name: policyGroupDetails
    description: The policy definition group summary at this level.
    types:
    - uid: ComplianceDetail
      isArray: true
- name: PolicyAssignmentSummary
  description: Policy assignment summary.
  kind: object
  properties:
  - name: policyAssignmentId
    description: Policy assignment ID.
    types:
    - uid: string
  - name: policySetDefinitionId
    description: Policy set definition ID, if the policy assignment is for a policy set.
    types:
    - uid: string
  - name: results
    description: Compliance summary for the policy assignment.
    types:
    - uid: SummaryResults
  - name: policyDefinitions
    description: Policy definitions summary.
    types:
    - uid: PolicyDefinitionSummary
      isArray: true
  - name: policyGroups
    description: Policy definition group summary.
    types:
    - uid: PolicyGroupSummary
      isArray: true
- name: ComplianceDetail
  description: The compliance state rollup.
  kind: object
  properties:
  - name: complianceState
    description: The compliance state.
    types:
    - uid: string
  - name: count
    description: Summarized count value for this compliance state.
    types:
    - uid: integer
- name: PolicyDefinitionSummary
  description: Policy definition summary.
  kind: object
  properties:
  - name: policyDefinitionId
    description: Policy definition ID.
    types:
    - uid: string
  - name: policyDefinitionReferenceId
    description: Policy definition reference ID.
    types:
    - uid: string
  - name: policyDefinitionGroupNames
    description: Policy definition group names.
    types:
    - uid: string
      isArray: true
  - name: effect
    description: Policy effect, i.e. policy definition action.
    types:
    - uid: string
  - name: results
    description: Compliance summary for the policy definition.
    types:
    - uid: SummaryResults
- name: PolicyGroupSummary
  description: Policy definition group summary.
  kind: object
  properties:
  - name: policyGroupName
    description: Policy group name.
    types:
    - uid: string
  - name: results
    description: Compliance summary for the policy definition group.
    types:
    - uid: SummaryResults
examples:
- name: Summarize at policy set definition scope
  request:
    uri: POST https://management.azure.com/subscriptions/fffedd8f-ffff-fffd-fffd-fffed2f84852/providers/Microsoft.Authorization/policySetDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e338c/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=1&$from=2019-10-05T18:00:00Z&$to=2019-10-06T18:00:00Z&$filter=PolicyDefinitionAction eq 'deny'
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/subscriptions/fffedd8f-ffff-fffd-fffd-fffed2f84852/providers/Microsoft.Authorization/policySetDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e338c/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=1&$from=2019-10-05T18:00:00Z&$to=2019-10-06T18:00:00Z&$filter=PolicyDefinitionAction eq 'deny'
      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.policyinsights.models.PolicyStatesSummaryResourceType;
      import java.time.OffsetDateTime;

      /** Samples for PolicyStates SummarizeForPolicySetDefinition. */
      public final class Main {
          /*
           * x-ms-original-file: specification/policyinsights/resource-manager/Microsoft.PolicyInsights/stable/2019-10-01/examples/PolicyStates_SummarizeSubscriptionLevelPolicySetDefinitionScope.json
           */
          /**
           * Sample code: Summarize at policy set definition scope.
           *
           * @param manager Entry point to PolicyInsightsManager.
           */
          public static void summarizeAtPolicySetDefinitionScope(
              com.azure.resourcemanager.policyinsights.PolicyInsightsManager manager) {
              manager
                  .policyStates()
                  .summarizeForPolicySetDefinitionWithResponse(
                      PolicyStatesSummaryResourceType.LATEST,
                      "fffedd8f-ffff-fffd-fffd-fffed2f84852",
                      "3e3807c1-65c9-49e0-a406-82d8ae3e338c",
                      1,
                      OffsetDateTime.parse("2019-10-05T18:00:00Z"),
                      OffsetDateTime.parse("2019-10-06T18:00:00Z"),
                      "PolicyDefinitionAction eq 'deny'",
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-policyinsights_1.0.0-beta.3/sdk/policyinsights/azure-resourcemanager-policyinsights/README.md) on how to add the SDK to your project and authenticate.
      # [Go](#tab/Go)
      ``` go
      package armpolicyinsights_test

      import (
      	"context"
      	"log"

      	"time"

      	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"
      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/policyinsights/armpolicyinsights"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/policyinsights/resource-manager/Microsoft.PolicyInsights/stable/2019-10-01/examples/PolicyStates_SummarizeSubscriptionLevelPolicySetDefinitionScope.json
      func ExamplePolicyStatesClient_SummarizeForPolicySetDefinition() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armpolicyinsights.NewPolicyStatesClient(cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	res, err := client.SummarizeForPolicySetDefinition(ctx,
      		armpolicyinsights.PolicyStatesSummaryResourceTypeLatest,
      		"fffedd8f-ffff-fffd-fffd-fffed2f84852",
      		"3e3807c1-65c9-49e0-a406-82d8ae3e338c",
      		&armpolicyinsights.QueryOptions{Top: to.Ptr[int32](1),
      			Filter:    to.Ptr("PolicyDefinitionAction eq 'deny'"),
      			OrderBy:   nil,
      			Select:    nil,
      			From:      to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2019-10-05T18:00:00Z"); return t }()),
      			To:        to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2019-10-06T18:00:00Z"); return t }()),
      			Apply:     nil,
      			SkipToken: nil,
      			Expand:    nil,
      		},
      		nil)
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fpolicyinsights%2Farmpolicyinsights%2Fv0.5.0/sdk/resourcemanager/policyinsights/armpolicyinsights/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "@odata.context": "https://management.azure.com/subscriptions/fffedd8f-ffff-fffd-fffd-fffed2f84852/providers/Microsoft.Authorization/policySetDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e338c/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary",
        "@odata.count": 1,
        "value": [
          {
            "@odata.id": null,
            "@odata.context": "https://management.azure.com/subscriptions/fffedd8f-ffff-fffd-fffd-fffed2f84852/providers/Microsoft.Authorization/policySetDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e338c/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity",
            "results": {
              "queryResultsUri": "https://management.azure.com/subscriptions/fffedd8f-ffff-fffd-fffd-fffed2f84852/providers/Microsoft.Authorization/policySetDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e338c/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2019-10-05 18:00:00Z&$to=2019-10-06 18:00:00Z&$filter=(PolicyDefinitionAction eq 'deny') and IsCompliant eq false",
              "nonCompliantResources": 0,
              "nonCompliantPolicies": 0,
              "resourceDetails": [
                {
                  "complianceState": "compliant",
                  "count": 140
                }
              ],
              "policyDetails": [
                {
                  "complianceState": "compliant",
                  "count": 1
                }
              ],
              "policyGroupDetails": [
                {
                  "complianceState": "compliant",
                  "count": 1
                }
              ]
            },
            "policyAssignments": []
          }
        ]
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about Policy service - Summarizes policy states for the subscription level policy set definition.
errorCodes: []
