### YamlMime:RESTOperation
uid: management.azure.com.aks.agentpools.createorupdate
name: Create Or Update
service: AKS
groupName: Agent Pools
apiVersion: 2020-11-01
summary: "Creates or updates an agent pool.  \nCreates or updates an agent pool in the specified managed cluster."
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ContainerService/managedClusters/{resourceName}/agentPools/{agentPoolName}?api-version=2020-11-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: Subscription credentials which uniquely identify Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group.
  types:
  - uid: string
- name: resourceName
  in: path
  isRequired: true
  description: The name of the managed cluster resource.
  types:
  - uid: string
  pattern: ^[a-zA-Z0-9]$|^[a-zA-Z0-9][-_a-zA-Z0-9]{0,61}[a-zA-Z0-9]$
- name: agentPoolName
  in: path
  isRequired: true
  description: The name of the agent pool.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: Client Api Version.
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK
  types:
  - uid: AgentPool
- name: 201 Created
  description: Created
  types:
  - uid: AgentPool
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: CloudError
requestBody:
- name: default
  parameters:
  - name: properties.count
    in: body
    description: Number of agents (VMs) to host docker containers. Allowed values must be in the range of 0 to 100 (inclusive) for user pools and in the range of 1 to 100 (inclusive) for system pools. The default value is 1.
    types:
    - uid: integer
  - name: properties.vmSize
    in: body
    description: Size of agent VMs.
    types:
    - uid: ContainerServiceVMSizeTypes
  - name: properties.osDiskSizeGB
    in: body
    description: OS Disk Size in GB to be used to specify the disk size for every machine in this master/agent pool. If you specify 0, it will apply the default osDisk size according to the vmSize specified.
    types:
    - uid: integer
  - name: properties.osDiskType
    in: body
    description: OS disk type to be used for machines in a given agent pool. Allowed values are 'Ephemeral' and 'Managed'. Defaults to 'Managed'. May not be changed after creation.
    types:
    - uid: OSDiskType
  - name: properties.vnetSubnetID
    in: body
    description: VNet SubnetID specifies the VNet's subnet identifier for nodes and maybe pods
    types:
    - uid: string
  - name: properties.podSubnetID
    in: body
    description: Pod SubnetID specifies the VNet's subnet identifier for pods.
    types:
    - uid: string
  - name: properties.maxPods
    in: body
    description: Maximum number of pods that can run on a node.
    types:
    - uid: integer
  - name: properties.osType
    in: body
    description: OsType to be used to specify os type. Choose from Linux and Windows. Default to Linux.
    types:
    - uid: OSType
  - name: properties.maxCount
    in: body
    description: Maximum number of nodes for auto-scaling
    types:
    - uid: integer
  - name: properties.minCount
    in: body
    description: Minimum number of nodes for auto-scaling
    types:
    - uid: integer
  - name: properties.enableAutoScaling
    in: body
    description: Whether to enable auto-scaler
    types:
    - uid: boolean
  - name: properties.type
    in: body
    description: AgentPoolType represents types of an agent pool
    types:
    - uid: AgentPoolType
  - name: properties.mode
    in: body
    description: AgentPoolMode represents mode of an agent pool
    types:
    - uid: AgentPoolMode
  - name: properties.orchestratorVersion
    in: body
    description: Version of orchestrator specified when creating the managed cluster.
    types:
    - uid: string
  - name: properties.upgradeSettings
    in: body
    description: Settings for upgrading the agentpool
    types:
    - uid: AgentPoolUpgradeSettings
  - name: properties.availabilityZones
    in: body
    description: Availability zones for nodes. Must use VirtualMachineScaleSets AgentPoolType.
    types:
    - uid: string
      isArray: true
  - name: properties.enableNodePublicIP
    in: body
    description: Enable public IP for nodes
    types:
    - uid: boolean
  - name: properties.scaleSetPriority
    in: body
    description: ScaleSetPriority to be used to specify virtual machine scale set priority. Default to regular.
    types:
    - uid: ScaleSetPriority
  - name: properties.scaleSetEvictionPolicy
    in: body
    description: ScaleSetEvictionPolicy to be used to specify eviction policy for Spot virtual machine scale set. Default to Delete.
    types:
    - uid: ScaleSetEvictionPolicy
  - name: properties.spotMaxPrice
    in: body
    description: SpotMaxPrice to be used to specify the maximum price you are willing to pay in US Dollars. Possible values are any decimal value greater than zero or -1 which indicates default price to be up-to on-demand.
    types:
    - uid: number
  - name: properties.tags
    in: body
    description: Agent pool tags to be persisted on the agent pool virtual machine scale set.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.nodeLabels
    in: body
    description: Agent pool node labels to be persisted across all nodes in agent pool.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.nodeTaints
    in: body
    description: Taints added to new nodes during node pool create and scale. For example, key=value:NoSchedule.
    types:
    - uid: string
      isArray: true
  - name: properties.proximityPlacementGroupID
    in: body
    description: The ID for Proximity Placement Group.
    types:
    - uid: string
  - name: properties.kubeletConfig
    in: body
    description: KubeletConfig specifies the configuration of kubelet on agent nodes.
    types:
    - uid: KubeletConfig
  - name: properties.linuxOSConfig
    in: body
    description: LinuxOSConfig specifies the OS configuration of linux agent nodes.
    types:
    - uid: LinuxOSConfig
requestHeader: []
definitions:
- name: AgentPoolUpgradeSettings
  description: Settings for upgrading an agentpool
  kind: object
  properties:
  - name: maxSurge
    description: Count or percentage of additional nodes to be added during upgrade. If empty uses AKS default
    types:
    - uid: string
- name: PowerState
  description: Describes the Power State of the cluster
  kind: object
  properties:
  - name: code
    description: Tells whether the cluster is Running or Stopped
    types:
    - uid: code
- name: KubeletConfig
  description: Kubelet configurations of agent nodes.
  kind: object
  properties:
  - name: cpuManagerPolicy
    description: CPU Manager policy to use.
    types:
    - uid: string
  - name: cpuCfsQuota
    description: Enable CPU CFS quota enforcement for containers that specify CPU limits.
    types:
    - uid: boolean
  - name: cpuCfsQuotaPeriod
    description: Sets CPU CFS quota period value.
    types:
    - uid: string
  - name: imageGcHighThreshold
    description: The percent of disk usage after which image garbage collection is always run.
    types:
    - uid: integer
  - name: imageGcLowThreshold
    description: The percent of disk usage before which image garbage collection is never run.
    types:
    - uid: integer
  - name: topologyManagerPolicy
    description: Topology Manager policy to use.
    types:
    - uid: string
  - name: allowedUnsafeSysctls
    description: Allowlist of unsafe sysctls or unsafe sysctl patterns (ending in `*`).
    types:
    - uid: string
      isArray: true
  - name: failSwapOn
    description: If set to true it will make the Kubelet fail to start if swap is enabled on the node.
    types:
    - uid: boolean
- name: LinuxOSConfig
  description: OS configurations of Linux agent nodes.
  kind: object
  properties:
  - name: sysctls
    description: Sysctl settings for Linux agent nodes.
    types:
    - uid: SysctlConfig
  - name: transparentHugePageEnabled
    description: Transparent Huge Page enabled configuration.
    types:
    - uid: string
  - name: transparentHugePageDefrag
    description: Transparent Huge Page defrag configuration.
    types:
    - uid: string
  - name: swapFileSizeMB
    description: SwapFileSizeMB specifies size in MB of a swap file will be created on each node.
    types:
    - uid: integer
- name: AgentPool
  description: Agent Pool.
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: Resource ID.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource that is unique within a resource group. This name can be used to access the resource.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type
    types:
    - uid: string
  - name: properties.count
    description: Number of agents (VMs) to host docker containers. Allowed values must be in the range of 0 to 100 (inclusive) for user pools and in the range of 1 to 100 (inclusive) for system pools. The default value is 1.
    types:
    - uid: integer
  - name: properties.vmSize
    description: Size of agent VMs.
    types:
    - uid: ContainerServiceVMSizeTypes
  - name: properties.osDiskSizeGB
    description: OS Disk Size in GB to be used to specify the disk size for every machine in this master/agent pool. If you specify 0, it will apply the default osDisk size according to the vmSize specified.
    types:
    - uid: integer
  - name: properties.osDiskType
    description: OS disk type to be used for machines in a given agent pool. Allowed values are 'Ephemeral' and 'Managed'. Defaults to 'Managed'. May not be changed after creation.
    types:
    - uid: OSDiskType
  - name: properties.vnetSubnetID
    description: VNet SubnetID specifies the VNet's subnet identifier for nodes and maybe pods
    types:
    - uid: string
  - name: properties.podSubnetID
    description: Pod SubnetID specifies the VNet's subnet identifier for pods.
    types:
    - uid: string
  - name: properties.maxPods
    description: Maximum number of pods that can run on a node.
    types:
    - uid: integer
  - name: properties.osType
    description: OsType to be used to specify os type. Choose from Linux and Windows. Default to Linux.
    types:
    - uid: OSType
  - name: properties.maxCount
    description: Maximum number of nodes for auto-scaling
    types:
    - uid: integer
  - name: properties.minCount
    description: Minimum number of nodes for auto-scaling
    types:
    - uid: integer
  - name: properties.enableAutoScaling
    description: Whether to enable auto-scaler
    types:
    - uid: boolean
  - name: properties.type
    description: AgentPoolType represents types of an agent pool
    types:
    - uid: AgentPoolType
  - name: properties.mode
    description: AgentPoolMode represents mode of an agent pool
    types:
    - uid: AgentPoolMode
  - name: properties.orchestratorVersion
    description: Version of orchestrator specified when creating the managed cluster.
    types:
    - uid: string
  - name: properties.nodeImageVersion
    isReadyOnly: true
    description: Version of node image
    types:
    - uid: string
  - name: properties.upgradeSettings
    description: Settings for upgrading the agentpool
    types:
    - uid: AgentPoolUpgradeSettings
  - name: properties.provisioningState
    isReadyOnly: true
    description: The current deployment or provisioning state, which only appears in the response.
    types:
    - uid: string
  - name: properties.powerState
    isReadyOnly: true
    description: Describes whether the Agent Pool is Running or Stopped
    types:
    - uid: PowerState
  - name: properties.availabilityZones
    description: Availability zones for nodes. Must use VirtualMachineScaleSets AgentPoolType.
    types:
    - uid: string
      isArray: true
  - name: properties.enableNodePublicIP
    description: Enable public IP for nodes
    types:
    - uid: boolean
  - name: properties.scaleSetPriority
    description: ScaleSetPriority to be used to specify virtual machine scale set priority. Default to regular.
    types:
    - uid: ScaleSetPriority
  - name: properties.scaleSetEvictionPolicy
    description: ScaleSetEvictionPolicy to be used to specify eviction policy for Spot virtual machine scale set. Default to Delete.
    types:
    - uid: ScaleSetEvictionPolicy
  - name: properties.spotMaxPrice
    description: SpotMaxPrice to be used to specify the maximum price you are willing to pay in US Dollars. Possible values are any decimal value greater than zero or -1 which indicates default price to be up-to on-demand.
    types:
    - uid: number
  - name: properties.tags
    description: Agent pool tags to be persisted on the agent pool virtual machine scale set.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.nodeLabels
    description: Agent pool node labels to be persisted across all nodes in agent pool.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.nodeTaints
    description: Taints added to new nodes during node pool create and scale. For example, key=value:NoSchedule.
    types:
    - uid: string
      isArray: true
  - name: properties.proximityPlacementGroupID
    description: The ID for Proximity Placement Group.
    types:
    - uid: string
  - name: properties.kubeletConfig
    description: KubeletConfig specifies the configuration of kubelet on agent nodes.
    types:
    - uid: KubeletConfig
  - name: properties.linuxOSConfig
    description: LinuxOSConfig specifies the OS configuration of linux agent nodes.
    types:
    - uid: LinuxOSConfig
- name: CloudError
  description: An error response from the Container service.
  kind: object
  properties:
  - name: error
    description: Details about the error.
    types:
    - uid: CloudErrorBody
- name: code
  description: Tells whether the cluster is Running or Stopped
  kind: enum
  properties:
  - name: Running
    types:
    - uid: string
  - name: Stopped
    types:
    - uid: string
- name: SysctlConfig
  description: Sysctl settings for Linux agent nodes.
  kind: object
  properties:
  - name: netCoreSomaxconn
    description: Sysctl setting net.core.somaxconn.
    types:
    - uid: integer
  - name: netCoreNetdevMaxBacklog
    description: Sysctl setting net.core.netdev_max_backlog.
    types:
    - uid: integer
  - name: netCoreRmemMax
    description: Sysctl setting net.core.rmem_max.
    types:
    - uid: integer
  - name: netCoreWmemMax
    description: Sysctl setting net.core.wmem_max.
    types:
    - uid: integer
  - name: netCoreOptmemMax
    description: Sysctl setting net.core.optmem_max.
    types:
    - uid: integer
  - name: netIpv4TcpMaxSynBacklog
    description: Sysctl setting net.ipv4.tcp_max_syn_backlog.
    types:
    - uid: integer
  - name: netIpv4TcpMaxTwBuckets
    description: Sysctl setting net.ipv4.tcp_max_tw_buckets.
    types:
    - uid: integer
  - name: netIpv4TcpFinTimeout
    description: Sysctl setting net.ipv4.tcp_fin_timeout.
    types:
    - uid: integer
  - name: netIpv4TcpKeepaliveTime
    description: Sysctl setting net.ipv4.tcp_keepalive_time.
    types:
    - uid: integer
  - name: netIpv4TcpKeepaliveProbes
    description: Sysctl setting net.ipv4.tcp_keepalive_probes.
    types:
    - uid: integer
  - name: netIpv4TcpkeepaliveIntvl
    description: Sysctl setting net.ipv4.tcp_keepalive_intvl.
    types:
    - uid: integer
  - name: netIpv4TcpRmem
    description: Sysctl setting net.ipv4.tcp_rmem.
    types:
    - uid: integer
  - name: netIpv4TcpWmem
    description: Sysctl setting net.ipv4.tcp_wmem.
    types:
    - uid: integer
  - name: netIpv4TcpTwReuse
    description: Sysctl setting net.ipv4.tcp_tw_reuse.
    types:
    - uid: boolean
  - name: netIpv4IpLocalPortRange
    description: Sysctl setting net.ipv4.ip_local_port_range.
    types:
    - uid: string
  - name: netIpv4NeighDefaultGcThresh1
    description: Sysctl setting net.ipv4.neigh.default.gc_thresh1.
    types:
    - uid: integer
  - name: netIpv4NeighDefaultGcThresh2
    description: Sysctl setting net.ipv4.neigh.default.gc_thresh2.
    types:
    - uid: integer
  - name: netIpv4NeighDefaultGcThresh3
    description: Sysctl setting net.ipv4.neigh.default.gc_thresh3.
    types:
    - uid: integer
  - name: netNetfilterNfConntrackMax
    description: Sysctl setting net.netfilter.nf_conntrack_max.
    types:
    - uid: integer
  - name: netNetfilterNfConntrackBuckets
    description: Sysctl setting net.netfilter.nf_conntrack_buckets.
    types:
    - uid: integer
  - name: fsInotifyMaxUserWatches
    description: Sysctl setting fs.inotify.max_user_watches.
    types:
    - uid: integer
  - name: fsFileMax
    description: Sysctl setting fs.file-max.
    types:
    - uid: integer
  - name: fsAioMaxNr
    description: Sysctl setting fs.aio-max-nr.
    types:
    - uid: integer
  - name: fsNrOpen
    description: Sysctl setting fs.nr_open.
    types:
    - uid: integer
  - name: kernelThreadsMax
    description: Sysctl setting kernel.threads-max.
    types:
    - uid: integer
  - name: vmMaxMapCount
    description: Sysctl setting vm.max_map_count.
    types:
    - uid: integer
  - name: vmSwappiness
    description: Sysctl setting vm.swappiness.
    types:
    - uid: integer
  - name: vmVfsCachePressure
    description: Sysctl setting vm.vfs_cache_pressure.
    types:
    - uid: integer
- name: ContainerServiceVMSizeTypes
  description: Size of agent VMs.
  kind: enum
  properties:
  - name: Standard_A1
    types:
    - uid: string
  - name: Standard_A10
    types:
    - uid: string
  - name: Standard_A11
    types:
    - uid: string
  - name: Standard_A1_v2
    types:
    - uid: string
  - name: Standard_A2
    types:
    - uid: string
  - name: Standard_A2_v2
    types:
    - uid: string
  - name: Standard_A2m_v2
    types:
    - uid: string
  - name: Standard_A3
    types:
    - uid: string
  - name: Standard_A4
    types:
    - uid: string
  - name: Standard_A4_v2
    types:
    - uid: string
  - name: Standard_A4m_v2
    types:
    - uid: string
  - name: Standard_A5
    types:
    - uid: string
  - name: Standard_A6
    types:
    - uid: string
  - name: Standard_A7
    types:
    - uid: string
  - name: Standard_A8
    types:
    - uid: string
  - name: Standard_A8_v2
    types:
    - uid: string
  - name: Standard_A8m_v2
    types:
    - uid: string
  - name: Standard_A9
    types:
    - uid: string
  - name: Standard_B2ms
    types:
    - uid: string
  - name: Standard_B2s
    types:
    - uid: string
  - name: Standard_B4ms
    types:
    - uid: string
  - name: Standard_B8ms
    types:
    - uid: string
  - name: Standard_D1
    types:
    - uid: string
  - name: Standard_D11
    types:
    - uid: string
  - name: Standard_D11_v2
    types:
    - uid: string
  - name: Standard_D11_v2_Promo
    types:
    - uid: string
  - name: Standard_D12
    types:
    - uid: string
  - name: Standard_D12_v2
    types:
    - uid: string
  - name: Standard_D12_v2_Promo
    types:
    - uid: string
  - name: Standard_D13
    types:
    - uid: string
  - name: Standard_D13_v2
    types:
    - uid: string
  - name: Standard_D13_v2_Promo
    types:
    - uid: string
  - name: Standard_D14
    types:
    - uid: string
  - name: Standard_D14_v2
    types:
    - uid: string
  - name: Standard_D14_v2_Promo
    types:
    - uid: string
  - name: Standard_D15_v2
    types:
    - uid: string
  - name: Standard_D16_v3
    types:
    - uid: string
  - name: Standard_D16s_v3
    types:
    - uid: string
  - name: Standard_D1_v2
    types:
    - uid: string
  - name: Standard_D2
    types:
    - uid: string
  - name: Standard_D2_v2
    types:
    - uid: string
  - name: Standard_D2_v2_Promo
    types:
    - uid: string
  - name: Standard_D2_v3
    types:
    - uid: string
  - name: Standard_D2s_v3
    types:
    - uid: string
  - name: Standard_D3
    types:
    - uid: string
  - name: Standard_D32_v3
    types:
    - uid: string
  - name: Standard_D32s_v3
    types:
    - uid: string
  - name: Standard_D3_v2
    types:
    - uid: string
  - name: Standard_D3_v2_Promo
    types:
    - uid: string
  - name: Standard_D4
    types:
    - uid: string
  - name: Standard_D4_v2
    types:
    - uid: string
  - name: Standard_D4_v2_Promo
    types:
    - uid: string
  - name: Standard_D4_v3
    types:
    - uid: string
  - name: Standard_D4s_v3
    types:
    - uid: string
  - name: Standard_D5_v2
    types:
    - uid: string
  - name: Standard_D5_v2_Promo
    types:
    - uid: string
  - name: Standard_D64_v3
    types:
    - uid: string
  - name: Standard_D64s_v3
    types:
    - uid: string
  - name: Standard_D8_v3
    types:
    - uid: string
  - name: Standard_D8s_v3
    types:
    - uid: string
  - name: Standard_DS1
    types:
    - uid: string
  - name: Standard_DS11
    types:
    - uid: string
  - name: Standard_DS11_v2
    types:
    - uid: string
  - name: Standard_DS11_v2_Promo
    types:
    - uid: string
  - name: Standard_DS12
    types:
    - uid: string
  - name: Standard_DS12_v2
    types:
    - uid: string
  - name: Standard_DS12_v2_Promo
    types:
    - uid: string
  - name: Standard_DS13
    types:
    - uid: string
  - name: Standard_DS13-2_v2
    types:
    - uid: string
  - name: Standard_DS13-4_v2
    types:
    - uid: string
  - name: Standard_DS13_v2
    types:
    - uid: string
  - name: Standard_DS13_v2_Promo
    types:
    - uid: string
  - name: Standard_DS14
    types:
    - uid: string
  - name: Standard_DS14-4_v2
    types:
    - uid: string
  - name: Standard_DS14-8_v2
    types:
    - uid: string
  - name: Standard_DS14_v2
    types:
    - uid: string
  - name: Standard_DS14_v2_Promo
    types:
    - uid: string
  - name: Standard_DS15_v2
    types:
    - uid: string
  - name: Standard_DS1_v2
    types:
    - uid: string
  - name: Standard_DS2
    types:
    - uid: string
  - name: Standard_DS2_v2
    types:
    - uid: string
  - name: Standard_DS2_v2_Promo
    types:
    - uid: string
  - name: Standard_DS3
    types:
    - uid: string
  - name: Standard_DS3_v2
    types:
    - uid: string
  - name: Standard_DS3_v2_Promo
    types:
    - uid: string
  - name: Standard_DS4
    types:
    - uid: string
  - name: Standard_DS4_v2
    types:
    - uid: string
  - name: Standard_DS4_v2_Promo
    types:
    - uid: string
  - name: Standard_DS5_v2
    types:
    - uid: string
  - name: Standard_DS5_v2_Promo
    types:
    - uid: string
  - name: Standard_E16_v3
    types:
    - uid: string
  - name: Standard_E16s_v3
    types:
    - uid: string
  - name: Standard_E2_v3
    types:
    - uid: string
  - name: Standard_E2s_v3
    types:
    - uid: string
  - name: Standard_E32-16s_v3
    types:
    - uid: string
  - name: Standard_E32-8s_v3
    types:
    - uid: string
  - name: Standard_E32_v3
    types:
    - uid: string
  - name: Standard_E32s_v3
    types:
    - uid: string
  - name: Standard_E4_v3
    types:
    - uid: string
  - name: Standard_E4s_v3
    types:
    - uid: string
  - name: Standard_E64-16s_v3
    types:
    - uid: string
  - name: Standard_E64-32s_v3
    types:
    - uid: string
  - name: Standard_E64_v3
    types:
    - uid: string
  - name: Standard_E64s_v3
    types:
    - uid: string
  - name: Standard_E8_v3
    types:
    - uid: string
  - name: Standard_E8s_v3
    types:
    - uid: string
  - name: Standard_F1
    types:
    - uid: string
  - name: Standard_F16
    types:
    - uid: string
  - name: Standard_F16s
    types:
    - uid: string
  - name: Standard_F16s_v2
    types:
    - uid: string
  - name: Standard_F1s
    types:
    - uid: string
  - name: Standard_F2
    types:
    - uid: string
  - name: Standard_F2s
    types:
    - uid: string
  - name: Standard_F2s_v2
    types:
    - uid: string
  - name: Standard_F32s_v2
    types:
    - uid: string
  - name: Standard_F4
    types:
    - uid: string
  - name: Standard_F4s
    types:
    - uid: string
  - name: Standard_F4s_v2
    types:
    - uid: string
  - name: Standard_F64s_v2
    types:
    - uid: string
  - name: Standard_F72s_v2
    types:
    - uid: string
  - name: Standard_F8
    types:
    - uid: string
  - name: Standard_F8s
    types:
    - uid: string
  - name: Standard_F8s_v2
    types:
    - uid: string
  - name: Standard_G1
    types:
    - uid: string
  - name: Standard_G2
    types:
    - uid: string
  - name: Standard_G3
    types:
    - uid: string
  - name: Standard_G4
    types:
    - uid: string
  - name: Standard_G5
    types:
    - uid: string
  - name: Standard_GS1
    types:
    - uid: string
  - name: Standard_GS2
    types:
    - uid: string
  - name: Standard_GS3
    types:
    - uid: string
  - name: Standard_GS4
    types:
    - uid: string
  - name: Standard_GS4-4
    types:
    - uid: string
  - name: Standard_GS4-8
    types:
    - uid: string
  - name: Standard_GS5
    types:
    - uid: string
  - name: Standard_GS5-16
    types:
    - uid: string
  - name: Standard_GS5-8
    types:
    - uid: string
  - name: Standard_H16
    types:
    - uid: string
  - name: Standard_H16m
    types:
    - uid: string
  - name: Standard_H16mr
    types:
    - uid: string
  - name: Standard_H16r
    types:
    - uid: string
  - name: Standard_H8
    types:
    - uid: string
  - name: Standard_H8m
    types:
    - uid: string
  - name: Standard_L16s
    types:
    - uid: string
  - name: Standard_L32s
    types:
    - uid: string
  - name: Standard_L4s
    types:
    - uid: string
  - name: Standard_L8s
    types:
    - uid: string
  - name: Standard_M128-32ms
    types:
    - uid: string
  - name: Standard_M128-64ms
    types:
    - uid: string
  - name: Standard_M128ms
    types:
    - uid: string
  - name: Standard_M128s
    types:
    - uid: string
  - name: Standard_M64-16ms
    types:
    - uid: string
  - name: Standard_M64-32ms
    types:
    - uid: string
  - name: Standard_M64ms
    types:
    - uid: string
  - name: Standard_M64s
    types:
    - uid: string
  - name: Standard_NC12
    types:
    - uid: string
  - name: Standard_NC12s_v2
    types:
    - uid: string
  - name: Standard_NC12s_v3
    types:
    - uid: string
  - name: Standard_NC24
    types:
    - uid: string
  - name: Standard_NC24r
    types:
    - uid: string
  - name: Standard_NC24rs_v2
    types:
    - uid: string
  - name: Standard_NC24rs_v3
    types:
    - uid: string
  - name: Standard_NC24s_v2
    types:
    - uid: string
  - name: Standard_NC24s_v3
    types:
    - uid: string
  - name: Standard_NC6
    types:
    - uid: string
  - name: Standard_NC6s_v2
    types:
    - uid: string
  - name: Standard_NC6s_v3
    types:
    - uid: string
  - name: Standard_ND12s
    types:
    - uid: string
  - name: Standard_ND24rs
    types:
    - uid: string
  - name: Standard_ND24s
    types:
    - uid: string
  - name: Standard_ND6s
    types:
    - uid: string
  - name: Standard_NV12
    types:
    - uid: string
  - name: Standard_NV24
    types:
    - uid: string
  - name: Standard_NV6
    types:
    - uid: string
- name: OSDiskType
  description: OSDiskType represents the type of an OS disk on an agent pool.
  kind: enum
  properties:
  - name: Managed
    types:
    - uid: string
  - name: Ephemeral
    types:
    - uid: string
- name: OSType
  description: OsType to be used to specify os type. Choose from Linux and Windows. Default to Linux.
  kind: enum
  properties:
  - name: Linux
    types:
    - uid: string
  - name: Windows
    types:
    - uid: string
- name: AgentPoolType
  description: AgentPoolType represents types of an agent pool.
  kind: enum
  properties:
  - name: VirtualMachineScaleSets
    types:
    - uid: string
  - name: AvailabilitySet
    types:
    - uid: string
- name: AgentPoolMode
  description: AgentPoolMode represents mode of an agent pool.
  kind: enum
  properties:
  - name: System
    types:
    - uid: string
  - name: User
    types:
    - uid: string
- name: ScaleSetPriority
  description: ScaleSetPriority to be used to specify virtual machine scale set priority. Default to regular.
  kind: enum
  properties:
  - name: Spot
    types:
    - uid: string
  - name: Regular
    types:
    - uid: string
- name: ScaleSetEvictionPolicy
  description: ScaleSetEvictionPolicy to be used to specify eviction policy for Spot virtual machine scale set. Default to Delete.
  kind: enum
  properties:
  - name: Delete
    types:
    - uid: string
  - name: Deallocate
    types:
    - uid: string
- name: CloudErrorBody
  description: An error response from the Container service.
  kind: object
  properties:
  - name: code
    description: An identifier for the error. Codes are invariant and are intended to be consumed programmatically.
    types:
    - uid: string
  - name: message
    description: A message describing the error, intended to be suitable for display in a user interface.
    types:
    - uid: string
  - name: target
    description: The target of the particular error. For example, the name of the property in error.
    types:
    - uid: string
  - name: details
    description: A list of additional details about the error.
    types:
    - uid: CloudErrorBody
      isArray: true
examples:
- name: Create/Update Agent Pool
  request:
    uri: PUT https://management.azure.com/subscriptions/subid1/resourceGroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1?api-version=2020-11-01
    body: >-
      {
        "properties": {
          "orchestratorVersion": "",
          "count": 3,
          "vmSize": "Standard_DS1_v2",
          "osType": "Linux",
          "tags": {
            "name1": "val1"
          },
          "nodeLabels": {
            "key1": "val1"
          },
          "nodeTaints": [
            "Key1=Value1:NoSchedule"
          ],
          "scaleSetPriority": "Spot",
          "scaleSetEvictionPolicy": "Delete",
          "mode": "User"
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Succeeded",
          "orchestratorVersion": "1.9.6",
          "count": 3,
          "vmSize": "Standard_DS1_v2",
          "maxPods": 110,
          "osType": "Linux",
          "tags": {
            "name1": "val1"
          },
          "nodeLabels": {
            "key1": "val1"
          },
          "nodeTaints": [
            "Key1=Value1:NoSchedule"
          ],
          "scaleSetPriority": "Spot",
          "scaleSetEvictionPolicy": "Delete",
          "mode": "User",
          "nodeImageVersion": "AKSUbuntu:1604:2020.03.11"
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Creating",
          "orchestratorVersion": "1.9.6",
          "count": 3,
          "vmSize": "Standard_DS1_v2",
          "maxPods": 110,
          "osType": "Linux",
          "tags": {
            "name1": "val1"
          },
          "nodeLabels": {
            "key1": "val1"
          },
          "nodeTaints": [
            "Key1=Value1:NoSchedule"
          ],
          "scaleSetPriority": "Spot",
          "scaleSetEvictionPolicy": "Delete",
          "mode": "User"
        }
      }
- name: Update Agent Pool
  request:
    uri: PUT https://management.azure.com/subscriptions/subid1/resourceGroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1?api-version=2020-11-01
    body: >-
      {
        "properties": {
          "orchestratorVersion": "",
          "count": 3,
          "enableAutoScaling": true,
          "minCount": 2,
          "maxCount": 2,
          "vmSize": "Standard_DS1_v2",
          "osType": "Linux",
          "nodeTaints": [
            "Key1=Value1:NoSchedule"
          ],
          "scaleSetPriority": "Spot",
          "scaleSetEvictionPolicy": "Delete"
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Succeeded",
          "orchestratorVersion": "1.9.6",
          "count": 3,
          "enableAutoScaling": true,
          "minCount": 2,
          "maxCount": 2,
          "vmSize": "Standard_DS1_v2",
          "maxPods": 110,
          "osType": "Linux",
          "nodeTaints": [
            "Key1=Value1:NoSchedule"
          ],
          "scaleSetPriority": "Spot",
          "scaleSetEvictionPolicy": "Delete"
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Updating",
          "orchestratorVersion": "1.9.6",
          "count": 3,
          "enableAutoScaling": true,
          "minCount": 2,
          "maxCount": 2,
          "vmSize": "Standard_DS1_v2",
          "maxPods": 110,
          "osType": "Linux",
          "nodeTaints": [
            "Key1=Value1:NoSchedule"
          ],
          "scaleSetPriority": "Spot",
          "scaleSetEvictionPolicy": "Delete"
        }
      }
- name: Create Spot Agent Pool
  request:
    uri: PUT https://management.azure.com/subscriptions/subid1/resourceGroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1?api-version=2020-11-01
    body: >-
      {
        "properties": {
          "orchestratorVersion": "",
          "count": 3,
          "vmSize": "Standard_DS1_v2",
          "osType": "Linux",
          "tags": {
            "name1": "val1"
          },
          "nodeLabels": {
            "key1": "val1"
          },
          "nodeTaints": [
            "Key1=Value1:NoSchedule"
          ],
          "scaleSetPriority": "Spot",
          "scaleSetEvictionPolicy": "Delete"
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Succeeded",
          "orchestratorVersion": "1.9.6",
          "count": 3,
          "vmSize": "Standard_DS1_v2",
          "maxPods": 110,
          "osType": "Linux",
          "tags": {
            "name1": "val1"
          },
          "nodeLabels": {
            "key1": "val1"
          },
          "nodeTaints": [
            "Key1=Value1:NoSchedule"
          ],
          "scaleSetPriority": "Spot",
          "scaleSetEvictionPolicy": "Delete",
          "spotMaxPrice": -1
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Creating",
          "orchestratorVersion": "1.9.6",
          "count": 3,
          "vmSize": "Standard_DS1_v2",
          "maxPods": 110,
          "osType": "Linux",
          "tags": {
            "name1": "val1"
          },
          "nodeLabels": {
            "key1": "val1"
          },
          "nodeTaints": [
            "Key1=Value1:NoSchedule"
          ],
          "scaleSetPriority": "Spot",
          "scaleSetEvictionPolicy": "Delete",
          "spotMaxPrice": -1
        }
      }
- name: Create Agent Pool with PPG
  request:
    uri: PUT https://management.azure.com/subscriptions/subid1/resourceGroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1?api-version=2020-11-01
    body: >-
      {
        "properties": {
          "orchestratorVersion": "",
          "count": 3,
          "vmSize": "Standard_DS2_v2",
          "osType": "Linux",
          "proximityPlacementGroupID": "/subscriptions/subid1/resourcegroups/rg1/providers//Microsoft.Compute/proximityPlacementGroups/ppg1"
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Succeeded",
          "orchestratorVersion": "1.9.6",
          "count": 3,
          "vmSize": "Standard_DS2_v2",
          "maxPods": 110,
          "osType": "Linux",
          "proximityPlacementGroupID": "/subscriptions/subid1/resourcegroups/rg1/providers//Microsoft.Compute/proximityPlacementGroups/ppg1"
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Creating",
          "orchestratorVersion": "1.9.6",
          "count": 3,
          "vmSize": "Standard_DS2_v2",
          "maxPods": 110,
          "osType": "Linux",
          "proximityPlacementGroupID": "/subscriptions/subid1/resourcegroups/rg1/providers//Microsoft.Compute/proximityPlacementGroups/ppg1"
        }
      }
- name: Create Agent Pool with Ephemeral OS Disk
  request:
    uri: PUT https://management.azure.com/subscriptions/subid1/resourceGroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1?api-version=2020-11-01
    body: >-
      {
        "properties": {
          "orchestratorVersion": "",
          "count": 3,
          "vmSize": "Standard_DS2_v2",
          "osType": "Linux",
          "osDiskType": "Ephemeral",
          "osDiskSizeGB": 64
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Succeeded",
          "orchestratorVersion": "1.17.8",
          "count": 3,
          "vmSize": "Standard_DS2_v2",
          "maxPods": 110,
          "osType": "Linux",
          "osDiskType": "Ephemeral",
          "osDiskSizeGB": 64
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Creating",
          "orchestratorVersion": "1.17.8",
          "count": 3,
          "vmSize": "Standard_DS2_v2",
          "maxPods": 110,
          "osType": "Linux",
          "osDiskType": "Ephemeral",
          "osDiskSizeGB": 64
        }
      }
- name: Create Agent Pool with KubeletConfig and LinuxOSConfig
  request:
    uri: PUT https://management.azure.com/subscriptions/subid1/resourceGroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1?api-version=2020-11-01
    body: >-
      {
        "properties": {
          "orchestratorVersion": "",
          "count": 3,
          "vmSize": "Standard_DS2_v2",
          "osType": "Linux",
          "kubeletConfig": {
            "cpuManagerPolicy": "static",
            "cpuCfsQuota": true,
            "cpuCfsQuotaPeriod": "200ms",
            "imageGcHighThreshold": 90,
            "imageGcLowThreshold": 70,
            "topologyManagerPolicy": "best-effort",
            "allowedUnsafeSysctls": [
              "kernel.msg*",
              "net.core.somaxconn"
            ],
            "failSwapOn": false
          },
          "linuxOSConfig": {
            "sysctls": {
              "netIpv4TcpWmem": 12345,
              "netIpv4TcpTwReuse": true,
              "netIpv4IpLocalPortRange": "20000 60000",
              "kernelThreadsMax": 99999
            },
            "transparentHugePageEnabled": "always",
            "transparentHugePageDefrag": "madvise",
            "swapFileSizeMB": 1500
          }
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Succeeded",
          "orchestratorVersion": "1.17.8",
          "count": 3,
          "vmSize": "Standard_DS2_v2",
          "maxPods": 110,
          "osType": "Linux",
          "kubeletConfig": {
            "cpuManagerPolicy": "static",
            "cpuCfsQuota": true,
            "cpuCfsQuotaPeriod": "200ms",
            "imageGcHighThreshold": 90,
            "imageGcLowThreshold": 70,
            "topologyManagerPolicy": "best-effort",
            "allowedUnsafeSysctls": [
              "kernel.msg*",
              "net.core.somaxconn"
            ],
            "failSwapOn": false
          },
          "linuxOSConfig": {
            "sysctls": {
              "netIpv4TcpWmem": 12345,
              "netIpv4TcpTwReuse": true,
              "netIpv4IpLocalPortRange": "20000 60000",
              "kernelThreadsMax": 99999
            },
            "transparentHugePageEnabled": "always",
            "transparentHugePageDefrag": "madvise",
            "swapFileSizeMB": 1500
          }
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1/agentPools/agentpool1",
        "type": "Microsoft.ContainerService/managedClusters/agentPools",
        "name": "agentpool1",
        "properties": {
          "provisioningState": "Creating",
          "orchestratorVersion": "1.17.8",
          "count": 3,
          "vmSize": "Standard_DS2_v2",
          "maxPods": 110,
          "osType": "Linux",
          "kubeletConfig": {
            "cpuManagerPolicy": "static",
            "cpuCfsQuota": true,
            "cpuCfsQuotaPeriod": "200ms",
            "imageGcHighThreshold": 90,
            "imageGcLowThreshold": 70,
            "topologyManagerPolicy": "best-effort",
            "allowedUnsafeSysctls": [
              "kernel.msg*",
              "net.core.somaxconn"
            ],
            "failSwapOn": false
          },
          "linuxOSConfig": {
            "sysctls": {
              "netIpv4TcpWmem": 12345,
              "netIpv4TcpTwReuse": true,
              "netIpv4IpLocalPortRange": "20000 60000",
              "kernelThreadsMax": 99999
            },
            "transparentHugePageEnabled": "always",
            "transparentHugePageDefrag": "madvise",
            "swapFileSizeMB": 1500
          }
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
errorCodes: []
