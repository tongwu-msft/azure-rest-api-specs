### YamlMime:RESTOperation
summary: Creates or updates a managed cluster. Creates or updates a managed cluster with the specified configuration for agents and Kubernetes version.
service: AKS
apiVersion: 2017-08-31
groupName: Managed Clusters
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ContainerService/managedClusters/{resourceName}?api-version=2017-08-31
uriParameters:
- in: path
  isRequired: true
  description: Subscription credentials which uniquely identify Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.
  types:
  - uid: string
  name: subscriptionId
- in: path
  isRequired: true
  description: The name of the resource group.
  types:
  - uid: string
  name: resourceGroupName
- in: path
  isRequired: true
  description: The name of the managed cluster resource.
  types:
  - uid: string
  name: resourceName
- in: query
  isRequired: true
  description: Client Api Version.
  types:
  - uid: string
  name: api-version
responses:
- description: OK
  types:
  - uid: ManagedCluster
  name: 200 OK
- description: Created
  types:
  - uid: ManagedCluster
  name: 201 Created
requestBody:
- parameters:
  - in: body
    isRequired: true
    description: Resource location
    types:
    - uid: string
    name: location
  - in: body
    description: Resource tags
    types:
    - isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
      uid: object
    name: tags
  - in: body
    description: Properties of a managed cluster.
    types:
    - uid: ManagedClusterProperties
    name: properties
requestHeader: []
definitions:
- name: ManagedClusterProperties
  description: Properties of a managed cluster.
  kind: object
  properties:
  - isReadyOnly: true
    description: The current deployment or provisioning state, which only appears in the response.
    types:
    - uid: string
    name: provisioningState
  - description: DNS prefix specified when creating the managed cluster.
    types:
    - uid: string
    name: dnsPrefix
  - isReadyOnly: true
    description: FDQN for the master pool.
    types:
    - uid: string
    name: fqdn
  - description: Version of Kubernetes specified when creating the managed cluster.
    types:
    - uid: string
    name: kubernetesVersion
  - description: Access profiles for the managed cluster.
    types:
    - uid: AccessProfiles
    name: accessProfiles
  - description: Profile for the container service agent pool.
    types:
    - isArray: true
      uid: ContainerServiceAgentPoolProfile
    name: agentPoolProfiles
  - description: Profile for Linux VMs in the container service cluster.
    types:
    - uid: ContainerServiceLinuxProfile
    name: linuxProfile
  - description: Information about a service principal identity for the cluster to use for manipulating Azure APIs. Either secret or keyVaultSecretRef must be specified.
    types:
    - uid: ContainerServiceServicePrincipalProfile
    name: servicePrincipalProfile
- name: ManagedCluster
  description: The list of managed clusters.
  kind: object
  properties:
  - isReadyOnly: true
    description: Resource Id
    types:
    - uid: string
    name: id
  - isReadyOnly: true
    description: Resource name
    types:
    - uid: string
    name: name
  - isReadyOnly: true
    description: Resource type
    types:
    - uid: string
    name: type
  - description: Resource location
    types:
    - uid: string
    name: location
  - description: Resource tags
    types:
    - isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
      uid: object
    name: tags
  - description: Properties of a managed cluster.
    types:
    - uid: ManagedClusterProperties
    name: properties
- name: AccessProfiles
  description: Access profiles for the managed cluster.
  kind: object
  properties:
  - description: An access profile with administrative privileges to the cluster.
    types:
    - uid: AccessProfile
    name: clusterAdmin
  - description: An access profile with user-level privileges to the cluster.
    types:
    - uid: AccessProfile
    name: clusterUser
- name: ContainerServiceAgentPoolProfile
  description: Profile for the container service agent pool.
  kind: object
  properties:
  - description: Unique name of the agent pool profile in the context of the subscription and resource group.
    types:
    - uid: string
    name: name
  - description: 'Number of agents (VMs) to host docker containers. Allowed values must be in the range of 1 to 100 (inclusive). The default value is 1. '
    types:
    - uid: integer
    name: count
  - description: Size of agent VMs.
    types:
    - uid: ContainerServiceVMSizeTypes
    name: vmSize
  - description: OS Disk Size in GB to be used to specify the disk size for every machine in this master/agent pool. If you specify 0, it will apply the default osDisk size according to the vmSize specified.
    types:
    - uid: integer
    name: osDiskSizeGB
  - description: DNS prefix to be used to create the FQDN for the agent pool.
    types:
    - uid: string
    name: dnsPrefix
  - isReadyOnly: true
    description: FDQN for the agent pool.
    types:
    - uid: string
    name: fqdn
  - description: Ports number array used to expose on this agent pool. The default opened ports are different based on your choice of orchestrator.
    types:
    - isArray: true
      uid: integer
    name: ports
  - description: Storage profile specifies what kind of storage used. Choose from StorageAccount and ManagedDisks. Leave it empty, we will choose for you based on the orchestrator choice.
    types:
    - uid: ContainerServiceStorageProfileTypes
    name: storageProfile
  - description: VNet SubnetID specifies the vnet's subnet identifier. If you specify either master VNet Subnet, or agent VNet Subnet, you need to specify both. And they have to be in the same VNet.
    types:
    - uid: string
    name: vnetSubnetID
  - description: OsType to be used to specify os type. Choose from Linux and Windows. Default to Linux.
    types:
    - uid: OSType
    name: osType
- name: ContainerServiceLinuxProfile
  description: Profile for Linux VMs in the container service cluster.
  kind: object
  properties:
  - description: The administrator username to use for Linux VMs.
    types:
    - uid: string
    name: adminUsername
  - description: SSH configuration for Linux-based VMs running on Azure.
    types:
    - uid: ContainerServiceSshConfiguration
    name: ssh
- name: ContainerServiceServicePrincipalProfile
  description: Information about a service principal identity for the cluster to use for manipulating Azure APIs. Either secret or keyVaultSecretRef must be specified.
  kind: object
  properties:
  - description: The ID for the service principal.
    types:
    - uid: string
    name: clientId
  - description: The secret password associated with the service principal in plain text.
    types:
    - uid: string
    name: secret
  - description: Reference to a secret stored in Azure Key Vault.
    types:
    - uid: KeyVaultSecretRef
    name: keyVaultSecretRef
- name: AccessProfile
  description: An access profile with administrative privileges to the cluster.
  kind: object
  properties:
  - description: Base64-encoded Kubernetes configuration file.
    types:
    - uid: string
    name: kubeConfig
- name: ContainerServiceVMSizeTypes
  description: Size of agent VMs.
  kind: enum
  properties:
  - types:
    - uid: string
    name: Standard_A0
  - types:
    - uid: string
    name: Standard_A1
  - types:
    - uid: string
    name: Standard_A10
  - types:
    - uid: string
    name: Standard_A11
  - types:
    - uid: string
    name: Standard_A1_v2
  - types:
    - uid: string
    name: Standard_A2
  - types:
    - uid: string
    name: Standard_A2_v2
  - types:
    - uid: string
    name: Standard_A2m_v2
  - types:
    - uid: string
    name: Standard_A3
  - types:
    - uid: string
    name: Standard_A4
  - types:
    - uid: string
    name: Standard_A4_v2
  - types:
    - uid: string
    name: Standard_A4m_v2
  - types:
    - uid: string
    name: Standard_A5
  - types:
    - uid: string
    name: Standard_A6
  - types:
    - uid: string
    name: Standard_A7
  - types:
    - uid: string
    name: Standard_A8
  - types:
    - uid: string
    name: Standard_A8_v2
  - types:
    - uid: string
    name: Standard_A8m_v2
  - types:
    - uid: string
    name: Standard_A9
  - types:
    - uid: string
    name: Standard_D1
  - types:
    - uid: string
    name: Standard_D11
  - types:
    - uid: string
    name: Standard_D11_v2
  - types:
    - uid: string
    name: Standard_D11_v2_Promo
  - types:
    - uid: string
    name: Standard_D12
  - types:
    - uid: string
    name: Standard_D12_v2
  - types:
    - uid: string
    name: Standard_D12_v2_Promo
  - types:
    - uid: string
    name: Standard_D13
  - types:
    - uid: string
    name: Standard_D13_v2
  - types:
    - uid: string
    name: Standard_D13_v2_Promo
  - types:
    - uid: string
    name: Standard_D14
  - types:
    - uid: string
    name: Standard_D14_v2
  - types:
    - uid: string
    name: Standard_D14_v2_Promo
  - types:
    - uid: string
    name: Standard_D15_v2
  - types:
    - uid: string
    name: Standard_D16_v3
  - types:
    - uid: string
    name: Standard_D16s_v3
  - types:
    - uid: string
    name: Standard_D1_v2
  - types:
    - uid: string
    name: Standard_D2
  - types:
    - uid: string
    name: Standard_D2_v2
  - types:
    - uid: string
    name: Standard_D2_v2_Promo
  - types:
    - uid: string
    name: Standard_D2_v3
  - types:
    - uid: string
    name: Standard_D2s_v3
  - types:
    - uid: string
    name: Standard_D3
  - types:
    - uid: string
    name: Standard_D3_v2
  - types:
    - uid: string
    name: Standard_D3_v2_Promo
  - types:
    - uid: string
    name: Standard_D4
  - types:
    - uid: string
    name: Standard_D4_v2
  - types:
    - uid: string
    name: Standard_D4_v2_Promo
  - types:
    - uid: string
    name: Standard_D4_v3
  - types:
    - uid: string
    name: Standard_D4s_v3
  - types:
    - uid: string
    name: Standard_D5_v2
  - types:
    - uid: string
    name: Standard_D5_v2_Promo
  - types:
    - uid: string
    name: Standard_D8_v3
  - types:
    - uid: string
    name: Standard_D8s_v3
  - types:
    - uid: string
    name: Standard_DS1
  - types:
    - uid: string
    name: Standard_DS11
  - types:
    - uid: string
    name: Standard_DS11_v2
  - types:
    - uid: string
    name: Standard_DS11_v2_Promo
  - types:
    - uid: string
    name: Standard_DS12
  - types:
    - uid: string
    name: Standard_DS12_v2
  - types:
    - uid: string
    name: Standard_DS12_v2_Promo
  - types:
    - uid: string
    name: Standard_DS13
  - types:
    - uid: string
    name: Standard_DS13_v2
  - types:
    - uid: string
    name: Standard_DS13_v2_Promo
  - types:
    - uid: string
    name: Standard_DS14
  - types:
    - uid: string
    name: Standard_DS14_v2
  - types:
    - uid: string
    name: Standard_DS14_v2_Promo
  - types:
    - uid: string
    name: Standard_DS15_v2
  - types:
    - uid: string
    name: Standard_DS1_v2
  - types:
    - uid: string
    name: Standard_DS2
  - types:
    - uid: string
    name: Standard_DS2_v2
  - types:
    - uid: string
    name: Standard_DS2_v2_Promo
  - types:
    - uid: string
    name: Standard_DS3
  - types:
    - uid: string
    name: Standard_DS3_v2
  - types:
    - uid: string
    name: Standard_DS3_v2_Promo
  - types:
    - uid: string
    name: Standard_DS4
  - types:
    - uid: string
    name: Standard_DS4_v2
  - types:
    - uid: string
    name: Standard_DS4_v2_Promo
  - types:
    - uid: string
    name: Standard_DS5_v2
  - types:
    - uid: string
    name: Standard_DS5_v2_Promo
  - types:
    - uid: string
    name: Standard_E16_v3
  - types:
    - uid: string
    name: Standard_E16s_v3
  - types:
    - uid: string
    name: Standard_E2_v3
  - types:
    - uid: string
    name: Standard_E2s_v3
  - types:
    - uid: string
    name: Standard_E32_v3
  - types:
    - uid: string
    name: Standard_E32s_v3
  - types:
    - uid: string
    name: Standard_E4_v3
  - types:
    - uid: string
    name: Standard_E4s_v3
  - types:
    - uid: string
    name: Standard_E64_v3
  - types:
    - uid: string
    name: Standard_E64s_v3
  - types:
    - uid: string
    name: Standard_E8_v3
  - types:
    - uid: string
    name: Standard_E8s_v3
  - types:
    - uid: string
    name: Standard_F1
  - types:
    - uid: string
    name: Standard_F16
  - types:
    - uid: string
    name: Standard_F16s
  - types:
    - uid: string
    name: Standard_F1s
  - types:
    - uid: string
    name: Standard_F2
  - types:
    - uid: string
    name: Standard_F2s
  - types:
    - uid: string
    name: Standard_F4
  - types:
    - uid: string
    name: Standard_F4s
  - types:
    - uid: string
    name: Standard_F8
  - types:
    - uid: string
    name: Standard_F8s
  - types:
    - uid: string
    name: Standard_G1
  - types:
    - uid: string
    name: Standard_G2
  - types:
    - uid: string
    name: Standard_G3
  - types:
    - uid: string
    name: Standard_G4
  - types:
    - uid: string
    name: Standard_G5
  - types:
    - uid: string
    name: Standard_GS1
  - types:
    - uid: string
    name: Standard_GS2
  - types:
    - uid: string
    name: Standard_GS3
  - types:
    - uid: string
    name: Standard_GS4
  - types:
    - uid: string
    name: Standard_GS5
  - types:
    - uid: string
    name: Standard_H16
  - types:
    - uid: string
    name: Standard_H16m
  - types:
    - uid: string
    name: Standard_H16mr
  - types:
    - uid: string
    name: Standard_H16r
  - types:
    - uid: string
    name: Standard_H8
  - types:
    - uid: string
    name: Standard_H8m
  - types:
    - uid: string
    name: Standard_L16s
  - types:
    - uid: string
    name: Standard_L32s
  - types:
    - uid: string
    name: Standard_L4s
  - types:
    - uid: string
    name: Standard_L8s
  - types:
    - uid: string
    name: Standard_M128s
  - types:
    - uid: string
    name: Standard_M64ms
  - types:
    - uid: string
    name: Standard_NC12
  - types:
    - uid: string
    name: Standard_NC24
  - types:
    - uid: string
    name: Standard_NC24r
  - types:
    - uid: string
    name: Standard_NC6
  - types:
    - uid: string
    name: Standard_NV12
  - types:
    - uid: string
    name: Standard_NV24
  - types:
    - uid: string
    name: Standard_NV6
- name: ContainerServiceStorageProfileTypes
  description: Storage profile specifies what kind of storage used. Choose from StorageAccount and ManagedDisks. Leave it empty, we will choose for you based on the orchestrator choice.
  kind: enum
  properties:
  - types:
    - uid: string
    name: StorageAccount
  - types:
    - uid: string
    name: ManagedDisks
- name: OSType
  description: OsType to be used to specify os type. Choose from Linux and Windows. Default to Linux.
  kind: enum
  properties:
  - types:
    - uid: string
    name: Linux
  - types:
    - uid: string
    name: Windows
- name: ContainerServiceSshConfiguration
  description: SSH configuration for Linux-based VMs running on Azure.
  kind: object
  properties:
  - description: Contains information about SSH certificate public key data.
    types:
    - isArray: true
      uid: ContainerServiceSshPublicKey
    name: publicKeys
- name: KeyVaultSecretRef
  description: Reference to a secret stored in Azure Key Vault.
  kind: object
  properties:
  - description: Key vault identifier.
    types:
    - uid: string
    name: vaultID
  - description: The secret name.
    types:
    - uid: string
    name: secretName
  - description: The secret version.
    types:
    - uid: string
    name: version
- name: ContainerServiceSshPublicKey
  description: The list of SSH public keys used to authenticate with Linux-based VMs. Only expect one key specified.
  kind: object
  properties:
  - description: Certificate public key used to authenticate with VMs through SSH. The certificate must be in PEM format with or without headers.
    types:
    - uid: string
    name: keyData
examples:
- request:
    uri: PUT https://management.azure.com/subscriptions/subid1/resourceGroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1?api-version=2017-08-31
    body: >-
      {
        "location": "location1",
        "properties": {
          "dnsPrefix": "dnsprefix1",
          "agentPoolProfiles": [
            {
              "count": 1,
              "name": "agentpool1",
              "vmSize": "Standard_D2_v2"
            }
          ],
          "kubernetesVersion": "1.7.7"
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1",
        "location": "location1",
        "name": "mycluster1",
        "properties": {
          "accessProfiles": {
            "clusterAdmin": {
              "kubeConfig": "kubeConfig1"
            },
            "clusterUser": {
              "kubeConfig": "kubeConfig2"
            }
          },
          "agentPoolProfiles": [
            {
              "count": 1,
              "dnsPrefix": "agentpool1dnsPrefix",
              "fqdn": "agentpool1fqdn",
              "name": "agentpool1",
              "osType": "Linux",
              "ports": [
                1
              ],
              "storageProfile": "ManagedDisks",
              "vmSize": "Standard_D2_v2"
            }
          ],
          "dnsPrefix": "dnsprefix1",
          "fqdn": "dnsprefix1-123456.abc.location1.azmk8s.io",
          "kubernetesVersion": "1.7.7",
          "linuxProfile": {
            "adminUsername": "azureuser",
            "ssh": {
              "publicKeys": [
                {
                  "keyData": "keydata"
                }
              ]
            }
          },
          "provisioningState": "Succeeded",
          "servicePrincipalProfile": {
            "clientId": "clientid",
            "keyVaultSecretRef": null,
            "secret": "secret"
          }
        },
        "tags": "managedcluster",
        "type": "Microsoft.ContainerService/ManagedClusters"
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1",
        "location": "location1",
        "name": "mycluster1",
        "properties": {
          "accessProfiles": {
            "clusterAdmin": {
              "kubeConfig": "kubeConfig1"
            },
            "clusterUser": {
              "kubeConfig": "kubeConfig2"
            }
          },
          "agentPoolProfiles": [
            {
              "count": 1,
              "dnsPrefix": "agentpool1dnsPrefix",
              "fqdn": "agentpool1fqdn",
              "name": "agentpool1",
              "osType": "Linux",
              "ports": [
                1
              ],
              "storageProfile": "ManagedDisks",
              "vmSize": "Standard_D2_v2"
            }
          ],
          "dnsPrefix": "dnsprefix1",
          "fqdn": "dnsprefix1-123456.abc.location1.azmk8s.io",
          "kubernetesVersion": "1.7.7",
          "linuxProfile": {
            "adminUsername": "azureuser",
            "ssh": {
              "publicKeys": [
                {
                  "keyData": "keydata"
                }
              ]
            }
          },
          "provisioningState": "Succeeded",
          "servicePrincipalProfile": {
            "clientId": "clientid",
            "keyVaultSecretRef": null,
            "secret": "secret"
          }
        },
        "tags": "managedcluster",
        "type": "Microsoft.ContainerService/ManagedClusters"
      }
  name: Create/Update Managed Cluster
security:
- type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - description: impersonate your user account
    name: user_impersonation
name: Create Or Update
uid: management.azure.com.aks.managedclusters.createorupdate
