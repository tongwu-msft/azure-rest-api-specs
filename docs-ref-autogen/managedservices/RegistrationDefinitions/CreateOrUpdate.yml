### YamlMime:RESTOperation
uid: management.azure.com.managedservices.registrationdefinitions.createorupdate
name: Create Or Update
service: Managed Services
groupName: Registration Definitions
apiVersion: 2019-06-01
summary: Creates or updates a registration definition.
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/{scope}/providers/Microsoft.ManagedServices/registrationDefinitions/{registrationDefinitionId}?api-version=2019-06-01
uriParameters:
- name: scope
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: Scope of the resource.
  types:
  - uid: string
- name: registrationDefinitionId
  in: path
  isRequired: true
  description: Guid of the registration definition.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The API version to use for this operation.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Ok - Returns information about the updated registration definition.
  types:
  - uid: RegistrationDefinition
- name: 201 Created
  description: Created - Returns information about the created registration definition.
  types:
  - uid: RegistrationDefinition
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: properties
    in: body
    description: Properties of a registration definition.
    types:
    - uid: RegistrationDefinitionProperties
  - name: plan
    in: body
    description: Plan details for the managed services.
    types:
    - uid: Plan
requestHeader: []
definitions:
- name: RegistrationDefinitionProperties
  description: Properties of a registration definition.
  kind: object
  properties:
  - name: description
    description: Description of the registration definition.
    types:
    - uid: string
  - name: authorizations
    description: Authorization tuple containing principal id of the user/security group or service principal and id of the build-in role.
    types:
    - uid: Authorization
      isArray: true
  - name: registrationDefinitionName
    description: Name of the registration definition.
    types:
    - uid: string
  - name: managedByTenantId
    description: Id of the managedBy tenant.
    types:
    - uid: string
  - name: provisioningState
    isReadyOnly: true
    description: Current state of the registration definition.
    types:
    - uid: ProvisioningState
  - name: managedByTenantName
    isReadyOnly: true
    description: Name of the managedBy tenant.
    types:
    - uid: string
- name: Plan
  description: Plan details for the managed services.
  kind: object
  properties:
  - name: name
    description: The plan name.
    types:
    - uid: string
  - name: publisher
    description: The publisher ID.
    types:
    - uid: string
  - name: product
    description: The product code.
    types:
    - uid: string
  - name: version
    description: The plan's version.
    types:
    - uid: string
- name: RegistrationDefinition
  description: Registration definition.
  kind: object
  properties:
  - name: properties
    description: Properties of a registration definition.
    types:
    - uid: RegistrationDefinitionProperties
  - name: plan
    description: Plan details for the managed services.
    types:
    - uid: Plan
  - name: id
    isReadyOnly: true
    description: Fully qualified path of the registration definition.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Type of the resource.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Name of the registration definition.
    types:
    - uid: string
- name: ErrorResponse
  description: Error response.
  kind: object
  properties:
  - name: error
    description: The error details.
    types:
    - uid: ErrorDefinition
- name: Authorization
  description: Authorization tuple containing principal Id (of user/service principal/security group) and role definition id.
  kind: object
  properties:
  - name: principalId
    description: Principal Id of the security group/service principal/user that would be assigned permissions to the projected subscription
    types:
    - uid: string
  - name: principalIdDisplayName
    description: Display name of the principal Id.
    types:
    - uid: string
  - name: roleDefinitionId
    description: The role definition identifier. This role will define all the permissions that the security group/service principal/user must have on the projected subscription. This role cannot be an owner role.
    types:
    - uid: string
  - name: delegatedRoleDefinitionIds
    description: The delegatedRoleDefinitionIds field is required when the roleDefinitionId refers to the User Access Administrator Role. It is the list of role definition ids which define all the permissions that the user in the authorization can assign to other security groups/service principals/users.
    types:
    - uid: string
      isArray: true
- name: ProvisioningState
  description: Current state of the registration definition.
  kind: enum
  properties:
  - name: NotSpecified
    types:
    - uid: string
  - name: Accepted
    types:
    - uid: string
  - name: Running
    types:
    - uid: string
  - name: Ready
    types:
    - uid: string
  - name: Creating
    types:
    - uid: string
  - name: Created
    types:
    - uid: string
  - name: Deleting
    types:
    - uid: string
  - name: Deleted
    types:
    - uid: string
  - name: Canceled
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
  - name: Succeeded
    types:
    - uid: string
  - name: Updating
    types:
    - uid: string
- name: ErrorDefinition
  description: Error response indicates Azure Resource Manager is not able to process the incoming request. The reason is provided in the error message.
  kind: object
  properties:
  - name: code
    description: Error code.
    types:
    - uid: string
  - name: message
    description: Error message indicating why the operation failed.
    types:
    - uid: string
  - name: details
    description: Internal error details.
    types:
    - uid: ErrorDefinition
      isArray: true
examples:
- name: Put Registration Definition
  request:
    uri: PUT https://management.azure.com/subscription/0afefe50-734e-4610-8a82-a144ahf49dea/providers/Microsoft.ManagedServices/registrationDefinitions/26c128c2-fefa-4340-9bb1-6e081c90ada2?api-version=2019-06-01
    body: >-
      {
        "properties": {
          "registrationDefinitionName": "DefinitionName",
          "description": "Tes1t",
          "managedByTenantId": "83abe5cd-bcc3-441a-bd86-e6a75360cecc",
          "authorizations": [
            {
              "principalId": "f98d86a2-4cc4-4e9d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "Support User",
              "roleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7"
            },
            {
              "principalId": "f98d86a2-4cc4-4e9d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "User Access Administrator",
              "roleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
              "delegatedRoleDefinitionIds": [
                "b24988ac-6180-42a0-ab88-20f7382dd24c"
              ]
            }
          ]
        },
        "plan": {
          "name": "addesai-plan",
          "product": "test",
          "publisher": "marketplace-test",
          "version": "1.0.0"
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "properties": {
          "description": "Test",
          "managedByTenantId": "83ace5cd-bcc3-441a-hd86-e6a75360cecc",
          "registrationDefinitionName": "DefinitionName",
          "authorizations": [
            {
              "principalId": "f98g86a2-4cc4-4e6d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "Support User",
              "roleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7"
            },
            {
              "principalId": "f98d86a2-4cc4-4e9d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "User Access Administrator",
              "roleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
              "delegatedRoleDefinitionIds": [
                "b24988ac-6180-42a0-ab88-20f7382dd24c"
              ]
            }
          ],
          "provisioningState": "Succeeded",
          "managedByTenantName": "Test Tenant"
        },
        "plan": {
          "name": "addesai-plan",
          "product": "test",
          "publisher": "marketplace-test",
          "version": "1.0.0"
        },
        "id": "/subscriptions/0afefe50-734e-4610-8a82-a144ahf49dea/providers/Microsoft.ManagedServices/registrationDefinitions/26c128c2-fefa-4340-9bb1-6e081c90ada2",
        "type": "Microsoft.ManagedServices/registrationDefinitions",
        "name": "26c128c2-fefa-4340-9bb1-6e081c90ada2"
      }
  - statusCode: "201"
    body: >-
      {
        "properties": {
          "description": "Test",
          "managedByTenantId": "83ace5cd-bcc3-441a-hd86-e6a75360cecc",
          "registrationDefinitionName": "DefinitionName",
          "authorizations": [
            {
              "principalId": "f98g86a2-4cc4-4e6d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "Support User",
              "roleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7"
            },
            {
              "principalId": "f98d86a2-4cc4-4e9d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "User Access Administrator",
              "roleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
              "delegatedRoleDefinitionIds": [
                "b24988ac-6180-42a0-ab88-20f7382dd24c"
              ]
            }
          ],
          "provisioningState": "Succeeded",
          "managedByTenantName": "Test Tenant"
        },
        "plan": {
          "name": "addesai-plan",
          "product": "test",
          "publisher": "marketplace-test",
          "version": "1.0.0"
        },
        "id": "/subscriptions/0afefe50-734e-4610-8a82-a144ahf49dea/providers/Microsoft.ManagedServices/registrationDefinitions/26c128c2-fefa-4340-9bb1-6e081c90ada2",
        "type": "Microsoft.ManagedServices/registrationDefinitions",
        "name": "26c128c2-fefa-4340-9bb1-6e081c90ada2"
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
errorCodes: []
