### YamlMime:RESTOperation
uid: management.azure.com.managedservices.registrationdefinitions.createorupdate
name: Create Or Update
service: Managed Services
groupName: Registration Definitions
apiVersion: 2020-02-01-preview
summary: Creates or updates a registration definition.
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/{scope}/providers/Microsoft.ManagedServices/registrationDefinitions/{registrationDefinitionId}?api-version=2020-02-01-preview
uriParameters:
- name: scope
  in: path
  isRequired: true
  skipUrlEncoding: true
  description: The scope of the resource.
  types:
  - uid: string
- name: registrationDefinitionId
  in: path
  isRequired: true
  description: The GUID of the registration definition.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The API version to use for this operation.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Ok - Returns information about the updated registration definition.
  types:
  - uid: RegistrationDefinition
- name: 201 Created
  description: Created - Returns information about the created registration definition.
  types:
  - uid: RegistrationDefinition
- name: Other Status Codes
  description: The error response describing why the operation failed.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: properties
    in: body
    description: The properties of a registration definition.
    types:
    - uid: RegistrationDefinitionProperties
  - name: plan
    in: body
    description: The details for the Managed Services offer’s plan in Azure Marketplace.
    types:
    - uid: Plan
requestHeader: []
definitions:
- name: RegistrationDefinitionProperties
  description: The properties of a registration definition.
  kind: object
  properties:
  - name: description
    description: The description of the registration definition.
    types:
    - uid: string
  - name: authorizations
    description: The collection of authorization objects describing the access Azure Active Directory principals in the managedBy tenant will receive on the delegated resource in the managed tenant.
    types:
    - uid: Authorization
      isArray: true
  - name: eligibleAuthorizations
    description: The collection of eligible authorization objects describing the just-in-time access Azure Active Directory principals in the managedBy tenant will receive on the delegated resource in the managed tenant.
    types:
    - uid: EligibleAuthorization
      isArray: true
  - name: registrationDefinitionName
    description: The name of the registration definition.
    types:
    - uid: string
  - name: managedByTenantId
    description: The identifier of the managedBy tenant.
    types:
    - uid: string
  - name: provisioningState
    isReadyOnly: true
    description: The current provisioning state of the registration definition.
    types:
    - uid: ProvisioningState
  - name: managedByTenantName
    isReadyOnly: true
    description: The name of the managedBy tenant.
    types:
    - uid: string
- name: Plan
  description: The details for the Managed Services offer’s plan in Azure Marketplace.
  kind: object
  properties:
  - name: name
    description: Azure Marketplace plan name.
    types:
    - uid: string
  - name: publisher
    description: Azure Marketplace publisher ID.
    types:
    - uid: string
  - name: product
    description: Azure Marketplace product code.
    types:
    - uid: string
  - name: version
    description: Azure Marketplace plan's version.
    types:
    - uid: string
- name: RegistrationDefinition
  description: The registration definition.
  kind: object
  properties:
  - name: properties
    description: The properties of a registration definition.
    types:
    - uid: RegistrationDefinitionProperties
  - name: plan
    description: The details for the Managed Services offer’s plan in Azure Marketplace.
    types:
    - uid: Plan
  - name: id
    isReadyOnly: true
    description: The fully qualified path of the registration definition.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the Azure resource (Microsoft.ManagedServices/registrationDefinitions).
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the registration definition.
    types:
    - uid: string
- name: ErrorResponse
  description: Error response.
  kind: object
  properties:
  - name: error
    description: The error details.
    types:
    - uid: ErrorDefinition
- name: Authorization
  description: The Azure Active Directory principal identifier and Azure built-in role that describes the access the principal will receive on the delegated resource in the managed tenant.
  kind: object
  properties:
  - name: principalId
    description: The identifier of the Azure Active Directory principal.
    types:
    - uid: string
  - name: principalIdDisplayName
    description: The display name of the Azure Active Directory principal.
    types:
    - uid: string
  - name: roleDefinitionId
    description: The identifier of the Azure built-in role that defines the permissions that the Azure Active Directory principal will have on the projected scope.
    types:
    - uid: string
  - name: delegatedRoleDefinitionIds
    description: The delegatedRoleDefinitionIds field is required when the roleDefinitionId refers to the User Access Administrator Role. It is the list of role definition ids which define all the permissions that the user in the authorization can assign to other principals.
    types:
    - uid: string
      isArray: true
- name: EligibleAuthorization
  description: The Azure Active Directory principal identifier, Azure built-in role, and just-in-time access policy that describes the just-in-time access the principal will receive on the delegated resource in the managed tenant.
  kind: object
  properties:
  - name: principalId
    description: The identifier of the Azure Active Directory principal.
    types:
    - uid: string
  - name: principalIdDisplayName
    description: The display name of the Azure Active Directory principal.
    types:
    - uid: string
  - name: roleDefinitionId
    description: The identifier of the Azure built-in role that defines the permissions that the Azure Active Directory principal will have on the projected scope.
    types:
    - uid: string
  - name: justInTimeAccessPolicy
    description: The just-in-time access policy setting.
    types:
    - uid: JustInTimeAccessPolicy
- name: ProvisioningState
  description: The current provisioning state of the registration definition.
  kind: enum
  properties:
  - name: NotSpecified
    types:
    - uid: string
  - name: Accepted
    types:
    - uid: string
  - name: Running
    types:
    - uid: string
  - name: Ready
    types:
    - uid: string
  - name: Creating
    types:
    - uid: string
  - name: Created
    types:
    - uid: string
  - name: Deleting
    types:
    - uid: string
  - name: Deleted
    types:
    - uid: string
  - name: Canceled
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
  - name: Succeeded
    types:
    - uid: string
  - name: Updating
    types:
    - uid: string
- name: ErrorDefinition
  description: The error response indicating why the incoming request wasn’t able to be processed
  kind: object
  properties:
  - name: code
    description: The error code.
    types:
    - uid: string
  - name: message
    description: The error message indicating why the operation failed.
    types:
    - uid: string
  - name: details
    description: The internal error details.
    types:
    - uid: ErrorDefinition
      isArray: true
- name: JustInTimeAccessPolicy
  description: Just-in-time access policy setting.
  kind: object
  properties:
  - name: multiFactorAuthProvider
    description: The multi-factor authorization provider to be used for just-in-time access requests.
    types:
    - uid: MultiFactorAuthProvider
  - name: maximumActivationDuration
    description: The maximum access duration in ISO 8601 format for just-in-time access requests.
    types:
    - uid: string
  - name: managedByTenantApprovers
    description: The list of managedByTenant approvers for the eligible authorization.
    types:
    - uid: EligibleApprover
      isArray: true
- name: MultiFactorAuthProvider
  description: The multi-factor authorization provider to be used for just-in-time access requests.
  kind: enum
  properties:
  - name: Azure
    types:
    - uid: string
  - name: None
    types:
    - uid: string
- name: EligibleApprover
  description: Defines the Azure Active Directory principal that can approve any just-in-time access requests by the principal defined in the EligibleAuthorization.
  kind: object
  properties:
  - name: principalId
    description: The identifier of the Azure Active Directory principal.
    types:
    - uid: string
  - name: principalIdDisplayName
    description: The display name of the Azure Active Directory principal.
    types:
    - uid: string
examples:
- name: Put Registration Definition
  request:
    uri: PUT https://management.azure.com/subscription/0afefe50-734e-4610-8a82-a144ahf49dea/providers/Microsoft.ManagedServices/registrationDefinitions/26c128c2-fefa-4340-9bb1-6e081c90ada2?api-version=2020-02-01-preview
    body: >-
      {
        "properties": {
          "registrationDefinitionName": "DefinitionName",
          "description": "Tes1t",
          "managedByTenantId": "83abe5cd-bcc3-441a-bd86-e6a75360cecc",
          "authorizations": [
            {
              "principalId": "f98d86a2-4cc4-4e9d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "Support User",
              "roleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7"
            },
            {
              "principalId": "f98d86a2-4cc4-4e9d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "User Access Administrator",
              "roleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
              "delegatedRoleDefinitionIds": [
                "b24988ac-6180-42a0-ab88-20f7382dd24c"
              ]
            }
          ],
          "eligibleAuthorizations": [
            {
              "principalId": "3e0ed8c6-e902-4fc5-863c-e3ddbb2ae2a2",
              "principalIdDisplayName": "Support User",
              "roleDefinitionId": "ae349356-3a1b-4a5e-921d-050484c6347e",
              "justInTimeAccessPolicy": {
                "multiFactorAuthProvider": "Azure",
                "maximumActivationDuration": "PT8H",
                "managedByTenantApprovers": [
                  {
                    "principalId": "d9b22cd6-6407-43cc-8c60-07c56df0b51a",
                    "principalIdDisplayName": "Approver Group"
                  }
                ]
              }
            }
          ]
        },
        "plan": {
          "name": "addesai-plan",
          "product": "test",
          "publisher": "marketplace-test",
          "version": "1.0.0"
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "properties": {
          "description": "Test",
          "managedByTenantId": "83ace5cd-bcc3-441a-hd86-e6a75360cecc",
          "registrationDefinitionName": "DefinitionName",
          "authorizations": [
            {
              "principalId": "f98g86a2-4cc4-4e6d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "Support User",
              "roleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7"
            },
            {
              "principalId": "f98d86a2-4cc4-4e9d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "User Access Administrator",
              "roleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
              "delegatedRoleDefinitionIds": [
                "b24988ac-6180-42a0-ab88-20f7382dd24c"
              ]
            }
          ],
          "eligibleAuthorizations": [
            {
              "justInTimeAccessPolicy": {
                "multiFactorAuthProvider": "Azure",
                "maximumActivationDuration": "PT8H",
                "managedByTenantApprovers": [
                  {
                    "principalId": "d9b22cd6-6407-43cc-8c60-07c56df0b51a",
                    "principalIdDisplayName": "Approver Group"
                  }
                ]
              },
              "principalId": "3e0ed8c6-e902-4fc5-863c-e3ddbb2ae2a2",
              "principalIdDisplayName": "Support User",
              "roleDefinitionId": "ae349356-3a1b-4a5e-921d-050484c6347e"
            }
          ],
          "provisioningState": "Succeeded",
          "managedByTenantName": "Test Tenant"
        },
        "plan": {
          "name": "addesai-plan",
          "product": "test",
          "publisher": "marketplace-test",
          "version": "1.0.0"
        },
        "id": "/subscriptions/0afefe50-734e-4610-8a82-a144ahf49dea/providers/Microsoft.ManagedServices/registrationDefinitions/26c128c2-fefa-4340-9bb1-6e081c90ada2",
        "type": "Microsoft.ManagedServices/registrationDefinitions",
        "name": "26c128c2-fefa-4340-9bb1-6e081c90ada2"
      }
  - statusCode: "201"
    body: >-
      {
        "properties": {
          "description": "Test",
          "managedByTenantId": "83ace5cd-bcc3-441a-hd86-e6a75360cecc",
          "registrationDefinitionName": "DefinitionName",
          "authorizations": [
            {
              "principalId": "f98g86a2-4cc4-4e6d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "Support User",
              "roleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7"
            },
            {
              "principalId": "f98d86a2-4cc4-4e9d-ad47-b3e80a1bcdfc",
              "principalIdDisplayName": "User Access Administrator",
              "roleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
              "delegatedRoleDefinitionIds": [
                "b24988ac-6180-42a0-ab88-20f7382dd24c"
              ]
            }
          ],
          "eligibleAuthorizations": [
            {
              "justInTimeAccessPolicy": {
                "multiFactorAuthProvider": "Azure",
                "maximumActivationDuration": "PT8H",
                "managedByTenantApprovers": [
                  {
                    "principalId": "d9b22cd6-6407-43cc-8c60-07c56df0b51a",
                    "principalIdDisplayName": "Approver Group"
                  }
                ]
              },
              "principalId": "3e0ed8c6-e902-4fc5-863c-e3ddbb2ae2a2",
              "principalIdDisplayName": "Support User",
              "roleDefinitionId": "ae349356-3a1b-4a5e-921d-050484c6347e"
            }
          ],
          "provisioningState": "Succeeded",
          "managedByTenantName": "Test Tenant"
        },
        "plan": {
          "name": "addesai-plan",
          "product": "test",
          "publisher": "marketplace-test",
          "version": "1.0.0"
        },
        "id": "/subscriptions/0afefe50-734e-4610-8a82-a144ahf49dea/providers/Microsoft.ManagedServices/registrationDefinitions/26c128c2-fefa-4340-9bb1-6e081c90ada2",
        "type": "Microsoft.ManagedServices/registrationDefinitions",
        "name": "26c128c2-fefa-4340-9bb1-6e081c90ada2"
      }
security:
- name: azure_auth
  type: oauth2
  description: The Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: Learn more about Managed Services service - Creates or updates a registration definition.
errorCodes: []
