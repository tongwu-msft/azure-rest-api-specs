### YamlMime:RESTOperation
uid: management.azure.com.batchmanagement.batchaccount.update
name: Update
service: Batch Management
groupName: Batch Account
apiVersion: 2022-06-01
summary: Updates the properties of an existing Batch account.
consumes:
- application/json
produces:
- application/json
paths:
- content: PATCH https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Batch/batchAccounts/{accountName}?api-version=2022-06-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The Azure subscription ID. This is a GUID-formatted string (e.g. 00000000-0000-0000-0000-000000000000)
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group that contains the Batch account.
  types:
  - uid: string
- name: accountName
  in: path
  isRequired: true
  description: The name of the Batch account.
  types:
  - uid: string
  pattern: ^[a-zA-Z0-9]+$
- name: api-version
  in: query
  isRequired: true
  description: The API version to be used with the HTTP request.
  types:
  - uid: string
responses:
- name: 200 OK
  description: The operation was successful. The response contains the Batch account entity.
  types:
  - uid: BatchAccount
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: CloudError
requestBody:
- name: default
  parameters:
  - name: tags
    in: body
    description: The user-specified tags associated with the account.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: identity
    in: body
    description: The identity of the Batch account.
    types:
    - uid: BatchAccountIdentity
  - name: properties.autoStorage
    in: body
    description: The properties related to the auto-storage account.
    types:
    - uid: AutoStorageBaseProperties
  - name: properties.encryption
    in: body
    description: "The encryption configuration for the Batch account.  \nConfigures how customer data is encrypted inside the Batch account. By default, accounts are encrypted using a Microsoft managed key. For additional control, a customer-managed key can be used instead."
    types:
    - uid: EncryptionProperties
  - name: properties.allowedAuthenticationModes
    in: body
    description: List of allowed authentication modes for the Batch account that can be used to authenticate with the data plane. This does not affect authentication with the control plane.
    types:
    - uid: string
      isArray: true
  - name: properties.publicNetworkAccess
    in: body
    description: "The network access type for accessing Azure Batch account.  \nIf not specified, the default value is 'enabled'."
    types:
    - uid: PublicNetworkAccessType
  - name: properties.networkProfile
    in: body
    description: "Network profile for Batch account, which contains network rule settings for each endpoint.  \nThe network profile only takes effect when publicNetworkAccess is enabled."
    types:
    - uid: NetworkProfile
requestHeader: []
definitions:
- name: BatchAccountIdentity
  description: The identity of the Batch account, if configured. This is used when the user specifies 'Microsoft.KeyVault' as their Batch account encryption configuration or when `ManagedIdentity` is selected as the auto-storage authentication mode.
  kind: object
  properties:
  - name: principalId
    isReadyOnly: true
    description: The principal id of the Batch account. This property will only be provided for a system assigned identity.
    types:
    - uid: string
  - name: tenantId
    isReadyOnly: true
    description: The tenant id associated with the Batch account. This property will only be provided for a system assigned identity.
    types:
    - uid: string
  - name: type
    description: The type of identity used for the Batch account.
    types:
    - uid: ResourceIdentityType
  - name: userAssignedIdentities
    description: The list of user identities associated with the Batch account.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: UserAssignedIdentities
- name: AutoStorageBaseProperties
  description: The properties related to the auto-storage account.
  kind: object
  properties:
  - name: storageAccountId
    description: The resource ID of the storage account to be used for auto-storage account.
    types:
    - uid: string
  - name: authenticationMode
    description: The authentication mode which the Batch service will use to manage the auto-storage account.
    types:
    - uid: AutoStorageAuthenticationMode
    defaultValue: StorageKeys
  - name: nodeIdentityReference
    description: "The reference to the user assigned identity which compute nodes will use to access auto-storage.  \nThe identity referenced here must be assigned to pools which have compute nodes that need access to auto-storage."
    types:
    - uid: ComputeNodeIdentityReference
- name: EncryptionProperties
  description: Configures how customer data is encrypted inside the Batch account. By default, accounts are encrypted using a Microsoft managed key. For additional control, a customer-managed key can be used instead.
  kind: object
  properties:
  - name: keySource
    description: Type of the key source.
    types:
    - uid: KeySource
  - name: keyVaultProperties
    description: Additional details when using Microsoft.KeyVault
    types:
    - uid: KeyVaultProperties
- name: NetworkProfile
  description: Network profile for Batch account, which contains network rule settings for each endpoint.
  kind: object
  properties:
  - name: accountAccess
    description: Network access profile for batchAccount endpoint (Batch account data plane API).
    types:
    - uid: EndpointAccessProfile
  - name: nodeManagementAccess
    description: Network access profile for nodeManagement endpoint (Batch service managing compute nodes for Batch pools).
    types:
    - uid: EndpointAccessProfile
- name: BatchAccount
  description: Contains information about an Azure Batch account.
  kind: object
  properties:
  - name: identity
    description: The identity of the Batch account.
    types:
    - uid: BatchAccountIdentity
  - name: properties.accountEndpoint
    isReadyOnly: true
    description: The account endpoint used to interact with the Batch service.
    types:
    - uid: string
  - name: properties.nodeManagementEndpoint
    isReadyOnly: true
    description: The endpoint used by compute node to connect to the Batch node management service.
    types:
    - uid: string
  - name: properties.provisioningState
    isReadyOnly: true
    description: The provisioned state of the resource
    types:
    - uid: ProvisioningState
  - name: properties.poolAllocationMode
    isReadyOnly: true
    description: "The allocation mode to use for creating pools in the Batch account.  \nThe allocation mode for creating pools in the Batch account."
    types:
    - uid: PoolAllocationMode
  - name: properties.keyVaultReference
    isReadyOnly: true
    description: "A reference to the Azure key vault associated with the Batch account.  \nIdentifies the Azure key vault associated with a Batch account."
    types:
    - uid: KeyVaultReference
  - name: properties.publicNetworkAccess
    description: "The network interface type for accessing Azure Batch service and Batch account operations.  \nIf not specified, the default value is 'enabled'."
    types:
    - uid: PublicNetworkAccessType
    defaultValue: Enabled
  - name: properties.networkProfile
    description: "Network profile for Batch account, which contains network rule settings for each endpoint.  \nThe network profile only takes effect when publicNetworkAccess is enabled."
    types:
    - uid: NetworkProfile
  - name: properties.privateEndpointConnections
    isReadyOnly: true
    description: List of private endpoint connections associated with the Batch account
    types:
    - uid: PrivateEndpointConnection
      isArray: true
  - name: properties.autoStorage
    isReadyOnly: true
    description: "The properties and status of any auto-storage account associated with the Batch account.  \nContains information about the auto-storage account associated with a Batch account."
    types:
    - uid: AutoStorageProperties
  - name: properties.encryption
    isReadyOnly: true
    description: "The encryption configuration for the Batch account.  \nConfigures how customer data is encrypted inside the Batch account. By default, accounts are encrypted using a Microsoft managed key. For additional control, a customer-managed key can be used instead."
    types:
    - uid: EncryptionProperties
  - name: properties.dedicatedCoreQuota
    isReadyOnly: true
    description: "The dedicated core quota for the Batch account.  \nFor accounts with PoolAllocationMode set to UserSubscription, quota is managed on the subscription so this value is not returned."
    types:
    - uid: integer
  - name: properties.lowPriorityCoreQuota
    isReadyOnly: true
    description: "The low-priority core quota for the Batch account.  \nFor accounts with PoolAllocationMode set to UserSubscription, quota is managed on the subscription so this value is not returned."
    types:
    - uid: integer
  - name: properties.dedicatedCoreQuotaPerVMFamily
    isReadyOnly: true
    description: A list of the dedicated core quota per Virtual Machine family for the Batch account. For accounts with PoolAllocationMode set to UserSubscription, quota is managed on the subscription so this value is not returned.
    types:
    - uid: VirtualMachineFamilyCoreQuota
      isArray: true
  - name: properties.dedicatedCoreQuotaPerVMFamilyEnforced
    isReadyOnly: true
    description: "A value indicating whether core quotas per Virtual Machine family are enforced for this account  \nIf this flag is true, dedicated core quota is enforced via both the dedicatedCoreQuotaPerVMFamily and dedicatedCoreQuota properties on the account. If this flag is false, dedicated core quota is enforced only via the dedicatedCoreQuota property on the account and does not consider Virtual Machine family."
    types:
    - uid: boolean
  - name: properties.poolQuota
    isReadyOnly: true
    description: The pool quota for the Batch account.
    types:
    - uid: integer
  - name: properties.activeJobAndJobScheduleQuota
    isReadyOnly: true
    description: The active job and job schedule quota for the Batch account.
    types:
    - uid: integer
  - name: properties.allowedAuthenticationModes
    isReadyOnly: true
    description: List of allowed authentication modes for the Batch account that can be used to authenticate with the data plane. This does not affect authentication with the control plane.
    types:
    - uid: string
      isArray: true
  - name: id
    isReadyOnly: true
    description: The ID of the resource.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource.
    types:
    - uid: string
  - name: location
    isReadyOnly: true
    description: The location of the resource.
    types:
    - uid: string
  - name: tags
    isReadyOnly: true
    description: The tags of the resource.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: CloudError
  description: An error response from the Batch service.
  kind: object
  properties:
  - name: error
    description: The body of the error response.
    types:
    - uid: CloudErrorBody
- name: BatchAccountUpdateParameters
  description: Parameters for updating an Azure Batch account.
  kind: object
  properties:
  - name: tags
    description: The user-specified tags associated with the account.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: identity
    description: The identity of the Batch account.
    types:
    - uid: BatchAccountIdentity
  - name: properties.autoStorage
    description: The properties related to the auto-storage account.
    types:
    - uid: AutoStorageBaseProperties
  - name: properties.encryption
    description: "The encryption configuration for the Batch account.  \nConfigures how customer data is encrypted inside the Batch account. By default, accounts are encrypted using a Microsoft managed key. For additional control, a customer-managed key can be used instead."
    types:
    - uid: EncryptionProperties
  - name: properties.allowedAuthenticationModes
    description: List of allowed authentication modes for the Batch account that can be used to authenticate with the data plane. This does not affect authentication with the control plane.
    types:
    - uid: string
      isArray: true
  - name: properties.publicNetworkAccess
    description: "The network access type for accessing Azure Batch account.  \nIf not specified, the default value is 'enabled'."
    types:
    - uid: PublicNetworkAccessType
    defaultValue: Enabled
  - name: properties.networkProfile
    description: "Network profile for Batch account, which contains network rule settings for each endpoint.  \nThe network profile only takes effect when publicNetworkAccess is enabled."
    types:
    - uid: NetworkProfile
- name: ResourceIdentityType
  description: The type of identity used for the Batch account.
  kind: enum
  properties:
  - name: SystemAssigned
    description: Batch account has a system assigned identity with it.
    types:
    - uid: string
  - name: UserAssigned
    description: Batch account has user assigned identities with it.
    types:
    - uid: string
  - name: None
    description: Batch account has no identity associated with it. Setting `None` in update account will remove existing identities.
    types:
    - uid: string
- name: UserAssignedIdentities
  description: The list of associated user identities.
  kind: object
  properties:
  - name: principalId
    isReadyOnly: true
    description: The principal id of user assigned identity.
    types:
    - uid: string
  - name: clientId
    isReadyOnly: true
    description: The client id of user assigned identity.
    types:
    - uid: string
- name: AutoStorageAuthenticationMode
  description: The authentication mode which the Batch service will use to manage the auto-storage account.
  kind: enum
  properties:
  - name: StorageKeys
    description: The Batch service will authenticate requests to auto-storage using storage account keys.
    types:
    - uid: string
  - name: BatchAccountManagedIdentity
    description: The Batch service will authenticate requests to auto-storage using the managed identity assigned to the Batch account.
    types:
    - uid: string
- name: ComputeNodeIdentityReference
  description: The reference to a user assigned identity associated with the Batch pool which a compute node will use.
  kind: object
  properties:
  - name: resourceId
    description: The ARM resource id of the user assigned identity.
    types:
    - uid: string
- name: KeySource
  description: Type of the key source.
  kind: enum
  properties:
  - name: Microsoft.Batch
    description: Batch creates and manages the encryption keys used to protect the account data.
    types:
    - uid: string
  - name: Microsoft.KeyVault
    description: The encryption keys used to protect the account data are stored in an external key vault. If this is set then the Batch Account identity must be set to `SystemAssigned` and a valid Key Identifier must also be supplied under the keyVaultProperties.
    types:
    - uid: string
- name: KeyVaultProperties
  description: KeyVault configuration when using an encryption KeySource of Microsoft.KeyVault.
  kind: object
  properties:
  - name: keyIdentifier
    description: >-
      Full path to the versioned secret. Example https://mykeyvault.vault.azure.net/keys/testkey/6e34a81fef704045975661e297a4c053. To be usable the following prerequisites must be met:

       The Batch Account has a System Assigned identity
       The account identity has been granted Key/Get, Key/Unwrap and Key/Wrap permissions
       The KeyVault has soft-delete and purge protection enabled
    types:
    - uid: string
- name: EndpointAccessProfile
  description: Network access profile for Batch endpoint.
  kind: object
  properties:
  - name: defaultAction
    description: "The default action when there is no IPRule matched.  \nDefault action for endpoint access. It is only applicable when publicNetworkAccess is enabled."
    types:
    - uid: EndpointAccessDefaultAction
  - name: ipRules
    description: Array of IP ranges to filter client IP address.
    types:
    - uid: IPRule
      isArray: true
- name: ProvisioningState
  description: The provisioned state of the resource
  kind: enum
  properties:
  - name: Invalid
    description: The account is in an invalid state.
    types:
    - uid: string
  - name: Creating
    description: The account is being created.
    types:
    - uid: string
  - name: Deleting
    description: The account is being deleted.
    types:
    - uid: string
  - name: Succeeded
    description: The account has been created and is ready for use.
    types:
    - uid: string
  - name: Failed
    description: The last operation for the account is failed.
    types:
    - uid: string
  - name: Cancelled
    description: The last operation for the account is cancelled.
    types:
    - uid: string
- name: PoolAllocationMode
  description: The allocation mode for creating pools in the Batch account.
  kind: enum
  properties:
  - name: BatchService
    description: Pools will be allocated in subscriptions owned by the Batch service.
    types:
    - uid: string
  - name: UserSubscription
    description: Pools will be allocated in a subscription owned by the user.
    types:
    - uid: string
- name: KeyVaultReference
  description: Identifies the Azure key vault associated with a Batch account.
  kind: object
  properties:
  - name: id
    description: The resource ID of the Azure key vault associated with the Batch account.
    types:
    - uid: string
  - name: url
    description: The URL of the Azure key vault associated with the Batch account.
    types:
    - uid: string
- name: PublicNetworkAccessType
  description: The network access type for operating on the resources in the Batch account.
  kind: enum
  properties:
  - name: Enabled
    description: Enables connectivity to Azure Batch through public DNS.
    types:
    - uid: string
  - name: Disabled
    description: Disables public connectivity and enables private connectivity to Azure Batch Service through private endpoint resource.
    types:
    - uid: string
- name: PrivateEndpointConnection
  description: Contains information about a private link resource.
  kind: object
  properties:
  - name: properties.provisioningState
    isReadyOnly: true
    description: The provisioning state of the private endpoint connection.
    types:
    - uid: PrivateEndpointConnectionProvisioningState
  - name: properties.privateEndpoint
    isReadyOnly: true
    description: "The ARM resource identifier of the private endpoint.  \nThe private endpoint of the private endpoint connection."
    types:
    - uid: PrivateEndpoint
  - name: properties.groupIds
    isReadyOnly: true
    description: "The group id of the private endpoint connection.  \nThe value has one and only one group id."
    types:
    - uid: string
      isArray: true
  - name: properties.privateLinkServiceConnectionState
    description: "The private link service connection state of the private endpoint connection.  \nThe private link service connection state of the private endpoint connection"
    types:
    - uid: PrivateLinkServiceConnectionState
  - name: id
    isReadyOnly: true
    description: The ID of the resource.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource.
    types:
    - uid: string
  - name: etag
    isReadyOnly: true
    description: The ETag of the resource, used for concurrency statements.
    types:
    - uid: string
- name: AutoStorageProperties
  description: Contains information about the auto-storage account associated with a Batch account.
  kind: object
  properties:
  - name: lastKeySync
    description: The UTC time at which storage keys were last synchronized with the Batch account.
    types:
    - uid: string
  - name: storageAccountId
    description: The resource ID of the storage account to be used for auto-storage account.
    types:
    - uid: string
  - name: authenticationMode
    description: The authentication mode which the Batch service will use to manage the auto-storage account.
    types:
    - uid: AutoStorageAuthenticationMode
    defaultValue: StorageKeys
  - name: nodeIdentityReference
    description: "The reference to the user assigned identity which compute nodes will use to access auto-storage.  \nThe identity referenced here must be assigned to pools which have compute nodes that need access to auto-storage."
    types:
    - uid: ComputeNodeIdentityReference
- name: VirtualMachineFamilyCoreQuota
  description: A VM Family and its associated core quota for the Batch account.
  kind: object
  properties:
  - name: name
    isReadyOnly: true
    description: The Virtual Machine family name.
    types:
    - uid: string
  - name: coreQuota
    isReadyOnly: true
    description: The core quota for the VM family for the Batch account.
    types:
    - uid: integer
- name: CloudErrorBody
  description: An error response from the Batch service.
  kind: object
  properties:
  - name: code
    description: An identifier for the error. Codes are invariant and are intended to be consumed programmatically.
    types:
    - uid: string
  - name: message
    description: A message describing the error, intended to be suitable for display in a user interface.
    types:
    - uid: string
  - name: target
    description: The target of the particular error. For example, the name of the property in error.
    types:
    - uid: string
  - name: details
    description: A list of additional details about the error.
    types:
    - uid: CloudErrorBody
      isArray: true
- name: EndpointAccessDefaultAction
  description: The default action when there is no IPRule matched.
  kind: enum
  properties:
  - name: Allow
    description: Allow client access.
    types:
    - uid: string
  - name: Deny
    description: Deny client access.
    types:
    - uid: string
- name: IPRule
  description: Rule to filter client IP address.
  kind: object
  properties:
  - name: action
    description: Action when client IP address is matched.
    types:
    - uid: IPRuleAction
  - name: value
    description: "The IP address or IP address range to filter  \nIPv4 address, or IPv4 address range in CIDR format."
    types:
    - uid: string
- name: PrivateEndpointConnectionProvisioningState
  description: The provisioning state of the private endpoint connection.
  kind: enum
  properties:
  - name: Creating
    description: The connection is creating.
    types:
    - uid: string
  - name: Updating
    description: The user has requested that the connection status be updated, but the update operation has not yet completed. You may not reference the connection when connecting the Batch account.
    types:
    - uid: string
  - name: Deleting
    description: The connection is deleting.
    types:
    - uid: string
  - name: Succeeded
    description: The connection status is final and is ready for use if Status is Approved.
    types:
    - uid: string
  - name: Failed
    description: The user requested that the connection be updated and it failed. You may retry the update operation.
    types:
    - uid: string
  - name: Cancelled
    description: The user has cancelled the connection creation.
    types:
    - uid: string
- name: PrivateEndpoint
  description: The private endpoint of the private endpoint connection.
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: The ARM resource identifier of the private endpoint. This is of the form /subscriptions/{subscription}/resourceGroups/{group}/providers/Microsoft.Network/privateEndpoints/{privateEndpoint}.
    types:
    - uid: string
- name: PrivateLinkServiceConnectionState
  description: The private link service connection state of the private endpoint connection
  kind: object
  properties:
  - name: status
    description: The status for the private endpoint connection of Batch account
    types:
    - uid: PrivateLinkServiceConnectionStatus
  - name: description
    description: Description of the private Connection state
    types:
    - uid: string
  - name: actionRequired
    isReadyOnly: true
    description: Action required on the private connection state
    types:
    - uid: string
- name: IPRuleAction
  description: Action when client IP address is matched.
  kind: enum
  properties:
  - name: Allow
    description: Allow access for the matched client IP address.
    types:
    - uid: string
- name: PrivateLinkServiceConnectionStatus
  description: The status of the Batch private endpoint connection
  kind: enum
  properties:
  - name: Approved
    description: The private endpoint connection is approved and can be used to access Batch account
    types:
    - uid: string
  - name: Pending
    description: The private endpoint connection is pending and cannot be used to access Batch account
    types:
    - uid: string
  - name: Rejected
    description: The private endpoint connection is rejected and cannot be used to access Batch account
    types:
    - uid: string
  - name: Disconnected
    description: The private endpoint connection is disconnected and cannot be used to access Batch account
    types:
    - uid: string
examples:
- name: BatchAccountUpdate
  request:
    uri: PATCH https://management.azure.com/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Batch/batchAccounts/sampleacct?api-version=2022-06-01
    body: >-
      {
        "properties": {
          "autoStorage": {
            "storageAccountId": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Storage/storageAccounts/samplestorage"
          }
        }
      }
  responses:
  - statusCode: "200"
    body: >-
      {
        "name": "sampleacct",
        "location": "japaneast",
        "properties": {
          "accountEndpoint": "sampleacct.japaneast.batch.azure.com",
          "provisioningState": "Succeeded",
          "poolAllocationMode": "BatchService",
          "dedicatedCoreQuota": 20,
          "lowPriorityCoreQuota": 20,
          "poolQuota": 20,
          "activeJobAndJobScheduleQuota": 20,
          "autoStorage": {
            "storageAccountId": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Storage/storageAccounts/samplestorage",
            "lastKeySync": "2016-03-10T23:48:38.9878479Z"
          },
          "publicNetworkAccess": "Enabled"
        },
        "identity": {
          "type": "None"
        },
        "id": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Batch/batchAccounts/sampleacct",
        "type": "Microsoft.Batch/batchAccounts"
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: Learn more about Batch Management service - Updates the properties of an existing Batch account.
errorCodes: []
