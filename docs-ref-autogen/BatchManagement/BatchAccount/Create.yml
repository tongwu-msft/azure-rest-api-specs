### YamlMime:RESTOperation
uid: management.azure.com.batchmanagement.batchaccount.create
name: Create
service: Batch Management
groupName: Batch Account
apiVersion: 2020-03-01
summary: Creates a new Batch account with the specified parameters. Existing accounts cannot be updated with this API and should instead be updated with the Update Batch Account API.
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Batch/batchAccounts/{accountName}?api-version=2020-03-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The Azure subscription ID. This is a GUID-formatted string (e.g. 00000000-0000-0000-0000-000000000000)
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group that contains the Batch account.
  types:
  - uid: string
- name: accountName
  in: path
  isRequired: true
  description: 'A name for the Batch account which must be unique within the region. Batch account names must be between 3 and 24 characters in length and must use only numbers and lowercase letters. This name is used as part of the DNS name that is used to access the Batch service in the region in which the account is created. For example: http://accountname.region.batch.azure.com/.'
  types:
  - uid: string
  pattern: ^[a-z0-9]+$
- name: api-version
  in: query
  isRequired: true
  description: The API version to be used with the HTTP request.
  types:
  - uid: string
responses:
- name: 200 OK
  description: The operation was successful. The response contains the Batch account entity.
  types:
  - uid: BatchAccount
- name: 202 Accepted
  headers:
  - name: Location
    value: string
  - name: Retry-After
    value: integer
  description: The operation will be completed asynchronously.
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: CloudError
requestBody:
- name: default
  parameters:
  - name: location
    in: body
    isRequired: true
    description: The region in which to create the account.
    types:
    - uid: string
  - name: tags
    in: body
    description: The user-specified tags associated with the account.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.autoStorage
    in: body
    description: The properties related to the auto-storage account.
    types:
    - uid: AutoStorageBaseProperties
  - name: properties.poolAllocationMode
    in: body
    description: "The allocation mode to use for creating pools in the Batch account.  \nThe pool allocation mode also affects how clients may authenticate to the Batch Service API. If the mode is BatchService, clients may authenticate using access keys or Azure Active Directory. If the mode is UserSubscription, clients must use Azure Active Directory. The default is BatchService."
    types:
    - uid: PoolAllocationMode
  - name: properties.keyVaultReference
    in: body
    description: A reference to the Azure key vault associated with the Batch account.
    types:
    - uid: KeyVaultReference
  - name: properties.publicNetworkAccess
    in: body
    description: "The network access type for accessing Azure Batch account.  \nIf not specified, the default value is 'enabled'."
    types:
    - uid: PublicNetworkAccessType
  - name: properties.encryption
    in: body
    description: The encryption configuration for the Batch account.
    types:
    - uid: EncryptionProperties
requestHeader: []
definitions:
- name: AutoStorageBaseProperties
  description: The properties related to the auto-storage account.
  kind: object
  properties:
  - name: storageAccountId
    description: The resource ID of the storage account to be used for auto-storage account.
    types:
    - uid: string
- name: KeyVaultReference
  description: Identifies the Azure key vault associated with a Batch account.
  kind: object
  properties:
  - name: id
    description: The resource ID of the Azure key vault associated with the Batch account.
    types:
    - uid: string
  - name: url
    description: The URL of the Azure key vault associated with the Batch account.
    types:
    - uid: string
- name: EncryptionProperties
  kind: object
  properties:
  - name: keySource
    description: Type of the key source.
    types:
    - uid: KeySource
  - name: keyVaultProperties
    description: Additional details when using Microsoft.KeyVault
    types:
    - uid: KeyVaultProperties
- name: BatchAccount
  description: Contains information about an Azure Batch account.
  kind: object
  properties:
  - name: properties.accountEndpoint
    isReadyOnly: true
    description: The account endpoint used to interact with the Batch service.
    types:
    - uid: string
  - name: properties.provisioningState
    isReadyOnly: true
    description: The provisioned state of the resource
    types:
    - uid: ProvisioningState
  - name: properties.poolAllocationMode
    isReadyOnly: true
    description: "The allocation mode to use for creating pools in the Batch account.  \nThe allocation mode for creating pools in the Batch account."
    types:
    - uid: PoolAllocationMode
  - name: properties.keyVaultReference
    isReadyOnly: true
    description: "A reference to the Azure key vault associated with the Batch account.  \nIdentifies the Azure key vault associated with a Batch account."
    types:
    - uid: KeyVaultReference
  - name: properties.publicNetworkAccess
    isReadyOnly: true
    description: "The network interface type for accessing Azure Batch service and Batch account operations.  \nIf not specified, the default value is 'enabled'."
    types:
    - uid: PublicNetworkAccessType
  - name: properties.privateEndpointConnections
    isReadyOnly: true
    description: List of private endpoint connections associated with the Batch account
    types:
    - uid: PrivateEndpointConnection
      isArray: true
  - name: properties.autoStorage
    isReadyOnly: true
    description: "The properties and status of any auto-storage account associated with the Batch account.  \nContains information about the auto-storage account associated with a Batch account."
    types:
    - uid: AutoStorageProperties
  - name: properties.encryption
    isReadyOnly: true
    description: The encryption configuration for the Batch account.
    types:
    - uid: EncryptionProperties
  - name: properties.dedicatedCoreQuota
    isReadyOnly: true
    description: "The dedicated core quota for the Batch account.  \nFor accounts with PoolAllocationMode set to UserSubscription, quota is managed on the subscription so this value is not returned."
    types:
    - uid: integer
  - name: properties.lowPriorityCoreQuota
    isReadyOnly: true
    description: "The low-priority core quota for the Batch account.  \nFor accounts with PoolAllocationMode set to UserSubscription, quota is managed on the subscription so this value is not returned."
    types:
    - uid: integer
  - name: properties.dedicatedCoreQuotaPerVMFamily
    isReadyOnly: true
    description: A list of the dedicated core quota per Virtual Machine family for the Batch account. For accounts with PoolAllocationMode set to UserSubscription, quota is managed on the subscription so this value is not returned.
    types:
    - uid: VirtualMachineFamilyCoreQuota
      isArray: true
  - name: properties.dedicatedCoreQuotaPerVMFamilyEnforced
    isReadyOnly: true
    description: "A value indicating whether the core quota for the Batch Account is enforced per Virtual Machine family or not.  \nBatch is transitioning its core quota system for dedicated cores to be enforced per Virtual Machine family. During this transitional phase, the dedicated core quota per Virtual Machine family may not yet be enforced. If this flag is false, dedicated core quota is enforced via the old dedicatedCoreQuota property on the account and does not consider Virtual Machine family. If this flag is true, dedicated core quota is enforced via the dedicatedCoreQuotaPerVMFamily property on the account, and the old dedicatedCoreQuota does not apply."
    types:
    - uid: boolean
  - name: properties.poolQuota
    isReadyOnly: true
    description: The pool quota for the Batch account.
    types:
    - uid: integer
  - name: properties.activeJobAndJobScheduleQuota
    isReadyOnly: true
    description: The active job and job schedule quota for the Batch account.
    types:
    - uid: integer
  - name: id
    isReadyOnly: true
    description: The ID of the resource.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource.
    types:
    - uid: string
  - name: location
    isReadyOnly: true
    description: The location of the resource.
    types:
    - uid: string
  - name: tags
    isReadyOnly: true
    description: The tags of the resource.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: CloudError
  description: An error response from the Batch service.
  kind: object
  properties:
  - name: error
    description: An error response from the Batch service.
    types:
    - uid: CloudErrorBody
- name: BatchAccountCreateParameters
  description: Parameters supplied to the Create operation.
  kind: object
  properties:
  - name: location
    description: The region in which to create the account.
    types:
    - uid: string
  - name: tags
    description: The user-specified tags associated with the account.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: properties.autoStorage
    description: The properties related to the auto-storage account.
    types:
    - uid: AutoStorageBaseProperties
  - name: properties.poolAllocationMode
    description: "The allocation mode to use for creating pools in the Batch account.  \nThe pool allocation mode also affects how clients may authenticate to the Batch Service API. If the mode is BatchService, clients may authenticate using access keys or Azure Active Directory. If the mode is UserSubscription, clients must use Azure Active Directory. The default is BatchService."
    types:
    - uid: PoolAllocationMode
  - name: properties.keyVaultReference
    description: A reference to the Azure key vault associated with the Batch account.
    types:
    - uid: KeyVaultReference
  - name: properties.publicNetworkAccess
    description: "The network access type for accessing Azure Batch account.  \nIf not specified, the default value is 'enabled'."
    types:
    - uid: PublicNetworkAccessType
  - name: properties.encryption
    description: The encryption configuration for the Batch account.
    types:
    - uid: EncryptionProperties
- name: KeySource
  description: Type of the key source.
  kind: enum
  properties:
  - name: Microsoft.Batch
    description: Batch creates and manages the encryption keys used to protect the account data.
    types:
    - uid: string
  - name: Microsoft.KeyVault
    description: The encryption keys used to protect the account data are stored in an external key vault.
    types:
    - uid: string
- name: KeyVaultProperties
  kind: object
  properties:
  - name: keyIdentifier
    description: Full path to the versioned secret. Example https://mykeyvault.vault.azure.net/keys/testkey/6e34a81fef704045975661e297a4c053
    types:
    - uid: string
- name: ProvisioningState
  description: The provisioned state of the resource
  kind: enum
  properties:
  - name: Invalid
    description: The account is in an invalid state.
    types:
    - uid: string
  - name: Creating
    description: The account is being created.
    types:
    - uid: string
  - name: Deleting
    description: The account is being deleted.
    types:
    - uid: string
  - name: Succeeded
    description: The account has been created and is ready for use.
    types:
    - uid: string
  - name: Failed
    description: The last operation for the account is failed.
    types:
    - uid: string
  - name: Cancelled
    description: The last operation for the account is cancelled.
    types:
    - uid: string
- name: PoolAllocationMode
  description: The allocation mode for creating pools in the Batch account.
  kind: enum
  properties:
  - name: BatchService
    description: Pools will be allocated in subscriptions owned by the Batch service.
    types:
    - uid: string
  - name: UserSubscription
    description: Pools will be allocated in a subscription owned by the user.
    types:
    - uid: string
- name: PublicNetworkAccessType
  description: The network access type for operating on the resources in the Batch account.
  kind: enum
  properties:
  - name: Enabled
    description: Enables connectivity to Azure Batch through public DNS.
    types:
    - uid: string
  - name: Disabled
    description: Disables public connectivity and enables private connectivity to Azure Batch Service through private endpoint resource.
    types:
    - uid: string
- name: PrivateEndpointConnection
  description: Contains information about a private link resource.
  kind: object
  properties:
  - name: properties.provisioningState
    isReadyOnly: true
    description: The provisioning state of the private endpoint connection.
    types:
    - uid: PrivateEndpointConnectionProvisioningState
  - name: properties.privateEndpoint
    description: "The ARM resource identifier of the private endpoint.  \nThe private endpoint of the private endpoint connection."
    types:
    - uid: PrivateEndpoint
  - name: properties.privateLinkServiceConnectionState
    description: "The private link service connection state of the private endpoint connection.  \nThe private link service connection state of the private endpoint connection"
    types:
    - uid: PrivateLinkServiceConnectionState
  - name: id
    isReadyOnly: true
    description: The ID of the resource.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource.
    types:
    - uid: string
  - name: etag
    isReadyOnly: true
    description: The ETag of the resource, used for concurrency statements.
    types:
    - uid: string
- name: AutoStorageProperties
  description: Contains information about the auto-storage account associated with a Batch account.
  kind: object
  properties:
  - name: lastKeySync
    description: The UTC time at which storage keys were last synchronized with the Batch account.
    types:
    - uid: string
  - name: storageAccountId
    description: The resource ID of the storage account to be used for auto-storage account.
    types:
    - uid: string
- name: VirtualMachineFamilyCoreQuota
  description: A VM Family and its associated core quota for the Batch account.
  kind: object
  properties:
  - name: name
    isReadyOnly: true
    description: The Virtual Machine family name.
    types:
    - uid: string
  - name: coreQuota
    isReadyOnly: true
    description: The core quota for the VM family for the Batch account.
    types:
    - uid: integer
- name: CloudErrorBody
  description: An error response from the Batch service.
  kind: object
  properties:
  - name: code
    description: An identifier for the error. Codes are invariant and are intended to be consumed programmatically.
    types:
    - uid: string
  - name: message
    description: A message describing the error, intended to be suitable for display in a user interface.
    types:
    - uid: string
  - name: target
    description: The target of the particular error. For example, the name of the property in error.
    types:
    - uid: string
  - name: details
    description: A list of additional details about the error.
    types:
    - uid: CloudErrorBody
      isArray: true
- name: PrivateEndpointConnectionProvisioningState
  description: The provisioning state of the private endpoint connection.
  kind: enum
  properties:
  - name: Succeeded
    description: The connection status is final and is ready for use if Status is Approved.
    types:
    - uid: string
  - name: Updating
    description: The user has requested that the connection status be updated, but the update operation has not yet completed. You may not reference the connection when connecting the Batch account.
    types:
    - uid: string
  - name: Failed
    description: The user requested that the connection be updated and it failed. You may retry the update operation.
    types:
    - uid: string
- name: PrivateEndpoint
  description: The private endpoint of the private endpoint connection.
  kind: object
  properties:
  - name: id
    isReadyOnly: true
    description: The ARM resource identifier of the private endpoint. This is of the form /subscriptions/{subscription}/resourceGroups/{group}/providers/Microsoft.Network/privateEndpoints/{privateEndpoint}.
    types:
    - uid: string
- name: PrivateLinkServiceConnectionState
  description: The private link service connection state of the private endpoint connection
  kind: object
  properties:
  - name: status
    description: The status for the private endpoint connection of Batch account
    types:
    - uid: PrivateLinkServiceConnectionStatus
  - name: description
    description: Description of the private Connection state
    types:
    - uid: string
  - name: actionRequired
    isReadyOnly: true
    description: Action required on the private connection state
    types:
    - uid: string
- name: PrivateLinkServiceConnectionStatus
  description: The status of the Batch private endpoint connection
  kind: enum
  properties:
  - name: Approved
    description: The private endpoint connection is approved and can be used to access Batch account
    types:
    - uid: string
  - name: Pending
    description: The private endpoint connection is pending and cannot be used to access Batch account
    types:
    - uid: string
  - name: Rejected
    description: The private endpoint connection is rejected and cannot be used to access Batch account
    types:
    - uid: string
  - name: Disconnected
    description: The private endpoint connection is disconnected and cannot be used to access Batch account
    types:
    - uid: string
examples:
- name: BatchAccountCreate_Default
  request:
    uri: PUT https://management.azure.com/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Batch/batchAccounts/sampleacct?api-version=2020-03-01
    body: >-
      {
        "location": "japaneast",
        "properties": {
          "autoStorage": {
            "storageAccountId": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Storage/storageAccounts/samplestorage"
          }
        }
      }
  responses:
  - statusCode: "202"
  - statusCode: "200"
    body: >-
      {
        "name": "sampleacct",
        "location": "japaneast",
        "properties": {
          "accountEndpoint": "sampleacct.japaneast.batch.azure.com",
          "provisioningState": "Succeeded",
          "poolAllocationMode": "BatchService",
          "dedicatedCoreQuota": 20,
          "lowPriorityCoreQuota": 20,
          "poolQuota": 20,
          "activeJobAndJobScheduleQuota": 20,
          "autoStorage": {
            "storageAccountId": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Storage/storageAccounts/samplestorage",
            "lastKeySync": "2016-03-10T23:48:38.9878479Z"
          },
          "publicNetworkAccess": "Enabled"
        },
        "id": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Batch/batchAccounts/sampleacct",
        "type": "Microsoft.Batch/batchAccounts"
      }
- name: BatchAccountCreate_BYOS
  request:
    uri: PUT https://management.azure.com/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Batch/batchAccounts/sampleacct?api-version=2020-03-01
    body: >-
      {
        "location": "japaneast",
        "properties": {
          "autoStorage": {
            "storageAccountId": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Storage/storageAccounts/samplestorage"
          },
          "poolAllocationMode": "UserSubscription",
          "keyVaultReference": {
            "id": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.KeyVault/vaults/sample",
            "url": "http://sample.vault.azure.net/"
          }
        }
      }
  responses:
  - statusCode: "202"
  - statusCode: "200"
    body: >-
      {
        "name": "sampleacct",
        "location": "japaneast",
        "properties": {
          "accountEndpoint": "sampleacct.japaneast.batch.azure.com",
          "provisioningState": "Succeeded",
          "poolAllocationMode": "UserSubscription",
          "dedicatedCoreQuota": 20,
          "lowPriorityCoreQuota": 20,
          "poolQuota": 20,
          "activeJobAndJobScheduleQuota": 20,
          "autoStorage": {
            "storageAccountId": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Storage/storageAccounts/samplestorage",
            "lastKeySync": "2016-03-10T23:48:38.9878479Z"
          },
          "keyVaultReference": {
            "id": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.KeyVault/vaults/sample",
            "url": "http://sample.vault.azure.net/"
          },
          "publicNetworkAccess": "Enabled"
        },
        "id": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Batch/batchAccounts/sampleacct",
        "type": "Microsoft.Batch/batchAccounts"
      }
- name: PrivateBatchAccountCreate
  request:
    uri: PUT https://management.azure.com/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Batch/batchAccounts/sampleacct?api-version=2020-03-01
    body: >-
      {
        "location": "japaneast",
        "properties": {
          "autoStorage": {
            "storageAccountId": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Storage/storageAccounts/samplestorage"
          },
          "keyVaultReference": {
            "id": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.KeyVault/vaults/sample",
            "url": "http://sample.vault.azure.net/"
          },
          "publicNetworkAccess": "Disabled"
        }
      }
  responses:
  - statusCode: "202"
  - statusCode: "200"
    body: >-
      {
        "name": "sampleacct",
        "location": "japaneast",
        "properties": {
          "accountEndpoint": "sampleacct.japaneast.batch.azure.com",
          "provisioningState": "Succeeded",
          "poolAllocationMode": "UserSubscription",
          "dedicatedCoreQuota": 20,
          "lowPriorityCoreQuota": 20,
          "poolQuota": 20,
          "activeJobAndJobScheduleQuota": 20,
          "autoStorage": {
            "storageAccountId": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Storage/storageAccounts/samplestorage",
            "lastKeySync": "2016-03-10T23:48:38.9878479Z"
          },
          "keyVaultReference": {
            "id": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.KeyVault/vaults/sample",
            "url": "http://sample.vault.azure.net/"
          },
          "publicNetworkAccess": "Disabled"
        },
        "id": "/subscriptions/subid/resourceGroups/default-azurebatch-japaneast/providers/Microsoft.Batch/batchAccounts/sampleacct",
        "type": "Microsoft.Batch/batchAccounts"
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
errorCodes: []
