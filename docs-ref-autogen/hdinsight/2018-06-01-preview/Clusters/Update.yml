### YamlMime:RESTOperation
uid: management.azure.com.hdinsight.2018-06-01-preview.clusters.update
name: Update
service: HDInsight
groupName: Clusters
apiVersion: 2018-06-01-preview
summary: Patch HDInsight cluster with the specified parameters.
consumes:
- application/json
produces:
- application/json
paths:
- content: PATCH https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.HDInsight/clusters/{clusterName}?api-version=2018-06-01-preview
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The subscription credentials which uniquely identify Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group.
  types:
  - uid: string
- name: clusterName
  in: path
  isRequired: true
  description: The name of the cluster.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The HDInsight client API Version.
  types:
  - uid: string
responses:
- name: Other Status Codes
  description: Error response describing why the operation failed.
  types:
  - uid: ErrorResponse
- name: 200 OK
  description: OK response definition.
  types:
  - uid: Cluster
requestBody:
- name: default
  parameters:
  - name: tags
    in: body
    description: The resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
requestHeader: []
definitions:
- name: ErrorResponse
  description: Describes the format of Error response.
  kind: object
  properties:
  - name: code
    description: Error code
    types:
    - uid: string
  - name: message
    description: Error message indicating why the operation failed.
    types:
    - uid: string
- name: Cluster
  description: The HDInsight cluster.
  kind: object
  properties:
  - name: etag
    description: The ETag for the resource
    types:
    - uid: string
  - name: properties
    description: The properties of the cluster.
    types:
    - uid: ClusterGetProperties
  - name: identity
    description: The identity of the cluster, if configured.
    types:
    - uid: ClusterIdentity
  - name: location
    description: The Azure Region where the resource lives
    types:
    - uid: string
  - name: tags
    description: Resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: id
    isReadyOnly: true
    description: Fully qualified resource Id for the resource.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: The name of the resource
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: The type of the resource.
    types:
    - uid: string
- name: ClusterPatchParameters
  description: The PatchCluster request parameters
  kind: object
  properties:
  - name: tags
    description: The resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: ClusterGetProperties
  description: The properties of cluster.
  kind: object
  properties:
  - name: clusterVersion
    description: The version of the cluster.
    types:
    - uid: string
  - name: clusterHdpVersion
    description: The hdp version of the cluster.
    types:
    - uid: string
  - name: osType
    description: The type of operating system.
    types:
    - uid: OSType
  - name: tier
    description: The cluster tier.
    types:
    - uid: Tier
  - name: clusterId
    description: The cluster id.
    types:
    - uid: string
  - name: clusterDefinition
    description: The cluster definition.
    types:
    - uid: ClusterDefinition
  - name: kafkaRestProperties
    description: The cluster kafka rest proxy configuration.
    types:
    - uid: KafkaRestProperties
  - name: securityProfile
    description: The security profile.
    types:
    - uid: SecurityProfile
  - name: computeProfile
    description: The compute profile.
    types:
    - uid: ComputeProfile
  - name: provisioningState
    description: The provisioning state, which only appears in the response.
    types:
    - uid: HDInsightClusterProvisioningState
  - name: createdDate
    description: The date on which the cluster was created.
    types:
    - uid: string
  - name: clusterState
    description: The state of the cluster.
    types:
    - uid: string
  - name: quotaInfo
    description: The quota information.
    types:
    - uid: QuotaInfo
  - name: errors
    description: The list of errors.
    types:
    - uid: Errors
      isArray: true
  - name: connectivityEndpoints
    description: The list of connectivity endpoints.
    types:
    - uid: ConnectivityEndpoint
      isArray: true
  - name: diskEncryptionProperties
    description: The disk encryption properties.
    types:
    - uid: DiskEncryptionProperties
  - name: encryptionInTransitProperties
    description: The encryption-in-transit properties.
    types:
    - uid: EncryptionInTransitProperties
  - name: storageProfile
    description: The storage profile.
    types:
    - uid: StorageProfile
  - name: minSupportedTlsVersion
    description: The minimal supported tls version.
    types:
    - uid: string
  - name: excludedServicesConfig
    description: The excluded services config.
    types:
    - uid: ExcludedServicesConfig
  - name: networkProperties
    description: The network properties.
    types:
    - uid: NetworkProperties
  - name: computeIsolationProperties
    description: The compute isolation properties.
    types:
    - uid: ComputeIsolationProperties
- name: ClusterIdentity
  description: Identity for the cluster.
  kind: object
  properties:
  - name: principalId
    isReadyOnly: true
    description: The principal id of cluster identity. This property will only be provided for a system assigned identity.
    types:
    - uid: string
  - name: tenantId
    isReadyOnly: true
    description: The tenant id associated with the cluster. This property will only be provided for a system assigned identity.
    types:
    - uid: string
  - name: type
    description: The type of identity used for the cluster. The type 'SystemAssigned, UserAssigned' includes both an implicitly created identity and a set of user assigned identities.
    types:
    - uid: ResourceIdentityType
  - name: userAssignedIdentities
    description: "The list of user identities associated with the cluster. The user identity dictionary key references will be ARM resource ids in the form: '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ManagedIdentity/userAssignedIdentities/{identityName}'."
    types:
    - uid: UserAssignedIdentities
- name: OSType
  description: The type of operating system.
  kind: enum
  properties:
  - name: Windows
    types:
    - uid: string
  - name: Linux
    types:
    - uid: string
- name: Tier
  description: The cluster tier.
  kind: enum
  properties:
  - name: Standard
    types:
    - uid: string
  - name: Premium
    types:
    - uid: string
- name: ClusterDefinition
  description: The cluster definition.
  kind: object
  properties:
  - name: blueprint
    description: The link to the blueprint.
    types:
    - uid: string
  - name: kind
    description: The type of cluster.
    types:
    - uid: string
  - name: componentVersion
    description: The versions of different services in the cluster.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
  - name: configurations
    description: The cluster configurations.
    types:
    - uid: object
- name: KafkaRestProperties
  description: The kafka rest proxy configuration which contains AAD security group information.
  kind: object
  properties:
  - name: clientGroupInfo
    description: The information of AAD security group.
    types:
    - uid: ClientGroupInfo
  - name: configurationOverride
    description: The configurations that need to be overriden.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: SecurityProfile
  description: The security profile which contains Ssh public key for the HDInsight cluster.
  kind: object
  properties:
  - name: directoryType
    description: The directory type.
    types:
    - uid: DirectoryType
  - name: domain
    description: The organization's active directory domain.
    types:
    - uid: string
  - name: organizationalUnitDN
    description: The organizational unit within the Active Directory to place the cluster and service accounts.
    types:
    - uid: string
  - name: ldapsUrls
    description: The LDAPS protocol URLs to communicate with the Active Directory.
    types:
    - uid: string
      isArray: true
  - name: domainUsername
    description: The domain user account that will have admin privileges on the cluster.
    types:
    - uid: string
  - name: domainUserPassword
    description: The domain admin password.
    types:
    - uid: string
  - name: clusterUsersGroupDNs
    description: Optional. The Distinguished Names for cluster user groups
    types:
    - uid: string
      isArray: true
  - name: aaddsResourceId
    description: The resource ID of the user's Azure Active Directory Domain Service.
    types:
    - uid: string
  - name: msiResourceId
    description: User assigned identity that has permissions to read and create cluster-related artifacts in the user's AADDS.
    types:
    - uid: string
- name: ComputeProfile
  description: Describes the compute profile.
  kind: object
  properties:
  - name: roles
    description: The list of roles in the cluster.
    types:
    - uid: Role
      isArray: true
- name: HDInsightClusterProvisioningState
  description: The provisioning state, which only appears in the response.
  kind: enum
  properties:
  - name: InProgress
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
  - name: Succeeded
    types:
    - uid: string
  - name: Canceled
    types:
    - uid: string
  - name: Deleting
    types:
    - uid: string
- name: QuotaInfo
  description: The quota properties for the cluster.
  kind: object
  properties:
  - name: coresUsed
    description: The cores used by the cluster.
    types:
    - uid: integer
- name: Errors
  description: The error message associated with the cluster creation.
  kind: object
  properties:
  - name: code
    description: The error code.
    types:
    - uid: string
  - name: message
    description: The error message.
    types:
    - uid: string
- name: ConnectivityEndpoint
  description: The connectivity properties
  kind: object
  properties:
  - name: name
    description: The name of the endpoint.
    types:
    - uid: string
  - name: protocol
    description: The protocol of the endpoint.
    types:
    - uid: string
  - name: location
    description: The location of the endpoint.
    types:
    - uid: string
  - name: port
    description: The port to connect to.
    types:
    - uid: integer
  - name: privateIPAddress
    description: The private ip address of the endpoint.
    types:
    - uid: string
- name: DiskEncryptionProperties
  description: The disk encryption properties
  kind: object
  properties:
  - name: vaultUri
    description: Base key vault URI where the customers key is located eg. https://myvault.vault.azure.net
    types:
    - uid: string
  - name: keyName
    description: Key name that is used for enabling disk encryption.
    types:
    - uid: string
  - name: keyVersion
    description: Specific key version that is used for enabling disk encryption.
    types:
    - uid: string
  - name: encryptionAlgorithm
    description: Algorithm identifier for encryption, default RSA-OAEP.
    types:
    - uid: JsonWebKeyEncryptionAlgorithm
  - name: msiResourceId
    description: Resource ID of Managed Identity that is used to access the key vault.
    types:
    - uid: string
  - name: encryptionAtHost
    description: Indicates whether or not resource disk encryption is enabled.
    types:
    - uid: boolean
    defaultValue: false
- name: EncryptionInTransitProperties
  description: The encryption-in-transit properties.
  kind: object
  properties:
  - name: isEncryptionInTransitEnabled
    description: Indicates whether or not inter cluster node communication is encrypted in transit.
    types:
    - uid: boolean
    defaultValue: false
- name: StorageProfile
  description: The storage profile.
  kind: object
  properties:
  - name: storageaccounts
    description: The list of storage accounts in the cluster.
    types:
    - uid: StorageAccount
      isArray: true
- name: ExcludedServicesConfig
  description: The configuration that services will be excluded when creating cluster.
  kind: object
  properties:
  - name: excludedServicesConfigId
    description: The config id of excluded services.
    types:
    - uid: string
  - name: excludedServicesList
    description: The list of excluded services.
    types:
    - uid: string
- name: NetworkProperties
  description: The network properties.
  kind: object
  properties:
  - name: resourceProviderConnection
    description: The direction for the resource provider connection.
    types:
    - uid: ResourceProviderConnection
  - name: privateLink
    description: Indicates whether or not private link is enabled.
    types:
    - uid: PrivateLink
- name: ComputeIsolationProperties
  description: The compute isolation properties.
  kind: object
  properties:
  - name: enableComputeIsolation
    description: The flag indicates whether enable compute isolation or not.
    types:
    - uid: boolean
    defaultValue: false
  - name: hostSku
    description: The host sku.
    types:
    - uid: string
- name: ResourceIdentityType
  description: The type of identity used for the cluster. The type 'SystemAssigned, UserAssigned' includes both an implicitly created identity and a set of user assigned identities.
  kind: enum
  properties:
  - name: SystemAssigned
    types:
    - uid: string
  - name: UserAssigned
    types:
    - uid: string
  - name: SystemAssigned, UserAssigned
    types:
    - uid: string
  - name: None
    types:
    - uid: string
- name: UserAssignedIdentities
  description: "The list of user identities associated with the cluster. The user identity dictionary key references will be ARM resource ids in the form: '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ManagedIdentity/userAssignedIdentities/{identityName}'."
  kind: object
  properties:
  - name: ''
    description: ''
    types:
    - uid: ''
- name: ClientGroupInfo
  description: The information of AAD security group.
  kind: object
  properties:
  - name: groupName
    description: The AAD security group name.
    types:
    - uid: string
  - name: groupId
    description: The AAD security group id.
    types:
    - uid: string
- name: DirectoryType
  description: The directory type.
  kind: enum
  properties:
  - name: ActiveDirectory
    types:
    - uid: string
- name: Role
  description: Describes a role on the cluster.
  kind: object
  properties:
  - name: name
    description: The name of the role.
    types:
    - uid: string
  - name: minInstanceCount
    description: The minimum instance count of the cluster.
    types:
    - uid: integer
  - name: targetInstanceCount
    description: The instance count of the cluster.
    types:
    - uid: integer
  - name: VMGroupName
    description: The name of the virtual machine group.
    types:
    - uid: string
  - name: autoscale
    description: The autoscale configurations.
    types:
    - uid: Autoscale
  - name: hardwareProfile
    description: The hardware profile.
    types:
    - uid: HardwareProfile
  - name: osProfile
    description: The operating system profile.
    types:
    - uid: OsProfile
  - name: virtualNetworkProfile
    description: The virtual network profile.
    types:
    - uid: VirtualNetworkProfile
  - name: dataDisksGroups
    description: The data disks groups for the role.
    types:
    - uid: DataDisksGroups
      isArray: true
  - name: scriptActions
    description: The list of script actions on the role.
    types:
    - uid: ScriptAction
      isArray: true
  - name: encryptDataDisks
    description: Indicates whether encrypt the data disks.
    types:
    - uid: boolean
    defaultValue: false
- name: JsonWebKeyEncryptionAlgorithm
  description: Algorithm identifier for encryption, default RSA-OAEP.
  kind: enum
  properties:
  - name: RSA-OAEP
    types:
    - uid: string
  - name: RSA-OAEP-256
    types:
    - uid: string
  - name: RSA1_5
    types:
    - uid: string
- name: StorageAccount
  description: The storage Account.
  kind: object
  properties:
  - name: name
    description: The name of the storage account.
    types:
    - uid: string
  - name: isDefault
    description: Whether or not the storage account is the default storage account.
    types:
    - uid: boolean
  - name: container
    description: The container in the storage account, only to be specified for WASB storage accounts.
    types:
    - uid: string
  - name: fileSystem
    description: The filesystem, only to be specified for Azure Data Lake Storage Gen 2.
    types:
    - uid: string
  - name: key
    description: The storage account access key.
    types:
    - uid: string
  - name: resourceId
    description: The resource ID of storage account, only to be specified for Azure Data Lake Storage Gen 2.
    types:
    - uid: string
  - name: msiResourceId
    description: The managed identity (MSI) that is allowed to access the storage account, only to be specified for Azure Data Lake Storage Gen 2.
    types:
    - uid: string
  - name: saskey
    description: The shared access signature key.
    types:
    - uid: string
  - name: fileshare
    description: The file share name.
    types:
    - uid: string
- name: ResourceProviderConnection
  description: The direction for the resource provider connection.
  kind: enum
  properties:
  - name: Inbound
    types:
    - uid: string
  - name: Outbound
    types:
    - uid: string
- name: PrivateLink
  description: Indicates whether or not private link is enabled.
  kind: enum
  properties:
  - name: Disabled
    types:
    - uid: string
  - name: Enabled
    types:
    - uid: string
- name: Autoscale
  description: The autoscale request parameters
  kind: object
  properties:
  - name: capacity
    description: Parameters for load-based autoscale
    types:
    - uid: AutoscaleCapacity
  - name: recurrence
    description: Parameters for schedule-based autoscale
    types:
    - uid: AutoscaleRecurrence
- name: HardwareProfile
  description: The hardware profile.
  kind: object
  properties:
  - name: vmSize
    description: The size of the VM
    types:
    - uid: string
- name: OsProfile
  description: The Linux operation systems profile.
  kind: object
  properties:
  - name: linuxOperatingSystemProfile
    description: The Linux OS profile.
    types:
    - uid: LinuxOperatingSystemProfile
- name: VirtualNetworkProfile
  description: The virtual network properties.
  kind: object
  properties:
  - name: id
    description: The ID of the virtual network.
    types:
    - uid: string
  - name: subnet
    description: The name of the subnet.
    types:
    - uid: string
- name: DataDisksGroups
  description: The data disks groups for the role.
  kind: object
  properties:
  - name: disksPerNode
    description: The number of disks per node.
    types:
    - uid: integer
  - name: storageAccountType
    isReadyOnly: true
    description: ReadOnly. The storage account type. Do not set this value.
    types:
    - uid: string
  - name: diskSizeGB
    isReadyOnly: true
    description: ReadOnly. The DiskSize in GB. Do not set this value.
    types:
    - uid: integer
- name: ScriptAction
  description: Describes a script action on role on the cluster.
  kind: object
  properties:
  - name: name
    description: The name of the script action.
    types:
    - uid: string
  - name: uri
    description: The URI to the script.
    types:
    - uid: string
  - name: parameters
    description: The parameters for the script provided.
    types:
    - uid: string
- name: AutoscaleCapacity
  description: The load-based autoscale request parameters
  kind: object
  properties:
  - name: minInstanceCount
    description: The minimum instance count of the cluster
    types:
    - uid: integer
  - name: maxInstanceCount
    description: The maximum instance count of the cluster
    types:
    - uid: integer
- name: AutoscaleRecurrence
  description: Schedule-based autoscale request parameters
  kind: object
  properties:
  - name: timeZone
    description: The time zone for the autoscale schedule times
    types:
    - uid: string
  - name: schedule
    description: Array of schedule-based autoscale rules
    types:
    - uid: AutoscaleSchedule
      isArray: true
- name: LinuxOperatingSystemProfile
  description: The ssh username, password, and ssh public key.
  kind: object
  properties:
  - name: username
    description: The username.
    types:
    - uid: string
  - name: password
    description: The password.
    types:
    - uid: string
  - name: sshProfile
    description: The SSH profile.
    types:
    - uid: SshProfile
- name: AutoscaleSchedule
  description: Parameters for a schedule-based autoscale rule, consisting of an array of days + a time and capacity
  kind: object
  properties:
  - name: days
    description: Days of the week for a schedule-based autoscale rule
    types:
    - uid: string
      isArray: true
  - name: timeAndCapacity
    description: Time and capacity for a schedule-based autoscale rule
    types:
    - uid: AutoscaleTimeAndCapacity
- name: SshProfile
  description: The list of SSH public keys.
  kind: object
  properties:
  - name: publicKeys
    description: The list of SSH public keys.
    types:
    - uid: SshPublicKey
      isArray: true
- name: AutoscaleTimeAndCapacity
  description: Time and capacity request parameters
  kind: object
  properties:
  - name: time
    description: 24-hour time in the form xx:xx
    types:
    - uid: string
  - name: minInstanceCount
    description: The minimum instance count of the cluster
    types:
    - uid: integer
  - name: maxInstanceCount
    description: The maximum instance count of the cluster
    types:
    - uid: integer
- name: SshPublicKey
  description: The SSH public key for the cluster nodes.
  kind: object
  properties:
  - name: certificateData
    description: The certificate for SSH.
    types:
    - uid: string
examples:
- name: Patch HDInsight Linux clusters
  request:
    uri: PATCH https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.HDInsight/clusters/cluster1?api-version=2018-06-01-preview
    body: >-
      {
        "tags": {
          "key1": "val1",
          "key2": "val2"
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PATCH https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.HDInsight/clusters/cluster1?api-version=2018-06-01-preview

      {
        "tags": {
          "key1": "val1",
          "key2": "val2"
        }
      }

      ```

  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.HDInsight/clusters/cluster1",
        "name": "cluster1",
        "type": "Microsoft.HDInsight/clusters",
        "location": "West US",
        "etag": "f0212a39-b827-45e0-9ffa-4f5232e58851",
        "tags": {
          "key1": "val1",
          "key2": "val2"
        },
        "properties": {
          "clusterVersion": "3.5.1000.0",
          "osType": "Linux",
          "clusterDefinition": {
            "blueprint": "https://blueprints.azurehdinsight.net/hadoop-3.5.1000.0.9243893.json",
            "kind": "hadoop"
          },
          "computeProfile": {
            "roles": [
              {
                "name": "headnode",
                "targetInstanceCount": 2,
                "hardwareProfile": {
                  "vmSize": "Standard_D3_V2"
                },
                "osProfile": {
                  "linuxOperatingSystemProfile": {
                    "username": "sshuser"
                  }
                }
              },
              {
                "name": "workernode",
                "targetInstanceCount": 4,
                "hardwareProfile": {
                  "vmSize": "Standard_D3_V2"
                },
                "osProfile": {
                  "linuxOperatingSystemProfile": {
                    "username": "sshuser"
                  }
                }
              },
              {
                "name": "zookeepernode",
                "targetInstanceCount": 3,
                "hardwareProfile": {
                  "vmSize": "Medium"
                },
                "osProfile": {
                  "linuxOperatingSystemProfile": {
                    "username": "sshuser"
                  }
                }
              }
            ]
          },
          "provisioningState": "Succeeded",
          "clusterState": "Running",
          "createdDate": "2017-01-11T18:58:26.187",
          "quotaInfo": {
            "coresUsed": 24
          },
          "connectivityEndpoints": [
            {
              "name": "SSH",
              "protocol": "TCP",
              "location": "cluster1-ssh.azurehdinsight.net",
              "port": 22
            },
            {
              "name": "HTTPS",
              "protocol": "TCP",
              "location": "cluster1.azurehdinsight.net",
              "port": 443
            }
          ],
          "tier": "Standard"
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: Learn more about HDInsight service - Patch HDInsight cluster with the specified parameters.
errorCodes: []
