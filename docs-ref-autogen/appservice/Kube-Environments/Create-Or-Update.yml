### YamlMime:RESTOperation
uid: management.azure.com.appservice.kubeenvironments.createorupdate
name: Create Or Update
service: App Service
groupName: Kube Environments
apiVersion: 2022-03-01
summary: Description for Creates or updates a Kubernetes Environment.
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/kubeEnvironments/{name}?api-version=2022-03-01
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: Your Azure subscription ID. This is a GUID-formatted string (e.g. 00000000-0000-0000-0000-000000000000).
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: Name of the resource group to which the resource belongs.
  types:
  - uid: string
  pattern: ^[-\w\._\(\)]+[^\.]$
- name: name
  in: path
  isRequired: true
  description: Name of the Kubernetes Environment.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: API Version
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK
  types:
  - uid: KubeEnvironment
- name: 201 Created
  description: Created
  types:
  - uid: KubeEnvironment
- name: Other Status Codes
  description: App Service error response.
  types:
  - uid: DefaultErrorResponse
requestBody:
- name: default
  parameters:
  - name: extendedLocation
    in: body
    description: Extended Location.
    types:
    - uid: ExtendedLocation
  - name: properties.internalLoadBalancerEnabled
    in: body
    description: Only visible within Vnet/Subnet
    types:
    - uid: boolean
  - name: properties.staticIp
    in: body
    description: Static IP of the KubeEnvironment
    types:
    - uid: string
  - name: properties.environmentType
    in: body
    description: Type of Kubernetes Environment. Only supported for Container App Environments with value as Managed
    types:
    - uid: string
  - name: properties.arcConfiguration
    in: body
    description: >-
      Cluster configuration which determines the ARC cluster

      components types. Eg: Choosing between BuildService kind,

      FrontEnd Service ArtifactsStorageType etc.
    types:
    - uid: ArcConfiguration
  - name: properties.appLogsConfiguration
    in: body
    description: >-
      Cluster configuration which enables the log daemon to export

      app logs to a destination. Currently only "log-analytics" is

      supported
    types:
    - uid: AppLogsConfiguration
  - name: properties.containerAppsConfiguration
    in: body
    description: Cluster configuration for Container Apps Environments to configure Dapr Instrumentation Key and VNET Configuration
    types:
    - uid: ContainerAppsConfiguration
  - name: properties.aksResourceID
    in: body
    description: ''
    types:
    - uid: string
  - name: kind
    in: body
    description: Kind of resource.
    types:
    - uid: string
  - name: location
    in: body
    isRequired: true
    description: Resource Location.
    types:
    - uid: string
  - name: tags
    in: body
    description: Resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
requestHeader: []
definitions:
- name: ExtendedLocation
  description: Extended Location.
  kind: object
  properties:
  - name: name
    description: Name of extended location.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Type of extended location.
    types:
    - uid: string
- name: ArcConfiguration
  kind: object
  properties:
  - name: artifactsStorageType
    description: ''
    types:
    - uid: StorageType
  - name: artifactStorageClassName
    description: ''
    types:
    - uid: string
  - name: artifactStorageMountPath
    description: ''
    types:
    - uid: string
  - name: artifactStorageNodeName
    description: ''
    types:
    - uid: string
  - name: artifactStorageAccessMode
    description: ''
    types:
    - uid: string
  - name: frontEndServiceConfiguration
    description: ''
    types:
    - uid: FrontEndConfiguration
  - name: kubeConfig
    description: ''
    types:
    - uid: string
- name: AppLogsConfiguration
  kind: object
  properties:
  - name: destination
    description: ''
    types:
    - uid: string
  - name: logAnalyticsConfiguration
    description: ''
    types:
    - uid: LogAnalyticsConfiguration
- name: ContainerAppsConfiguration
  kind: object
  properties:
  - name: daprAIInstrumentationKey
    description: Azure Monitor instrumentation key used by Dapr to export Service to Service communication telemetry
    types:
    - uid: string
  - name: platformReservedCidr
    description: IP range in CIDR notation that can be reserved for environment infrastructure IP addresses. It must not overlap with any other Subnet IP ranges.
    types:
    - uid: string
  - name: platformReservedDnsIP
    description: An IP address from the IP range defined by platformReservedCidr that will be reserved for the internal DNS server
    types:
    - uid: string
  - name: controlPlaneSubnetResourceId
    description: Resource ID of a subnet for control plane infrastructure components. This subnet must be in the same VNET as the subnet defined in appSubnetResourceId. Must not overlap with the IP range defined in platformReservedCidr, if defined.
    types:
    - uid: string
  - name: appSubnetResourceId
    description: Resource ID of a subnet for control plane infrastructure components. This subnet must be in the same VNET as the subnet defined in appSubnetResourceId. Must not overlap with the IP range defined in platformReservedCidr, if defined.
    types:
    - uid: string
  - name: dockerBridgeCidr
    description: CIDR notation IP range assigned to the Docker bridge network. It must not overlap with any Subnet IP ranges or the IP range defined in platformReservedCidr, if defined.
    types:
    - uid: string
- name: KubeEnvironment
  description: A Kubernetes cluster specialized for web workloads by Azure App Service
  kind: object
  properties:
  - name: extendedLocation
    description: Extended Location.
    types:
    - uid: ExtendedLocation
  - name: properties.provisioningState
    isReadyOnly: true
    description: Provisioning state of the Kubernetes Environment.
    types:
    - uid: KubeEnvironmentProvisioningState
  - name: properties.deploymentErrors
    isReadyOnly: true
    description: Any errors that occurred during deployment or deployment validation
    types:
    - uid: string
  - name: properties.internalLoadBalancerEnabled
    description: Only visible within Vnet/Subnet
    types:
    - uid: boolean
  - name: properties.defaultDomain
    isReadyOnly: true
    description: Default Domain Name for the cluster
    types:
    - uid: string
  - name: properties.staticIp
    description: Static IP of the KubeEnvironment
    types:
    - uid: string
  - name: properties.environmentType
    description: Type of Kubernetes Environment. Only supported for Container App Environments with value as Managed
    types:
    - uid: string
  - name: properties.arcConfiguration
    description: >-
      Cluster configuration which determines the ARC cluster

      components types. Eg: Choosing between BuildService kind,

      FrontEnd Service ArtifactsStorageType etc.
    types:
    - uid: ArcConfiguration
  - name: properties.appLogsConfiguration
    description: >-
      Cluster configuration which enables the log daemon to export

      app logs to a destination. Currently only "log-analytics" is

      supported
    types:
    - uid: AppLogsConfiguration
  - name: properties.containerAppsConfiguration
    description: Cluster configuration for Container Apps Environments to configure Dapr Instrumentation Key and VNET Configuration
    types:
    - uid: ContainerAppsConfiguration
  - name: properties.aksResourceID
    description: ''
    types:
    - uid: string
  - name: id
    isReadyOnly: true
    description: Resource Id.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource Name.
    types:
    - uid: string
  - name: kind
    description: Kind of resource.
    types:
    - uid: string
  - name: location
    description: Resource Location.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type.
    types:
    - uid: string
  - name: tags
    description: Resource tags.
    types:
    - uid: object
      isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
- name: DefaultErrorResponse
  description: App Service error response.
  kind: object
  properties:
  - name: error
    isReadyOnly: true
    description: Error model.
    types:
    - uid: Error
- name: StorageType
  kind: enum
  properties:
  - name: LocalNode
    types:
    - uid: string
  - name: NetworkFileSystem
    types:
    - uid: string
- name: FrontEndConfiguration
  kind: object
  properties:
  - name: kind
    description: ''
    types:
    - uid: FrontEndServiceType
- name: LogAnalyticsConfiguration
  kind: object
  properties:
  - name: customerId
    description: ''
    types:
    - uid: string
  - name: sharedKey
    description: ''
    types:
    - uid: string
- name: KubeEnvironmentProvisioningState
  description: Provisioning state of the Kubernetes Environment.
  kind: enum
  properties:
  - name: Succeeded
    types:
    - uid: string
  - name: Failed
    types:
    - uid: string
  - name: Canceled
    types:
    - uid: string
  - name: Waiting
    types:
    - uid: string
  - name: InitializationInProgress
    types:
    - uid: string
  - name: InfrastructureSetupInProgress
    types:
    - uid: string
  - name: InfrastructureSetupComplete
    types:
    - uid: string
  - name: ScheduledForDelete
    types:
    - uid: string
  - name: UpgradeRequested
    types:
    - uid: string
  - name: UpgradeFailed
    types:
    - uid: string
- name: Error
  description: Error model.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Standardized string to programmatically identify the error.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: Detailed error description and debugging information.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: Detailed error description and debugging information.
    types:
    - uid: string
  - name: details
    description: Detailed errors.
    types:
    - uid: Details
      isArray: true
  - name: innererror
    isReadyOnly: true
    description: More information to debug error.
    types:
    - uid: string
- name: FrontEndServiceType
  kind: enum
  properties:
  - name: NodePort
    types:
    - uid: string
  - name: LoadBalancer
    types:
    - uid: string
- name: Details
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Standardized string to programmatically identify the error.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: Detailed error description and debugging information.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: Detailed error description and debugging information.
    types:
    - uid: string
examples:
- name: Create kube environments
  request:
    uri: PUT https://management.azure.com/subscriptions/34adfa4f-cedf-4dc0-ba29-b6d1a69ab345/resourceGroups/examplerg/providers/Microsoft.Web/kubeEnvironments/testkubeenv?api-version=2022-03-01
    body: >-
      {
        "location": "East US",
        "properties": {
          "staticIp": "1.2.3.4"
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      PUT https://management.azure.com/subscriptions/34adfa4f-cedf-4dc0-ba29-b6d1a69ab345/resourceGroups/examplerg/providers/Microsoft.Web/kubeEnvironments/testkubeenv?api-version=2022-03-01

      {
        "location": "East US",
        "properties": {
          "staticIp": "1.2.3.4"
        }
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.appservice.fluent.models.KubeEnvironmentInner;

      /** Samples for KubeEnvironments CreateOrUpdate. */
      public final class Main {
          /*
           * x-ms-original-file: specification/web/resource-manager/Microsoft.Web/stable/2022-03-01/examples/KubeEnvironments_CreateOrUpdate.json
           */
          /**
           * Sample code: Create kube environments.
           *
           * @param azure The entry point for accessing resource management APIs in Azure.
           */
          public static void createKubeEnvironments(com.azure.resourcemanager.AzureResourceManager azure) {
              azure
                  .webApps()
                  .manager()
                  .serviceClient()
                  .getKubeEnvironments()
                  .createOrUpdate(
                      "examplerg",
                      "testkubeenv",
                      new KubeEnvironmentInner().withLocation("East US").withStaticIp("1.2.3.4"),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager_2.19.0/sdk/resourcemanager/azure-resourcemanager/README.md) on how to add the SDK to your project and authenticate.
      # [Go](#tab/Go)
      ``` go
      package armappservice_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"
      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/appservice/armappservice/v2"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/web/resource-manager/Microsoft.Web/stable/2022-03-01/examples/KubeEnvironments_CreateOrUpdate.json
      func ExampleKubeEnvironmentsClient_BeginCreateOrUpdate() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armappservice.NewKubeEnvironmentsClient("34adfa4f-cedf-4dc0-ba29-b6d1a69ab345", cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	poller, err := client.BeginCreateOrUpdate(ctx,
      		"examplerg",
      		"testkubeenv",
      		armappservice.KubeEnvironment{
      			Location: to.Ptr("East US"),
      			Properties: &armappservice.KubeEnvironmentProperties{
      				StaticIP: to.Ptr("1.2.3.4"),
      			},
      		},
      		nil)
      	if err != nil {
      		log.Fatalf("failed to finish the request: %v", err)
      	}
      	res, err := poller.PollUntilDone(ctx, nil)
      	if err != nil {
      		log.Fatalf("failed to pull the result: %v", err)
      	}
      	// TODO: use response item
      	_ = res
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fappservice%2Farmappservice%2Fv2.0.0/sdk/resourcemanager/appservice/armappservice/README.md) on how to add the SDK to your project and authenticate.
      # [JavaScript](#tab/JavaScript)
      ``` js
      const { WebSiteManagementClient } = require("@azure/arm-appservice");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Description for Creates or updates a Kubernetes Environment.
       *
       * @summary Description for Creates or updates a Kubernetes Environment.
       * x-ms-original-file: specification/web/resource-manager/Microsoft.Web/stable/2022-03-01/examples/KubeEnvironments_CreateOrUpdate.json
       */
      async function createKubeEnvironments() {
        const subscriptionId = "34adfa4f-cedf-4dc0-ba29-b6d1a69ab345";
        const resourceGroupName = "examplerg";
        const name = "testkubeenv";
        const kubeEnvironmentEnvelope = {
          location: "East US",
          staticIp: "1.2.3.4",
        };
        const credential = new DefaultAzureCredential();
        const client = new WebSiteManagementClient(credential, subscriptionId);
        const result = await client.kubeEnvironments.beginCreateOrUpdateAndWait(
          resourceGroupName,
          name,
          kubeEnvironmentEnvelope
        );
        console.log(result);
      }

      createKubeEnvironments().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-appservice_13.0.2/sdk/appservice/arm-appservice/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/34adfa4f-cedf-4dc0-ba29-b6d1a69ab345/resourceGroups/examplerg/providers/Microsoft.Web/kubeEnvironments/testkubeenv",
        "name": "testkubeenv",
        "type": "Microsoft.Web/kubeEnvironments",
        "location": "East US",
        "extendedLocation": {
          "name": "/subscriptions/34adfa4f-cedf-4dc0-ba29-b6d1a69ab345/resourceGroups/examplerg/providers/Microsoft.ExtendedLocation/customLocations/testcustomlocation",
          "type": "customLocation"
        },
        "tags": {},
        "properties": {
          "provisioningState": "Succeeded",
          "deploymentErrors": null,
          "internalLoadBalancerEnabled": false,
          "defaultDomain": "testkubeenv.k4apps.io",
          "staticIp": "1.2.3.4",
          "arcConfiguration": null,
          "appLogsConfiguration": null,
          "aksResourceID": "test"
        }
      }
  - statusCode: "201"
    body: >-
      {
        "id": "/subscriptions/34adfa4f-cedf-4dc0-ba29-b6d1a69ab345/resourceGroups/examplerg/providers/Microsoft.Web/kubeEnvironments/testkubeenv",
        "name": "testkubeenv",
        "type": "Microsoft.Web/kubeEnvironments",
        "location": "East US",
        "extendedLocation": {
          "name": "/subscriptions/34adfa4f-cedf-4dc0-ba29-b6d1a69ab345/resourceGroups/examplerg/providers/Microsoft.ExtendedLocation/customLocations/testcustomlocation",
          "type": "customLocation"
        },
        "tags": {},
        "properties": {
          "provisioningState": "InitializationInProgress",
          "deploymentErrors": null,
          "internalLoadBalancerEnabled": false,
          "defaultDomain": "testkubeenv.k4apps.io",
          "staticIp": "1.2.3.4",
          "arcConfiguration": null,
          "appLogsConfiguration": null,
          "aksResourceID": "test"
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about App Service service - Description for Creates or updates a Kubernetes Environment.
errorCodes: []
