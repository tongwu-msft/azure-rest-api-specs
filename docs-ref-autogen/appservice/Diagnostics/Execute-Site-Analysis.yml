### YamlMime:RESTOperation
uid: management.azure.com.appservice.diagnostics.executesiteanalysis
name: Execute Site Analysis
service: App Service
groupName: Diagnostics
apiVersion: 2019-08-01
summary: Description for Execute Analysis
consumes:
- application/json
produces:
- application/json
paths:
- content: POST https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{siteName}/diagnostics/{diagnosticCategory}/analyses/{analysisName}/execute?api-version=2019-08-01
- content: POST https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{siteName}/diagnostics/{diagnosticCategory}/analyses/{analysisName}/execute?startTime={startTime}&endTime={endTime}&timeGrain={timeGrain}&api-version=2019-08-01
  isOptional: true
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: Your Azure subscription ID. This is a GUID-formatted string (e.g. 00000000-0000-0000-0000-000000000000).
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: Name of the resource group to which the resource belongs.
  types:
  - uid: string
  pattern: ^[-\w\._\(\)]+[^\.]$
- name: siteName
  in: path
  isRequired: true
  description: Site Name
  types:
  - uid: string
- name: diagnosticCategory
  in: path
  isRequired: true
  description: Category Name
  types:
  - uid: string
- name: analysisName
  in: path
  isRequired: true
  description: Analysis Resource Name
  types:
  - uid: string
- name: startTime
  in: query
  description: Start Time
  types:
  - uid: string
  format: date-time
- name: endTime
  in: query
  description: End Time
  types:
  - uid: string
  format: date-time
- name: timeGrain
  in: query
  description: Time Grain
  types:
  - uid: string
  pattern: PT[1-9][0-9]+[SMH]
- name: api-version
  in: query
  isRequired: true
  description: API Version
  types:
  - uid: string
responses:
- name: 200 OK
  description: OK
  types:
  - uid: DiagnosticAnalysis
- name: Other Status Codes
  description: App Service error response.
  types:
  - uid: DefaultErrorResponse
requestHeader: []
definitions:
- name: DiagnosticAnalysis
  description: Class representing a diagnostic analysis done on an application
  kind: object
  properties:
  - name: properties.startTime
    description: Start time of the period
    types:
    - uid: string
  - name: properties.endTime
    description: End time of the period
    types:
    - uid: string
  - name: properties.abnormalTimePeriods
    description: List of time periods.
    types:
    - uid: AbnormalTimePeriod
      isArray: true
  - name: properties.payload
    description: Data by each detector
    types:
    - uid: AnalysisData
      isArray: true
  - name: properties.nonCorrelatedDetectors
    description: Data by each detector for detectors that did not corelate
    types:
    - uid: DetectorDefinition
      isArray: true
  - name: id
    isReadyOnly: true
    description: Resource Id.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource Name.
    types:
    - uid: string
  - name: kind
    description: Kind of resource.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type.
    types:
    - uid: string
- name: DefaultErrorResponse
  description: App Service error response.
  kind: object
  properties:
  - name: error
    isReadyOnly: true
    description: Error model.
    types:
    - uid: Error
- name: AbnormalTimePeriod
  description: Class representing Abnormal Time Period identified in diagnosis
  kind: object
  properties:
  - name: startTime
    description: Start time of the downtime
    types:
    - uid: string
  - name: endTime
    description: End time of the downtime
    types:
    - uid: string
  - name: events
    description: List of Possible Cause of downtime
    types:
    - uid: DetectorAbnormalTimePeriod
      isArray: true
  - name: solutions
    description: List of proposed solutions
    types:
    - uid: Solution
      isArray: true
- name: AnalysisData
  description: Class Representing Detector Evidence used for analysis
  kind: object
  properties:
  - name: source
    description: Name of the Detector
    types:
    - uid: string
  - name: detectorDefinition
    description: Detector Definition
    types:
    - uid: DetectorDefinition
  - name: metrics
    description: Source Metrics
    types:
    - uid: DiagnosticMetricSet
      isArray: true
  - name: data
    description: Additional Source Data
    types:
    - uid: array
      isArray: true
  - name: detectorMetaData
    description: Detector Meta Data
    types:
    - uid: ResponseMetaData
- name: DetectorDefinition
  description: Class representing detector definition
  kind: object
  properties:
  - name: properties.displayName
    isReadyOnly: true
    description: Display name of the detector
    types:
    - uid: string
  - name: properties.description
    isReadyOnly: true
    description: Description of the detector
    types:
    - uid: string
  - name: properties.rank
    isReadyOnly: true
    description: Detector Rank
    types:
    - uid: number
  - name: properties.isEnabled
    isReadyOnly: true
    description: Flag representing whether detector is enabled or not.
    types:
    - uid: boolean
  - name: id
    isReadyOnly: true
    description: Resource Id.
    types:
    - uid: string
  - name: name
    isReadyOnly: true
    description: Resource Name.
    types:
    - uid: string
  - name: kind
    description: Kind of resource.
    types:
    - uid: string
  - name: type
    isReadyOnly: true
    description: Resource type.
    types:
    - uid: string
- name: Error
  description: Error model.
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Standardized string to programmatically identify the error.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: Detailed error description and debugging information.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: Detailed error description and debugging information.
    types:
    - uid: string
  - name: details
    description: Detailed errors.
    types:
    - uid: Details
      isArray: true
  - name: innererror
    isReadyOnly: true
    description: More information to debug error.
    types:
    - uid: string
- name: DetectorAbnormalTimePeriod
  description: Class representing Abnormal Time Period detected.
  kind: object
  properties:
  - name: startTime
    description: Start time of the correlated event
    types:
    - uid: string
  - name: endTime
    description: End time of the correlated event
    types:
    - uid: string
  - name: message
    description: Message describing the event
    types:
    - uid: string
  - name: source
    description: Represents the name of the Detector
    types:
    - uid: string
  - name: priority
    description: Represents the rank of the Detector
    types:
    - uid: number
  - name: metaData
    description: Downtime metadata
    types:
    - uid: array
      isArray: true
  - name: type
    description: Represents the type of the Detector
    types:
    - uid: IssueType
  - name: solutions
    description: List of proposed solutions
    types:
    - uid: Solution
      isArray: true
- name: Solution
  description: Class Representing Solution for problems detected.
  kind: object
  properties:
  - name: id
    description: Solution Id.
    types:
    - uid: number
  - name: displayName
    description: Display Name of the solution
    types:
    - uid: string
  - name: order
    description: Order of the solution.
    types:
    - uid: number
  - name: description
    description: Description of the solution
    types:
    - uid: string
  - name: type
    description: Type of Solution
    types:
    - uid: SolutionType
  - name: data
    description: Solution Data.
    types:
    - uid: array
      isArray: true
  - name: metadata
    description: Solution Metadata.
    types:
    - uid: array
      isArray: true
- name: DiagnosticMetricSet
  description: Class representing Diagnostic Metric information
  kind: object
  properties:
  - name: name
    description: Name of the metric
    types:
    - uid: string
  - name: unit
    description: Metric's unit
    types:
    - uid: string
  - name: startTime
    description: Start time of the period
    types:
    - uid: string
  - name: endTime
    description: End time of the period
    types:
    - uid: string
  - name: timeGrain
    description: Presented time grain. Supported grains at the moment are PT1M, PT1H, P1D
    types:
    - uid: string
  - name: values
    description: Collection of metric values for the selected period based on the {Microsoft.Web.Hosting.Administration.DiagnosticMetricSet.TimeGrain}
    types:
    - uid: DiagnosticMetricSample
      isArray: true
- name: ResponseMetaData
  kind: object
  properties:
  - name: dataSource
    description: Source of the Data
    types:
    - uid: DataSource
- name: Details
  kind: object
  properties:
  - name: code
    isReadyOnly: true
    description: Standardized string to programmatically identify the error.
    types:
    - uid: string
  - name: message
    isReadyOnly: true
    description: Detailed error description and debugging information.
    types:
    - uid: string
  - name: target
    isReadyOnly: true
    description: Detailed error description and debugging information.
    types:
    - uid: string
- name: IssueType
  description: Represents the type of the Detector
  kind: enum
  properties:
  - name: ServiceIncident
    types:
    - uid: string
  - name: AppDeployment
    types:
    - uid: string
  - name: AppCrash
    types:
    - uid: string
  - name: RuntimeIssueDetected
    types:
    - uid: string
  - name: AseDeployment
    types:
    - uid: string
  - name: UserIssue
    types:
    - uid: string
  - name: PlatformIssue
    types:
    - uid: string
  - name: Other
    types:
    - uid: string
- name: SolutionType
  description: Type of Solution
  kind: enum
  properties:
  - name: QuickSolution
    types:
    - uid: string
  - name: DeepInvestigation
    types:
    - uid: string
  - name: BestPractices
    types:
    - uid: string
- name: DiagnosticMetricSample
  description: Class representing Diagnostic Metric
  kind: object
  properties:
  - name: timestamp
    description: Time at which metric is measured
    types:
    - uid: string
  - name: roleInstance
    description: "Role Instance. Null if this counter is not per instance \nThis is returned and should be whichever instance name we desire to be returned\ni.e. CPU and Memory return RDWORKERNAME (LargeDed..._IN_0) \nwhere RDWORKERNAME is Machine name below and RoleInstance name in parenthesis"
    types:
    - uid: string
  - name: total
    description: Total value of the metric. If multiple measurements are made this will have sum of all.
    types:
    - uid: number
  - name: maximum
    description: Maximum of the metric sampled during the time period
    types:
    - uid: number
  - name: minimum
    description: Minimum of the metric sampled during the time period
    types:
    - uid: number
  - name: isAggregated
    description: Whether the values are aggregates across all workers or not
    types:
    - uid: boolean
- name: DataSource
  description: Class representing data source used by the detectors
  kind: object
  properties:
  - name: instructions
    description: Instructions if any for the data source
    types:
    - uid: string
      isArray: true
  - name: dataSourceUri
    description: Datasource Uri Links
    types:
    - uid: NameValuePair
      isArray: true
- name: NameValuePair
  description: Name value pair.
  kind: object
  properties:
  - name: name
    description: Pair name.
    types:
    - uid: string
  - name: value
    description: Pair value.
    types:
    - uid: string
examples:
- name: Execute site slot analysis
  request:
    uri: POST https://management.azure.com/subscriptions/34adfa4f-cedf-4dc0-ba29-b6d1a69ab345/resourceGroups/Sample-WestUSResourceGroup/providers/Microsoft.Web/sites/SampleApp/diagnostics/availability/analyses/apprestartanalyses/execute?api-version=2019-08-01
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/34adfa4f-cedf-4dc0-ba29-b6d1a69ab345/resourceGroups/Sample-WestUSResourceGroup/providers/Microsoft.Web/sites/SampleApp/slots/staging/diagnostics/availability/analyses/apprestartanalyses",
        "name": "apprestartanalysis",
        "properties": {
          "startTime": "2017-11-05T22:50:00Z",
          "endTime": "2017-11-06T22:50:00Z",
          "abnormalTimePeriods": [
            {
              "startTime": "2017-11-05T22:50:00Z",
              "endTime": "2017-11-06T22:50:00Z",
              "events": [
                {
                  "startTime": "2017-11-06T22:21:50Z",
                  "endTime": "2017-11-06T22:21:48Z",
                  "message": "Your application process was restarted as application environment variables changed. This can most likely occur due to update in app settings or swap operation. This event occurred multiple times during the day.",
                  "source": null,
                  "priority": 0,
                  "metaData": [
                    [
                      {
                        "name": "feature",
                        "value": "auditlogs"
                      },
                      {
                        "name": "displayedName",
                        "value": "Check Audit Logs"
                      }
                    ]
                  ],
                  "type": "ServiceIncident",
                  "solutions": []
                }
              ],
              "solutions": []
            }
          ],
          "payload": [
            {
              "source": "workerprocessrecycle",
              "metrics": [
                {
                  "name": "All Application Stop Events",
                  "unit": null,
                  "startTime": "2017-11-05T22:50:00Z",
                  "endTime": "2017-11-06T22:50:00Z",
                  "timeGrain": "00:05:00",
                  "values": [
                    {
                      "timestamp": "2017-11-06T00:00:00Z",
                      "roleInstance": "RD00155D3C15BE",
                      "total": 2
                    },
                    {
                      "timestamp": "2017-11-06T00:00:00Z",
                      "total": 2,
                      "isAggregated": true
                    },
                    {
                      "timestamp": "2017-11-06T00:10:00Z",
                      "roleInstance": "RD00155D3C15C1",
                      "total": 2
                    },
                    {
                      "timestamp": "2017-11-06T00:10:00Z",
                      "roleInstance": "RD00155D3BE0FB",
                      "total": 2
                    },
                    {
                      "timestamp": "2017-11-06T00:10:00Z",
                      "total": 4,
                      "isAggregated": true
                    }
                  ]
                },
                {
                  "name": "User Events",
                  "unit": "",
                  "startTime": "2017-11-05T22:50:00Z",
                  "endTime": "2017-11-06T22:50:00Z",
                  "timeGrain": "00:05:00",
                  "values": [
                    {
                      "timestamp": "2017-11-06T22:20:00Z",
                      "total": 3,
                      "isAggregated": true
                    },
                    {
                      "timestamp": "2017-11-06T22:20:00Z",
                      "roleInstance": "RD00155D3C09FC",
                      "total": 1
                    },
                    {
                      "timestamp": "2017-11-06T22:20:00Z",
                      "roleInstance": "RD00155D3C2ADC",
                      "total": 1
                    },
                    {
                      "timestamp": "2017-11-06T22:20:00Z",
                      "roleInstance": "RD00155D3C214E",
                      "total": 1
                    }
                  ]
                }
              ],
              "data": [],
              "detectorMetaData": null
            }
          ],
          "nonCorrelatedDetectors": []
        }
      }
- name: Execute site analysis
  request:
    uri: POST https://management.azure.com/subscriptions/34adfa4f-cedf-4dc0-ba29-b6d1a69ab345/resourceGroups/Sample-WestUSResourceGroup/providers/Microsoft.Web/sites/SampleApp/diagnostics/availability/analyses/apprestartanalyses/execute?api-version=2019-08-01
  responses:
  - statusCode: "200"
    body: >-
      {
        "id": "/subscriptions/34adfa4f-cedf-4dc0-ba29-b6d1a69ab345/resourceGroups/Sample-WestUSResourceGroup/providers/Microsoft.Web/sites/SampleApp/diagnostics/availability/analyses/apprestartanalyses",
        "name": "apprestartanalysis",
        "properties": {
          "startTime": "2017-11-05T22:50:00Z",
          "endTime": "2017-11-06T22:50:00Z",
          "abnormalTimePeriods": [
            {
              "startTime": "2017-11-05T22:50:00Z",
              "endTime": "2017-11-06T22:50:00Z",
              "events": [
                {
                  "startTime": "2017-11-06T22:21:50Z",
                  "endTime": "2017-11-06T22:21:48Z",
                  "message": "Your application process was restarted as application environment variables changed. This can most likely occur due to update in app settings or swap operation. This event occurred multiple times during the day.",
                  "source": null,
                  "priority": 0,
                  "metaData": [
                    [
                      {
                        "name": "feature",
                        "value": "auditlogs"
                      },
                      {
                        "name": "displayedName",
                        "value": "Check Audit Logs"
                      }
                    ]
                  ],
                  "type": "ServiceIncident",
                  "solutions": []
                }
              ],
              "solutions": []
            }
          ],
          "payload": [
            {
              "source": "workerprocessrecycle",
              "metrics": [
                {
                  "name": "All Application Stop Events",
                  "unit": null,
                  "startTime": "2017-11-05T22:50:00Z",
                  "endTime": "2017-11-06T22:50:00Z",
                  "timeGrain": "00:05:00",
                  "values": [
                    {
                      "timestamp": "2017-11-06T00:00:00Z",
                      "roleInstance": "RD00155D3C15BE",
                      "total": 2
                    },
                    {
                      "timestamp": "2017-11-06T00:00:00Z",
                      "total": 2,
                      "isAggregated": true
                    },
                    {
                      "timestamp": "2017-11-06T00:10:00Z",
                      "roleInstance": "RD00155D3C15C1",
                      "total": 2
                    },
                    {
                      "timestamp": "2017-11-06T00:10:00Z",
                      "roleInstance": "RD00155D3BE0FB",
                      "total": 2
                    },
                    {
                      "timestamp": "2017-11-06T00:10:00Z",
                      "total": 4,
                      "isAggregated": true
                    }
                  ]
                },
                {
                  "name": "User Events",
                  "unit": "",
                  "startTime": "2017-11-05T22:50:00Z",
                  "endTime": "2017-11-06T22:50:00Z",
                  "timeGrain": "00:05:00",
                  "values": [
                    {
                      "timestamp": "2017-11-06T22:20:00Z",
                      "total": 3,
                      "isAggregated": true
                    },
                    {
                      "timestamp": "2017-11-06T22:20:00Z",
                      "roleInstance": "RD00155D3C09FC",
                      "total": 1
                    },
                    {
                      "timestamp": "2017-11-06T22:20:00Z",
                      "roleInstance": "RD00155D3C2ADC",
                      "total": 1
                    },
                    {
                      "timestamp": "2017-11-06T22:20:00Z",
                      "roleInstance": "RD00155D3C214E",
                      "total": 1
                    }
                  ]
                }
              ],
              "data": [],
              "detectorMetaData": null
            }
          ],
          "nonCorrelatedDetectors": []
        }
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: Learn more about <App Service> service - Description for Execute Analysis
errorCodes: []
