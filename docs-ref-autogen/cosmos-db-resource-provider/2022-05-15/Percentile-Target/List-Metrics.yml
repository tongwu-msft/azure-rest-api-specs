### YamlMime:RESTOperation
uid: management.azure.com.cosmos-db-resource-provider.2022-05-15.percentiletarget.listmetrics
name: List Metrics
service: Cosmos DB Resource Provider
groupName: Percentile Target
apiVersion: 2022-05-15
summary: Retrieves the metrics determined by the given filter for the given account target region. This url is only for PBS and Replication Latency data
consumes:
- application/json
produces:
- application/json
paths:
- content: GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.DocumentDB/databaseAccounts/{accountName}/targetRegion/{targetRegion}/percentile/metrics?api-version=2022-05-15&$filter={$filter}
uriParameters:
- name: subscriptionId
  in: path
  isRequired: true
  description: The ID of the target subscription.
  types:
  - uid: string
- name: resourceGroupName
  in: path
  isRequired: true
  description: The name of the resource group. The name is case insensitive.
  types:
  - uid: string
- name: accountName
  in: path
  isRequired: true
  description: Cosmos DB database account name.
  types:
  - uid: string
  pattern: ^[a-z0-9]+(-[a-z0-9]+)*
- name: targetRegion
  in: path
  isRequired: true
  description: Target region to which data is written. Cosmos DB region, with spaces between words and each word capitalized.
  types:
  - uid: string
- name: api-version
  in: query
  isRequired: true
  description: The API version to use for this operation.
  types:
  - uid: string
- name: $filter
  in: query
  isRequired: true
  description: An OData filter expression that describes a subset of metrics to return. The parameters that can be filtered are name.value (name of the metric, can have an or of multiple names), startTime, endTime, and timeGrain. The supported operator is eq.
  types:
  - uid: string
responses:
- name: 200 OK
  description: The percentile metrics for the account and target regions were retrieved successfully.
  types:
  - uid: PercentileMetricListResult
requestHeader: []
definitions:
- name: PercentileMetricListResult
  description: The response to a list percentile metrics request.
  kind: object
  properties:
  - name: value
    isReadyOnly: true
    description: The list of percentile metrics for the account.
    types:
    - uid: PercentileMetric
      isArray: true
- name: PercentileMetric
  description: Percentile Metric data
  kind: object
  properties:
  - name: startTime
    isReadyOnly: true
    description: The start time for the metric (ISO-8601 format).
    types:
    - uid: string
  - name: endTime
    isReadyOnly: true
    description: The end time for the metric (ISO-8601 format).
    types:
    - uid: string
  - name: timeGrain
    isReadyOnly: true
    description: The time grain to be used to summarize the metric values.
    types:
    - uid: string
  - name: unit
    isReadyOnly: true
    description: The unit of the metric.
    types:
    - uid: UnitType
  - name: name
    isReadyOnly: true
    description: The name information for the metric.
    types:
    - uid: MetricName
  - name: metricValues
    isReadyOnly: true
    description: The percentile metric values for the specified time window and timestep.
    types:
    - uid: PercentileMetricValue
      isArray: true
- name: UnitType
  description: The unit of the metric.
  kind: enum
  properties:
  - name: Count
    types:
    - uid: string
  - name: Bytes
    types:
    - uid: string
  - name: Seconds
    types:
    - uid: string
  - name: Percent
    types:
    - uid: string
  - name: CountPerSecond
    types:
    - uid: string
  - name: BytesPerSecond
    types:
    - uid: string
  - name: Milliseconds
    types:
    - uid: string
- name: MetricName
  description: A metric name.
  kind: object
  properties:
  - name: value
    isReadyOnly: true
    description: The name of the metric.
    types:
    - uid: string
  - name: localizedValue
    isReadyOnly: true
    description: The friendly name of the metric.
    types:
    - uid: string
- name: PercentileMetricValue
  description: Represents percentile metrics values.
  kind: object
  properties:
  - name: P10
    isReadyOnly: true
    description: The 10th percentile value for the metric.
    types:
    - uid: number
  - name: P25
    isReadyOnly: true
    description: The 25th percentile value for the metric.
    types:
    - uid: number
  - name: P50
    isReadyOnly: true
    description: The 50th percentile value for the metric.
    types:
    - uid: number
  - name: P75
    isReadyOnly: true
    description: The 75th percentile value for the metric.
    types:
    - uid: number
  - name: P90
    isReadyOnly: true
    description: The 90th percentile value for the metric.
    types:
    - uid: number
  - name: P95
    isReadyOnly: true
    description: The 95th percentile value for the metric.
    types:
    - uid: number
  - name: P99
    isReadyOnly: true
    description: The 99th percentile value for the metric.
    types:
    - uid: number
  - name: _count
    isReadyOnly: true
    description: The number of values for the metric.
    types:
    - uid: number
  - name: average
    isReadyOnly: true
    description: The average value of the metric.
    types:
    - uid: number
  - name: maximum
    isReadyOnly: true
    description: The max value of the metric.
    types:
    - uid: number
  - name: minimum
    isReadyOnly: true
    description: The min value of the metric.
    types:
    - uid: number
  - name: timestamp
    isReadyOnly: true
    description: The metric timestamp (ISO-8601 format).
    types:
    - uid: string
  - name: total
    isReadyOnly: true
    description: The total value of the metric.
    types:
    - uid: number
examples:
- name: CosmosDBDatabaseAccountRegionGetMetrics
  request:
    uri: GET https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.DocumentDB/databaseAccounts/ddb1/targetRegion/East US/percentile/metrics?api-version=2022-05-15&$filter=$filter=(name.value eq 'Probabilistic Bounded Staleness') and timeGrain eq duration'PT5M' and startTime eq '2017-11-19T23:53:55.2780000Z' and endTime eq '2017-11-20T00:13:55.2780000Z
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      GET https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.DocumentDB/databaseAccounts/ddb1/targetRegion/East US/percentile/metrics?api-version=2022-05-15&$filter=$filter=(name.value eq 'Probabilistic Bounded Staleness') and timeGrain eq duration'PT5M' and startTime eq '2017-11-19T23:53:55.2780000Z' and endTime eq '2017-11-20T00:13:55.2780000Z
      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;

      /** Samples for PercentileTarget ListMetrics. */
      public final class Main {
          /*
           * x-ms-original-file: specification/cosmos-db/resource-manager/Microsoft.DocumentDB/stable/2022-05-15/examples/CosmosDBPercentileTargetGetMetrics.json
           */
          /**
           * Sample code: CosmosDBDatabaseAccountRegionGetMetrics.
           *
           * @param azure The entry point for accessing resource management APIs in Azure.
           */
          public static void cosmosDBDatabaseAccountRegionGetMetrics(com.azure.resourcemanager.AzureResourceManager azure) {
              azure
                  .cosmosDBAccounts()
                  .manager()
                  .serviceClient()
                  .getPercentileTargets()
                  .listMetrics(
                      "rg1",
                      "ddb1",
                      "East US",
                      "$filter=(name.value eq 'Probabilistic Bounded Staleness') and timeGrain eq duration'PT5M' and"
                          + " startTime eq '2017-11-19T23:53:55.2780000Z' and endTime eq '2017-11-20T00:13:55.2780000Z",
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager_2.18.0/sdk/resourcemanager/azure-resourcemanager/README.md) on how to add the SDK to your project and authenticate.
      # [Go](#tab/Go)
      ``` go
      package armcosmos_test

      import (
      	"context"
      	"log"

      	"github.com/Azure/azure-sdk-for-go/sdk/azidentity"
      	"github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/cosmos/armcosmos/v2"
      )

      // Generated from example definition: https://github.com/Azure/azure-rest-api-specs/tree/main/specification/cosmos-db/resource-manager/Microsoft.DocumentDB/stable/2022-05-15/examples/CosmosDBPercentileTargetGetMetrics.json
      func ExamplePercentileTargetClient_NewListMetricsPager() {
      	cred, err := azidentity.NewDefaultAzureCredential(nil)
      	if err != nil {
      		log.Fatalf("failed to obtain a credential: %v", err)
      	}
      	ctx := context.Background()
      	client, err := armcosmos.NewPercentileTargetClient("subid", cred, nil)
      	if err != nil {
      		log.Fatalf("failed to create client: %v", err)
      	}
      	pager := client.NewListMetricsPager("rg1",
      		"ddb1",
      		"East US",
      		"$filter=(name.value eq 'Probabilistic Bounded Staleness') and timeGrain eq duration'PT5M' and startTime eq '2017-11-19T23:53:55.2780000Z' and endTime eq '2017-11-20T00:13:55.2780000Z",
      		nil)
      	for pager.More() {
      		nextResult, err := pager.NextPage(ctx)
      		if err != nil {
      			log.Fatalf("failed to advance page: %v", err)
      		}
      		for _, v := range nextResult.Value {
      			// TODO: use page item
      			_ = v
      		}
      	}
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-go/blob/sdk%2Fresourcemanager%2Fcosmos%2Farmcosmos%2Fv2.0.0/sdk/resourcemanager/cosmos/armcosmos/README.md) on how to add the SDK to your project and authenticate.
      # [JavaScript](#tab/JavaScript)
      ``` js
      const { CosmosDBManagementClient } = require("@azure/arm-cosmosdb");
      const { DefaultAzureCredential } = require("@azure/identity");

      /**
       * This sample demonstrates how to Retrieves the metrics determined by the given filter for the given account target region. This url is only for PBS and Replication Latency data
       *
       * @summary Retrieves the metrics determined by the given filter for the given account target region. This url is only for PBS and Replication Latency data
       * x-ms-original-file: specification/cosmos-db/resource-manager/Microsoft.DocumentDB/stable/2022-05-15/examples/CosmosDBPercentileTargetGetMetrics.json
       */
      async function cosmosDbDatabaseAccountRegionGetMetrics() {
        const subscriptionId = "subid";
        const resourceGroupName = "rg1";
        const accountName = "ddb1";
        const targetRegion = "East US";
        const filter =
          "$filter=(name.value eq 'Probabilistic Bounded Staleness') and timeGrain eq duration'PT5M' and startTime eq '2017-11-19T23:53:55.2780000Z' and endTime eq '2017-11-20T00:13:55.2780000Z";
        const credential = new DefaultAzureCredential();
        const client = new CosmosDBManagementClient(credential, subscriptionId);
        const resArray = new Array();
        for await (let item of client.percentileTarget.listMetrics(
          resourceGroupName,
          accountName,
          targetRegion,
          filter
        )) {
          resArray.push(item);
        }
        console.log(resArray);
      }

      cosmosDbDatabaseAccountRegionGetMetrics().catch(console.error);

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-js/blob/%40azure%2Farm-cosmosdb_15.1.0/sdk/cosmosdb/arm-cosmosdb/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "value": [
          {
            "timeGrain": "PT5M",
            "startTime": "2017-11-19T23:53:55.2780000Z",
            "endTime": "2017-11-20T00:13:55.2780000Z",
            "unit": "Milliseconds",
            "metricValues": [
              {
                "timestamp": "2017-11-19T23:53:55.2780000Z",
                "P10": 1.11,
                "P25": 2.5,
                "P50": 4.34,
                "P75": 5.2,
                "P90": 6.77,
                "P95": 7.1,
                "P99": 8.3
              }
            ],
            "name": {
              "value": "Probabilistic Bounded Staleness-S-West Central US-T-East US",
              "localizedValue": "Probabilistic Bounded Staleness-S-West Central US-T-East US"
            }
          },
          {
            "timeGrain": "PT5M",
            "startTime": "2017-11-19T23:53:55.2780000Z",
            "endTime": "2017-11-20T00:13:55.2780000Z",
            "unit": "Milliseconds",
            "metricValues": [
              {
                "timestamp": "2017-11-19T23:53:55.2780000Z",
                "P10": 1.11,
                "P25": 2.5,
                "P50": 4.34,
                "P75": 5.2,
                "P90": 6.77,
                "P95": 7.1,
                "P99": 8.3
              }
            ],
            "name": {
              "value": "Probabilistic Bounded Staleness-S-West US-T-East US",
              "localizedValue": "Probabilistic Bounded Staleness-S-West Central US-T-West US"
            }
          }
        ]
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: Impersonate your user account
metadata:
  description: >
    Retrieves the metrics determined by the given filter for the given account target region. This url is only for PBS and Replication Latency data
errorCodes: []
