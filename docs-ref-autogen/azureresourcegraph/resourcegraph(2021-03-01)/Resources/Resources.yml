### YamlMime:RESTOperation
uid: management.azure.com.azureresourcegraph.resourcegraph(2021-03-01).resources.resources
name: Resources
service: Azure Resource Graph
groupName: Resources
apiVersion: 2021-03-01
summary: Queries the resources managed by Azure Resource Manager for scopes specified in the request.
consumes:
- application/json
produces:
- application/json
paths:
- content: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
uriParameters:
- name: api-version
  in: query
  isRequired: true
  description: Api Version.
  types:
  - uid: string
responses:
- name: 200 OK
  description: Result of the query operation
  types:
  - uid: QueryResponse
- name: Other Status Codes
  description: An error occurred while processing the request. See the error.code parameter to identify the specific error.
  types:
  - uid: ErrorResponse
requestBody:
- name: default
  parameters:
  - name: subscriptions
    in: body
    description: Azure subscriptions against which to execute the query.
    types:
    - uid: string
      isArray: true
  - name: managementGroups
    in: body
    description: "Azure management groups against which to execute the query. Example: [ 'mg1', 'mg2' ]"
    types:
    - uid: string
      isArray: true
  - name: query
    in: body
    isRequired: true
    description: The resources query.
    types:
    - uid: string
  - name: options
    in: body
    description: The query evaluation options
    types:
    - uid: QueryRequestOptions
  - name: facets
    in: body
    description: An array of facet requests to be computed against the query result.
    types:
    - uid: FacetRequest
      isArray: true
requestHeader: []
definitions:
- name: QueryRequestOptions
  description: The options for query evaluation
  kind: object
  properties:
  - name: $skipToken
    description: Continuation token for pagination, capturing the next page size and offset, as well as the context of the query.
    types:
    - uid: string
  - name: $top
    description: The maximum number of rows that the query should return. Overrides the page size when ```$skipToken``` property is present.
    types:
    - uid: integer
  - name: $skip
    description: The number of rows to skip from the beginning of the results. Overrides the next page offset when ```$skipToken``` property is present.
    types:
    - uid: integer
  - name: resultFormat
    description: Defines in which format query result returned.
    types:
    - uid: ResultFormat
    defaultValue: objectArray
  - name: allowPartialScopes
    description: Only applicable for tenant and management group level queries to decide whether to allow partial scopes for result in case the number of subscriptions exceed allowed limits.
    types:
    - uid: boolean
    defaultValue: false
- name: FacetRequest
  description: A request to compute additional statistics (facets) over the query results.
  kind: object
  properties:
  - name: expression
    description: The column or list of columns to summarize by
    types:
    - uid: string
  - name: options
    description: The options for facet evaluation
    types:
    - uid: FacetRequestOptions
- name: QueryResponse
  description: Query result.
  kind: object
  properties:
  - name: totalRecords
    description: Number of total records matching the query.
    types:
    - uid: integer
  - name: count
    description: Number of records returned in the current response. In the case of paging, this is the number of records in the current page.
    types:
    - uid: integer
  - name: resultTruncated
    description: Indicates whether the query results are truncated.
    types:
    - uid: ResultTruncated
  - name: $skipToken
    description: When present, the value can be passed to a subsequent query call (together with the same query and scopes used in the current request) to retrieve the next page of data.
    types:
    - uid: string
  - name: data
    description: Query output in JObject array or Table format.
    types:
    - uid: object
  - name: facets
    description: Query facets.
    types:
    - uid: FacetResult
      isArray: true
    - uid: FacetError
      isArray: true
    typesTitle: Facet[]
- name: ErrorResponse
  description: Error response.
  kind: object
  properties:
  - name: error
    description: "Error info.  \nError information."
    types:
    - uid: Error
- name: QueryRequest
  description: Describes a query to be executed.
  kind: object
  properties:
  - name: subscriptions
    description: Azure subscriptions against which to execute the query.
    types:
    - uid: string
      isArray: true
  - name: managementGroups
    description: "Azure management groups against which to execute the query. Example: [ 'mg1', 'mg2' ]"
    types:
    - uid: string
      isArray: true
  - name: query
    description: The resources query.
    types:
    - uid: string
  - name: options
    description: The query evaluation options
    types:
    - uid: QueryRequestOptions
  - name: facets
    description: An array of facet requests to be computed against the query result.
    types:
    - uid: FacetRequest
      isArray: true
- name: ResultFormat
  description: Defines in which format query result returned.
  kind: enum
  properties:
  - name: table
    types:
    - uid: string
  - name: objectArray
    types:
    - uid: string
- name: FacetRequestOptions
  description: The options for facet evaluation
  kind: object
  properties:
  - name: sortBy
    description: The column name or query expression to sort on. Defaults to count if not present.
    types:
    - uid: string
  - name: sortOrder
    description: The sorting order by the selected column (count by default).
    types:
    - uid: FacetSortOrder
    defaultValue: desc
  - name: filter
    description: Specifies the filter condition for the 'where' clause which will be run on main query's result, just before the actual faceting.
    types:
    - uid: string
  - name: $top
    description: The maximum number of facet rows that should be returned.
    types:
    - uid: integer
- name: ResultTruncated
  description: Indicates whether the query results are truncated.
  kind: enum
  properties:
  - name: "true"
    types:
    - uid: string
  - name: "false"
    types:
    - uid: string
- name: Error
  description: Error info.
  kind: object
  properties:
  - name: code
    description: Error code identifying the specific error.
    types:
    - uid: string
  - name: message
    description: A human readable error message.
    types:
    - uid: string
  - name: details
    description: Error details
    types:
    - uid: ErrorDetails
      isArray: true
- name: FacetSortOrder
  description: The sorting order by the selected column (count by default).
  kind: enum
  properties:
  - name: asc
    types:
    - uid: string
  - name: desc
    types:
    - uid: string
- name: FacetResult
  description: Successfully executed facet containing additional statistics on the response of a query.
  kind: object
  properties:
  - name: totalRecords
    description: Number of total records in the facet results.
    types:
    - uid: integer
  - name: count
    description: Number of records returned in the facet response.
    types:
    - uid: integer
  - name: data
    description: A JObject array or Table containing the desired facets. Only present if the facet is valid.
    types:
    - uid: object
  - name: expression
    description: Facet expression, same as in the corresponding facet request.
    types:
    - uid: string
  - name: resultType
    description: Result type
    types:
    - uid: FacetResult
    typesTitle: string
- name: FacetError
  description: A facet whose execution resulted in an error.
  kind: object
  properties:
  - name: errors
    description: An array containing detected facet errors with details.
    types:
    - uid: ErrorDetails
      isArray: true
  - name: expression
    description: Facet expression, same as in the corresponding facet request.
    types:
    - uid: string
  - name: resultType
    description: Result type
    types:
    - uid: FacetError
    typesTitle: string
- name: ErrorDetails
  description: Error details.
  kind: object
  properties:
  - name: code
    description: Error code identifying the specific error.
    types:
    - uid: string
  - name: message
    description: A human readable error message.
    types:
    - uid: string
examples:
- name: Basic query
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | project id, name, type, location, tags | limit 3"
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | project id, name, type, location, tags | limit 3"
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;
      import java.util.Arrays;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesBasicQuery.json
           */
          /**
           * Sample code: Basic query.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void basicQuery(com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest()
                          .withSubscriptions(Arrays.asList("cfbbd179-59d2-4052-aa06-9270a38aa9d6"))
                          .withQuery("Resources | project id, name, type, location, tags | limit 3"),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 3,
        "count": 3,
        "resultTruncated": "false",
        "facets": [],
        "data": [
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG1/providers/Microsoft.Network/networkInterfaces/myNetworkInterface",
            "name": "myNetworkInterface",
            "type": "microsoft.network/networkinterfaces",
            "location": "centralus",
            "tags": {
              "tag1": "Value1"
            }
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Network/virtualNetworks/myVnet",
            "name": "myVnet",
            "type": "microsoft.network/virtualnetworks",
            "location": "westus",
            "tags": {}
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Network/publicIPAddresses/myPublicIp",
            "name": "myPublicIp",
            "type": "microsoft.network/publicipaddresses",
            "location": "westus",
            "tags": {}
          }
        ]
      }
- name: Basic tenant query
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "query": "Resources | project id, name, type, location, tags | limit 3"
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "query": "Resources | project id, name, type, location, tags | limit 3"
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesTenantBasicQuery.json
           */
          /**
           * Sample code: Basic tenant query.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void basicTenantQuery(com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest().withQuery("Resources | project id, name, type, location, tags | limit 3"),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 3,
        "count": 3,
        "resultTruncated": "false",
        "facets": [],
        "data": [
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG1/providers/Microsoft.Network/networkInterfaces/myNetworkInterface",
            "name": "myNetworkInterface",
            "type": "microsoft.network/networkinterfaces",
            "location": "centralus",
            "tags": {
              "tag1": "Value1"
            }
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Network/virtualNetworks/myVnet",
            "name": "myVnet",
            "type": "microsoft.network/virtualnetworks",
            "location": "westus",
            "tags": {}
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Network/publicIPAddresses/myPublicIp",
            "name": "myPublicIp",
            "type": "microsoft.network/publicipaddresses",
            "location": "westus",
            "tags": {}
          }
        ]
      }
- name: Basic management group query
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "managementGroups": [
          "e927f598-c1d4-4f72-8541-95d83a6a4ac8",
          "ProductionMG"
        ],
        "query": "Resources | project id, name, type, location, tags | limit 3"
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "managementGroups": [
          "e927f598-c1d4-4f72-8541-95d83a6a4ac8",
          "ProductionMG"
        ],
        "query": "Resources | project id, name, type, location, tags | limit 3"
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;
      import java.util.Arrays;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesMgBasicQuery.json
           */
          /**
           * Sample code: Basic management group query.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void basicManagementGroupQuery(com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest()
                          .withManagementGroups(Arrays.asList("e927f598-c1d4-4f72-8541-95d83a6a4ac8", "ProductionMG"))
                          .withQuery("Resources | project id, name, type, location, tags | limit 3"),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 3,
        "count": 3,
        "resultTruncated": "false",
        "facets": [],
        "data": [
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG1/providers/Microsoft.Network/networkInterfaces/myNetworkInterface",
            "name": "myNetworkInterface",
            "type": "microsoft.network/networkinterfaces",
            "location": "centralus",
            "tags": {
              "tag1": "Value1"
            }
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Network/virtualNetworks/myVnet",
            "name": "myVnet",
            "type": "microsoft.network/virtualnetworks",
            "location": "westus",
            "tags": {}
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Network/publicIPAddresses/myPublicIp",
            "name": "myPublicIp",
            "type": "microsoft.network/publicipaddresses",
            "location": "westus",
            "tags": {}
          }
        ]
      }
- name: Filter resources
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | project id, name, type, location | where type =~ 'Microsoft.Compute/virtualMachines' | limit 3"
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | project id, name, type, location | where type =~ 'Microsoft.Compute/virtualMachines' | limit 3"
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;
      import java.util.Arrays;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesFilterQuery.json
           */
          /**
           * Sample code: Filter resources.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void filterResources(com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest()
                          .withSubscriptions(Arrays.asList("cfbbd179-59d2-4052-aa06-9270a38aa9d6"))
                          .withQuery(
                              "Resources | project id, name, type, location | where type =~"
                                  + " 'Microsoft.Compute/virtualMachines' | limit 3"),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 3,
        "count": 3,
        "resultTruncated": "false",
        "facets": [],
        "data": [
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG1/providers/Microsoft.Compute/virtualMachines/myVm1",
            "name": "myVm1",
            "type": "microsoft.compute/virtualmachines",
            "location": "centralus"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Compute/virtualMachines/myVirtualMachine",
            "name": "myVirtualMachine",
            "type": "microsoft.compute/virtualmachines",
            "location": "eastus"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG3/providers/Microsoft.Compute/virtualMachines/testVm",
            "name": "testVm",
            "type": "microsoft.compute/virtualmachines",
            "location": "eastus"
          }
        ]
      }
- name: Summarize resources by location
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | project id, name, type, location | summarize by location"
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | project id, name, type, location | summarize by location"
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;
      import java.util.Arrays;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesSummarizeQuery.json
           */
          /**
           * Sample code: Summarize resources by location.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void summarizeResourcesByLocation(
              com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest()
                          .withSubscriptions(Arrays.asList("cfbbd179-59d2-4052-aa06-9270a38aa9d6"))
                          .withQuery("Resources | project id, name, type, location | summarize by location"),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 3,
        "count": 3,
        "resultTruncated": "false",
        "facets": [],
        "data": [
          {
            "location": "centralus"
          },
          {
            "location": "eastus"
          },
          {
            "location": "westus"
          }
        ]
      }
- name: Complex query
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | project id, name, type, location | where type =~ 'Microsoft.Compute/virtualMachines' | summarize count() by location | top 3 by count_"
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | project id, name, type, location | where type =~ 'Microsoft.Compute/virtualMachines' | summarize count() by location | top 3 by count_"
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;
      import java.util.Arrays;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesComplexQuery.json
           */
          /**
           * Sample code: Complex query.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void complexQuery(com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest()
                          .withSubscriptions(Arrays.asList("cfbbd179-59d2-4052-aa06-9270a38aa9d6"))
                          .withQuery(
                              "Resources | project id, name, type, location | where type =~"
                                  + " 'Microsoft.Compute/virtualMachines' | summarize count() by location | top 3 by count_"),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 3,
        "count": 3,
        "resultTruncated": "false",
        "facets": [],
        "data": [
          {
            "location": "centralus",
            "count_": 11
          },
          {
            "location": "eastus",
            "count_": 11
          },
          {
            "location": "southcentralus",
            "count_": 3
          }
        ]
      }
- name: Access a properties field
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | where type =~ 'Microsoft.Compute/virtualMachines' | summarize count() by tostring(properties.storageProfile.osDisk.osType)"
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | where type =~ 'Microsoft.Compute/virtualMachines' | summarize count() by tostring(properties.storageProfile.osDisk.osType)"
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;
      import java.util.Arrays;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesPropertiesQuery.json
           */
          /**
           * Sample code: Access a properties field.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void accessAPropertiesField(com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest()
                          .withSubscriptions(Arrays.asList("cfbbd179-59d2-4052-aa06-9270a38aa9d6"))
                          .withQuery(
                              "Resources | where type =~ 'Microsoft.Compute/virtualMachines' | summarize count() by"
                                  + " tostring(properties.storageProfile.osDisk.osType)"),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 2,
        "count": 2,
        "resultTruncated": "false",
        "facets": [],
        "data": [
          {
            "properties_storageProfile_osDisk_osType": "Linux",
            "count": 7
          },
          {
            "properties_storageProfile_osDisk_osType": "Windows",
            "count": 23
          }
        ]
      }
- name: Query with a facet request
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | where type =~ 'Microsoft.Compute/virtualMachines' | project id, name, location, resourceGroup, properties.storageProfile.osDisk.osType | limit 5",
        "facets": [
          {
            "expression": "location",
            "options": {
              "sortOrder": "desc",
              "$top": 3
            }
          },
          {
            "expression": "properties.storageProfile.osDisk.osType",
            "options": {
              "sortOrder": "desc",
              "$top": 3
            }
          },
          {
            "expression": "nonExistingColumn",
            "options": {
              "sortOrder": "desc",
              "$top": 3
            }
          },
          {
            "expression": "resourceGroup",
            "options": {
              "sortBy": "tolower(resourceGroup)",
              "sortOrder": "asc",
              "$top": 3
            }
          },
          {
            "expression": "resourceGroup",
            "options": {
              "filter": "resourceGroup contains 'test'",
              "$top": 3
            }
          }
        ]
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | where type =~ 'Microsoft.Compute/virtualMachines' | project id, name, location, resourceGroup, properties.storageProfile.osDisk.osType | limit 5",
        "facets": [
          {
            "expression": "location",
            "options": {
              "sortOrder": "desc",
              "$top": 3
            }
          },
          {
            "expression": "properties.storageProfile.osDisk.osType",
            "options": {
              "sortOrder": "desc",
              "$top": 3
            }
          },
          {
            "expression": "nonExistingColumn",
            "options": {
              "sortOrder": "desc",
              "$top": 3
            }
          },
          {
            "expression": "resourceGroup",
            "options": {
              "sortBy": "tolower(resourceGroup)",
              "sortOrder": "asc",
              "$top": 3
            }
          },
          {
            "expression": "resourceGroup",
            "options": {
              "filter": "resourceGroup contains 'test'",
              "$top": 3
            }
          }
        ]
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.FacetRequest;
      import com.azure.resourcemanager.resourcegraph.models.FacetRequestOptions;
      import com.azure.resourcemanager.resourcegraph.models.FacetSortOrder;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;
      import java.util.Arrays;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesFacetQuery.json
           */
          /**
           * Sample code: Query with a facet request.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void queryWithAFacetRequest(com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest()
                          .withSubscriptions(Arrays.asList("cfbbd179-59d2-4052-aa06-9270a38aa9d6"))
                          .withQuery(
                              "Resources | where type =~ 'Microsoft.Compute/virtualMachines' | project id, name, location,"
                                  + " resourceGroup, properties.storageProfile.osDisk.osType | limit 5")
                          .withFacets(
                              Arrays
                                  .asList(
                                      new FacetRequest()
                                          .withExpression("location")
                                          .withOptions(
                                              new FacetRequestOptions().withSortOrder(FacetSortOrder.DESC).withTop(3)),
                                      new FacetRequest()
                                          .withExpression("properties.storageProfile.osDisk.osType")
                                          .withOptions(
                                              new FacetRequestOptions().withSortOrder(FacetSortOrder.DESC).withTop(3)),
                                      new FacetRequest()
                                          .withExpression("nonExistingColumn")
                                          .withOptions(
                                              new FacetRequestOptions().withSortOrder(FacetSortOrder.DESC).withTop(3)),
                                      new FacetRequest()
                                          .withExpression("resourceGroup")
                                          .withOptions(
                                              new FacetRequestOptions()
                                                  .withSortBy("tolower(resourceGroup)")
                                                  .withSortOrder(FacetSortOrder.ASC)
                                                  .withTop(3)),
                                      new FacetRequest()
                                          .withExpression("resourceGroup")
                                          .withOptions(
                                              new FacetRequestOptions()
                                                  .withFilter("resourceGroup contains 'test'")
                                                  .withTop(3)))),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 5,
        "count": 5,
        "resultTruncated": "false",
        "data": [
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/B-TEST-RG/providers/Microsoft.Compute/virtualMachines/myTestVm",
            "name": "myTestVm",
            "location": "eastus",
            "resourceGroup": "B-TEST-RG",
            "properties_storageProfile_osDisk_osType": "Windows"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/c-rg/providers/Microsoft.Compute/virtualMachines/myTestAccountVm",
            "name": "myTestAccountVm",
            "location": "westcentralus",
            "resourceGroup": "c-rg",
            "properties_storageProfile_osDisk_osType": "Windows"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/I-RG/providers/Microsoft.Compute/virtualMachines/yetanothertest",
            "name": "yetanothertest",
            "location": "eastus",
            "resourceGroup": "I-RG",
            "properties_storageProfile_osDisk_osType": "Linux"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/x-test-rg/providers/Microsoft.Compute/virtualMachines/drafttest1bux4cv7a7q3aw",
            "name": "drafttest1bux4cv7a7q3aw",
            "location": "southcentralus",
            "resourceGroup": "x-test-rg",
            "properties_storageProfile_osDisk_osType": "Linux"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/y-rg/providers/Microsoft.Compute/virtualMachines/testvmntp25370",
            "name": "testvmntp25370",
            "location": "eastus",
            "resourceGroup": "y-rg",
            "properties_storageProfile_osDisk_osType": "Windows"
          }
        ],
        "facets": [
          {
            "expression": "location",
            "resultType": "FacetResult",
            "totalRecords": 3,
            "count": 3,
            "data": [
              {
                "location": "eastus",
                "count": 3
              },
              {
                "location": "southcentralus",
                "count": 1
              },
              {
                "location": "westcentralus",
                "count": 1
              }
            ]
          },
          {
            "expression": "properties.storageProfile.osDisk.osType",
            "resultType": "FacetResult",
            "totalRecords": 2,
            "count": 2,
            "data": [
              {
                "properties_storageProfile_osDisk_osType": "Linux",
                "count": 2
              },
              {
                "properties_storageProfile_osDisk_osType": "Windows",
                "count": 3
              }
            ]
          },
          {
            "expression": "nonExistingColumn",
            "resultType": "FacetError",
            "errors": [
              {
                "code": "NoValidColumns",
                "message": "No valid columns in facet expression."
              },
              {
                "code": "InvalidColumnNames",
                "message": "Invalid column names: [nonExistingColumn]."
              }
            ]
          },
          {
            "expression": "resourceGroup",
            "resultType": "FacetResult",
            "totalRecords": 5,
            "count": 3,
            "data": [
              {
                "resourceGroup": "B-TEST-RG",
                "count": 1
              },
              {
                "resourceGroup": "c-rg",
                "count": 1
              },
              {
                "resourceGroup": "I-RG",
                "count": 1
              }
            ]
          },
          {
            "expression": "resourceGroup",
            "resultType": "FacetResult",
            "totalRecords": 2,
            "count": 2,
            "data": [
              {
                "resourceGroup": "B-TEST-RG",
                "count": 1
              },
              {
                "resourceGroup": "x-test-rg",
                "count": 1
              }
            ]
          }
        ]
      }
- name: First page query
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | where name contains 'test' | project id, name, type, location",
        "options": {
          "$top": 3,
          "$skip": 0
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | where name contains 'test' | project id, name, type, location",
        "options": {
          "$top": 3,
          "$skip": 0
        }
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequestOptions;
      import java.util.Arrays;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesFirstPageQuery.json
           */
          /**
           * Sample code: First page query.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void firstPageQuery(com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest()
                          .withSubscriptions(Arrays.asList("cfbbd179-59d2-4052-aa06-9270a38aa9d6"))
                          .withQuery("Resources | where name contains 'test' | project id, name, type, location")
                          .withOptions(new QueryRequestOptions().withTop(3).withSkip(0)),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 386,
        "count": 3,
        "resultTruncated": "false",
        "facets": [],
        "$skipToken": "eyAibm8iOiAibHVjayIsICJidXQiOiAibmljZSIsICJ0cnkiOiAiISIgfQ==",
        "data": [
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG1/providers/Microsoft.Compute/disks/yetanothertest_OsDisk_1_f396cbcb625a457bb69fe2abf5975820",
            "name": "yetanothertest_OsDisk_1_f396cbcb625a457bb69fe2abf5975820",
            "type": "microsoft.compute/disks",
            "location": "eastus"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Automation/automationAccounts/TestAA",
            "name": "TestAA",
            "type": "microsoft.automation/automationaccounts",
            "location": "westcentralus"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Automation/automationAccounts/TestAA/runbooks/TestRB",
            "name": "TestRB",
            "type": "microsoft.automation/automationaccounts/runbooks",
            "location": "westcentralus"
          }
        ]
      }
- name: Next page query
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | where name contains 'test' | project id, name, type, location",
        "options": {
          "$skipToken": "eyAibm8iOiAibHVjayIsICJidXQiOiAibmljZSIsICJ0cnkiOiAiISIgfQ=="
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | where name contains 'test' | project id, name, type, location",
        "options": {
          "$skipToken": "eyAibm8iOiAibHVjayIsICJidXQiOiAibmljZSIsICJ0cnkiOiAiISIgfQ=="
        }
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequestOptions;
      import java.util.Arrays;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesNextPageQuery.json
           */
          /**
           * Sample code: Next page query.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void nextPageQuery(com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest()
                          .withSubscriptions(Arrays.asList("cfbbd179-59d2-4052-aa06-9270a38aa9d6"))
                          .withQuery("Resources | where name contains 'test' | project id, name, type, location")
                          .withOptions(
                              new QueryRequestOptions()
                                  .withSkipToken("eyAibm8iOiAibHVjayIsICJidXQiOiAibmljZSIsICJ0cnkiOiAiISIgfQ==")),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 386,
        "count": 3,
        "resultTruncated": "false",
        "facets": [],
        "$skipToken": "eyAibm8yIjogImx1Y2syIiwgImJ1dDIiOiAibmljZTIiLCAidHJ5MiI6ICIhIiB9",
        "data": [
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG1/providers/Microsoft.Compute/disks/second_OsDisk_dddddbcb625a457bb69fe2abf5975820",
            "name": "second_OsDisk_dddddbcb625a457bb69fe2abf5975820",
            "type": "microsoft.compute/disks",
            "location": "eastus"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Automation/automationAccounts/AATest",
            "name": "AATest",
            "type": "microsoft.automation/automationaccounts",
            "location": "westcentralus"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Automation/automationAccounts/TestAA/runbooks/RBTest",
            "name": "RBTest",
            "type": "microsoft.automation/automationaccounts/runbooks",
            "location": "westcentralus"
          }
        ]
      }
- name: Random page query
  request:
    uri: POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01
    body: >-
      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | where name contains 'test' | project id, name, type, location",
        "options": {
          "$top": 2,
          "$skip": 10
        }
      }
    codeTab: |+
      # [HTTP](#tab/HTTP)
      ``` http
      POST https://management.azure.com/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01

      {
        "subscriptions": [
          "cfbbd179-59d2-4052-aa06-9270a38aa9d6"
        ],
        "query": "Resources | where name contains 'test' | project id, name, type, location",
        "options": {
          "$top": 2,
          "$skip": 10
        }
      }

      ```

      # [Java](#tab/Java)
      ``` java
      import com.azure.core.util.Context;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequest;
      import com.azure.resourcemanager.resourcegraph.models.QueryRequestOptions;
      import java.util.Arrays;

      /** Samples for ResourceProvider Resources. */
      public final class Main {
          /*
           * x-ms-original-file: specification/resourcegraph/resource-manager/Microsoft.ResourceGraph/stable/2021-03-01/examples/ResourcesRandomPageQuery.json
           */
          /**
           * Sample code: Random page query.
           *
           * @param manager Entry point to ResourceGraphManager.
           */
          public static void randomPageQuery(com.azure.resourcemanager.resourcegraph.ResourceGraphManager manager) {
              manager
                  .resourceProviders()
                  .resourcesWithResponse(
                      new QueryRequest()
                          .withSubscriptions(Arrays.asList("cfbbd179-59d2-4052-aa06-9270a38aa9d6"))
                          .withQuery("Resources | where name contains 'test' | project id, name, type, location")
                          .withOptions(new QueryRequestOptions().withTop(2).withSkip(10)),
                      Context.NONE);
          }
      }

      ```
      Read this [SDK documentation](https://github.com/Azure/azure-sdk-for-java/blob/azure-resourcemanager-resourcegraph_1.0.0-beta.3/sdk/resourcegraph/azure-resourcemanager-resourcegraph/README.md) on how to add the SDK to your project and authenticate.
  responses:
  - statusCode: "200"
    body: >-
      {
        "totalRecords": 386,
        "count": 2,
        "resultTruncated": "false",
        "facets": [],
        "$skipToken": "eyAibm8iOiAibHVjayIsICJidXQiOiAibmljZSIsICJ0cnkiOiAiISIgfQ==",
        "data": [
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG1/providers/Microsoft.Compute/disks/third_OsDisk_dddddbcb625a457bb69fe2abf5975820",
            "name": "third_OsDisk_dddddbcb625a457bb69fe2abf5975820",
            "type": "microsoft.compute/disks",
            "location": "eastus"
          },
          {
            "id": "/subscriptions/cfbbd179-59d2-4052-aa06-9270a38aa9d6/resourceGroups/RG2/providers/Microsoft.Automation/automationAccounts/CCTest",
            "name": "CCTest",
            "type": "microsoft.automation/automationaccounts",
            "location": "westcentralus"
          }
        ]
      }
security:
- name: azure_auth
  type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - name: user_impersonation
    description: impersonate your user account
metadata:
  description: >
    Learn more about Azure Resource Graph service - Queries the resources managed by Azure Resource Manager for scopes specified in the request.
errorCodes: []
