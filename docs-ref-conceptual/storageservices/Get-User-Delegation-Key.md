---
title: "Get User Delegation Key"
description: Gets a key for a user delegation SAS (shared access signature).
ms.date: 07/03/2019
ms.prod: azure
ms.service: storage
ms.topic: reference
author: pemari-msft
ms.author: pemari
translation.priority.mt: 
  - de-de
  - es-es
  - fr-fr
  - it-it
  - ja-jp
  - ko-kr
  - pt-br
  - ru-ru
  - zh-cn
  - zh-tw
---

# Get User Delegation Key

The `Get User Delegation Key` operation gets a key that can be used to generate a user delegation SAS (shared access signature). A user delegation SAS grants access to resources in the Blob service to a user with Azure Active Directory credentials. The `Get User Delegation Key` operation is available in version 2018-11-09 and later.  
  
## Request

Construct the `Get User Delegation Key` as follows. HTTPS is required. Replace `myaccount` with the name of your storage account.  
  
|POST Method Request URI|HTTP Version|  
|----------------------------|------------------|  
|`https://myaccount.blob.core.windows.net/?restype=service&comp=userdelegationkey`|HTTP/1.1|  
  
### Emulated Storage Service URI  

When making a request against the local storage service, specify the local hostname and Blob service port as `127.0.0.1:10000`, followed by the local storage account name:  
  
|POST Method Request URI|HTTP Version|  
|----------------------------|------------------|  
|`http://127.0.0.1:10000/devstoreaccount1/?restype=service&comp=userdelegationkey`|HTTP/1.1|  
  
For more information, see [Using the Azure Storage Emulator for Development and Testing](/azure/storage/storage-use-emulator).  
  
### URI Parameters  

The following additional parameters may be specified on the request URI.  
  
|Parameter|Description|  
|---------------|-----------------|  
|`timeout`|Optional. The `timeout` parameter is expressed in seconds. For more information, see [Setting Timeouts for Blob Service Operations](Setting-Timeouts-for-Blob-Service-Operations.md).|  
  
### Request Headers  

The following table describes required and optional request headers.  
  
|Request Header|Description|  
|--------------------|-----------------|  
|`Authorization`|Required. Specifies the authorization scheme. Only authorization with Azure Active Directory is supported. For more information, see [Authenticate with Azure Active Directory](authenticate-with-azure-active-directory.md).|  
|`x-ms-version`|Required for all authorized requests. For more information, see [Versioning for the Azure Storage Services](Versioning-for-the-Azure-Storage-Services.md).|  
|`x-ms-client-request-id`|Optional. Provides a client-generated, opaque value with a 1 KB character limit that is recorded in the analytics logs when storage analytics logging is enabled. Using this header is highly recommended for correlating client-side activities with requests received by the server. For more information, see [About Storage Analytics Logging](About-Storage-Analytics-Logging.md) and [Azure Logging: Using Logs to Track Storage Requests](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/08/03/windows-azure-storage-logging-using-logs-to-track-storage-requests.aspx).|  
  
### Request Body

The format of the request body is as follows:

```xml
<?xml version="1.0" encoding="utf-8"?>  
<KeyInfo>  
    <Start>String, formatted ISO Date</Start>
    <Expiry>String, formatted ISO Date </Expiry>
</KeyInfo>  
```

The following table describes the elements of the request body:  

|Element Name|Description|
|------------------|-----------------|  
|**Start**|Required. The start time for the user delegation SAS, in ISO Date format. It must be a valid date and time within 7 days of the current time. |
|**Expiry**|Required. The expiry time of user delegation SAS, in ISO Date format. It must be a valid date and time within 7 days of the current time. |

## Response

The response includes an HTTP status code and a set of response headers.  
  
### Status Code

A successful operation returns status code 200 (OK).  
  
For information about status codes, see [Status and Error Codes](Status-and-Error-Codes2.md).  
  
### Response Headers

The response for this operation includes the following headers. The response may also include additional standard HTTP headers. All standard headers conform to the [HTTP/1.1 protocol specification](http://go.microsoft.com/fwlink/?linkid=150478).  
  
|Response Header|Description|  
|--------------------|-----------------|  
|`x-ms-request-id`|This header uniquely identifies the request that was made and can be used for troubleshooting the request. For more information, see [Troubleshooting API Operations](Troubleshooting-API-Operations.md).|  
|`x-ms-version`|Indicates the version of the Blob service used to execute the request.|  
|`Date`|A UTC date/time value generated by the service that indicates the time at which the response was initiated.|  
|`x-ms-client-request-id`|This header can be used to troubleshoot requests and corresponding responses. The value of this header is equal to the value of the `x-ms-client-request-id` header if it is present in the request and the value is at most 1024 visible ASCII characters. If the `x-ms-client-request-id` header is not present in the request, this header will not be present in the response.|  

### Response Body

The format of the response body is as follows:

```xml
<?xml version="1.0" encoding="utf-8"?>
<UserDelegationKey>
    <SignedOid>String, a GUID</SignedOid>
    <SignedTid>String, a GUID</SignedTid>
    <SignedStart>String, formatted ISO Date</SignedStart>
    <SignedExpiry>String, formatted ISO Date</SignedExpiry>
    <SignedService>b</SignedService>
    <SignedVersion>String, rest api version used to create delegation key</SignedVersion>
    <Value>String, key signature</Value>
</UserDelegationKey>
```

The following table describes the elements of the response body:

|Element Name|Description|  
|------------------|-----------------|  
|**SignedOid**|The immutable identifier for an object in the Microsoft identity system.|  
|**SignedTid**|A GUID that represents the Azure AD tenant that the user is from.|  
|**SignedStart**|The start time of the user delegation key, in ISO Date format.|  
|**SignedExpiry**|The expiry time of the user delegation key, in ISO Date format.|  
|**SignedService**|The service of the user delegation key can be used for, b represents Blob service.|
|**SignedVersion**|The rest api version used to get user delegation key.|  
|**Value**|The signature of the user delegation key.|  

## Authorization

Only the account owner may call this operation.  
  
## Remarks

A user delegation key cannot be used to access resources in the Blob service directly. However, it can be used to generate a user delegation SAS, which grants access to the specified Blob service resources, with the specified permissions and over the specified interval.
  
## See Also

- [Authentication for the Azure Storage Services](authorization-for-the-azure-storage-services.md)   
- [Status and Error Codes](Status-and-Error-Codes2.md)   
- [Blob Service Error Codes](Blob-Service-Error-Codes.md)   